"use strict";var f3=Object.defineProperty,p3=Object.defineProperties,g3=Object.getOwnPropertyDescriptors,KV=Object.getOwnPropertySymbols,m3=Object.prototype.hasOwnProperty,_3=Object.prototype.propertyIsEnumerable,ZV=(Qe,ve,F)=>ve in Qe?f3(Qe,ve,{enumerable:!0,configurable:!0,writable:!0,value:F}):Qe[ve]=F,YV=(Qe,ve)=>{for(var F in ve||(ve={}))m3.call(ve,F)&&ZV(Qe,F,ve[F]);if(KV)for(var F of KV(ve))_3.call(ve,F)&&ZV(Qe,F,ve[F]);return Qe},QV=(Qe,ve)=>p3(Qe,g3(ve));(self.webpackChunktictactoe=self.webpackChunktictactoe||[]).push([[179],{2011:(Qe,ve,F)=>{F.d(ve,{Dh:()=>De,GT:()=>Ce,cc:()=>Oe,on:()=>Re,pX:()=>ae,xv:()=>de});var g=F(5e3),U=F(127);Qe=F.hmd(Qe);const k=["ngOnDestroy"],ae=(ne,ye,We,$e={})=>new Proxy(ne,{get:(Se,ge)=>We.runOutsideAngular(()=>{var he;if(ne[ge])return(null===(he=null==$e?void 0:$e.spy)||void 0===he?void 0:he.get)&&$e.spy.get(ge,ne[ge]),ne[ge];if(k.indexOf(ge)>-1)return()=>{};const Fe=ye.toPromise().then(X=>{const oe=X&&X[ge];return"function"==typeof oe?oe.bind(X):oe&&oe.then?oe.then(fe=>We.run(()=>fe)):We.run(()=>oe)});return new Proxy(()=>{},{get:(X,oe)=>Fe[oe],apply:(X,oe,fe)=>Fe.then(Y=>{var J;const ee=Y&&Y(...fe);return(null===(J=null==$e?void 0:$e.spy)||void 0===J?void 0:J.apply)&&$e.spy.apply(ge,fe,ee),ee})})})}),Ce=(ne,ye)=>{ye.forEach(We=>{Object.getOwnPropertyNames(We.prototype||We).forEach($e=>{Object.defineProperty(ne.prototype,$e,Object.getOwnPropertyDescriptor(We.prototype||We,$e))})})};class we{constructor(ye){return ye}}const De=new g.OlP("angularfire2.app.options"),de=new g.OlP("angularfire2.app.name");function Re(ne,ye,We){const Se="object"==typeof We&&We||{};Se.name=Se.name||"string"==typeof We&&We||"[DEFAULT]";const he=U.Z.apps.filter(Fe=>Fe&&Fe.name===Se.name)[0]||ye.runOutsideAngular(()=>U.Z.initializeApp(ne,Se));try{JSON.stringify(ne)!==JSON.stringify(he.options)&&H("error",`${he.name} Firebase App already initialized with different options${Qe.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(Fe){}return new we(he)}const H=(ne,...ye)=>{(0,g.X6Q)()&&"undefined"!=typeof console&&console[ne](...ye)};function Oe(ne,ye,We,$e,Se){const[,ge,he]=globalThis.\u0275AngularfireInstanceCache.find(Fe=>Fe[0]===ne)||[];if(ge)return function Ae(ne,ye){try{return ne.toString()===ye.toString()}catch(We){return ne===ye}}(Se,he)||(ke("error",`${ye} was already initialized on the ${We} Firebase App with different settings.${Le?" You may need to reload as Firebase is not HMR aware.":""}`),ke("warn",{is:Se,was:he})),ge;{const Fe=$e();return globalThis.\u0275AngularfireInstanceCache.push([ne,Fe,Se]),Fe}}const Le=!!Qe.hot,ke=(ne,...ye)=>{(0,g.X6Q)()&&"undefined"!=typeof console&&console[ne](...ye)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},7573:(Qe,ve,F)=>{F.d(ve,{$:()=>Vo,A:()=>$,B:()=>Ae,G:()=>nn,H:()=>Jt,J:()=>as,L:()=>B,M:()=>Wc,N:()=>qa,P:()=>iu,Q:()=>Gu,R:()=>Ls,T:()=>t_,U:()=>za,V:()=>zu,W:()=>zc,X:()=>Cf,Y:()=>Yu,Z:()=>us,_:()=>Lo,a:()=>Xn,a0:()=>Af,a1:()=>i_,a2:()=>s_,a3:()=>Ie,a4:()=>Xu,a5:()=>Sf,a6:()=>Ui,a7:()=>Yc,a8:()=>o_,a9:()=>a_,aA:()=>js,aB:()=>ta,aC:()=>cd,aD:()=>ml,aE:()=>Pe,aI:()=>Wo,aL:()=>ho,aa:()=>ls,ab:()=>$o,ac:()=>u_,af:()=>Jc,ag:()=>Mf,ah:()=>Rf,ak:()=>Kc,al:()=>f_,an:()=>sl,ao:()=>L0,ap:()=>Kt,aq:()=>fe,ar:()=>Ze,as:()=>ze,at:()=>$e,au:()=>_d,av:()=>uu,aw:()=>Se,ax:()=>X,ay:()=>J,az:()=>V,b:()=>gt,c:()=>Qo,d:()=>Gf,e:()=>Wf,f:()=>hd,g:()=>Bs,h:()=>Ot,i:()=>pi,j:()=>ea,k:()=>Jf,l:()=>od,m:()=>ep,o:()=>de,r:()=>$0,s:()=>g_,u:()=>ud});var g=F(5861),U=F(2090),k=F(9681),ae=F(1877),Ce=F(655),we=F(4859);const de={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},$={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Ae=function te(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Le=function Oe(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ke=new U.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ye=new ae.Yd("@firebase/auth");function We(E,...p){ye.logLevel<=ae.in.ERROR&&ye.error(`Auth (${k.SDK_VERSION}): ${E}`,...p)}function $e(E,...p){throw Fe(E,...p)}function Se(E,...p){return Fe(E,...p)}function ge(E,p,_){const I=Object.assign(Object.assign({},Le()),{[p]:_});return new U.LL("auth","Firebase",I).create(p,{appName:E.name})}function he(E,p,_){if(!(p instanceof _))throw _.name!==p.constructor.name&&$e(E,"argument-error"),ge(E,"argument-error",`Type of ${p.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Fe(E,...p){if("string"!=typeof E){const _=p[0],I=[...p.slice(1)];return I[0]&&(I[0].appName=E.name),E._errorFactory.create(_,...I)}return ke.create(E,...p)}function X(E,p,..._){if(!E)throw Fe(p,..._)}function oe(E){const p="INTERNAL ASSERTION FAILED: "+E;throw We(p),new Error(p)}function fe(E,p){E||oe(p)}const Y=new Map;function J(E){fe(E instanceof Function,"Expected a class definition");let p=Y.get(E);return p?(fe(p instanceof E,"Instance stored in cache mismatched with class"),p):(p=new E,Y.set(E,p),p)}function ie(){var E;return"undefined"!=typeof self&&(null===(E=self.location)||void 0===E?void 0:E.href)||""}function Me(){return"http:"===nt()||"https:"===nt()}function nt(){var E;return"undefined"!=typeof self&&(null===(E=self.location)||void 0===E?void 0:E.protocol)||null}class je{constructor(p,_){this.shortDelay=p,this.longDelay=_,fe(_>p,"Short delay should be less than long delay!"),this.isMobile=(0,U.uI)()||(0,U.b$)()}get(){return function Wt(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Me()||(0,U.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Yt(E,p){fe(E.emulator,"Emulator should always be set here");const{url:_}=E.emulator;return p?`${_}${p.startsWith("/")?p.slice(1):p}`:_}class Nn{static initialize(p,_,I){this.fetchImpl=p,_&&(this.headersImpl=_),I&&(this.responseImpl=I)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void oe("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void oe("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void oe("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const un={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},zt=new je(3e4,6e4);function xt(E,p){return E.tenantId&&!p.tenantId?Object.assign(Object.assign({},p),{tenantId:E.tenantId}):p}function Lt(E,p,_,I){return fn.apply(this,arguments)}function fn(){return(fn=(0,g.Z)(function*(E,p,_,I,A={}){return Ar(E,A,(0,g.Z)(function*(){let R={},Q={};I&&("GET"===p?Q=I:R={body:JSON.stringify(I)});const me=(0,U.xO)(Object.assign({key:E.config.apiKey},Q)).slice(1),Ge=yield E._getAdditionalHeaders();return Ge["Content-Type"]="application/json",E.languageCode&&(Ge["X-Firebase-Locale"]=E.languageCode),Nn.fetch()(li(E,E.config.apiHost,_,me),Object.assign({method:p,headers:Ge,referrerPolicy:"no-referrer"},R))}))})).apply(this,arguments)}function Ar(E,p,_){return oo.apply(this,arguments)}function oo(){return(oo=(0,g.Z)(function*(E,p,_){E._canInitEmulator=!1;const I=Object.assign(Object.assign({},un),p);try{const A=new ci(E),R=yield Promise.race([_(),A.promise]);A.clearNetworkTimeout();const Q=yield R.json();if("needConfirmation"in Q)throw gr(E,"account-exists-with-different-credential",Q);if(R.ok&&!("errorMessage"in Q))return Q;{const me=R.ok?Q.errorMessage:Q.error.message,[Ge,et]=me.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Ge)throw gr(E,"credential-already-in-use",Q);if("EMAIL_EXISTS"===Ge)throw gr(E,"email-already-in-use",Q);if("USER_DISABLED"===Ge)throw gr(E,"user-disabled",Q);const wt=I[Ge]||Ge.toLowerCase().replace(/[_\s]+/g,"-");if(et)throw ge(E,wt,et);$e(E,wt)}}catch(A){if(A instanceof U.ZR)throw A;$e(E,"network-request-failed")}})).apply(this,arguments)}function Dn(E,p,_,I){return ts.apply(this,arguments)}function ts(){return(ts=(0,g.Z)(function*(E,p,_,I,A={}){const R=yield Lt(E,p,_,I,A);return"mfaPendingCredential"in R&&$e(E,"multi-factor-auth-required",{_serverResponse:R}),R})).apply(this,arguments)}function li(E,p,_,I){const A=`${p}${_}?${I}`;return E.config.emulator?Yt(E.config,A):`${E.config.apiScheme}://${A}`}class ci{constructor(p){this.auth=p,this.timer=null,this.promise=new Promise((_,I)=>{this.timer=setTimeout(()=>I(Se(this.auth,"network-request-failed")),zt.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function gr(E,p,_){const I={appName:E.name};_.email&&(I.email=_.email),_.phoneNumber&&(I.phoneNumber=_.phoneNumber);const A=Se(E,p,I);return A.customData._tokenResponse=_,A}function it(){return(it=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:delete",p)})).apply(this,arguments)}function Gr(E,p){return ln.apply(this,arguments)}function ln(){return(ln=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function tn(E,p){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:lookup",p)})).apply(this,arguments)}function Ei(E){if(E)try{const p=new Date(Number(E));if(!isNaN(p.getTime()))return p.toUTCString()}catch(p){}}function or(){return(or=(0,g.Z)(function*(E,p=!1){const _=(0,U.m9)(E),I=yield _.getIdToken(p),A=Ft(I);X(A&&A.exp&&A.auth_time&&A.iat,_.auth,"internal-error");const R="object"==typeof A.firebase?A.firebase:void 0,Q=null==R?void 0:R.sign_in_provider;return{claims:A,token:I,authTime:Ei(ns(A.auth_time)),issuedAtTime:Ei(ns(A.iat)),expirationTime:Ei(ns(A.exp)),signInProvider:Q||null,signInSecondFactor:(null==R?void 0:R.sign_in_second_factor)||null}})).apply(this,arguments)}function ns(E){return 1e3*Number(E)}function Ft(E){var p;const[_,I,A]=E.split(".");if(void 0===_||void 0===I||void 0===A)return We("JWT malformed, contained fewer than 3 sections"),null;try{const R=(0,U.tV)(I);return R?JSON.parse(R):(We("Failed to decode base64 JWT payload"),null)}catch(R){return We("Caught error parsing JWT payload as JSON",null===(p=R)||void 0===p?void 0:p.toString()),null}}function Ke(E,p){return wi.apply(this,arguments)}function wi(){return(wi=(0,g.Z)(function*(E,p,_=!1){if(_)return p;try{return yield p}catch(I){throw I instanceof U.ZR&&qr(I)&&E.auth.currentUser===E&&(yield E.auth.signOut()),I}})).apply(this,arguments)}function qr({code:E}){return"auth/user-disabled"===E||"auth/user-token-expired"===E}class Vt{constructor(p){this.user=p,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(p){var _;if(p){const I=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),I}{this.errorBackoff=3e4;const A=(null!==(_=this.user.stsTokenManager.expirationTime)&&void 0!==_?_:0)-Date.now()-3e5;return Math.max(0,A)}}schedule(p=!1){var _=this;if(!this.isRunning)return;const I=this.getInterval(p);this.timerId=setTimeout((0,g.Z)(function*(){yield _.iteration()}),I)}iteration(){var p=this;return(0,g.Z)(function*(){var _;try{yield p.user.getIdToken(!0)}catch(I){return void("auth/network-request-failed"===(null===(_=I)||void 0===_?void 0:_.code)&&p.schedule(!0))}p.schedule()})()}}class rs{constructor(p,_){this.createdAt=p,this.lastLoginAt=_,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ei(this.lastLoginAt),this.creationTime=Ei(this.createdAt)}_copy(p){this.createdAt=p.createdAt,this.lastLoginAt=p.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Pn(E){return Qt.apply(this,arguments)}function Qt(){return(Qt=(0,g.Z)(function*(E){var p;const _=E.auth,I=yield E.getIdToken(),A=yield Ke(E,tn(_,{idToken:I}));X(null==A?void 0:A.users.length,_,"internal-error");const R=A.users[0];E._notifyReloadListener(R);const Q=(null===(p=R.providerUserInfo)||void 0===p?void 0:p.length)?Yn(R.providerUserInfo):[],me=Ut(E.providerData,Q),wt=!!E.isAnonymous&&!(E.email&&R.passwordHash||(null==me?void 0:me.length)),rn={uid:R.localId,displayName:R.displayName||null,photoURL:R.photoUrl||null,email:R.email||null,emailVerified:R.emailVerified||!1,phoneNumber:R.phoneNumber||null,tenantId:R.tenantId||null,providerData:me,metadata:new rs(R.createdAt,R.lastLoginAt),isAnonymous:wt};Object.assign(E,rn)})).apply(this,arguments)}function Kr(){return(Kr=(0,g.Z)(function*(E){const p=(0,U.m9)(E);yield Pn(p),yield p.auth._persistUserIfCurrent(p),p.auth._notifyListenersIfCurrent(p)})).apply(this,arguments)}function Ut(E,p){return[...E.filter(I=>!p.some(A=>A.providerId===I.providerId)),...p]}function Yn(E){return E.map(p=>{var{providerId:_}=p,I=(0,Ce._T)(p,["providerId"]);return{providerId:_,uid:I.rawId||"",displayName:I.displayName||null,email:I.email||null,phoneNumber:I.phoneNumber||null,photoURL:I.photoUrl||null}})}function pe(){return(pe=(0,g.Z)(function*(E,p){const _=yield Ar(E,{},(0,g.Z)(function*(){const I=(0,U.xO)({grant_type:"refresh_token",refresh_token:p}).slice(1),{tokenApiHost:A,apiKey:R}=E.config,Q=li(E,A,"/v1/token",`key=${R}`),me=yield E._getAdditionalHeaders();return me["Content-Type"]="application/x-www-form-urlencoded",Nn.fetch()(Q,{method:"POST",headers:me,body:I})}));return{accessToken:_.access_token,expiresIn:_.expires_in,refreshToken:_.refresh_token}})).apply(this,arguments)}class Ue{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(p){X(p.idToken,"internal-error"),X(void 0!==p.idToken,"internal-error"),X(void 0!==p.refreshToken,"internal-error");const _="expiresIn"in p&&void 0!==p.expiresIn?Number(p.expiresIn):function tt(E){const p=Ft(E);return X(p,"internal-error"),X(void 0!==p.exp,"internal-error"),X(void 0!==p.iat,"internal-error"),Number(p.exp)-Number(p.iat)}(p.idToken);this.updateTokensAndExpiration(p.idToken,p.refreshToken,_)}getToken(p,_=!1){var I=this;return(0,g.Z)(function*(){return X(!I.accessToken||I.refreshToken,p,"user-token-expired"),_||!I.accessToken||I.isExpired?I.refreshToken?(yield I.refresh(p,I.refreshToken),I.accessToken):null:I.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(p,_){var I=this;return(0,g.Z)(function*(){const{accessToken:A,refreshToken:R,expiresIn:Q}=yield function He(E,p){return pe.apply(this,arguments)}(p,_);I.updateTokensAndExpiration(A,R,Number(Q))})()}updateTokensAndExpiration(p,_,I){this.refreshToken=_||null,this.accessToken=p||null,this.expirationTime=Date.now()+1e3*I}static fromJSON(p,_){const{refreshToken:I,accessToken:A,expirationTime:R}=_,Q=new Ue;return I&&(X("string"==typeof I,"internal-error",{appName:p}),Q.refreshToken=I),A&&(X("string"==typeof A,"internal-error",{appName:p}),Q.accessToken=A),R&&(X("number"==typeof R,"internal-error",{appName:p}),Q.expirationTime=R),Q}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(p){this.accessToken=p.accessToken,this.refreshToken=p.refreshToken,this.expirationTime=p.expirationTime}_clone(){return Object.assign(new Ue,this.toJSON())}_performRefresh(){return oe("not implemented")}}function ot(E,p){X("string"==typeof E||void 0===E,"internal-error",{appName:p})}class lt{constructor(p){var{uid:_,auth:I,stsTokenManager:A}=p,R=(0,Ce._T)(p,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Vt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=_,this.auth=I,this.stsTokenManager=A,this.accessToken=A.accessToken,this.displayName=R.displayName||null,this.email=R.email||null,this.emailVerified=R.emailVerified||!1,this.phoneNumber=R.phoneNumber||null,this.photoURL=R.photoURL||null,this.isAnonymous=R.isAnonymous||!1,this.tenantId=R.tenantId||null,this.providerData=R.providerData?[...R.providerData]:[],this.metadata=new rs(R.createdAt||void 0,R.lastLoginAt||void 0)}getIdToken(p){var _=this;return(0,g.Z)(function*(){const I=yield Ke(_,_.stsTokenManager.getToken(_.auth,p));return X(I,_.auth,"internal-error"),_.accessToken!==I&&(_.accessToken=I,yield _.auth._persistUserIfCurrent(_),_.auth._notifyListenersIfCurrent(_)),I})()}getIdTokenResult(p){return function pn(E){return or.apply(this,arguments)}(this,p)}reload(){return function rt(E){return Kr.apply(this,arguments)}(this)}_assign(p){this!==p&&(X(this.uid===p.uid,this.auth,"internal-error"),this.displayName=p.displayName,this.photoURL=p.photoURL,this.email=p.email,this.emailVerified=p.emailVerified,this.phoneNumber=p.phoneNumber,this.isAnonymous=p.isAnonymous,this.tenantId=p.tenantId,this.providerData=p.providerData.map(_=>Object.assign({},_)),this.metadata._copy(p.metadata),this.stsTokenManager._assign(p.stsTokenManager))}_clone(p){return new lt(Object.assign(Object.assign({},this),{auth:p,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(p){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=p,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(p){this.reloadListener?this.reloadListener(p):this.reloadUserInfo=p}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(p,_=!1){var I=this;return(0,g.Z)(function*(){let A=!1;p.idToken&&p.idToken!==I.stsTokenManager.accessToken&&(I.stsTokenManager.updateFromServerResponse(p),A=!0),_&&(yield Pn(I)),yield I.auth._persistUserIfCurrent(I),A&&I.auth._notifyListenersIfCurrent(I)})()}delete(){var p=this;return(0,g.Z)(function*(){const _=yield p.getIdToken();return yield Ke(p,function xs(E,p){return it.apply(this,arguments)}(p.auth,{idToken:_})),p.stsTokenManager.clearRefreshToken(),p.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(p=>Object.assign({},p)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(p,_){var I,A,R,Q,me,Ge,et,wt;const rn=null!==(I=_.displayName)&&void 0!==I?I:void 0,ti=null!==(A=_.email)&&void 0!==A?A:void 0,_s=null!==(R=_.phoneNumber)&&void 0!==R?R:void 0,Hs=null!==(Q=_.photoURL)&&void 0!==Q?Q:void 0,Al=null!==(me=_.tenantId)&&void 0!==me?me:void 0,Ed=null!==(Ge=_._redirectEventId)&&void 0!==Ge?Ge:void 0,wd=null!==(et=_.createdAt)&&void 0!==et?et:void 0,Sl=null!==(wt=_.lastLoginAt)&&void 0!==wt?wt:void 0,{uid:oa,emailVerified:sp,isAnonymous:aa,providerData:Mr,stsTokenManager:wn}=_;X(oa&&wn,p,"internal-error");const op=Ue.fromJSON(this.name,wn);X("string"==typeof oa,p,"internal-error"),ot(rn,p.name),ot(ti,p.name),X("boolean"==typeof sp,p,"internal-error"),X("boolean"==typeof aa,p,"internal-error"),ot(_s,p.name),ot(Hs,p.name),ot(Al,p.name),ot(Ed,p.name),ot(wd,p.name),ot(Sl,p.name);const ua=new lt({uid:oa,auth:p,email:ti,emailVerified:sp,displayName:rn,isAnonymous:aa,photoURL:Hs,phoneNumber:_s,tenantId:Al,stsTokenManager:op,createdAt:wd,lastLoginAt:Sl});return Mr&&Array.isArray(Mr)&&(ua.providerData=Mr.map(la=>Object.assign({},la))),Ed&&(ua._redirectEventId=Ed),ua}static _fromIdTokenResponse(p,_,I=!1){return(0,g.Z)(function*(){const A=new Ue;A.updateFromServerResponse(_);const R=new lt({uid:_.localId,auth:p,stsTokenManager:A,isAnonymous:I});return yield Pn(R),R})()}}const B=(()=>{class E{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,g.Z)(function*(){return!0})()}_set(_,I){var A=this;return(0,g.Z)(function*(){A.storage[_]=I})()}_get(_){var I=this;return(0,g.Z)(function*(){const A=I.storage[_];return void 0===A?null:A})()}_remove(_){var I=this;return(0,g.Z)(function*(){delete I.storage[_]})()}_addListener(_,I){}_removeListener(_,I){}}return E.type="NONE",E})();function V(E,p,_){return`firebase:${E}:${p}:${_}`}class q{constructor(p,_,I){this.persistence=p,this.auth=_,this.userKey=I;const{config:A,name:R}=this.auth;this.fullUserKey=V(this.userKey,A.apiKey,R),this.fullPersistenceKey=V("persistence",A.apiKey,R),this.boundEventHandler=_._onStorageEvent.bind(_),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(p){return this.persistence._set(this.fullUserKey,p.toJSON())}getCurrentUser(){var p=this;return(0,g.Z)(function*(){const _=yield p.persistence._get(p.fullUserKey);return _?lt._fromJSON(p.auth,_):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(p){var _=this;return(0,g.Z)(function*(){if(_.persistence===p)return;const I=yield _.getCurrentUser();return yield _.removeCurrentUser(),_.persistence=p,I?_.setCurrentUser(I):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(p,_,I="authUser"){return(0,g.Z)(function*(){if(!_.length)return new q(J(B),p,I);const A=(yield Promise.all(_.map(function(){var et=(0,g.Z)(function*(wt){if(yield wt._isAvailable())return wt});return function(wt){return et.apply(this,arguments)}}()))).filter(et=>et);let R=A[0]||J(B);const Q=V(I,p.config.apiKey,p.name);let me=null;for(const et of _)try{const wt=yield et._get(Q);if(wt){const rn=lt._fromJSON(p,wt);et!==R&&(me=rn),R=et;break}}catch(wt){}const Ge=A.filter(et=>et._shouldAllowMigration);return R._shouldAllowMigration&&Ge.length?(R=Ge[0],me&&(yield R._set(Q,me.toJSON())),yield Promise.all(_.map(function(){var et=(0,g.Z)(function*(wt){if(wt!==R)try{yield wt._remove(Q)}catch(rn){}});return function(wt){return et.apply(this,arguments)}}())),new q(R,p,I)):new q(R,p,I)})()}}function L(E){const p=E.toLowerCase();if(p.includes("opera/")||p.includes("opr/")||p.includes("opios/"))return"Opera";if(Te(p))return"IEMobile";if(p.includes("msie")||p.includes("trident/"))return"IE";if(p.includes("edge/"))return"Edge";if(M(p))return"Firefox";if(p.includes("silk/"))return"Silk";if(Je(p))return"Blackberry";if(yt(p))return"Webos";if(O(p))return"Safari";if((p.includes("chrome/")||re(p))&&!p.includes("edge/"))return"Chrome";if(ze(p))return"Android";{const I=E.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==I?void 0:I.length))return I[1]}return"Other"}function M(E=(0,U.z$)()){return/firefox\//i.test(E)}function O(E=(0,U.z$)()){const p=E.toLowerCase();return p.includes("safari/")&&!p.includes("chrome/")&&!p.includes("crios/")&&!p.includes("android")}function re(E=(0,U.z$)()){return/crios\//i.test(E)}function Te(E=(0,U.z$)()){return/iemobile/i.test(E)}function ze(E=(0,U.z$)()){return/android/i.test(E)}function Je(E=(0,U.z$)()){return/blackberry/i.test(E)}function yt(E=(0,U.z$)()){return/webos/i.test(E)}function Ze(E=(0,U.z$)()){return/iphone|ipad|ipod/i.test(E)||/macintosh/i.test(E)&&/mobile/i.test(E)}function Kt(E=(0,U.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(E)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(E)}function ar(E=(0,U.z$)()){return Ze(E)||ze(E)||yt(E)||Je(E)||/windows phone/i.test(E)||Te(E)}function Qn(E,p=[]){let _;switch(E){case"Browser":_=L((0,U.z$)());break;case"Worker":_=`${L((0,U.z$)())}-${E}`;break;default:_=E}const I=p.length?p.join(","):"FirebaseCore-web";return`${_}/JsCore/${k.SDK_VERSION}/${I}`}class $c{constructor(p){this.auth=p,this.queue=[]}pushCallback(p,_){const I=R=>new Promise((Q,me)=>{try{Q(p(R))}catch(Ge){me(Ge)}});I.onAbort=_,this.queue.push(I);const A=this.queue.length-1;return()=>{this.queue[A]=()=>Promise.resolve()}}runMiddleware(p){var _=this;return(0,g.Z)(function*(){var I;if(_.auth.currentUser===p)return;const A=[];try{for(const R of _.queue)yield R(p),R.onAbort&&A.push(R.onAbort)}catch(R){A.reverse();for(const Q of A)try{Q()}catch(me){}throw _.auth._errorFactory.create("login-blocked",{originalMessage:null===(I=R)||void 0===I?void 0:I.message})}})()}}class di{constructor(p,_,I){this.app=p,this.heartbeatServiceProvider=_,this.config=I,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dt(this),this.idTokenSubscription=new Dt(this),this.beforeStateQueue=new $c(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ke,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=p.name,this.clientVersion=I.sdkClientVersion}_initializeWithPersistence(p,_){var I=this;return _&&(this._popupRedirectResolver=J(_)),this._initializationPromise=this.queue((0,g.Z)(function*(){var A,R;if(!I._deleted&&(I.persistenceManager=yield q.create(I,p),!I._deleted)){if(null===(A=I._popupRedirectResolver)||void 0===A?void 0:A._shouldInitProactively)try{yield I._popupRedirectResolver._initialize(I)}catch(Q){}yield I.initializeCurrentUser(_),I.lastNotifiedUid=(null===(R=I.currentUser)||void 0===R?void 0:R.uid)||null,!I._deleted&&(I._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var p=this;return(0,g.Z)(function*(){if(p._deleted)return;const _=yield p.assertedPersistence.getCurrentUser();if(p.currentUser||_){if(p.currentUser&&_&&p.currentUser.uid===_.uid)return p._currentUser._assign(_),void(yield p.currentUser.getIdToken());yield p._updateCurrentUser(_,!0)}})()}initializeCurrentUser(p){var _=this;return(0,g.Z)(function*(){var I;const A=yield _.assertedPersistence.getCurrentUser();let R=A,Q=!1;if(p&&_.config.authDomain){yield _.getOrInitRedirectPersistenceManager();const me=null===(I=_.redirectUser)||void 0===I?void 0:I._redirectEventId,Ge=null==R?void 0:R._redirectEventId,et=yield _.tryRedirectSignIn(p);(!me||me===Ge)&&(null==et?void 0:et.user)&&(R=et.user,Q=!0)}if(!R)return _.directlySetCurrentUser(null);if(!R._redirectEventId){if(Q)try{yield _.beforeStateQueue.runMiddleware(R)}catch(me){R=A,_._popupRedirectResolver._overrideRedirectResult(_,()=>Promise.reject(me))}return R?_.reloadAndSetCurrentUserOrClear(R):_.directlySetCurrentUser(null)}return X(_._popupRedirectResolver,_,"argument-error"),yield _.getOrInitRedirectPersistenceManager(),_.redirectUser&&_.redirectUser._redirectEventId===R._redirectEventId?_.directlySetCurrentUser(R):_.reloadAndSetCurrentUserOrClear(R)})()}tryRedirectSignIn(p){var _=this;return(0,g.Z)(function*(){let I=null;try{I=yield _._popupRedirectResolver._completeRedirectFn(_,p,!0)}catch(A){yield _._setRedirectUser(null)}return I})()}reloadAndSetCurrentUserOrClear(p){var _=this;return(0,g.Z)(function*(){var I;try{yield Pn(p)}catch(A){if("auth/network-request-failed"!==(null===(I=A)||void 0===I?void 0:I.code))return _.directlySetCurrentUser(null)}return _.directlySetCurrentUser(p)})()}useDeviceLanguage(){this.languageCode=function St(){if("undefined"==typeof navigator)return null;const E=navigator;return E.languages&&E.languages[0]||E.language||null}()}_delete(){var p=this;return(0,g.Z)(function*(){p._deleted=!0})()}updateCurrentUser(p){var _=this;return(0,g.Z)(function*(){const I=p?(0,U.m9)(p):null;return I&&X(I.auth.config.apiKey===_.config.apiKey,_,"invalid-user-token"),_._updateCurrentUser(I&&I._clone(_))})()}_updateCurrentUser(p,_=!1){var I=this;return(0,g.Z)(function*(){if(!I._deleted)return p&&X(I.tenantId===p.tenantId,I,"tenant-id-mismatch"),_||(yield I.beforeStateQueue.runMiddleware(p)),I.queue((0,g.Z)(function*(){yield I.directlySetCurrentUser(p),I.notifyAuthListeners()}))})()}signOut(){var p=this;return(0,g.Z)(function*(){return yield p.beforeStateQueue.runMiddleware(null),(p.redirectPersistenceManager||p._popupRedirectResolver)&&(yield p._setRedirectUser(null)),p._updateCurrentUser(null,!0)})()}setPersistence(p){var _=this;return this.queue((0,g.Z)(function*(){yield _.assertedPersistence.setPersistence(J(p))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(p){this._errorFactory=new U.LL("auth","Firebase",p())}onAuthStateChanged(p,_,I){return this.registerStateListener(this.authStateSubscription,p,_,I)}beforeAuthStateChanged(p,_){return this.beforeStateQueue.pushCallback(p,_)}onIdTokenChanged(p,_,I){return this.registerStateListener(this.idTokenSubscription,p,_,I)}toJSON(){var p;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(p=this._currentUser)||void 0===p?void 0:p.toJSON()}}_setRedirectUser(p,_){var I=this;return(0,g.Z)(function*(){const A=yield I.getOrInitRedirectPersistenceManager(_);return null===p?A.removeCurrentUser():A.setCurrentUser(p)})()}getOrInitRedirectPersistenceManager(p){var _=this;return(0,g.Z)(function*(){if(!_.redirectPersistenceManager){const I=p&&J(p)||_._popupRedirectResolver;X(I,_,"argument-error"),_.redirectPersistenceManager=yield q.create(_,[J(I._redirectPersistence)],"redirectUser"),_.redirectUser=yield _.redirectPersistenceManager.getCurrentUser()}return _.redirectPersistenceManager})()}_redirectUserForId(p){var _=this;return(0,g.Z)(function*(){var I,A;return _._isInitialized&&(yield _.queue((0,g.Z)(function*(){}))),(null===(I=_._currentUser)||void 0===I?void 0:I._redirectEventId)===p?_._currentUser:(null===(A=_.redirectUser)||void 0===A?void 0:A._redirectEventId)===p?_.redirectUser:null})()}_persistUserIfCurrent(p){var _=this;return(0,g.Z)(function*(){if(p===_.currentUser)return _.queue((0,g.Z)(function*(){return _.directlySetCurrentUser(p)}))})()}_notifyListenersIfCurrent(p){p===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var p,_;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const I=null!==(_=null===(p=this.currentUser)||void 0===p?void 0:p.uid)&&void 0!==_?_:null;this.lastNotifiedUid!==I&&(this.lastNotifiedUid=I,this.authStateSubscription.next(this.currentUser))}registerStateListener(p,_,I,A){if(this._deleted)return()=>{};const R="function"==typeof _?_:_.next.bind(_),Q=this._isInitialized?Promise.resolve():this._initializationPromise;return X(Q,this,"internal-error"),Q.then(()=>R(this.currentUser)),"function"==typeof _?p.addObserver(_,I,A):p.addObserver(_)}directlySetCurrentUser(p){var _=this;return(0,g.Z)(function*(){_.currentUser&&_.currentUser!==p&&_._currentUser._stopProactiveRefresh(),p&&_.isProactiveRefreshEnabled&&p._startProactiveRefresh(),_.currentUser=p,p?yield _.assertedPersistence.setCurrentUser(p):yield _.assertedPersistence.removeCurrentUser()})()}queue(p){return this.operations=this.operations.then(p,p),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(p){!p||this.frameworks.includes(p)||(this.frameworks.push(p),this.frameworks.sort(),this.clientVersion=Qn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var p=this;return(0,g.Z)(function*(){var _;const I={"X-Client-Version":p.clientVersion};p.app.options.appId&&(I["X-Firebase-gmpid"]=p.app.options.appId);const A=yield null===(_=p.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===_?void 0:_.getHeartbeatsHeader();return A&&(I["X-Firebase-Client"]=A),I})()}}function Pe(E){return(0,U.m9)(E)}class Dt{constructor(p){this.auth=p,this.observer=null,this.addObserver=(0,U.ne)(_=>this.observer=_)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function nn(E,p,_){const I=Pe(E);X(I._canInitEmulator,I,"emulator-config-failed"),X(/^https?:\/\//.test(p),I,"invalid-emulator-scheme");const A=!!(null==_?void 0:_.disableWarnings),R=xr(p),{host:Q,port:me}=function ao(E){const p=xr(E),_=/(\/\/)?([^?#/]+)/.exec(E.substr(p.length));if(!_)return{host:"",port:null};const I=_[2].split("@").pop()||"",A=/^(\[[^\]]+\])(:|$)/.exec(I);if(A){const R=A[1];return{host:R,port:Ln(I.substr(R.length+1))}}{const[R,Q]=I.split(":");return{host:R,port:Ln(Q)}}}(p);I.config.emulator={url:`${R}//${Q}${null===me?"":`:${me}`}/`},I.settings.appVerificationDisabledForTesting=!0,I.emulatorConfig=Object.freeze({host:Q,port:me,protocol:R.replace(":",""),options:Object.freeze({disableWarnings:A})}),A||function is(){function E(){const p=document.createElement("p"),_=p.style;p.innerText="Running in emulator mode. Do not use with production credentials.",_.position="fixed",_.width="100%",_.backgroundColor="#ffffff",_.border=".1em solid #000000",_.color="#b50000",_.bottom="0px",_.left="0px",_.margin="0px",_.zIndex="10000",_.textAlign="center",p.classList.add("firebase-emulator-warning"),document.body.appendChild(p)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",E):E())}()}function xr(E){const p=E.indexOf(":");return p<0?"":E.substr(0,p+1)}function Ln(E){if(!E)return null;const p=Number(E);return isNaN(p)?null:p}class Jt{constructor(p,_){this.providerId=p,this.signInMethod=_}toJSON(){return oe("not implemented")}_getIdTokenResponse(p){return oe("not implemented")}_linkToIdToken(p,_){return oe("not implemented")}_getReauthenticationResolver(p){return oe("not implemented")}}function uo(E,p){return Ms.apply(this,arguments)}function Ms(){return(Ms=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:resetPassword",xt(E,p))})).apply(this,arguments)}function Ct(E,p){return No.apply(this,arguments)}function No(){return(No=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function ss(E,p){return $a.apply(this,arguments)}function $a(){return($a=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:update",xt(E,p))})).apply(this,arguments)}function Gn(){return(Gn=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signInWithPassword",xt(E,p))})).apply(this,arguments)}function os(E,p){return lo.apply(this,arguments)}function lo(){return(lo=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:sendOobCode",xt(E,p))})).apply(this,arguments)}function ur(E,p){return Xt.apply(this,arguments)}function Xt(){return(Xt=(0,g.Z)(function*(E,p){return os(E,p)})).apply(this,arguments)}function mf(E,p){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,g.Z)(function*(E,p){return os(E,p)})).apply(this,arguments)}function hi(E,p){return Zr.apply(this,arguments)}function Zr(){return(Zr=(0,g.Z)(function*(E,p){return os(E,p)})).apply(this,arguments)}function Hc(E,p){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,g.Z)(function*(E,p){return os(E,p)})).apply(this,arguments)}function Yr(){return(Yr=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signInWithEmailLink",xt(E,p))})).apply(this,arguments)}function _f(){return(_f=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signInWithEmailLink",xt(E,p))})).apply(this,arguments)}class Hu extends Jt{constructor(p,_,I,A=null){super("password",I),this._email=p,this._password=_,this._tenantId=A}static _fromEmailAndPassword(p,_){return new Hu(p,_,"password")}static _fromEmailAndCode(p,_,I=null){return new Hu(p,_,"emailLink",I)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(p){const _="string"==typeof p?JSON.parse(p):p;if((null==_?void 0:_.email)&&(null==_?void 0:_.password)){if("password"===_.signInMethod)return this._fromEmailAndPassword(_.email,_.password);if("emailLink"===_.signInMethod)return this._fromEmailAndCode(_.email,_.password,_.tenantId)}return null}_getIdTokenResponse(p){var _=this;return(0,g.Z)(function*(){switch(_.signInMethod){case"password":return function Po(E,p){return Gn.apply(this,arguments)}(p,{returnSecureToken:!0,email:_._email,password:_._password});case"emailLink":return function Ga(E,p){return Yr.apply(this,arguments)}(p,{email:_._email,oobCode:_._password});default:$e(p,"internal-error")}})()}_linkToIdToken(p,_){var I=this;return(0,g.Z)(function*(){switch(I.signInMethod){case"password":return Ct(p,{idToken:_,returnSecureToken:!0,email:I._email,password:I._password});case"emailLink":return function e_(E,p){return _f.apply(this,arguments)}(p,{idToken:_,email:I._email,oobCode:I._password});default:$e(p,"internal-error")}})()}_getReauthenticationResolver(p){return this._getIdTokenResponse(p)}}function Vn(E,p){return yf.apply(this,arguments)}function yf(){return(yf=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signInWithIdp",xt(E,p))})).apply(this,arguments)}class as extends Jt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(p){const _=new as(p.providerId,p.signInMethod);return p.idToken||p.accessToken?(p.idToken&&(_.idToken=p.idToken),p.accessToken&&(_.accessToken=p.accessToken),p.nonce&&!p.pendingToken&&(_.nonce=p.nonce),p.pendingToken&&(_.pendingToken=p.pendingToken)):p.oauthToken&&p.oauthTokenSecret?(_.accessToken=p.oauthToken,_.secret=p.oauthTokenSecret):$e("argument-error"),_}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(p){const _="string"==typeof p?JSON.parse(p):p,{providerId:I,signInMethod:A}=_,R=(0,Ce._T)(_,["providerId","signInMethod"]);if(!I||!A)return null;const Q=new as(I,A);return Q.idToken=R.idToken||void 0,Q.accessToken=R.accessToken||void 0,Q.secret=R.secret,Q.nonce=R.nonce,Q.pendingToken=R.pendingToken||null,Q}_getIdTokenResponse(p){return Vn(p,this.buildRequest())}_linkToIdToken(p,_){const I=this.buildRequest();return I.idToken=_,Vn(p,I)}_getReauthenticationResolver(p){const _=this.buildRequest();return _.autoCreate=!1,Vn(p,_)}buildRequest(){const p={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)p.pendingToken=this.pendingToken;else{const _={};this.idToken&&(_.id_token=this.idToken),this.accessToken&&(_.access_token=this.accessToken),this.secret&&(_.oauth_token_secret=this.secret),_.providerId=this.providerId,this.nonce&&!this.pendingToken&&(_.nonce=this.nonce),p.postBody=(0,U.xO)(_)}return p}}function A0(E,p){return ko.apply(this,arguments)}function ko(){return(ko=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:sendVerificationCode",xt(E,p))})).apply(this,arguments)}function vf(){return(vf=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signInWithPhoneNumber",xt(E,p))})).apply(this,arguments)}function Wu(){return(Wu=(0,g.Z)(function*(E,p){const _=yield Dn(E,"POST","/v1/accounts:signInWithPhoneNumber",xt(E,p));if(_.temporaryProof)throw gr(E,"account-exists-with-different-credential",_);return _})).apply(this,arguments)}const M0={USER_NOT_FOUND:"user-not-found"};function Ef(){return(Ef=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signInWithPhoneNumber",xt(E,Object.assign(Object.assign({},p),{operation:"REAUTH"})),M0)})).apply(this,arguments)}class Oo extends Jt{constructor(p){super("phone","phone"),this.params=p}static _fromVerification(p,_){return new Oo({verificationId:p,verificationCode:_})}static _fromTokenResponse(p,_){return new Oo({phoneNumber:p,temporaryProof:_})}_getIdTokenResponse(p){return function S0(E,p){return vf.apply(this,arguments)}(p,this._makeVerificationRequest())}_linkToIdToken(p,_){return function x0(E,p){return Wu.apply(this,arguments)}(p,Object.assign({idToken:_},this._makeVerificationRequest()))}_getReauthenticationResolver(p){return function R0(E,p){return Ef.apply(this,arguments)}(p,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:p,phoneNumber:_,verificationId:I,verificationCode:A}=this.params;return p&&_?{temporaryProof:p,phoneNumber:_}:{sessionInfo:I,code:A}}toJSON(){const p={providerId:this.providerId};return this.params.phoneNumber&&(p.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(p.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(p.verificationCode=this.params.verificationCode),this.params.verificationId&&(p.verificationId=this.params.verificationId),p}static fromJSON(p){"string"==typeof p&&(p=JSON.parse(p));const{verificationId:_,verificationCode:I,phoneNumber:A,temporaryProof:R}=p;return I||_||A||R?new Oo({verificationId:_,verificationCode:I,phoneNumber:A,temporaryProof:R}):null}}class co{constructor(p){var _,I,A,R,Q,me;const Ge=(0,U.zd)((0,U.pd)(p)),et=null!==(_=Ge.apiKey)&&void 0!==_?_:null,wt=null!==(I=Ge.oobCode)&&void 0!==I?I:null,rn=function N0(E){switch(E){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(A=Ge.mode)&&void 0!==A?A:null);X(et&&wt&&rn,"argument-error"),this.apiKey=et,this.operation=rn,this.code=wt,this.continueUrl=null!==(R=Ge.continueUrl)&&void 0!==R?R:null,this.languageCode=null!==(Q=Ge.languageCode)&&void 0!==Q?Q:null,this.tenantId=null!==(me=Ge.tenantId)&&void 0!==me?me:null}static parseLink(p){const _=function wf(E){const p=(0,U.zd)((0,U.pd)(E)).link,_=p?(0,U.zd)((0,U.pd)(p)).deep_link_id:null,I=(0,U.zd)((0,U.pd)(E)).deep_link_id;return(I?(0,U.zd)((0,U.pd)(I)).link:null)||I||_||p||E}(p);try{return new co(_)}catch(I){return null}}}let Wc=(()=>{class E{constructor(){this.providerId=E.PROVIDER_ID}static credential(_,I){return Hu._fromEmailAndPassword(_,I)}static credentialWithLink(_,I){const A=co.parseLink(I);return X(A,"argument-error"),Hu._fromEmailAndCode(_,A.code,A.tenantId)}}return E.PROVIDER_ID="password",E.EMAIL_PASSWORD_SIGN_IN_METHOD="password",E.EMAIL_LINK_SIGN_IN_METHOD="emailLink",E})();class Rs{constructor(p){this.providerId=p,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(p){this.defaultLanguageCode=p}setCustomParameters(p){return this.customParameters=p,this}getCustomParameters(){return this.customParameters}}class fi extends Rs{constructor(){super(...arguments),this.scopes=[]}addScope(p){return this.scopes.includes(p)||this.scopes.push(p),this}getScopes(){return[...this.scopes]}}class za extends fi{static credentialFromJSON(p){const _="string"==typeof p?JSON.parse(p):p;return X("providerId"in _&&"signInMethod"in _,"argument-error"),as._fromParams(_)}credential(p){return this._credential(Object.assign(Object.assign({},p),{nonce:p.rawNonce}))}_credential(p){return X(p.idToken||p.accessToken,"argument-error"),as._fromParams(Object.assign(Object.assign({},p),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(p){return za.oauthCredentialFromTaggedObject(p)}static credentialFromError(p){return za.oauthCredentialFromTaggedObject(p.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthIdToken:_,oauthAccessToken:I,oauthTokenSecret:A,pendingToken:R,nonce:Q,providerId:me}=p;if(!I&&!A&&!_&&!R||!me)return null;try{return new za(me)._credential({idToken:_,accessToken:I,nonce:Q,pendingToken:R})}catch(Ge){return null}}}let qa=(()=>{class E extends fi{constructor(){super("facebook.com")}static credential(_){return as._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.FACEBOOK_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return E.credential(_.oauthAccessToken)}catch(I){return null}}}return E.FACEBOOK_SIGN_IN_METHOD="facebook.com",E.PROVIDER_ID="facebook.com",E})(),Gu=(()=>{class E extends fi{constructor(){super("google.com"),this.addScope("profile")}static credential(_,I){return as._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.GOOGLE_SIGN_IN_METHOD,idToken:_,accessToken:I})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthIdToken:I,oauthAccessToken:A}=_;if(!I&&!A)return null;try{return E.credential(I,A)}catch(R){return null}}}return E.GOOGLE_SIGN_IN_METHOD="google.com",E.PROVIDER_ID="google.com",E})(),t_=(()=>{class E extends fi{constructor(){super("github.com")}static credential(_){return as._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.GITHUB_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return E.credential(_.oauthAccessToken)}catch(I){return null}}}return E.GITHUB_SIGN_IN_METHOD="github.com",E.PROVIDER_ID="github.com",E})();class ho extends Jt{constructor(p,_){super(p,p),this.pendingToken=_}_getIdTokenResponse(p){return Vn(p,this.buildRequest())}_linkToIdToken(p,_){const I=this.buildRequest();return I.idToken=_,Vn(p,I)}_getReauthenticationResolver(p){const _=this.buildRequest();return _.autoCreate=!1,Vn(p,_)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(p){const _="string"==typeof p?JSON.parse(p):p,{providerId:I,signInMethod:A,pendingToken:R}=_;return I&&A&&R&&I===A?new ho(I,R):null}static _create(p,_){return new ho(p,_)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class zu extends Rs{constructor(p){X(p.startsWith("saml."),"argument-error"),super(p)}static credentialFromResult(p){return zu.samlCredentialFromTaggedObject(p)}static credentialFromError(p){return zu.samlCredentialFromTaggedObject(p.customData||{})}static credentialFromJSON(p){const _=ho.fromJSON(p);return X(_,"argument-error"),_}static samlCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{pendingToken:_,providerId:I}=p;if(!_||!I)return null;try{return ho._create(I,_)}catch(A){return null}}}let zc=(()=>{class E extends fi{constructor(){super("twitter.com")}static credential(_,I){return as._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.TWITTER_SIGN_IN_METHOD,oauthToken:_,oauthTokenSecret:I})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthAccessToken:I,oauthTokenSecret:A}=_;if(!I||!A)return null;try{return E.credential(I,A)}catch(R){return null}}}return E.TWITTER_SIGN_IN_METHOD="twitter.com",E.PROVIDER_ID="twitter.com",E})();function If(E,p){return Qr.apply(this,arguments)}function Qr(){return(Qr=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signUp",xt(E,p))})).apply(this,arguments)}class mr{constructor(p){this.user=p.user,this.providerId=p.providerId,this._tokenResponse=p._tokenResponse,this.operationType=p.operationType}static _fromIdTokenResponse(p,_,I,A=!1){return(0,g.Z)(function*(){const R=yield lt._fromIdTokenResponse(p,I,A),Q=n_(I);return new mr({user:R,providerId:Q,_tokenResponse:I,operationType:_})})()}static _forOperation(p,_,I){return(0,g.Z)(function*(){yield p._updateTokensIfNecessary(I,!0);const A=n_(I);return new mr({user:p,providerId:A,_tokenResponse:I,operationType:_})})()}}function n_(E){return E.providerId?E.providerId:"phoneNumber"in E?"phone":null}function Cf(E){return bf.apply(this,arguments)}function bf(){return(bf=(0,g.Z)(function*(E){var p;const _=Pe(E);if(yield _._initializationPromise,null===(p=_.currentUser)||void 0===p?void 0:p.isAnonymous)return new mr({user:_.currentUser,providerId:null,operationType:"signIn"});const I=yield If(_,{returnSecureToken:!0}),A=yield mr._fromIdTokenResponse(_,"signIn",I,!0);return yield _._updateCurrentUser(A.user),A})).apply(this,arguments)}class qu extends U.ZR{constructor(p,_,I,A){var R;super(_.code,_.message),this.operationType=I,this.user=A,Object.setPrototypeOf(this,qu.prototype),this.customData={appName:p.name,tenantId:null!==(R=p.tenantId)&&void 0!==R?R:void 0,_serverResponse:_.customData._serverResponse,operationType:I}}static _fromErrorAndOperation(p,_,I,A){return new qu(p,_,I,A)}}function Ku(E,p,_,I){return("reauthenticate"===p?_._getReauthenticationResolver(E):_._getIdTokenResponse(E)).catch(R=>{throw"auth/multi-factor-auth-required"===R.code?qu._fromErrorAndOperation(E,R,p,I):R})}function qc(E){return new Set(E.map(({providerId:p})=>p).filter(p=>!!p))}function Kc(E,p){return r_.apply(this,arguments)}function r_(){return(r_=(0,g.Z)(function*(E,p){const _=(0,U.m9)(E);yield Fo(!0,_,p);const{providerUserInfo:I}=yield Gr(_.auth,{idToken:yield _.getIdToken(),deleteProvider:[p]}),A=qc(I||[]);return _.providerData=_.providerData.filter(R=>A.has(R.providerId)),A.has("phone")||(_.phoneNumber=null),yield _.auth._persistUserIfCurrent(_),_})).apply(this,arguments)}function cn(E,p){return Zu.apply(this,arguments)}function Zu(){return(Zu=(0,g.Z)(function*(E,p,_=!1){const I=yield Ke(E,p._linkToIdToken(E.auth,yield E.getIdToken()),_);return mr._forOperation(E,"link",I)})).apply(this,arguments)}function Fo(E,p,_){return sn.apply(this,arguments)}function sn(){return(sn=(0,g.Z)(function*(E,p,_){yield Pn(p);const A=!1===E?"provider-already-linked":"no-such-provider";X(qc(p.providerData).has(_)===E,p.auth,A)})).apply(this,arguments)}function Df(E,p){return Ka.apply(this,arguments)}function Ka(){return(Ka=(0,g.Z)(function*(E,p,_=!1){var I;const{auth:A}=E,R="reauthenticate";try{const Q=yield Ke(E,Ku(A,R,p,E),_);X(Q.idToken,A,"internal-error");const me=Ft(Q.idToken);X(me,A,"internal-error");const{sub:Ge}=me;return X(E.uid===Ge,A,"user-mismatch"),mr._forOperation(E,R,Q)}catch(Q){throw"auth/user-not-found"===(null===(I=Q)||void 0===I?void 0:I.code)&&$e(A,"user-mismatch"),Q}})).apply(this,arguments)}function Za(E,p){return _r.apply(this,arguments)}function _r(){return(_r=(0,g.Z)(function*(E,p,_=!1){const I="signIn",A=yield Ku(E,I,p),R=yield mr._fromIdTokenResponse(E,I,A);return _||(yield E._updateCurrentUser(R.user)),R})).apply(this,arguments)}function Yu(E,p){return Ya.apply(this,arguments)}function Ya(){return(Ya=(0,g.Z)(function*(E,p){return Za(Pe(E),p)})).apply(this,arguments)}function us(E,p){return yr.apply(this,arguments)}function yr(){return(yr=(0,g.Z)(function*(E,p){const _=(0,U.m9)(E);return yield Fo(!1,_,p.providerId),cn(_,p)})).apply(this,arguments)}function Lo(E,p){return Ns.apply(this,arguments)}function Ns(){return(Ns=(0,g.Z)(function*(E,p){return Df((0,U.m9)(E),p)})).apply(this,arguments)}function Tf(E,p){return Ci.apply(this,arguments)}function Ci(){return(Ci=(0,g.Z)(function*(E,p){return Dn(E,"POST","/v1/accounts:signInWithCustomToken",xt(E,p))})).apply(this,arguments)}function Vo(E,p){return Uo.apply(this,arguments)}function Uo(){return(Uo=(0,g.Z)(function*(E,p){const _=Pe(E),I=yield Tf(_,{token:p,returnSecureToken:!0}),A=yield mr._fromIdTokenResponse(_,"signIn",I);return yield _._updateCurrentUser(A.user),A})).apply(this,arguments)}class ct{constructor(p,_){this.factorId=p,this.uid=_.mfaEnrollmentId,this.enrollmentTime=new Date(_.enrolledAt).toUTCString(),this.displayName=_.displayName}static _fromServerResponse(p,_){return"phoneInfo"in _?Bo._fromServerResponse(p,_):$e(p,"internal-error")}}class Bo extends ct{constructor(p){super("phone",p),this.phoneNumber=p.phoneInfo}static _fromServerResponse(p,_){return new Bo(_)}}function Qu(E,p,_){var I;X((null===(I=_.url)||void 0===I?void 0:I.length)>0,E,"invalid-continue-uri"),X(void 0===_.dynamicLinkDomain||_.dynamicLinkDomain.length>0,E,"invalid-dynamic-link-domain"),p.continueUrl=_.url,p.dynamicLinkDomain=_.dynamicLinkDomain,p.canHandleCodeInApp=_.handleCodeInApp,_.iOS&&(X(_.iOS.bundleId.length>0,E,"missing-ios-bundle-id"),p.iOSBundleId=_.iOS.bundleId),_.android&&(X(_.android.packageName.length>0,E,"missing-android-pkg-name"),p.androidInstallApp=_.android.installApp,p.androidMinimumVersionCode=_.android.minimumVersion,p.androidPackageName=_.android.packageName)}function Af(E,p,_){return Zc.apply(this,arguments)}function Zc(){return(Zc=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E),A={requestType:"PASSWORD_RESET",email:p};_&&Qu(I,A,_),yield mf(I,A)})).apply(this,arguments)}function i_(E,p,_){return Ju.apply(this,arguments)}function Ju(){return(Ju=(0,g.Z)(function*(E,p,_){yield uo((0,U.m9)(E),{oobCode:p,newPassword:_})})).apply(this,arguments)}function s_(E,p){return jo.apply(this,arguments)}function jo(){return(jo=(0,g.Z)(function*(E,p){yield ss((0,U.m9)(E),{oobCode:p})})).apply(this,arguments)}function Ie(E,p){return Bt.apply(this,arguments)}function Bt(){return(Bt=(0,g.Z)(function*(E,p){const _=(0,U.m9)(E),I=yield uo(_,{oobCode:p}),A=I.requestType;switch(X(A,_,"internal-error"),A){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":X(I.newEmail,_,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":X(I.mfaInfo,_,"internal-error");default:X(I.email,_,"internal-error")}let R=null;return I.mfaInfo&&(R=ct._fromServerResponse(Pe(_),I.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.newEmail:I.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.email:I.newEmail)||null,multiFactorInfo:R},operation:A}})).apply(this,arguments)}function Xu(E,p){return gn.apply(this,arguments)}function gn(){return(gn=(0,g.Z)(function*(E,p){const{data:_}=yield Ie((0,U.m9)(E),p);return _.email})).apply(this,arguments)}function Sf(E,p,_){return Ps.apply(this,arguments)}function Ps(){return(Ps=(0,g.Z)(function*(E,p,_){const I=Pe(E),A=yield If(I,{returnSecureToken:!0,email:p,password:_}),R=yield mr._fromIdTokenResponse(I,"signIn",A);return yield I._updateCurrentUser(R.user),R})).apply(this,arguments)}function Ui(E,p,_){return Yu((0,U.m9)(E),Wc.credential(p,_))}function Yc(E,p,_){return Qa.apply(this,arguments)}function Qa(){return(Qa=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E),A={requestType:"EMAIL_SIGNIN",email:p};X(_.handleCodeInApp,I,"argument-error"),_&&Qu(I,A,_),yield hi(I,A)})).apply(this,arguments)}function o_(E,p){const _=co.parseLink(p);return"EMAIL_SIGNIN"===(null==_?void 0:_.operation)}function a_(E,p,_){return xf.apply(this,arguments)}function xf(){return(xf=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E),A=Wc.credentialWithLink(p,_||ie());return X(A._tenantId===(I.tenantId||null),I,"tenant-id-mismatch"),Yu(I,A)})).apply(this,arguments)}function Ja(E,p){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:createAuthUri",xt(E,p))})).apply(this,arguments)}function ls(E,p){return el.apply(this,arguments)}function el(){return(el=(0,g.Z)(function*(E,p){const I={identifier:p,continueUri:Me()?ie():"http://localhost"},{signinMethods:A}=yield Ja((0,U.m9)(E),I);return A||[]})).apply(this,arguments)}function $o(E,p){return bi.apply(this,arguments)}function bi(){return(bi=(0,g.Z)(function*(E,p){const _=(0,U.m9)(E),A={requestType:"VERIFY_EMAIL",idToken:yield E.getIdToken()};p&&Qu(_.auth,A,p);const{email:R}=yield ur(_.auth,A);R!==E.email&&(yield E.reload())})).apply(this,arguments)}function u_(E,p,_){return tl.apply(this,arguments)}function tl(){return(tl=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E),R={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield E.getIdToken(),newEmail:p};_&&Qu(I.auth,R,_);const{email:Q}=yield Hc(I.auth,R);Q!==E.email&&(yield E.reload())})).apply(this,arguments)}function l_(E,p){return Qc.apply(this,arguments)}function Qc(){return(Qc=(0,g.Z)(function*(E,p){return Lt(E,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Jc(E,p){return nl.apply(this,arguments)}function nl(){return(nl=(0,g.Z)(function*(E,{displayName:p,photoURL:_}){if(void 0===p&&void 0===_)return;const I=(0,U.m9)(E),R={idToken:yield I.getIdToken(),displayName:p,photoUrl:_,returnSecureToken:!0},Q=yield Ke(I,l_(I.auth,R));I.displayName=Q.displayName||null,I.photoURL=Q.photoUrl||null;const me=I.providerData.find(({providerId:Ge})=>"password"===Ge);me&&(me.displayName=I.displayName,me.photoURL=I.photoURL),yield I._updateTokensIfNecessary(Q)})).apply(this,arguments)}function Mf(E,p){return c_((0,U.m9)(E),p,null)}function Rf(E,p){return c_((0,U.m9)(E),null,p)}function c_(E,p,_){return rl.apply(this,arguments)}function rl(){return(rl=(0,g.Z)(function*(E,p,_){const{auth:I}=E,R={idToken:yield E.getIdToken(),returnSecureToken:!0};p&&(R.email=p),_&&(R.password=_);const Q=yield Ke(E,Ct(I,R));yield E._updateTokensIfNecessary(Q,!0)})).apply(this,arguments)}class fo{constructor(p,_,I={}){this.isNewUser=p,this.providerId=_,this.profile=I}}class Nf extends fo{constructor(p,_,I,A){super(p,_,I),this.username=A}}class d_ extends fo{constructor(p,_){super(p,"facebook.com",_)}}class Xc extends Nf{constructor(p,_){super(p,"github.com",_,"string"==typeof(null==_?void 0:_.login)?null==_?void 0:_.login:null)}}class Di extends fo{constructor(p,_){super(p,"google.com",_)}}class h_ extends Nf{constructor(p,_,I){super(p,"twitter.com",_,I)}}function f_(E){const{user:p,_tokenResponse:_}=E;return p.isAnonymous&&!_?{providerId:null,isNewUser:!1,profile:null}:function il(E){var p,_;if(!E)return null;const{providerId:I}=E,A=E.rawUserInfo?JSON.parse(E.rawUserInfo):{},R=E.isNewUser||"identitytoolkit#SignupNewUserResponse"===E.kind;if(!I&&(null==E?void 0:E.idToken)){const Q=null===(_=null===(p=Ft(E.idToken))||void 0===p?void 0:p.firebase)||void 0===_?void 0:_.sign_in_provider;if(Q)return new fo(R,"anonymous"!==Q&&"custom"!==Q?Q:null)}if(!I)return null;switch(I){case"facebook.com":return new d_(R,A);case"github.com":return new Xc(R,A);case"google.com":return new Di(R,A);case"twitter.com":return new h_(R,A,E.screenName||null);case"custom":case"anonymous":return new fo(R,null);default:return new fo(R,I,A)}}(_)}class ds{constructor(p,_,I){this.type=p,this.credential=_,this.auth=I}static _fromIdtoken(p,_){return new ds("enroll",p,_)}static _fromMfaPendingCredential(p){return new ds("signin",p)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(p){var _,I;if(null==p?void 0:p.multiFactorSession){if(null===(_=p.multiFactorSession)||void 0===_?void 0:_.pendingCredential)return ds._fromMfaPendingCredential(p.multiFactorSession.pendingCredential);if(null===(I=p.multiFactorSession)||void 0===I?void 0:I.idToken)return ds._fromIdtoken(p.multiFactorSession.idToken)}return null}}class Xa{constructor(p,_,I){this.session=p,this.hints=_,this.signInResolver=I}static _fromError(p,_){const I=Pe(p),A=_.customData._serverResponse,R=(A.mfaInfo||[]).map(me=>ct._fromServerResponse(I,me));X(A.mfaPendingCredential,I,"internal-error");const Q=ds._fromMfaPendingCredential(A.mfaPendingCredential);return new Xa(Q,R,function(){var me=(0,g.Z)(function*(Ge){const et=yield Ge._process(I,Q);delete A.mfaInfo,delete A.mfaPendingCredential;const wt=Object.assign(Object.assign({},A),{idToken:et.idToken,refreshToken:et.refreshToken});switch(_.operationType){case"signIn":const rn=yield mr._fromIdTokenResponse(I,_.operationType,wt);return yield I._updateCurrentUser(rn.user),rn;case"reauthenticate":return X(_.user,I,"internal-error"),mr._forOperation(_.user,_.operationType,wt);default:$e(I,"internal-error")}});return function(Ge){return me.apply(this,arguments)}}())}resolveSignIn(p){var _=this;return(0,g.Z)(function*(){return _.signInResolver(p)})()}}function sl(E,p){var _;const I=(0,U.m9)(E),A=p;return X(p.customData.operationType,I,"argument-error"),X(null===(_=A.customData._serverResponse)||void 0===_?void 0:_.mfaPendingCredential,I,"argument-error"),Xa._fromError(I,A)}function kf(E,p){return Lt(E,"POST","/v2/accounts/mfaEnrollment:start",xt(E,p))}class hs{constructor(p){this.user=p,this.enrolledFactors=[],p._onReload(_=>{_.mfaInfo&&(this.enrolledFactors=_.mfaInfo.map(I=>ct._fromServerResponse(p.auth,I)))})}static _fromUser(p){return new hs(p)}getSession(){var p=this;return(0,g.Z)(function*(){return ds._fromIdtoken(yield p.user.getIdToken(),p.user.auth)})()}enroll(p,_){var I=this;return(0,g.Z)(function*(){const A=p,R=yield I.getSession(),Q=yield Ke(I.user,A._process(I.user.auth,R,_));return yield I.user._updateTokensIfNecessary(Q),I.user.reload()})()}unenroll(p){var _=this;return(0,g.Z)(function*(){var I;const A="string"==typeof p?p:p.uid,R=yield _.user.getIdToken(),Q=yield Ke(_.user,function F0(E,p){return Lt(E,"POST","/v2/accounts/mfaEnrollment:withdraw",xt(E,p))}(_.user.auth,{idToken:R,mfaEnrollmentId:A}));_.enrolledFactors=_.enrolledFactors.filter(({uid:me})=>me!==A),yield _.user._updateTokensIfNecessary(Q);try{yield _.user.reload()}catch(me){if("auth/user-token-expired"!==(null===(I=me)||void 0===I?void 0:I.code))throw me}})()}}const Ho=new WeakMap;function L0(E){const p=(0,U.m9)(E);return Ho.has(p)||Ho.set(p,hs._fromUser(p)),Ho.get(p)}const ed="__sak";class eu{constructor(p,_){this.storageRetriever=p,this.type=_}_isAvailable(){try{return this.storage?(this.storage.setItem(ed,"1"),this.storage.removeItem(ed),Promise.resolve(!0)):Promise.resolve(!1)}catch(p){return Promise.resolve(!1)}}_set(p,_){return this.storage.setItem(p,JSON.stringify(_)),Promise.resolve()}_get(p){const _=this.storage.getItem(p);return Promise.resolve(_?JSON.parse(_):null)}_remove(p){return this.storage.removeItem(p),Promise.resolve()}get storage(){return this.storageRetriever()}}const gt=(()=>{class E extends eu{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(_,I)=>this.onStorageEvent(_,I),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function td(){const E=(0,U.z$)();return O(E)||Ze(E)}()&&function Ii(){try{return!(!window||window===window.top)}catch(E){return!1}}(),this.fallbackToPolling=ar(),this._shouldAllowMigration=!0}forAllChangedKeys(_){for(const I of Object.keys(this.listeners)){const A=this.storage.getItem(I),R=this.localCache[I];A!==R&&_(I,R,A)}}onStorageEvent(_,I=!1){if(!_.key)return void this.forAllChangedKeys((me,Ge,et)=>{this.notifyListeners(me,et)});const A=_.key;if(I?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const me=this.storage.getItem(A);if(_.newValue!==me)null!==_.newValue?this.storage.setItem(A,_.newValue):this.storage.removeItem(A);else if(this.localCache[A]===_.newValue&&!I)return}const R=()=>{const me=this.storage.getItem(A);!I&&this.localCache[A]===me||this.notifyListeners(A,me)},Q=this.storage.getItem(A);!function Mt(){return(0,U.w1)()&&10===document.documentMode}()||Q===_.newValue||_.newValue===_.oldValue?R():setTimeout(R,10)}notifyListeners(_,I){this.localCache[_]=I;const A=this.listeners[_];if(A)for(const R of Array.from(A))R(I&&JSON.parse(I))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((_,I,A)=>{this.onStorageEvent(new StorageEvent("storage",{key:_,oldValue:I,newValue:A}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(_,I){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[_]||(this.listeners[_]=new Set,this.localCache[_]=this.storage.getItem(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(_,I){var A=()=>super._set,R=this;return(0,g.Z)(function*(){yield A().call(R,_,I),R.localCache[_]=JSON.stringify(I)})()}_get(_){var I=()=>super._get,A=this;return(0,g.Z)(function*(){const R=yield I().call(A,_);return A.localCache[_]=JSON.stringify(R),R})()}_remove(_){var I=()=>super._remove,A=this;return(0,g.Z)(function*(){yield I().call(A,_),delete A.localCache[_]})()}}return E.type="LOCAL",E})(),Xn=(()=>{class E extends eu{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(_,I){}_removeListener(_,I){}}return E.type="SESSION",E})();let al=(()=>{class E{constructor(_){this.eventTarget=_,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(_){const I=this.receivers.find(R=>R.isListeningto(_));if(I)return I;const A=new E(_);return this.receivers.push(A),A}isListeningto(_){return this.eventTarget===_}handleEvent(_){var I=this;return(0,g.Z)(function*(){const A=_,{eventId:R,eventType:Q,data:me}=A.data,Ge=I.handlersMap[Q];if(!(null==Ge?void 0:Ge.size))return;A.ports[0].postMessage({status:"ack",eventId:R,eventType:Q});const et=Array.from(Ge).map(function(){var rn=(0,g.Z)(function*(ti){return ti(A.origin,me)});return function(ti){return rn.apply(this,arguments)}}()),wt=yield function Jr(E){return Promise.all(E.map(function(){var p=(0,g.Z)(function*(_){try{return{fulfilled:!0,value:yield _}}catch(I){return{fulfilled:!1,reason:I}}});return function(_){return p.apply(this,arguments)}}()))}(et);A.ports[0].postMessage({status:"done",eventId:R,eventType:Q,response:wt})})()}_subscribe(_,I){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[_]||(this.handlersMap[_]=new Set),this.handlersMap[_].add(I)}_unsubscribe(_,I){this.handlersMap[_]&&I&&this.handlersMap[_].delete(I),(!I||0===this.handlersMap[_].size)&&delete this.handlersMap[_],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return E.receivers=[],E})();function Wo(E="",p=10){let _="";for(let I=0;I<p;I++)_+=Math.floor(10*Math.random());return E+_}class Of{constructor(p){this.target=p,this.handlers=new Set}removeMessageHandler(p){p.messageChannel&&(p.messageChannel.port1.removeEventListener("message",p.onMessage),p.messageChannel.port1.close()),this.handlers.delete(p)}_send(p,_,I=50){var A=this;return(0,g.Z)(function*(){const R="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!R)throw new Error("connection_unavailable");let Q,me;return new Promise((Ge,et)=>{const wt=Wo("",20);R.port1.start();const rn=setTimeout(()=>{et(new Error("unsupported_event"))},I);me={messageChannel:R,onMessage(ti){const _s=ti;if(_s.data.eventId===wt)switch(_s.data.status){case"ack":clearTimeout(rn),Q=setTimeout(()=>{et(new Error("timeout"))},3e3);break;case"done":clearTimeout(Q),Ge(_s.data.response);break;default:clearTimeout(rn),clearTimeout(Q),et(new Error("invalid_response"))}}},A.handlers.add(me),R.port1.addEventListener("message",me.onMessage),A.target.postMessage({eventType:p,eventId:wt,data:_},[R.port2])}).finally(()=>{me&&A.removeMessageHandler(me)})})()}}function dn(){return window}function ks(){return void 0!==dn().WorkerGlobalScope&&"function"==typeof dn().importScripts}function Et(){return(Et=(0,g.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(E){return null}})).apply(this,arguments)}const ul="firebaseLocalStorageDb",Un="firebaseLocalStorage",Go="fbase_key";class po{constructor(p){this.request=p}toPromise(){return new Promise((p,_)=>{this.request.addEventListener("success",()=>{p(this.request.result)}),this.request.addEventListener("error",()=>{_(this.request.error)})})}}function zo(E,p){return E.transaction([Un],p?"readwrite":"readonly").objectStore(Un)}function fs(){const E=indexedDB.open(ul,1);return new Promise((p,_)=>{E.addEventListener("error",()=>{_(E.error)}),E.addEventListener("upgradeneeded",()=>{const I=E.result;try{I.createObjectStore(Un,{keyPath:Go})}catch(A){_(A)}}),E.addEventListener("success",(0,g.Z)(function*(){const I=E.result;I.objectStoreNames.contains(Un)?p(I):(I.close(),yield function tu(){const E=indexedDB.deleteDatabase(ul);return new po(E).toPromise()}(),p(yield fs()))}))})}function nu(E,p,_){return ll.apply(this,arguments)}function ll(){return(ll=(0,g.Z)(function*(E,p,_){const I=zo(E,!0).put({[Go]:p,value:_});return new po(I).toPromise()})).apply(this,arguments)}function go(){return(go=(0,g.Z)(function*(E,p){const _=zo(E,!1).get(p),I=yield new po(_).toPromise();return void 0===I?null:I.value})).apply(this,arguments)}function nd(E,p){const _=zo(E,!0).delete(p);return new po(_).toPromise()}const pi=(()=>{class E{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var _=this;return(0,g.Z)(function*(){return _.db||(_.db=yield fs()),_.db})()}_withRetries(_){var I=this;return(0,g.Z)(function*(){let A=0;for(;;)try{const R=yield I._openDb();return yield _(R)}catch(R){if(A++>3)throw R;I.db&&(I.db.close(),I.db=void 0)}})()}initializeServiceWorkerMessaging(){var _=this;return(0,g.Z)(function*(){return ks()?_.initializeReceiver():_.initializeSender()})()}initializeReceiver(){var _=this;return(0,g.Z)(function*(){_.receiver=al._getInstance(function Lf(){return ks()?self:null}()),_.receiver._subscribe("keyChanged",function(){var I=(0,g.Z)(function*(A,R){return{keyProcessed:(yield _._poll()).includes(R.key)}});return function(A,R){return I.apply(this,arguments)}}()),_.receiver._subscribe("ping",function(){var I=(0,g.Z)(function*(A,R){return["keyChanged"]});return function(A,R){return I.apply(this,arguments)}}())})()}initializeSender(){var _=this;return(0,g.Z)(function*(){var I,A;if(_.activeServiceWorker=yield function Os(){return Et.apply(this,arguments)}(),!_.activeServiceWorker)return;_.sender=new Of(_.activeServiceWorker);const R=yield _.sender._send("ping",{},800);!R||(null===(I=R[0])||void 0===I?void 0:I.fulfilled)&&(null===(A=R[0])||void 0===A?void 0:A.value.includes("keyChanged"))&&(_.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(_){var I=this;return(0,g.Z)(function*(){if(I.sender&&I.activeServiceWorker&&function U0(){var E;return(null===(E=null==navigator?void 0:navigator.serviceWorker)||void 0===E?void 0:E.controller)||null}()===I.activeServiceWorker)try{yield I.sender._send("keyChanged",{key:_},I.serviceWorkerReceiverAvailable?800:50)}catch(A){}})()}_isAvailable(){return(0,g.Z)(function*(){try{if(!indexedDB)return!1;const _=yield fs();return yield nu(_,ed,"1"),yield nd(_,ed),!0}catch(_){}return!1})()}_withPendingWrite(_){var I=this;return(0,g.Z)(function*(){I.pendingWrites++;try{yield _()}finally{I.pendingWrites--}})()}_set(_,I){var A=this;return(0,g.Z)(function*(){return A._withPendingWrite((0,g.Z)(function*(){return yield A._withRetries(R=>nu(R,_,I)),A.localCache[_]=I,A.notifyServiceWorker(_)}))})()}_get(_){var I=this;return(0,g.Z)(function*(){const A=yield I._withRetries(R=>function ru(E,p){return go.apply(this,arguments)}(R,_));return I.localCache[_]=A,A})()}_remove(_){var I=this;return(0,g.Z)(function*(){return I._withPendingWrite((0,g.Z)(function*(){return yield I._withRetries(A=>nd(A,_)),delete I.localCache[_],I.notifyServiceWorker(_)}))})()}_poll(){var _=this;return(0,g.Z)(function*(){const I=yield _._withRetries(Q=>{const me=zo(Q,!1).getAll();return new po(me).toPromise()});if(!I)return[];if(0!==_.pendingWrites)return[];const A=[],R=new Set;for(const{fbase_key:Q,value:me}of I)R.add(Q),JSON.stringify(_.localCache[Q])!==JSON.stringify(me)&&(_.notifyListeners(Q,me),A.push(Q));for(const Q of Object.keys(_.localCache))_.localCache[Q]&&!R.has(Q)&&(_.notifyListeners(Q,null),A.push(Q));return A})()}notifyListeners(_,I){this.localCache[_]=I;const A=this.listeners[_];if(A)for(const R of Array.from(A))R(I)}startPolling(){var _=this;this.stopPolling(),this.pollTimer=setInterval((0,g.Z)(function*(){return _._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(_,I){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[_]||(this.listeners[_]=new Set,this._get(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return E.type="LOCAL",E})();function id(E,p){return Lt(E,"POST","/v2/accounts/mfaSignIn:start",xt(E,p))}function Fs(){return(Fs=(0,g.Z)(function*(E){return(yield Lt(E,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function qo(E){return new Promise((p,_)=>{const I=document.createElement("script");I.setAttribute("src",E),I.onload=p,I.onerror=A=>{const R=Se("internal-error");R.customData=A,_(R)},I.type="text/javascript",I.charset="UTF-8",function er(){var E,p;return null!==(p=null===(E=document.getElementsByTagName("head"))||void 0===E?void 0:E[0])&&void 0!==p?p:document}().appendChild(I)})}function mo(E){return`__${E}${Math.floor(1e6*Math.random())}`}const tr=1e12;class ps{constructor(p){this.auth=p,this.counter=tr,this._widgets=new Map}render(p,_){const I=this.counter;return this._widgets.set(I,new zn(p,this.auth.name,_||{})),this.counter++,I}reset(p){var _;const I=p||tr;null===(_=this._widgets.get(I))||void 0===_||_.delete(),this._widgets.delete(I)}getResponse(p){var _;return(null===(_=this._widgets.get(p||tr))||void 0===_?void 0:_.getResponse())||""}execute(p){var _=this;return(0,g.Z)(function*(){var I;return null===(I=_._widgets.get(p||tr))||void 0===I||I.execute(),""})()}}class zn{constructor(p,_,I){this.params=I,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const A="string"==typeof p?document.getElementById(p):p;X(A,"argument-error",{appName:_}),this.container=A,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function $i(E){const p=[],_="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let I=0;I<E;I++)p.push(_.charAt(Math.floor(Math.random()*_.length)));return p.join("")}(50);const{callback:p,"expired-callback":_}=this.params;if(p)try{p(this.responseToken)}catch(I){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,_)try{_()}catch(I){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const hl=mo("rcb"),Uf=new je(3e4,6e4);class Bf{constructor(){var p;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(p=dn().grecaptcha)||void 0===p?void 0:p.render)}load(p,_=""){return X(function B0(E){return E.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(E)}(_),p,"argument-error"),this.shouldResolveImmediately(_)?Promise.resolve(dn().grecaptcha):new Promise((I,A)=>{const R=dn().setTimeout(()=>{A(Se(p,"network-request-failed"))},Uf.get());dn()[hl]=()=>{dn().clearTimeout(R),delete dn()[hl];const me=dn().grecaptcha;if(!me)return void A(Se(p,"internal-error"));const Ge=me.render;me.render=(et,wt)=>{const rn=Ge(et,wt);return this.counter++,rn},this.hostLanguage=_,I(me)},qo(`https://www.google.com/recaptcha/api.js??${(0,U.xO)({onload:hl,render:"explicit",hl:_})}`).catch(()=>{clearTimeout(R),A(Se(p,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(p){var _;return!!(null===(_=dn().grecaptcha)||void 0===_?void 0:_.render)&&(p===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Zo{load(p){return(0,g.Z)(function*(){return new ps(p)})()}clearedOneInstance(){}}const dr="recaptcha",j0={theme:"light",type:"image"};class Ls{constructor(p,_=Object.assign({},j0),I){this.parameters=_,this.type=dr,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Pe(I),this.isInvisible="invisible"===this.parameters.size,X("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const A="string"==typeof p?document.getElementById(p):p;X(A,this.auth,"argument-error"),this.container=A,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Zo:new Bf,this.validateStartingState()}verify(){var p=this;return(0,g.Z)(function*(){p.assertNotDestroyed();const _=yield p.render(),I=p.getAssertedRecaptcha();return I.getResponse(_)||new Promise(R=>{const Q=me=>{!me||(p.tokenChangeListeners.delete(Q),R(me))};p.tokenChangeListeners.add(Q),p.isInvisible&&I.execute(_)})})()}render(){try{this.assertNotDestroyed()}catch(p){return Promise.reject(p)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(p=>{throw this.renderPromise=null,p})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(p=>{this.container.removeChild(p)})}validateStartingState(){X(!this.parameters.sitekey,this.auth,"argument-error"),X(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),X("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(p){return _=>{if(this.tokenChangeListeners.forEach(I=>I(_)),"function"==typeof p)p(_);else if("string"==typeof p){const I=dn()[p];"function"==typeof I&&I(_)}}}assertNotDestroyed(){X(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var p=this;return(0,g.Z)(function*(){if(yield p.init(),!p.widgetId){let _=p.container;if(!p.isInvisible){const I=document.createElement("div");_.appendChild(I),_=I}p.widgetId=p.getAssertedRecaptcha().render(_,p.parameters)}return p.widgetId})()}init(){var p=this;return(0,g.Z)(function*(){X(Me()&&!ks(),p.auth,"internal-error"),yield function jf(){let E=null;return new Promise(p=>{"complete"!==document.readyState?(E=()=>p(),window.addEventListener("load",E)):p()}).catch(p=>{throw E&&window.removeEventListener("load",E),p})}(),p.recaptcha=yield p._recaptchaLoader.load(p.auth,p.auth.languageCode||void 0);const _=yield function sd(E){return Fs.apply(this,arguments)}(p.auth);X(_,p.auth,"internal-error"),p.parameters.sitekey=_})()}getAssertedRecaptcha(){return X(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Ti{constructor(p,_){this.verificationId=p,this.onConfirmation=_}confirm(p){const _=Oo._fromVerification(this.verificationId,p);return this.onConfirmation(_)}}function g_(E,p,_){return An.apply(this,arguments)}function An(){return(An=(0,g.Z)(function*(E,p,_){const I=Pe(E),A=yield vr(I,p,(0,U.m9)(_));return new Ti(A,R=>Yu(I,R))})).apply(this,arguments)}function od(E,p,_){return _o.apply(this,arguments)}function _o(){return(_o=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E);yield Fo(!1,I,"phone");const A=yield vr(I.auth,p,(0,U.m9)(_));return new Ti(A,R=>us(I,R))})).apply(this,arguments)}function $0(E,p,_){return ad.apply(this,arguments)}function ad(){return(ad=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E),A=yield vr(I.auth,p,(0,U.m9)(_));return new Ti(A,R=>Lo(I,R))})).apply(this,arguments)}function vr(E,p,_){return Xr.apply(this,arguments)}function Xr(){return(Xr=(0,g.Z)(function*(E,p,_){var I;const A=yield _.verify();try{let R;if(X("string"==typeof A,E,"argument-error"),X(_.type===dr,E,"argument-error"),R="string"==typeof p?{phoneNumber:p}:p,"session"in R){const Q=R.session;if("phoneNumber"in R)return X("enroll"===Q.type,E,"internal-error"),(yield kf(E,{idToken:Q.credential,phoneEnrollmentInfo:{phoneNumber:R.phoneNumber,recaptchaToken:A}})).phoneSessionInfo.sessionInfo;{X("signin"===Q.type,E,"internal-error");const me=(null===(I=R.multiFactorHint)||void 0===I?void 0:I.uid)||R.multiFactorUid;return X(me,E,"missing-multi-factor-info"),(yield id(E,{mfaPendingCredential:Q.credential,mfaEnrollmentId:me,phoneSignInInfo:{recaptchaToken:A}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Q}=yield A0(E,{phoneNumber:R.phoneNumber,recaptchaToken:A});return Q}}finally{_._reset()}})).apply(this,arguments)}function ud(E,p){return Yo.apply(this,arguments)}function Yo(){return(Yo=(0,g.Z)(function*(E,p){yield cn((0,U.m9)(E),p)})).apply(this,arguments)}let iu=(()=>{class E{constructor(_){this.providerId=E.PROVIDER_ID,this.auth=Pe(_)}verifyPhoneNumber(_,I){return vr(this.auth,_,(0,U.m9)(I))}static credential(_,I){return Oo._fromVerification(_,I)}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{phoneNumber:I,temporaryProof:A}=_;return I&&A?Oo._fromTokenResponse(I,A):null}}return E.PROVIDER_ID="phone",E.PHONE_SIGN_IN_METHOD="phone",E})();function Vs(E,p){return p?J(p):(X(E._popupRedirectResolver,E,"argument-error"),E._popupRedirectResolver)}class ld extends Jt{constructor(p){super("custom","custom"),this.params=p}_getIdTokenResponse(p){return Vn(p,this._buildIdpRequest())}_linkToIdToken(p,_){return Vn(p,this._buildIdpRequest(_))}_getReauthenticationResolver(p){return Vn(p,this._buildIdpRequest())}_buildIdpRequest(p){const _={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return p&&(_.idToken=p),_}}function $f(E){return Za(E.auth,new ld(E),E.bypassAuthState)}function kt(E){const{auth:p,user:_}=E;return X(_,p,"internal-error"),Df(_,new ld(E),E.bypassAuthState)}function H0(E){return gs.apply(this,arguments)}function gs(){return(gs=(0,g.Z)(function*(E){const{auth:p,user:_}=E;return X(_,p,"internal-error"),cn(_,new ld(E),E.bypassAuthState)})).apply(this,arguments)}class Er{constructor(p,_,I,A,R=!1){this.auth=p,this.resolver=I,this.user=A,this.bypassAuthState=R,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(_)?_:[_]}execute(){var p=this;return new Promise(function(){var _=(0,g.Z)(function*(I,A){p.pendingPromise={resolve:I,reject:A};try{p.eventManager=yield p.resolver._initialize(p.auth),yield p.onExecution(),p.eventManager.registerConsumer(p)}catch(R){p.reject(R)}});return function(I,A){return _.apply(this,arguments)}}())}onAuthEvent(p){var _=this;return(0,g.Z)(function*(){const{urlResponse:I,sessionId:A,postBody:R,tenantId:Q,error:me,type:Ge}=p;if(me)return void _.reject(me);const et={auth:_.auth,requestUri:I,sessionId:A,tenantId:Q||void 0,postBody:R||void 0,user:_.user,bypassAuthState:_.bypassAuthState};try{_.resolve(yield _.getIdpTask(Ge)(et))}catch(wt){_.reject(wt)}})()}onError(p){this.reject(p)}getIdpTask(p){switch(p){case"signInViaPopup":case"signInViaRedirect":return $f;case"linkViaPopup":case"linkViaRedirect":return H0;case"reauthViaPopup":case"reauthViaRedirect":return kt;default:$e(this.auth,"internal-error")}}resolve(p){fe(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(p),this.unregisterAndCleanUp()}reject(p){fe(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(p),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const su=new je(2e3,1e4);function Qo(E,p,_){return Hf.apply(this,arguments)}function Hf(){return(Hf=(0,g.Z)(function*(E,p,_){const I=Pe(E);he(E,p,Rs);const A=Vs(I,_);return new pl(I,"signInViaPopup",p,A).executeNotNull()})).apply(this,arguments)}function Wf(E,p,_){return gi.apply(this,arguments)}function gi(){return(gi=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E);he(I.auth,p,Rs);const A=Vs(I.auth,_);return new pl(I.auth,"reauthViaPopup",p,A,I).executeNotNull()})).apply(this,arguments)}function Gf(E,p,_){return fl.apply(this,arguments)}function fl(){return(fl=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E);he(I.auth,p,Rs);const A=Vs(I.auth,_);return new pl(I.auth,"linkViaPopup",p,A,I).executeNotNull()})).apply(this,arguments)}let pl=(()=>{class E extends Er{constructor(_,I,A,R,Q){super(_,I,R,Q),this.provider=A,this.authWindow=null,this.pollId=null,E.currentPopupAction&&E.currentPopupAction.cancel(),E.currentPopupAction=this}executeNotNull(){var _=this;return(0,g.Z)(function*(){const I=yield _.execute();return X(I,_.auth,"internal-error"),I})()}onExecution(){var _=this;return(0,g.Z)(function*(){fe(1===_.filter.length,"Popup operations only handle one event");const I=Wo();_.authWindow=yield _.resolver._openPopup(_.auth,_.provider,_.filter[0],I),_.authWindow.associatedEvent=I,_.resolver._originValidation(_.auth).catch(A=>{_.reject(A)}),_.resolver._isIframeWebStorageSupported(_.auth,A=>{A||_.reject(Se(_.auth,"web-storage-unsupported"))}),_.pollUserCancellation()})()}get eventId(){var _;return(null===(_=this.authWindow)||void 0===_?void 0:_.associatedEvent)||null}cancel(){this.reject(Se(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,E.currentPopupAction=null}pollUserCancellation(){const _=()=>{var I,A;this.pollId=(null===(A=null===(I=this.authWindow)||void 0===I?void 0:I.window)||void 0===A?void 0:A.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(Se(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(_,su.get())};_()}}return E.currentPopupAction=null,E})();const En=new Map;class mi extends Er{constructor(p,_,I=!1){super(p,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],_,void 0,I),this.eventId=null}execute(){var p=()=>super.execute,_=this;return(0,g.Z)(function*(){let I=En.get(_.auth._key());if(!I){try{const R=(yield function gl(E,p){return zf.apply(this,arguments)}(_.resolver,_.auth))?yield p().call(_):null;I=()=>Promise.resolve(R)}catch(A){I=()=>Promise.reject(A)}En.set(_.auth._key(),I)}return _.bypassAuthState||En.set(_.auth._key(),()=>Promise.resolve(null)),I()})()}onAuthEvent(p){var _=()=>super.onAuthEvent,I=this;return(0,g.Z)(function*(){if("signInViaRedirect"===p.type)return _().call(I,p);if("unknown"!==p.type){if(p.eventId){const A=yield I.auth._redirectUserForId(p.eventId);if(A)return I.user=A,_().call(I,p);I.resolve(null)}}else I.resolve(null)})()}onExecution(){return(0,g.Z)(function*(){})()}cleanUp(){}}function zf(){return(zf=(0,g.Z)(function*(E,p){const _=dd(p),I=qf(E);if(!(yield I._isAvailable()))return!1;const A="true"===(yield I._get(_));return yield I._remove(_),A})).apply(this,arguments)}function Us(E,p){return Jo.apply(this,arguments)}function Jo(){return(Jo=(0,g.Z)(function*(E,p){return qf(E)._set(dd(p),"true")})).apply(this,arguments)}function ml(){En.clear()}function cd(E,p){En.set(E._key(),p)}function qf(E){return J(E._redirectPersistence)}function dd(E){return V("pendingRedirect",E.config.apiKey,E.name)}function hd(E,p,_){return function _l(E,p,_){return ei.apply(this,arguments)}(E,p,_)}function ei(){return(ei=(0,g.Z)(function*(E,p,_){const I=Pe(E);he(E,p,Rs);const A=Vs(I,_);return yield Us(A,I),A._openRedirect(I,p,"signInViaRedirect")})).apply(this,arguments)}function Ot(E,p,_){return function ou(E,p,_){return Bn.apply(this,arguments)}(E,p,_)}function Bn(){return(Bn=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E);he(I.auth,p,Rs);const A=Vs(I.auth,_);yield Us(A,I.auth);const R=yield na(I);return A._openRedirect(I.auth,p,"reauthViaRedirect",R)})).apply(this,arguments)}function Bs(E,p,_){return function m_(E,p,_){return Xo.apply(this,arguments)}(E,p,_)}function Xo(){return(Xo=(0,g.Z)(function*(E,p,_){const I=(0,U.m9)(E);he(I.auth,p,Rs);const A=Vs(I.auth,_);yield Fo(!1,I,p.providerId),yield Us(A,I.auth);const R=yield na(I);return A._openRedirect(I.auth,p,"linkViaRedirect",R)})).apply(this,arguments)}function ea(E,p){return fd.apply(this,arguments)}function fd(){return(fd=(0,g.Z)(function*(E,p){return yield Pe(E)._initializationPromise,ta(E,p,!1)})).apply(this,arguments)}function ta(E,p){return yo.apply(this,arguments)}function yo(){return(yo=(0,g.Z)(function*(E,p,_=!1){const I=Pe(E),A=Vs(I,p),Q=yield new mi(I,A,_).execute();return Q&&!_&&(delete Q.user._redirectEventId,yield I._persistUserIfCurrent(Q.user),yield I._setRedirectUser(null,p)),Q})).apply(this,arguments)}function na(E){return Hi.apply(this,arguments)}function Hi(){return(Hi=(0,g.Z)(function*(E){const p=Wo(`${E.uid}:::`);return E._redirectEventId=p,yield E.auth._setRedirectUser(E),yield E.auth._persistUserIfCurrent(E),p})).apply(this,arguments)}class js{constructor(p){this.auth=p,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(p){this.consumers.add(p),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,p)&&(this.sendToConsumer(this.queuedRedirectEvent,p),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(p){this.consumers.delete(p)}onEvent(p){if(this.hasEventBeenHandled(p))return!1;let _=!1;return this.consumers.forEach(I=>{this.isEventForConsumer(p,I)&&(_=!0,this.sendToConsumer(p,I),this.saveEventToCache(p))}),this.hasHandledPotentialRedirect||!function vl(E){switch(E.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yl(E);default:return!1}}(p)||(this.hasHandledPotentialRedirect=!0,_||(this.queuedRedirectEvent=p,_=!0)),_}sendToConsumer(p,_){var I;if(p.error&&!yl(p)){const A=(null===(I=p.error.code)||void 0===I?void 0:I.split("auth/")[1])||"internal-error";_.onError(Se(this.auth,A))}else _.onAuthEvent(p)}isEventForConsumer(p,_){const I=null===_.eventId||!!p.eventId&&p.eventId===_.eventId;return _.filter.includes(p.type)&&I}hasEventBeenHandled(p){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(au(p))}saveEventToCache(p){this.cachedEventUids.add(au(p)),this.lastProcessedEventTime=Date.now()}}function au(E){return[E.type,E.eventId,E.sessionId,E.tenantId].filter(p=>p).join("-")}function yl({type:E,error:p}){return"unknown"===E&&"auth/no-auth-event"===(null==p?void 0:p.code)}function uu(E){return El.apply(this,arguments)}function El(){return(El=(0,g.Z)(function*(E,p={}){return Lt(E,"GET","/v1/projects",p)})).apply(this,arguments)}const __=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wl=/^https?/;function vo(){return(vo=(0,g.Z)(function*(E){if(E.config.emulator)return;const{authorizedDomains:p}=yield uu(E);for(const _ of p)try{if(y_(_))return}catch(I){}$e(E,"unauthorized-domain")})).apply(this,arguments)}function y_(E){const p=ie(),{protocol:_,hostname:I}=new URL(p);if(E.startsWith("chrome-extension://")){const Q=new URL(E);return""===Q.hostname&&""===I?"chrome-extension:"===_&&E.replace("chrome-extension://","")===p.replace("chrome-extension://",""):"chrome-extension:"===_&&Q.hostname===I}if(!wl.test(_))return!1;if(__.test(E))return I===E;const A=E.replace(/\./g,"\\.");return new RegExp("^(.+\\."+A+"|"+A+")$","i").test(I)}const G0=new je(3e4,6e4);function pd(){const E=dn().___jsl;if(null==E?void 0:E.H)for(const p of Object.keys(E.H))if(E.H[p].r=E.H[p].r||[],E.H[p].L=E.H[p].L||[],E.H[p].r=[...E.H[p].L],E.CP)for(let _=0;_<E.CP.length;_++)E.CP[_]=null}let lu=null;function gd(E){return lu=lu||function Zf(E){return new Promise((p,_)=>{var I,A,R;function Q(){pd(),gapi.load("gapi.iframes",{callback:()=>{p(gapi.iframes.getContext())},ontimeout:()=>{pd(),_(Se(E,"network-request-failed"))},timeout:G0.get()})}if(null===(A=null===(I=dn().gapi)||void 0===I?void 0:I.iframes)||void 0===A?void 0:A.Iframe)p(gapi.iframes.getContext());else{if(!(null===(R=dn().gapi)||void 0===R?void 0:R.load)){const me=mo("iframefcb");return dn()[me]=()=>{gapi.load?Q():_(Se(E,"network-request-failed"))},qo(`https://apis.google.com/js/api.js?onload=${me}`).catch(Ge=>_(Ge))}Q()}}).catch(p=>{throw lu=null,p})}(E),lu}const ms=new je(5e3,15e3),Il={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sa=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $s(E){const p=E.config;X(p.authDomain,E,"auth-domain-config-required");const _=p.emulator?Yt(p,"emulator/auth/iframe"):`https://${E.config.authDomain}/__/auth/iframe`,I={apiKey:p.apiKey,appName:E.name,v:k.SDK_VERSION},A=sa.get(E.config.apiHost);A&&(I.eid=A);const R=E._getFrameworks();return R.length&&(I.fw=R.join(",")),`${_}?${(0,U.xO)(I).slice(1)}`}function Qf(){return Qf=(0,g.Z)(function*(E){const p=yield gd(E),_=dn().gapi;return X(_,E,"internal-error"),p.open({where:document.body,url:$s(E),messageHandlersFilter:_.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Il,dontclear:!0},I=>new Promise(function(){var A=(0,g.Z)(function*(R,Q){yield I.restyle({setHideOnLeave:!1});const me=Se(E,"network-request-failed"),Ge=dn().setTimeout(()=>{Q(me)},ms.get());function et(){dn().clearTimeout(Ge),R(I)}I.ping(et).then(et,()=>{Q(me)})});return function(R,Q){return A.apply(this,arguments)}}()))}),Qf.apply(this,arguments)}const Eo={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class du{constructor(p){this.window=p,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(p){}}}function _d(E,p,_,I,A,R){X(E.config.authDomain,E,"auth-domain-config-required"),X(E.config.apiKey,E,"invalid-api-key");const Q={apiKey:E.config.apiKey,appName:E.name,authType:_,redirectUrl:I,v:k.SDK_VERSION,eventId:A};if(p instanceof Rs){p.setDefaultLanguage(E.languageCode),Q.providerId=p.providerId||"",(0,U.xb)(p.getCustomParameters())||(Q.customParameters=JSON.stringify(p.getCustomParameters()));for(const[Ge,et]of Object.entries(R||{}))Q[Ge]=et}if(p instanceof fi){const Ge=p.getScopes().filter(et=>""!==et);Ge.length>0&&(Q.scopes=Ge.join(","))}E.tenantId&&(Q.tid=E.tenantId);const me=Q;for(const Ge of Object.keys(me))void 0===me[Ge]&&delete me[Ge];return`${function Ai({config:E}){return E.emulator?Yt(E,"emulator/auth/handler"):`https://${E.authDomain}/__/auth/handler`}(E)}?${(0,U.xO)(me).slice(1)}`}const Si="webStorageSupport",Jf=class yd{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xn,this._completeRedirectFn=ta,this._overrideRedirectResult=cd}_openPopup(p,_,I,A){var R=this;return(0,g.Z)(function*(){var Q;fe(null===(Q=R.eventManagers[p._key()])||void 0===Q?void 0:Q.manager,"_initialize() not called before _openPopup()");const me=_d(p,_,I,ie(),A);return function v_(E,p,_,I=500,A=600){const R=Math.max((window.screen.availHeight-A)/2,0).toString(),Q=Math.max((window.screen.availWidth-I)/2,0).toString();let me="";const Ge=Object.assign(Object.assign({},Eo),{width:I.toString(),height:A.toString(),top:R,left:Q}),et=(0,U.z$)().toLowerCase();_&&(me=re(et)?"_blank":_),M(et)&&(p=p||"http://localhost",Ge.scrollbars="yes");const wt=Object.entries(Ge).reduce((ti,[_s,Hs])=>`${ti}${_s}=${Hs},`,"");if(function Fn(E=(0,U.z$)()){var p;return Ze(E)&&!!(null===(p=window.navigator)||void 0===p?void 0:p.standalone)}(et)&&"_self"!==me)return function hu(E,p){const _=document.createElement("a");_.href=E,_.target=p;const I=document.createEvent("MouseEvent");I.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),_.dispatchEvent(I)}(p||"",me),new du(null);const rn=window.open(p||"",me,wt);X(rn,E,"popup-blocked");try{rn.focus()}catch(ti){}return new du(rn)}(p,me,Wo())})()}_openRedirect(p,_,I,A){var R=this;return(0,g.Z)(function*(){return yield R._originValidation(p),function Ff(E){dn().location.href=E}(_d(p,_,I,ie(),A)),new Promise(()=>{})})()}_initialize(p){const _=p._key();if(this.eventManagers[_]){const{manager:A,promise:R}=this.eventManagers[_];return A?Promise.resolve(A):(fe(R,"If manager is not set, promise should be"),R)}const I=this.initAndGetManager(p);return this.eventManagers[_]={promise:I},I.catch(()=>{delete this.eventManagers[_]}),I}initAndGetManager(p){var _=this;return(0,g.Z)(function*(){const I=yield function Yf(E){return Qf.apply(this,arguments)}(p),A=new js(p);return I.register("authEvent",R=>(X(null==R?void 0:R.authEvent,p,"invalid-auth-event"),{status:A.onEvent(R.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),_.eventManagers[p._key()]={manager:A},_.iframes[p._key()]=I,A})()}_isIframeWebStorageSupported(p,_){this.iframes[p._key()].send(Si,{type:Si},A=>{var R;const Q=null===(R=null==A?void 0:A[0])||void 0===R?void 0:R[Si];void 0!==Q&&_(!!Q),$e(p,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(p){const _=p._key();return this.originValidationPromises[_]||(this.originValidationPromises[_]=function ra(E){return vo.apply(this,arguments)}(p)),this.originValidationPromises[_]}get _shouldInitProactively(){return ar()||O()||Ze()}};class Xf extends class I_{constructor(p){this.factorId=p}_process(p,_,I){switch(_.type){case"enroll":return this._finalizeEnroll(p,_.credential,I);case"signin":return this._finalizeSignIn(p,_.credential);default:return oe("unexpected MultiFactorSessionType")}}}{constructor(p){super("phone"),this.credential=p}static _fromCredential(p){return new Xf(p)}_finalizeEnroll(p,_,I){return function p_(E,p){return Lt(E,"POST","/v2/accounts/mfaEnrollment:finalize",xt(E,p))}(p,{idToken:_,displayName:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(p,_){return function cr(E,p){return Lt(E,"POST","/v2/accounts/mfaSignIn:finalize",xt(E,p))}(p,{mfaPendingCredential:_,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let ep=(()=>{class E{constructor(){}static assertion(_){return Xf._fromCredential(_)}}return E.FACTOR_ID="phone",E})();var C_="@firebase/auth",vd="0.20.10";class b_{constructor(p){this.auth=p,this.internalListeners=new Map}getUid(){var p;return this.assertAuthConfigured(),(null===(p=this.auth.currentUser)||void 0===p?void 0:p.uid)||null}getToken(p){var _=this;return(0,g.Z)(function*(){return _.assertAuthConfigured(),yield _.auth._initializationPromise,_.auth.currentUser?{accessToken:yield _.auth.currentUser.getIdToken(p)}:null})()}addAuthTokenListener(p){if(this.assertAuthConfigured(),this.internalListeners.has(p))return;const _=this.auth.onIdTokenChanged(I=>{var A;p((null===(A=I)||void 0===A?void 0:A.stsTokenManager.accessToken)||null)});this.internalListeners.set(p,_),this.updateProactiveRefresh()}removeAuthTokenListener(p){this.assertAuthConfigured();const _=this.internalListeners.get(p);!_||(this.internalListeners.delete(p),_(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,U.Pz)("authIdTokenMaxAge"),function Tl(E){(0,k._registerComponent)(new we.wA("auth",(p,{options:_})=>{const I=p.getProvider("app").getImmediate(),A=p.getProvider("heartbeat"),{apiKey:R,authDomain:Q}=I.options;return((me,Ge)=>{X(R&&!R.includes(":"),"invalid-api-key",{appName:me.name}),X(!(null==Q?void 0:Q.includes(":")),"argument-error",{appName:me.name});const et={apiKey:R,authDomain:Q,clientPlatform:E,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qn(E)},wt=new di(me,Ge,et);return function ce(E,p){const _=(null==p?void 0:p.persistence)||[],I=(Array.isArray(_)?_:[_]).map(J);(null==p?void 0:p.errorMap)&&E._updateErrorMap(p.errorMap),E._initializeWithPersistence(I,null==p?void 0:p.popupRedirectResolver)}(wt,_),wt})(I,A)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((p,_,I)=>{p.getProvider("auth-internal").initialize()})),(0,k._registerComponent)(new we.wA("auth-internal",p=>{const _=Pe(p.getProvider("auth").getImmediate());return new b_(_)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,k.registerVersion)(C_,vd,function tp(E){switch(E){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(E)),(0,k.registerVersion)(C_,vd,"esm2017")}("Browser")},2090:(Qe,ve,F)=>{F.d(ve,{$s:()=>Ue,BH:()=>St,DV:()=>gr,G6:()=>he,GJ:()=>li,L:()=>de,LL:()=>un,P0:()=>Me,Pz:()=>Wt,Sg:()=>je,UG:()=>Le,UI:()=>it,US:()=>we,Wl:()=>fn,Yr:()=>ge,ZB:()=>$,ZR:()=>Nn,aH:()=>nt,b$:()=>ye,cI:()=>Lt,dS:()=>Qt,eu:()=>X,g5:()=>k,gK:()=>qr,gQ:()=>pn,h$:()=>De,hl:()=>Fe,hu:()=>U,jU:()=>ke,m9:()=>qt,ne:()=>or,p$:()=>H,pd:()=>zr,r3:()=>ci,ru:()=>ne,tV:()=>Re,uI:()=>Ae,ug:()=>rt,vZ:()=>Gr,w1:()=>$e,w9:()=>ts,xO:()=>Sr,xb:()=>xs,z$:()=>Oe,zI:()=>oe,zd:()=>Ei});const U=function(B,V){if(!B)throw k(V)},k=function(B){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+B)},ae=function(B){const V=[];let q=0;for(let L=0;L<B.length;L++){let M=B.charCodeAt(L);M<128?V[q++]=M:M<2048?(V[q++]=M>>6|192,V[q++]=63&M|128):55296==(64512&M)&&L+1<B.length&&56320==(64512&B.charCodeAt(L+1))?(M=65536+((1023&M)<<10)+(1023&B.charCodeAt(++L)),V[q++]=M>>18|240,V[q++]=M>>12&63|128,V[q++]=M>>6&63|128,V[q++]=63&M|128):(V[q++]=M>>12|224,V[q++]=M>>6&63|128,V[q++]=63&M|128)}return V},we={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(B,V){if(!Array.isArray(B))throw Error("encodeByteArray takes an array as a parameter");this.init_();const q=V?this.byteToCharMapWebSafe_:this.byteToCharMap_,L=[];for(let M=0;M<B.length;M+=3){const O=B[M],re=M+1<B.length,Te=re?B[M+1]:0,ze=M+2<B.length,Je=ze?B[M+2]:0;let Kt=(15&Te)<<2|Je>>6,Fn=63&Je;ze||(Fn=64,re||(Kt=64)),L.push(q[O>>2],q[(3&O)<<4|Te>>4],q[Kt],q[Fn])}return L.join("")},encodeString(B,V){return this.HAS_NATIVE_SUPPORT&&!V?btoa(B):this.encodeByteArray(ae(B),V)},decodeString(B,V){return this.HAS_NATIVE_SUPPORT&&!V?atob(B):function(B){const V=[];let q=0,L=0;for(;q<B.length;){const M=B[q++];if(M<128)V[L++]=String.fromCharCode(M);else if(M>191&&M<224){const O=B[q++];V[L++]=String.fromCharCode((31&M)<<6|63&O)}else if(M>239&&M<365){const ze=((7&M)<<18|(63&B[q++])<<12|(63&B[q++])<<6|63&B[q++])-65536;V[L++]=String.fromCharCode(55296+(ze>>10)),V[L++]=String.fromCharCode(56320+(1023&ze))}else{const O=B[q++],re=B[q++];V[L++]=String.fromCharCode((15&M)<<12|(63&O)<<6|63&re)}}return V.join("")}(this.decodeStringToByteArray(B,V))},decodeStringToByteArray(B,V){this.init_();const q=V?this.charToByteMapWebSafe_:this.charToByteMap_,L=[];for(let M=0;M<B.length;){const O=q[B.charAt(M++)],Te=M<B.length?q[B.charAt(M)]:0;++M;const Je=M<B.length?q[B.charAt(M)]:64;++M;const Ze=M<B.length?q[B.charAt(M)]:64;if(++M,null==O||null==Te||null==Je||null==Ze)throw Error();L.push(O<<2|Te>>4),64!==Je&&(L.push(Te<<4&240|Je>>2),64!==Ze&&L.push(Je<<6&192|Ze))}return L},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let B=0;B<this.ENCODED_VALS.length;B++)this.byteToCharMap_[B]=this.ENCODED_VALS.charAt(B),this.charToByteMap_[this.byteToCharMap_[B]]=B,this.byteToCharMapWebSafe_[B]=this.ENCODED_VALS_WEBSAFE.charAt(B),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[B]]=B,B>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(B)]=B,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(B)]=B)}}},De=function(B){const V=ae(B);return we.encodeByteArray(V,!0)},de=function(B){return De(B).replace(/\./g,"")},Re=function(B){try{return we.decodeString(B,!0)}catch(V){console.error("base64Decode failed: ",V)}return null};function H(B){return $(void 0,B)}function $(B,V){if(!(V instanceof Object))return V;switch(V.constructor){case Date:return new Date(V.getTime());case Object:void 0===B&&(B={});break;case Array:B=[];break;default:return V}for(const q in V)!V.hasOwnProperty(q)||!te(q)||(B[q]=$(B[q],V[q]));return B}function te(B){return"__proto__"!==B}function Oe(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ae(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oe())}function Le(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(B){return!1}}function ke(){return"object"==typeof self&&self.self===self}function ne(){const B="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof B&&void 0!==B.id}function ye(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function $e(){const B=Oe();return B.indexOf("MSIE ")>=0||B.indexOf("Trident/")>=0}function ge(){return!1}function he(){return!Le()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fe(){return"object"==typeof indexedDB}function X(){return new Promise((B,V)=>{try{let q=!0;const L="validate-browser-context-for-indexeddb-analytics-module",M=self.indexedDB.open(L);M.onsuccess=()=>{M.result.close(),q||self.indexedDB.deleteDatabase(L),B(!0)},M.onupgradeneeded=()=>{q=!1},M.onerror=()=>{var O;V((null===(O=M.error)||void 0===O?void 0:O.message)||"")}}catch(q){V(q)}})}function oe(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}const ce=()=>{try{return function fe(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const B=process.env.__FIREBASE_DEFAULTS__;return B?JSON.parse(B):void 0})()||(()=>{if("undefined"==typeof document)return;let B;try{B=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(q){return}const V=B&&Re(B[1]);return V&&JSON.parse(V)})()}catch(B){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${B}`)}},Me=B=>{const V=(B=>{var V,q;return null===(q=null===(V=ce())||void 0===V?void 0:V.emulatorHosts)||void 0===q?void 0:q[B]})(B);if(!V)return;const q=V.lastIndexOf(":");if(q<=0||q+1===V.length)throw new Error(`Invalid host ${V} with no separate hostname and port!`);const L=parseInt(V.substring(q+1),10);return"["===V[0]?[V.substring(1,q-1),L]:[V.substring(0,q),L]},nt=()=>{var B;return null===(B=ce())||void 0===B?void 0:B.config},Wt=B=>{var V;return null===(V=ce())||void 0===V?void 0:V[`_${B}`]};class St{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((V,q)=>{this.resolve=V,this.reject=q})}wrapCallback(V){return(q,L)=>{q?this.reject(q):this.resolve(L),"function"==typeof V&&(this.promise.catch(()=>{}),1===V.length?V(q):V(q,L))}}}function je(B,V){if(B.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const L=V||"demo-project",M=B.iat||0,O=B.sub||B.user_id;if(!O)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const re=Object.assign({iss:`https://securetoken.google.com/${L}`,aud:L,iat:M,exp:M+3600,auth_time:M,sub:O,user_id:O,firebase:{sign_in_provider:"custom",identities:{}}},B);return[de(JSON.stringify({alg:"none",type:"JWT"})),de(JSON.stringify(re)),""].join(".")}class Nn extends Error{constructor(V,q,L){super(q),this.code=V,this.customData=L,this.name="FirebaseError",Object.setPrototypeOf(this,Nn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,un.prototype.create)}}class un{constructor(V,q,L){this.service=V,this.serviceName=q,this.errors=L}create(V,...q){const L=q[0]||{},M=`${this.service}/${V}`,O=this.errors[V],re=O?function zt(B,V){return B.replace(xt,(q,L)=>{const M=V[L];return null!=M?String(M):`<${L}?>`})}(O,L):"Error";return new Nn(M,`${this.serviceName}: ${re} (${M}).`,L)}}const xt=/\{\$([^}]+)}/g;function Lt(B){return JSON.parse(B)}function fn(B){return JSON.stringify(B)}const Ar=function(B){let V={},q={},L={},M="";try{const O=B.split(".");V=Lt(Re(O[0])||""),q=Lt(Re(O[1])||""),M=O[2],L=q.d||{},delete q.d}catch(O){}return{header:V,claims:q,data:L,signature:M}},ts=function(B){const q=Ar(B).claims;return!!q&&"object"==typeof q&&q.hasOwnProperty("iat")},li=function(B){const V=Ar(B).claims;return"object"==typeof V&&!0===V.admin};function ci(B,V){return Object.prototype.hasOwnProperty.call(B,V)}function gr(B,V){if(Object.prototype.hasOwnProperty.call(B,V))return B[V]}function xs(B){for(const V in B)if(Object.prototype.hasOwnProperty.call(B,V))return!1;return!0}function it(B,V,q){const L={};for(const M in B)Object.prototype.hasOwnProperty.call(B,M)&&(L[M]=V.call(q,B[M],M,B));return L}function Gr(B,V){if(B===V)return!0;const q=Object.keys(B),L=Object.keys(V);for(const M of q){if(!L.includes(M))return!1;const O=B[M],re=V[M];if(ln(O)&&ln(re)){if(!Gr(O,re))return!1}else if(O!==re)return!1}for(const M of L)if(!q.includes(M))return!1;return!0}function ln(B){return null!==B&&"object"==typeof B}function Sr(B){const V=[];for(const[q,L]of Object.entries(B))Array.isArray(L)?L.forEach(M=>{V.push(encodeURIComponent(q)+"="+encodeURIComponent(M))}):V.push(encodeURIComponent(q)+"="+encodeURIComponent(L));return V.length?"&"+V.join("&"):""}function Ei(B){const V={};return B.replace(/^\?/,"").split("&").forEach(L=>{if(L){const[M,O]=L.split("=");V[decodeURIComponent(M)]=decodeURIComponent(O)}}),V}function zr(B){const V=B.indexOf("?");if(!V)return"";const q=B.indexOf("#",V);return B.substring(V,q>0?q:void 0)}class pn{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let V=1;V<this.blockSize;++V)this.pad_[V]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(V,q){q||(q=0);const L=this.W_;if("string"==typeof V)for(let Ze=0;Ze<16;Ze++)L[Ze]=V.charCodeAt(q)<<24|V.charCodeAt(q+1)<<16|V.charCodeAt(q+2)<<8|V.charCodeAt(q+3),q+=4;else for(let Ze=0;Ze<16;Ze++)L[Ze]=V[q]<<24|V[q+1]<<16|V[q+2]<<8|V[q+3],q+=4;for(let Ze=16;Ze<80;Ze++){const Kt=L[Ze-3]^L[Ze-8]^L[Ze-14]^L[Ze-16];L[Ze]=4294967295&(Kt<<1|Kt>>>31)}let Je,yt,M=this.chain_[0],O=this.chain_[1],re=this.chain_[2],Te=this.chain_[3],ze=this.chain_[4];for(let Ze=0;Ze<80;Ze++){Ze<40?Ze<20?(Je=Te^O&(re^Te),yt=1518500249):(Je=O^re^Te,yt=1859775393):Ze<60?(Je=O&re|Te&(O|re),yt=2400959708):(Je=O^re^Te,yt=3395469782);const Kt=(M<<5|M>>>27)+Je+ze+yt+L[Ze]&4294967295;ze=Te,Te=re,re=4294967295&(O<<30|O>>>2),O=M,M=Kt}this.chain_[0]=this.chain_[0]+M&4294967295,this.chain_[1]=this.chain_[1]+O&4294967295,this.chain_[2]=this.chain_[2]+re&4294967295,this.chain_[3]=this.chain_[3]+Te&4294967295,this.chain_[4]=this.chain_[4]+ze&4294967295}update(V,q){if(null==V)return;void 0===q&&(q=V.length);const L=q-this.blockSize;let M=0;const O=this.buf_;let re=this.inbuf_;for(;M<q;){if(0===re)for(;M<=L;)this.compress_(V,M),M+=this.blockSize;if("string"==typeof V){for(;M<q;)if(O[re]=V.charCodeAt(M),++re,++M,re===this.blockSize){this.compress_(O),re=0;break}}else for(;M<q;)if(O[re]=V[M],++re,++M,re===this.blockSize){this.compress_(O),re=0;break}}this.inbuf_=re,this.total_+=q}digest(){const V=[];let q=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let M=this.blockSize-1;M>=56;M--)this.buf_[M]=255&q,q/=256;this.compress_(this.buf_);let L=0;for(let M=0;M<5;M++)for(let O=24;O>=0;O-=8)V[L]=this.chain_[M]>>O&255,++L;return V}}function or(B,V){const q=new ns(B,V);return q.subscribe.bind(q)}class ns{constructor(V,q){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=q,this.task.then(()=>{V(this)}).catch(L=>{this.error(L)})}next(V){this.forEachObserver(q=>{q.next(V)})}error(V){this.forEachObserver(q=>{q.error(V)}),this.close(V)}complete(){this.forEachObserver(V=>{V.complete()}),this.close()}subscribe(V,q,L){let M;if(void 0===V&&void 0===q&&void 0===L)throw new Error("Missing Observer.");M=function tt(B,V){if("object"!=typeof B||null===B)return!1;for(const q of V)if(q in B&&"function"==typeof B[q])return!0;return!1}(V,["next","error","complete"])?V:{next:V,error:q,complete:L},void 0===M.next&&(M.next=Ke),void 0===M.error&&(M.error=Ke),void 0===M.complete&&(M.complete=Ke);const O=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?M.error(this.finalError):M.complete()}catch(re){}}),this.observers.push(M),O}unsubscribeOne(V){void 0===this.observers||void 0===this.observers[V]||(delete this.observers[V],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(V){if(!this.finalized)for(let q=0;q<this.observers.length;q++)this.sendOne(q,V)}sendOne(V,q){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[V])try{q(this.observers[V])}catch(L){"undefined"!=typeof console&&console.error&&console.error(L)}})}close(V){this.finalized||(this.finalized=!0,void 0!==V&&(this.finalError=V),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ke(){}function qr(B,V){return`${B} failed: ${V} argument `}const Qt=function(B){const V=[];let q=0;for(let L=0;L<B.length;L++){let M=B.charCodeAt(L);if(M>=55296&&M<=56319){const O=M-55296;L++,U(L<B.length,"Surrogate pair missing trail surrogate."),M=65536+(O<<10)+(B.charCodeAt(L)-56320)}M<128?V[q++]=M:M<2048?(V[q++]=M>>6|192,V[q++]=63&M|128):M<65536?(V[q++]=M>>12|224,V[q++]=M>>6&63|128,V[q++]=63&M|128):(V[q++]=M>>18|240,V[q++]=M>>12&63|128,V[q++]=M>>6&63|128,V[q++]=63&M|128)}return V},rt=function(B){let V=0;for(let q=0;q<B.length;q++){const L=B.charCodeAt(q);L<128?V++:L<2048?V+=2:L>=55296&&L<=56319?(V+=4,q++):V+=3}return V};function Ue(B,V=1e3,q=2){const L=V*Math.pow(q,B),M=Math.round(.5*L*(Math.random()-.5)*2);return Math.min(144e5,L+M)}function qt(B){return B&&B._delegate?B._delegate:B}},3747:(Qe,ve,F)=>{var g=F(5e3);let U=null;function k(){return U}const De=new g.OlP("DocumentToken");let de=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return function Re(){return(0,g.LFG)($)}()},providedIn:"platform"}),n})();const H=new g.OlP("Location Initialized");let $=(()=>{class n extends de{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return k().getBaseHref(this._doc)}onPopState(t){const r=k().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=k().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){te()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){te()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(De))},n.\u0275prov=g.Yz7({token:n,factory:function(){return function Oe(){return new $((0,g.LFG)(De))}()},providedIn:"platform"}),n})();function te(){return!!window.history.pushState}function Ae(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Le(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function ke(n){return n&&"?"!==n[0]?"?"+n:n}let ne=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:function(){return function ye(n){const e=(0,g.LFG)(De).location;return new $e((0,g.LFG)(de),e&&e.origin||"")}()},providedIn:"root"}),n})();const We=new g.OlP("appBaseHref");let $e=(()=>{class n extends ne{constructor(t,r){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Ae(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+ke(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+ke(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+ke(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(de),g.LFG(We,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})(),Se=(()=>{class n extends ne{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Ae(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+ke(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+ke(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,t)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(de),g.LFG(We,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})(),ge=(()=>{class n{constructor(t,r){this._subject=new g.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=Le(X(i)),this._platformStrategy.onPopState(a=>{this._subject.emit({url:this.path(!0),pop:!0,state:a.state,type:a.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+ke(r))}normalize(t){return n.stripTrailingSlash(function Fe(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,X(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._platformStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ke(r)),i)}replaceState(t,r="",i=null){this._platformStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ke(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=ke,n.joinWithSlash=Ae,n.stripTrailingSlash=Le,n.\u0275fac=function(t){return new(t||n)(g.LFG(ne),g.LFG(de))},n.\u0275prov=g.Yz7({token:n,factory:function(){return function he(){return new ge((0,g.LFG)(ne),(0,g.LFG)(de))}()},providedIn:"root"}),n})();function X(n){return n.replace(/\/index.html$/,"")}let ss=(()=>{class n{constructor(t,r,i,a){this._iterableDiffers=t,this._keyValueDiffers=r,this._ngEl=i,this._renderer=a,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&((0,g.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),t.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),t.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,g.AaK)(r.item)}`);this._toggleClass(r.item,!0)}),t.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(r=>this._toggleClass(r,!0)):Object.keys(t).forEach(r=>this._toggleClass(r,!!t[r])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(r=>this._toggleClass(r,!1)):Object.keys(t).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(t,r){(t=t.trim())&&t.split(/\s+/g).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(g.ZZ4),g.Y36(g.aQg),g.Y36(g.SBq),g.Y36(g.Qsj))},n.\u0275dir=g.lG2({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class Po{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Gn=(()=>{class n{constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,a,l)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new Po(i.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)r.remove(null===a?void 0:a);else if(null!==a){const h=r.get(a);r.move(h,l),os(h,i)}});for(let i=0,a=r.length;i<a;i++){const h=r.get(i).context;h.index=i,h.count=a,h.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{os(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(g.s_b),g.Y36(g.Rgc),g.Y36(g.ZZ4))},n.\u0275dir=g.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function os(n,e){n.context.$implicit=e.item}let ur=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new Xt,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){mf("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){mf("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(g.s_b),g.Y36(g.Rgc))},n.\u0275dir=g.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class Xt{constructor(){this.$implicit=null,this.ngIf=null}}function mf(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,g.AaK)(e)}'.`)}function Vn(n,e){return new g.vHH(2100,"")}class yf{createSubscription(e,t){return e.subscribe({next:t,error:r=>{throw r}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class T0{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}onDestroy(e){}}const as=new T0,A0=new yf;let ko=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if((0,g.QGY)(t))return as;if((0,g.F4k)(t))return A0;throw Vn()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(g.sBO,16))},n.\u0275pipe=g.Yjl({name:"async",type:n,pure:!1}),n})(),Wu=(()=>{class n{transform(t){if(null==t)return null;if("string"!=typeof t)throw Vn();return t.toUpperCase()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=g.Yjl({name:"uppercase",type:n,pure:!0}),n})(),ho=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({}),n})();function mr(n){return"server"===n}let qu=(()=>{class n{}return n.\u0275prov=(0,g.Yz7)({token:n,providedIn:"root",factory:()=>new Ku((0,g.LFG)(De),window)}),n})();class Ku{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Kc(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=qc(this.window.history)||qc(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function qc(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Fo extends class Zu extends class we{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Ce(n){U||(U=n)}(new Fo)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Df(){return sn=sn||document.querySelector("base"),sn?sn.getAttribute("href"):null}();return null==t?null:function Za(n){Ka=Ka||document.createElement("a"),Ka.setAttribute("href",n);const e=Ka.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){sn=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function No(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Ka,sn=null;const _r=new g.OlP("TRANSITION_ID"),Ya=[{provide:g.ip1,useFactory:function Yu(n,e,t){return()=>{t.get(g.CZH).donePromise.then(()=>{const r=k(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[_r,De,g.zs3],multi:!0}];class us{static init(){(0,g.VLi)(new us)}addToWindow(e){g.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},g.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),g.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),g.dqk.frameworkStabilizers||(g.dqk.frameworkStabilizers=[]),g.dqk.frameworkStabilizers.push(r=>{const i=g.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const h=function(m){l=l||m,a--,0==a&&r(l)};i.forEach(function(m){m.whenStable(h)})})}findTestabilityInTree(e,t,r){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:r?k().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let yr=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();const Lo=new g.OlP("EventManagerPlugins");let Ns=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const l=i[a];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(Lo),g.LFG(g.R0b))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();class Tf{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=k().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let Ci=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})(),Vo=(()=>{class n extends Ci{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(a=>{const l=this._doc.createElement("style");l.textContent=a,i.push(r.appendChild(l))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(Uo),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Uo))}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(De))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();function Uo(n){k().remove(n)}const ct={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Bo=/%COMP%/g;function jo(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?jo(n,i,t):(i=i.replace(Bo,n),t.push(i))}return t}function Ie(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Xu=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new gn(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case g.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new Ui(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case g.ifc.ShadowDom:return new Yc(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=jo(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(Ns),g.LFG(Vo),g.LFG(g.AFp))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();class gn{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(ct[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,r){e&&e.insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=ct[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=ct[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(g.JOm.DashCase|g.JOm.Important)?e.style.setProperty(t,r,i&g.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&g.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Ie(r)):this.eventManager.addEventListener(e,t,Ie(r))}}class Ui extends gn{constructor(e,t,r,i){super(e),this.component=r;const a=jo(i+"-"+r.id,r.styles,[]);t.addStyles(a),this.contentAttr=function Ju(n){return"_ngcontent-%COMP%".replace(Bo,n)}(i+"-"+r.id),this.hostAttr=function s_(n){return"_nghost-%COMP%".replace(Bo,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class Yc extends gn{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=jo(i.id,i.styles,[]);for(let l=0;l<a.length;l++){const h=document.createElement("style");h.textContent=a[l],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Qa=(()=>{class n extends Tf{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(De))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();const o_=["alt","control","meta","shift"],xf={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ja={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Jn={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let ls=(()=>{class n extends Tf{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>k().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="";if(o_.forEach(m=>{const v=r.indexOf(m);v>-1&&(r.splice(v,1),l+=m+".")}),l+=a,0!=r.length||0===a.length)return null;const h={};return h.domEventName=i,h.fullKey=l,h}static getEventFullKey(t){let r="",i=function el(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&Ja.hasOwnProperty(e)&&(e=Ja[e]))}return xf[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),o_.forEach(a=>{a!=i&&Jn[a](t)&&(r+=a+".")}),r+=i,r}static eventCallback(t,r,i){return a=>{n.getEventFullKey(a)===t&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(De))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();const l_=(0,g.eFA)(g._c5,"browser",[{provide:g.Lbi,useValue:"browser"},{provide:g.g9A,useValue:function $o(){Fo.makeCurrent(),us.init()},multi:!0},{provide:De,useFactory:function u_(){return(0,g.RDi)(document),document},deps:[]}]),Qc=[{provide:g.zSh,useValue:"root"},{provide:g.qLn,useFactory:function bi(){return new g.qLn},deps:[]},{provide:Lo,useClass:Qa,multi:!0,deps:[De,g.R0b,g.Lbi]},{provide:Lo,useClass:ls,multi:!0,deps:[De]},{provide:Xu,useClass:Xu,deps:[Ns,Vo,g.AFp]},{provide:g.FYo,useExisting:Xu},{provide:Ci,useExisting:Vo},{provide:Vo,useClass:Vo,deps:[De]},{provide:g.dDg,useClass:g.dDg,deps:[g.R0b]},{provide:Ns,useClass:Ns,deps:[Lo,g.R0b]},{provide:class cn{},useClass:yr,deps:[]}];let Jc=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:g.AFp,useValue:t.appId},{provide:_r,useExisting:g.AFp},Ya]}}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(n,12))},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:Qc,imports:[ho,g.hGG]}),n})();"undefined"!=typeof window&&window;var yn=F(8996),ol=F(7669);function gt(...n){const e=(0,ol.yG)(n);return(0,yn.D)(n,e)}var Bi=F(7579);class Xn extends Bi.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}var Jr=F(8306);const{isArray:al}=Array,{getPrototypeOf:Wo,prototype:Of,keys:dn}=Object;function Ff(n){if(1===n.length){const e=n[0];if(al(e))return{args:e,keys:null};if(function ks(n){return n&&"object"==typeof n&&Wo(n)===Of}(e)){const t=dn(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}var Os=F(4671),Et=F(4004);const{isArray:U0}=Array;function ul(n){return(0,Et.U)(e=>function Lf(n,e){return U0(e)?n(...e):n(e)}(n,e))}function Vf(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}var Un=F(5403),Go=F(9672);function tu(n,e,t){n?(0,Go.f)(t,n,e):e()}var fs=F(576);function nu(n,e){const t=(0,fs.m)(n)?n:()=>n,r=i=>i.error(t());return new Jr.y(e?i=>e.schedule(r,0,i):r)}const ru=(0,F(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var go=F(8189);function rd(...n){return function nd(){return(0,go.J)(1)}()((0,yn.D)(n,(0,ol.yG)(n)))}var cl=F(8421);function dl(n){return new Jr.y(e=>{(0,cl.Xf)(n()).subscribe(e)})}var pi=F(515),id=F(727),cr=F(4482);function sd(){return(0,cr.e)((n,e)=>{let t=null;n._refCount++;const r=(0,Un.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class Fs extends Jr.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,cr.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new id.w0;const t=this.getSubject();e.add(this.source.subscribe((0,Un.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=id.w0.EMPTY)}return e}refCount(){return sd()(this)}}function er(n,e){return(0,cr.e)((t,r)=>{let i=null,a=0,l=!1;const h=()=>l&&!i&&r.complete();t.subscribe((0,Un.x)(r,m=>{null==i||i.unsubscribe();let v=0;const b=a++;(0,cl.Xf)(n(m,b)).subscribe(i=(0,Un.x)(r,D=>r.next(e?e(m,D,b,v++):D),()=>{i=null,h()}))},()=>{l=!0,h()}))})}function qo(n){return n<=0?()=>pi.E:(0,cr.e)((e,t)=>{let r=0;e.subscribe((0,Un.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function mo(...n){const e=(0,ol.yG)(n);return(0,cr.e)((t,r)=>{(e?rd(n,t,e):rd(n,t)).subscribe(r)})}function Ko(n,e,t,r,i){return(a,l)=>{let h=t,m=e,v=0;a.subscribe((0,Un.x)(l,b=>{const D=v++;m=h?n(m,b,D):(h=!0,b),r&&l.next(m)},i&&(()=>{h&&l.next(m),l.complete()})))}}function ji(n,e){return(0,cr.e)(Ko(n,e,arguments.length>=2,!0))}function tr(n,e){return(0,cr.e)((t,r)=>{let i=0;t.subscribe((0,Un.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}function ps(n){return(0,cr.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,Un.x)(t,void 0,void 0,l=>{a=(0,cl.Xf)(n(l,ps(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}var zn=F(5577);function $i(n,e){return(0,fs.m)(e)?(0,zn.z)(n,e,1):(0,zn.z)(n,1)}function hl(n){return n<=0?()=>pi.E:(0,cr.e)((e,t)=>{let r=[];e.subscribe((0,Un.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Uf(n=vn){return(0,cr.e)((e,t)=>{let r=!1;e.subscribe((0,Un.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function vn(){return new ru}function Bf(n){return(0,cr.e)((e,t)=>{let r=!1;e.subscribe((0,Un.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Zo(n,e){const t=arguments.length>=2;return r=>r.pipe(n?tr((i,a)=>n(i,a,r)):Os.y,qo(1),t?Bf(e):Uf(()=>new ru))}function dr(n,e,t){const r=(0,fs.m)(n)||e||t?{next:n,error:e,complete:t}:n;return r?(0,cr.e)((i,a)=>{var l;null===(l=r.subscribe)||void 0===l||l.call(r);let h=!0;i.subscribe((0,Un.x)(a,m=>{var v;null===(v=r.next)||void 0===v||v.call(r,m),a.next(m)},()=>{var m;h=!1,null===(m=r.complete)||void 0===m||m.call(r),a.complete()},m=>{var v;h=!1,null===(v=r.error)||void 0===v||v.call(r,m),a.error(m)},()=>{var m,v;h&&(null===(m=r.unsubscribe)||void 0===m||m.call(r)),null===(v=r.finalize)||void 0===v||v.call(r)}))}):Os.y}class Ls{constructor(e,t){this.id=e,this.url=t}}class jf extends Ls{constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ti extends Ls{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class g_ extends Ls{constructor(e,t,r){super(e,t),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class An extends Ls{constructor(e,t,r){super(e,t),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class od extends Ls{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _o extends Ls{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $0 extends Ls{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ad extends Ls{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vr extends Ls{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xr{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ud{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Yo{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class iu{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vs{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ld{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $f{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const kt="primary";class H0{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function gs(n){return new H0(n)}const Er="ngNavigationCancelingError";function su(n){const e=Error("NavigationCancelingError: "+n);return e[Er]=!0,e}function Hf(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],h=n[a];if(l.startsWith(":"))i[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function gi(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!Gf(n[i],e[i]))return!1;return!0}function Gf(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function fl(n){return Array.prototype.concat.apply([],n)}function pl(n){return n.length>0?n[n.length-1]:null}function En(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function mi(n){return(0,g.CqO)(n)?n:(0,g.QGY)(n)?(0,yn.D)(Promise.resolve(n)):gt(n)}const zf={exact:function cd(n,e,t){if(!Bs(n.segments,e.segments)||!_l(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!cd(n.children[r],e.children[r],t))return!1;return!0},subset:dd},Us={exact:function ml(n,e){return gi(n,e)},subset:function qf(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Gf(n[t],e[t]))},ignored:()=>!0};function Jo(n,e,t){return zf[t.paths](n.root,e.root,t.matrixParams)&&Us[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function dd(n,e,t){return hd(n,e,e.segments,t)}function hd(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!Bs(i,t)||e.hasChildren()||!_l(i,t,r))}if(n.segments.length===t.length){if(!Bs(n.segments,t)||!_l(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!dd(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(Bs(n.segments,i)&&_l(n.segments,i,r)&&n.children[kt])&&hd(n.children[kt],e,a,r)}}function _l(n,e,t){return e.every((r,i)=>Us[t](n[i].parameters,r.parameters))}class ei{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gs(this.queryParams)),this._queryParamMap}toString(){return fd.serialize(this)}}class Ot{constructor(e,t){this.segments=e,this.children=t,this.parent=null,En(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ta(this)}}class ou{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=gs(this.parameters)),this._parameterMap}toString(){return vl(this)}}function Bs(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}class Xo{}class ea{parse(e){const t=new pd(e);return new ei(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${yo(e.root,!0)}`,r=function El(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${Hi(t)}=${Hi(i)}`).join("&"):`${Hi(t)}=${Hi(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Kf(n){return encodeURI(n)}(e.fragment)}`:""}`}}const fd=new ea;function ta(n){return n.segments.map(e=>vl(e)).join("/")}function yo(n,e){if(!n.hasChildren())return ta(n);if(e){const t=n.children[kt]?yo(n.children[kt],!1):"",r=[];return En(n.children,(i,a)=>{a!==kt&&r.push(`${a}:${yo(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function m_(n,e){let t=[];return En(n.children,(r,i)=>{i===kt&&(t=t.concat(e(r,i)))}),En(n.children,(r,i)=>{i!==kt&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===kt?[yo(n.children[kt],!1)]:[`${i}:${yo(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[kt]?`${ta(n)}/${t[0]}`:`${ta(n)}/(${t.join("//")})`}}function na(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Hi(n){return na(n).replace(/%3B/gi,";")}function js(n){return na(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function au(n){return decodeURIComponent(n)}function yl(n){return au(n.replace(/\+/g,"%20"))}function vl(n){return`${js(n.path)}${function uu(n){return Object.keys(n).map(e=>`;${js(e)}=${js(n[e])}`).join("")}(n.parameters)}`}const __=/^[^\/()?;=#]+/;function wl(n){const e=n.match(__);return e?e[0]:""}const ra=/^[^=?&#]+/,y_=/^[^&#]+/;class pd{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ot([],{}):new Ot([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[kt]=new Ot(e,t)),r}parseSegment(){const e=wl(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new ou(au(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=wl(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=wl(this.remaining);i&&(r=i,this.capture(r))}e[au(t)]=au(r)}parseQueryParam(e){const t=function vo(n){const e=n.match(ra);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function G0(n){const e=n.match(y_);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=yl(t),a=yl(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=wl(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let a;r.indexOf(":")>-1?(a=r.substr(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=kt);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[kt]:new Ot([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class Zf{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=lu(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=lu(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=gd(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return gd(e,this._root).map(t=>t.value)}}function lu(n,e){if(n===e.value)return e;for(const t of e.children){const r=lu(n,t);if(r)return r}return null}function gd(n,e){if(n===e.value)return[e];for(const t of e.children){const r=gd(n,t);if(r.length)return r.unshift(e),r}return[]}class ms{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function ia(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class cu extends Zf{constructor(e,t){super(e),this.snapshot=t,bl(this,e)}toString(){return this.snapshot.toString()}}function Il(n,e){const t=function sa(n,e){const l=new Eo([],{},{},"",{},kt,e,null,n.root,-1,{});return new Cl("",new ms(l,[]))}(n,e),r=new Xn([new ou("",{})]),i=new Xn({}),a=new Xn({}),l=new Xn({}),h=new Xn(""),m=new $s(r,i,l,h,a,kt,e,t.root);return m.snapshot=t.root,new cu(new ms(m,[]),t)}class $s{constructor(e,t,r,i,a,l,h,m){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this._futureSnapshot=m}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Et.U)(e=>gs(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Et.U)(e=>gs(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Yf(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function Qf(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Eo{constructor(e,t,r,i,a,l,h,m,v,b,D){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this.routeConfig=m,this._urlSegment=v,this._lastPathIndex=b,this._resolve=D}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=gs(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gs(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Cl extends Zf{constructor(e,t){super(t),this.url=e,bl(this,t)}toString(){return md(this._root)}}function bl(n,e){e.value._routerState=n,e.children.forEach(t=>bl(n,t))}function md(n){const e=n.children.length>0?` { ${n.children.map(md).join(", ")} } `:"";return`${n.value}${e}`}function Dl(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,gi(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),gi(e.params,t.params)||n.params.next(t.params),function Wf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!gi(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),gi(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function du(n,e){const t=gi(n.params,e.params)&&function Bn(n,e){return Bs(n,e)&&n.every((t,r)=>gi(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||du(n.parent,e.parent))}function hu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function E_(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return hu(n,r,i);return hu(n,r)})}(n,e,t);return new ms(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>hu(n,h)),l}}const r=function w_(n){return new $s(new Xn(n.url),new Xn(n.params),new Xn(n.queryParams),new Xn(n.fragment),new Xn(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>hu(n,a));return new ms(r,i)}}function Ai(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Si(n){return"object"==typeof n&&null!=n&&n.outlets}function yd(n,e,t,r,i){let a={};if(r&&En(r,(h,m)=>{a[m]=Array.isArray(h)?h.map(v=>`${v}`):`${h}`}),n===e)return new ei(t,a,i);const l=Jf(n,e,t);return new ei(l,a,i)}function Jf(n,e,t){const r={};return En(n.children,(i,a)=>{r[a]=i===e?t:Jf(i,e,t)}),new Ot(n.segments,r)}class I_{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ai(r[0]))throw new Error("Root segment cannot have matrix parameters");const i=r.find(Si);if(i&&i!==pl(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ep{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function tp(n,e,t){if(n||(n=new Ot([],{})),0===n.segments.length&&n.hasChildren())return Tl(n,e,t);const r=function D_(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],h=t[r];if(Si(h))break;const m=`${h}`,v=r<t.length-1?t[r+1]:null;if(i>0&&void 0===m)break;if(m&&v&&"object"==typeof v&&void 0===v.outlets){if(!ip(m,v,l))return a;r+=2}else{if(!ip(m,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new Ot(n.segments.slice(0,r.pathIndex),{});return a.children[kt]=new Ot(n.segments.slice(r.pathIndex),n.children),Tl(a,0,i)}return r.match&&0===i.length?new Ot(n.segments,{}):r.match&&!n.hasChildren()?np(n,e,t):r.match?Tl(n,0,i):np(n,e,t)}function Tl(n,e,t){if(0===t.length)return new Ot(n.segments,{});{const r=function b_(n){return Si(n[0])?n[0].outlets:{[kt]:n}}(t),i={};return En(r,(a,l)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[l]=tp(n.children[l],e,a))}),En(n.children,(a,l)=>{void 0===r[l]&&(i[l]=a)}),new Ot(n.segments,i)}}function np(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(Si(a)){const m=rp(a.outlets);return new Ot(r,m)}if(0===i&&Ai(t[0])){r.push(new ou(n.segments[e].path,fu(t[0]))),i++;continue}const l=Si(a)?a.outlets[kt]:`${a}`,h=i<t.length-1?t[i+1]:null;l&&h&&Ai(h)?(r.push(new ou(l,fu(h))),i+=2):(r.push(new ou(l,{})),i++)}return new Ot(r,{})}function rp(n){const e={};return En(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=np(new Ot([],{}),0,t))}),e}function fu(n){const e={};return En(n,(t,r)=>e[r]=`${t}`),e}function ip(n,e,t){return n==t.path&&gi(e,t.parameters)}class p{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Dl(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=ia(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),En(i,(a,l)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=ia(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=ia(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=ia(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new ld(a.value.snapshot))}),e.children.length&&this.forwardEvent(new iu(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(Dl(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),Dl(h.route.value),this.activateChildRoutes(e,null,l.children)}else{const h=function _(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),m=h?h.module.componentFactoryResolver:null;l.attachRef=null,l.route=i,l.resolver=m,l.outlet&&l.outlet.activateWith(i,m),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}class I{constructor(e,t){this.routes=e,this.module=t}}function A(n){return"function"==typeof n}function Q(n){return n instanceof ei}const rn=Symbol("INITIAL_VALUE");function ti(){return er(n=>function po(...n){const e=(0,ol.yG)(n),t=(0,ol.jO)(n),{args:r,keys:i}=Ff(n);if(0===r.length)return(0,yn.D)([],e);const a=new Jr.y(function zo(n,e,t=Os.y){return r=>{tu(e,()=>{const{length:i}=n,a=new Array(i);let l=i,h=i;for(let m=0;m<i;m++)tu(e,()=>{const v=(0,yn.D)(n[m],e);let b=!1;v.subscribe((0,Un.x)(r,D=>{a[m]=D,b||(b=!0,h--),h||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>Vf(i,l):Os.y));return t?a.pipe(ul(t)):a}(n.map(e=>e.pipe(qo(1),mo(rn)))).pipe(ji((e,t)=>{let r=!1;return t.reduce((i,a,l)=>i!==rn?i:(a===rn&&(r=!0),r||!1!==a&&l!==t.length-1&&!Q(a)?i:a),e)},rn),tr(e=>e!==rn),(0,Et.U)(e=>Q(e)?e:!0===e),qo(1)))}class _s{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Hs,this.attachRef=null}}class Hs{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new _s,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let Al=(()=>{class n{constructor(t,r,i,a,l){this.parentContexts=t,this.location=r,this.resolver=i,this.changeDetector=l,this.activated=null,this._activatedRoute=null,this.activateEvents=new g.vpe,this.deactivateEvents=new g.vpe,this.attachEvents=new g.vpe,this.detachEvents=new g.vpe,this.name=a||kt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const l=(r=r||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),h=this.parentContexts.getOrCreateContext(this.name).children,m=new Ed(t,h,this.location.injector);this.activated=this.location.createComponent(l,this.location.length,m),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(Hs),g.Y36(g.s_b),g.Y36(g._Vd),g.$8M("name"),g.Y36(g.sBO))},n.\u0275dir=g.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class Ed{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===$s?this.route:e===Hs?this.childContexts:this.parent.get(e,t)}}let wd=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=g.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,r){1&t&&g._UZ(0,"router-outlet")},directives:[Al],encapsulation:2}),n})();function Sl(n,e=""){for(let t=0;t<n.length;t++){const r=n[t];oa(r,sp(e,r))}}function oa(n,e){n.children&&Sl(n.children,e)}function sp(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function aa(n){const e=n.children&&n.children.map(aa),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==kt&&(t.component=wd),t}function Mr(n){return n.outlet||kt}function wn(n,e){const t=n.filter(r=>Mr(r)===e);return t.push(...n.filter(r=>Mr(r)!==e)),t}const op={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function ua(n,e,t){var r;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},op):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const a=(e.matcher||Hf)(t,n,e);if(!a)return Object.assign({},op);const l={};En(a.posParams,(m,v)=>{l[v]=m.path});const h=a.consumed.length>0?Object.assign(Object.assign({},l),a.consumed[a.consumed.length-1].parameters):l;return{matched:!0,consumedSegments:a.consumed,remainingSegments:t.slice(a.consumed.length),parameters:h,positionalParamSegments:null!==(r=a.posParams)&&void 0!==r?r:{}}}function la(n,e,t,r,i="corrected"){if(t.length>0&&function aT(n,e,t){return t.some(r=>ap(n,e,r)&&Mr(r)!==kt)}(n,t,r)){const l=new Ot(e,function oT(n,e,t,r){const i={};i[kt]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&Mr(a)!==kt){const l=new Ot([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,i[Mr(a)]=l}return i}(n,e,r,new Ot(t,n.children)));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:[]}}if(0===t.length&&function uT(n,e,t){return t.some(r=>ap(n,e,r))}(n,t,r)){const l=new Ot(n.segments,function z0(n,e,t,r,i,a){const l={};for(const h of r)if(ap(n,t,h)&&!i[Mr(h)]){const m=new Ot([],{});m._sourceSegment=n,m._segmentIndexShift="legacy"===a?n.segments.length:e.length,l[Mr(h)]=m}return Object.assign(Object.assign({},i),l)}(n,e,t,r,n.children,i));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:t}}const a=new Ot(n.segments,n.children);return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}function ap(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function q0(n,e,t,r){return!!(Mr(n)===r||r!==kt&&ap(e,t,n))&&("**"===n.path||ua(e,n,t).matched)}function lT(n,e,t){return 0===e.length&&!n.children[t]}class T_{constructor(e){this.segmentGroup=e||null}}class xl{constructor(e){this.urlTree=e}}function nr(n){return nu(new T_(n))}function up(n){return nu(new xl(n))}class Id{constructor(e,t,r,i,a){this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=e.get(g.h0i)}apply(){const e=la(this.urlTree.root,[],[],this.config).segmentGroup,t=new Ot(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,kt).pipe((0,Et.U)(a=>this.createUrlTree(S_(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ps(a=>{if(a instanceof xl)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof T_?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,kt).pipe((0,Et.U)(i=>this.createUrlTree(S_(i),e.queryParams,e.fragment))).pipe(ps(i=>{throw i instanceof T_?this.noMatchError(i):i}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,r){const i=e.segments.length>0?new Ot([],{[kt]:e}):e;return new ei(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,Et.U)(a=>new Ot([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,yn.D)(i).pipe($i(a=>{const l=r.children[a],h=wn(t,a);return this.expandSegmentGroup(e,h,l,a).pipe((0,Et.U)(m=>({segment:m,outlet:a})))}),ji((a,l)=>(a[l.outlet]=l.segment,a),{}),function B0(n,e){const t=arguments.length>=2;return r=>r.pipe(n?tr((i,a)=>n(i,a,r)):Os.y,hl(1),t?Bf(e):Uf(()=>new ru))}())}expandSegment(e,t,r,i,a,l){return(0,yn.D)(r).pipe($i(h=>this.expandSegmentAgainstRoute(e,t,r,h,i,a,l).pipe(ps(v=>{if(v instanceof T_)return gt(null);throw v}))),Zo(h=>!!h),ps((h,m)=>{if(h instanceof ru||"EmptyError"===h.name)return lT(t,i,a)?gt(new Ot([],{})):nr(t);throw h}))}expandSegmentAgainstRoute(e,t,r,i,a,l,h){return q0(i,t,a,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,l):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l):nr(t):nr(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?up(a):this.lineralizeSegments(r,a).pipe((0,zn.z)(l=>{const h=new Ot(l,{});return this.expandSegment(e,h,t,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:h,consumedSegments:m,remainingSegments:v,positionalParamSegments:b}=ua(t,i,a);if(!h)return nr(t);const D=this.applyRedirectCommands(m,i.redirectTo,b);return i.redirectTo.startsWith("/")?up(D):this.lineralizeSegments(i,D).pipe((0,zn.z)(x=>this.expandSegment(e,t,r,x.concat(v),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){if("**"===r.path)return r.loadChildren?(r._loadedConfig?gt(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe((0,Et.U)(D=>(r._loadedConfig=D,new Ot(i,{})))):gt(new Ot(i,{}));const{matched:l,consumedSegments:h,remainingSegments:m}=ua(t,r,i);return l?this.getChildConfig(e,r,i).pipe((0,zn.z)(b=>{const D=b.module,x=b.routes,{segmentGroup:P,slicedSegments:G}=la(t,h,m,x),ue=new Ot(P.segments,P.children);if(0===G.length&&ue.hasChildren())return this.expandChildren(D,x,ue).pipe((0,Et.U)(ht=>new Ot(h,ht)));if(0===x.length&&0===G.length)return gt(new Ot(h,{}));const Ee=Mr(r)===a;return this.expandSegment(D,ue,x,G,Ee?kt:a,!0).pipe((0,Et.U)(dt=>new Ot(h.concat(dt.segments),dt.children)))})):nr(t)}getChildConfig(e,t,r){return t.children?gt(new I(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?gt(t._loadedConfig):this.runCanLoadGuards(e.injector,t,r).pipe((0,zn.z)(i=>i?this.configLoader.load(e.injector,t).pipe((0,Et.U)(a=>(t._loadedConfig=a,a))):function Z0(n){return nu(su(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))}(t))):gt(new I([],e))}runCanLoadGuards(e,t,r){const i=t.canLoad;return i&&0!==i.length?gt(i.map(l=>{const h=e.get(l);let m;if(function me(n){return n&&A(n.canLoad)}(h))m=h.canLoad(t,r);else{if(!A(h))throw new Error("Invalid CanLoad guard");m=h(t,r)}return mi(m)})).pipe(ti(),dr(l=>{if(!Q(l))return;const h=su(`Redirecting to "${this.urlSerializer.serialize(l)}"`);throw h.url=l,h}),(0,Et.U)(l=>!0===l)):gt(!0)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return gt(r);if(i.numberOfChildren>1||!i.children[kt])return nu(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));i=i.children[kt]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreatreUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new ei(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return En(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const h=i.substring(1);r[a]=t[h]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return En(t.children,(h,m)=>{l[m]=this.createSegmentGroup(e,h,r,i)}),new Ot(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}function S_(n){const e={};for(const r of Object.keys(n.children)){const a=S_(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function A_(n){if(1===n.numberOfChildren&&n.children[kt]){const e=n.children[kt];return new Ot(n.segments.concat(e.segments),e.children)}return n}(new Ot(n.segments,e))}class x_{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class lp{constructor(e,t){this.component=e,this.route=t}}function Y0(n,e,t){const r=n._root;return bd(r,e?e._root:null,t,[r.value])}function Cd(n,e,t){const r=function hT(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:t).get(n)}function bd(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=ia(e);return n.children.forEach(l=>{(function M_(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const m=function fT(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Bs(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Bs(n.url,e.url)||!gi(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!du(n,e)||!gi(n.queryParams,e.queryParams);default:return!du(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);m?i.canActivateChecks.push(new x_(r)):(a.data=l.data,a._resolvedData=l._resolvedData),bd(n,e,a.component?h?h.children:null:t,r,i),m&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new lp(h.outlet.component,l))}else l&&Dd(e,h,i),i.canActivateChecks.push(new x_(r)),bd(n,null,a.component?h?h.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),En(a,(l,h)=>Dd(l,t.getContext(h),i)),i}function Dd(n,e,t){const r=ia(n),i=n.value;En(r,(a,l)=>{Dd(a,i.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new lp(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class ET{}function N_(n){return new Jr.y(e=>e.error(n))}class IT{constructor(e,t,r,i,a,l){this.rootComponentType=e,this.config=t,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=l}recognize(){const e=la(this.urlTree.root,[],[],this.config.filter(l=>void 0===l.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,kt);if(null===t)return null;const r=new Eo([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},kt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new ms(r,t),a=new Cl(this.url,i);return this.inheritParamsAndData(a._root),a}inheritParamsAndData(e){const t=e.value,r=Yf(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,r)}processChildren(e,t){const r=[];for(const a of Object.keys(t.children)){const l=t.children[a],h=wn(e,a),m=this.processSegmentGroup(h,l,a);if(null===m)return null;r.push(...m)}const i=Q0(r);return function CT(n){n.sort((e,t)=>e.value.outlet===kt?-1:t.value.outlet===kt?1:e.value.outlet.localeCompare(t.value.outlet))}(i),i}processSegment(e,t,r,i){for(const a of e){const l=this.processSegmentAgainstRoute(a,t,r,i);if(null!==l)return l}return lT(t,r,i)?[]:null}processSegmentAgainstRoute(e,t,r,i){if(e.redirectTo||!q0(e,t,r,i))return null;let a,l=[],h=[];if("**"===e.path){const P=r.length>0?pl(r).parameters:{};a=new Eo(r,P,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ys(e),Mr(e),e.component,e,J0(t),pu(t)+r.length,TT(e))}else{const P=ua(t,e,r);if(!P.matched)return null;l=P.consumedSegments,h=P.remainingSegments,a=new Eo(l,P.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,ys(e),Mr(e),e.component,e,J0(t),pu(t)+l.length,TT(e))}const m=function bT(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:v,slicedSegments:b}=la(t,l,h,m.filter(P=>void 0===P.redirectTo),this.relativeLinkResolution);if(0===b.length&&v.hasChildren()){const P=this.processChildren(m,v);return null===P?null:[new ms(a,P)]}if(0===m.length&&0===b.length)return[new ms(a,[])];const D=Mr(e)===i,x=this.processSegment(m,v,b,D?kt:i);return null===x?null:[new ms(a,x)]}}function DT(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function Q0(n){const e=[],t=new Set;for(const r of n){if(!DT(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=Q0(r.children);e.push(new ms(r.value,i))}return e.filter(r=>!t.has(r))}function J0(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function pu(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function ys(n){return n.data||{}}function TT(n){return n.resolve||{}}function dp(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function k_(n){return er(e=>{const t=n(e);return t?(0,yn.D)(t).pipe((0,Et.U)(()=>e)):gt(e)})}class tw extends class Td{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const hp=new g.OlP("ROUTES");class fp{constructor(e,t,r,i){this.injector=e,this.compiler=t,this.onLoadStartListener=r,this.onLoadEndListener=i}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe((0,Et.U)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t);const l=a.create(e);return new I(fl(l.injector.get(hp,void 0,g.XFs.Self|g.XFs.Optional)).map(aa),l)}),ps(a=>{throw t._loader$=void 0,a}));return t._loader$=new Fs(i,()=>new Bi.x).pipe(sd()),t._loader$}loadModuleFactory(e){return mi(e()).pipe((0,zn.z)(t=>t instanceof g.YKP?gt(t):(0,yn.D)(this.compiler.compileModuleAsync(t))))}}class nw{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function eP(n){throw n}function Ml(n,e,t){return e.parse("/")}function pp(n,e){return gt(null)}const rw={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},AT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Nr=(()=>{class n{constructor(t,r,i,a,l,h,m){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=a,this.config=m,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Bi.x,this.errorHandler=eP,this.malformedUriErrorHandler=Ml,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:pp,afterPreactivation:pp},this.urlHandlingStrategy=new nw,this.routeReuseStrategy=new tw,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=l.get(g.h0i),this.console=l.get(g.c2e);const D=l.get(g.R0b);this.isNgZoneEnabled=D instanceof g.R0b&&g.R0b.isInAngularZone(),this.resetConfig(m),this.currentUrlTree=function gl(){return new ei(new Ot([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new fp(l,h,x=>this.triggerEvent(new Xr(x)),x=>this.triggerEvent(new ud(x))),this.routerState=Il(this.currentUrlTree,this.rootComponentType),this.transitions=new Xn({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(tr(i=>0!==i.id),(0,Et.U)(i=>Object.assign(Object.assign({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),er(i=>{let a=!1,l=!1;return gt(i).pipe(dr(h=>{this.currentNavigation={id:h.id,initialUrl:h.currentRawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),er(h=>{const m=this.browserUrlTree.toString(),v=!this.navigated||h.extractedUrl.toString()!==m||m!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||v)&&this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return iw(h.source)&&(this.browserUrlTree=h.extractedUrl),gt(h).pipe(er(D=>{const x=this.transitions.getValue();return r.next(new jf(D.id,this.serializeUrl(D.extractedUrl),D.source,D.restoredState)),x!==this.transitions.getValue()?pi.E:Promise.resolve(D)}),function cT(n,e,t,r){return er(i=>function Rr(n,e,t,r,i){return new Id(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,Et.U)(a=>Object.assign(Object.assign({},i),{urlAfterRedirects:a}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),dr(D=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:D.urlAfterRedirects})}),function JN(n,e,t,r,i){return(0,zn.z)(a=>function wT(n,e,t,r,i="emptyOnly",a="legacy"){try{const l=new IT(n,e,t,r,i,a).recognize();return null===l?N_(new ET):gt(l)}catch(l){return N_(l)}}(n,e,a.urlAfterRedirects,t(a.urlAfterRedirects),r,i).pipe((0,Et.U)(l=>Object.assign(Object.assign({},a),{targetSnapshot:l}))))}(this.rootComponentType,this.config,D=>this.serializeUrl(D),this.paramsInheritanceStrategy,this.relativeLinkResolution),dr(D=>{if("eager"===this.urlUpdateStrategy){if(!D.extras.skipLocationChange){const P=this.urlHandlingStrategy.merge(D.urlAfterRedirects,D.rawUrl);this.setBrowserUrl(P,D)}this.browserUrlTree=D.urlAfterRedirects}const x=new od(D.id,this.serializeUrl(D.extractedUrl),this.serializeUrl(D.urlAfterRedirects),D.targetSnapshot);r.next(x)}));if(v&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:x,extractedUrl:P,source:G,restoredState:ue,extras:Ee}=h,at=new jf(x,this.serializeUrl(P),G,ue);r.next(at);const dt=Il(P,this.rootComponentType).snapshot;return gt(Object.assign(Object.assign({},h),{targetSnapshot:dt,urlAfterRedirects:P,extras:Object.assign(Object.assign({},Ee),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=h.rawUrl,h.resolve(null),pi.E}),k_(h=>{const{targetSnapshot:m,id:v,extractedUrl:b,rawUrl:D,extras:{skipLocationChange:x,replaceUrl:P}}=h;return this.hooks.beforePreactivation(m,{navigationId:v,appliedUrlTree:b,rawUrlTree:D,skipLocationChange:!!x,replaceUrl:!!P})}),dr(h=>{const m=new _o(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);this.triggerEvent(m)}),(0,Et.U)(h=>Object.assign(Object.assign({},h),{guards:Y0(h.targetSnapshot,h.currentSnapshot,this.rootContexts)})),function R_(n,e){return(0,zn.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?gt(Object.assign(Object.assign({},t),{guardsResult:!0})):function pT(n,e,t,r){return(0,yn.D)(n).pipe((0,zn.z)(i=>function vT(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?gt(a.map(h=>{const m=Cd(h,e,i);let v;if(function wt(n){return n&&A(n.canDeactivate)}(m))v=mi(m.canDeactivate(n,e,t,r));else{if(!A(m))throw new Error("Invalid CanDeactivate guard");v=mi(m(n,e,t,r))}return v.pipe(Zo())})).pipe(ti()):gt(!0)}(i.component,i.route,t,e,r)),Zo(i=>!0!==i,!0))}(l,r,i,n).pipe((0,zn.z)(h=>h&&function R(n){return"boolean"==typeof n}(h)?function gT(n,e,t,r){return(0,yn.D)(e).pipe($i(i=>rd(function mT(n,e){return null!==n&&e&&e(new Yo(n)),gt(!0)}(i.route.parent,r),function cp(n,e){return null!==n&&e&&e(new Vs(n)),gt(!0)}(i.route,r),function yT(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function dT(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>dl(()=>gt(l.guards.map(m=>{const v=Cd(m,l.node,t);let b;if(function et(n){return n&&A(n.canActivateChild)}(v))b=mi(v.canActivateChild(r,n));else{if(!A(v))throw new Error("Invalid CanActivateChild guard");b=mi(v(r,n))}return b.pipe(Zo())})).pipe(ti())));return gt(a).pipe(ti())}(n,i.path,t),function _T(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return gt(!0);const i=r.map(a=>dl(()=>{const l=Cd(a,e,t);let h;if(function Ge(n){return n&&A(n.canActivate)}(l))h=mi(l.canActivate(e,n));else{if(!A(l))throw new Error("Invalid CanActivate guard");h=mi(l(e,n))}return h.pipe(Zo())}));return gt(i).pipe(ti())}(n,i.route,t))),Zo(i=>!0!==i,!0))}(r,a,n,e):gt(h)),(0,Et.U)(h=>Object.assign(Object.assign({},t),{guardsResult:h})))})}(this.ngModule.injector,h=>this.triggerEvent(h)),dr(h=>{if(Q(h.guardsResult)){const v=su(`Redirecting to "${this.serializeUrl(h.guardsResult)}"`);throw v.url=h.guardsResult,v}const m=new $0(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.triggerEvent(m)}),tr(h=>!!h.guardsResult||(this.restoreHistory(h),this.cancelNavigationTransition(h,""),!1)),k_(h=>{if(h.guards.canActivateChecks.length)return gt(h).pipe(dr(m=>{const v=new ad(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(v)}),er(m=>{let v=!1;return gt(m).pipe(function X0(n,e){return(0,zn.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return gt(t);let a=0;return(0,yn.D)(i).pipe($i(l=>function XN(n,e,t,r){return function Ws(n,e,t,r){const i=dp(n);if(0===i.length)return gt({});const a={};return(0,yn.D)(i).pipe((0,zn.z)(l=>function P_(n,e,t,r){const i=Cd(n,e,r);return mi(i.resolve?i.resolve(e,t):i(e,t))}(n[l],e,t,r).pipe(dr(h=>{a[l]=h}))),hl(1),(0,zn.z)(()=>dp(a).length===i.length?gt(a):pi.E))}(n._resolve,n,e,r).pipe((0,Et.U)(a=>(n._resolvedData=a,n.data=Object.assign(Object.assign({},n.data),Yf(n,t).resolve),null)))}(l.route,r,n,e)),dr(()=>a++),hl(1),(0,zn.z)(l=>a===i.length?gt(t):pi.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),dr({next:()=>v=!0,complete:()=>{v||(this.restoreHistory(m),this.cancelNavigationTransition(m,"At least one route resolver didn't emit any value."))}}))}),dr(m=>{const v=new vr(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(v)}))}),k_(h=>{const{targetSnapshot:m,id:v,extractedUrl:b,rawUrl:D,extras:{skipLocationChange:x,replaceUrl:P}}=h;return this.hooks.afterPreactivation(m,{navigationId:v,appliedUrlTree:b,rawUrlTree:D,skipLocationChange:!!x,replaceUrl:!!P})}),(0,Et.U)(h=>{const m=function v_(n,e,t){const r=hu(n,e._root,t?t._root:void 0);return new cu(r,e)}(this.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return Object.assign(Object.assign({},h),{targetRouterState:m})}),dr(h=>{this.currentUrlTree=h.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl),this.routerState=h.targetRouterState,"deferred"===this.urlUpdateStrategy&&(h.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,h),this.browserUrlTree=h.urlAfterRedirects)}),((n,e,t)=>(0,Et.U)(r=>(new p(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,h=>this.triggerEvent(h)),dr({next(){a=!0},complete(){a=!0}}),function j0(n){return(0,cr.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var h;a||l||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),(null===(h=this.currentNavigation)||void 0===h?void 0:h.id)===i.id&&(this.currentNavigation=null)}),ps(h=>{if(l=!0,function Qo(n){return n&&n[Er]}(h)){const m=Q(h.url);m||(this.navigated=!0,this.restoreHistory(i,!0));const v=new g_(i.id,this.serializeUrl(i.extractedUrl),h.message);r.next(v),m?setTimeout(()=>{const b=this.urlHandlingStrategy.merge(h.url,this.rawUrlTree),D={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||iw(i.source)};this.scheduleNavigation(b,"imperative",null,D,{resolve:i.resolve,reject:i.reject,promise:i.promise})},0):i.resolve(!1)}else{this.restoreHistory(i,!0);const m=new An(i.id,this.serializeUrl(i.extractedUrl),h);r.next(m);try{i.resolve(this.errorHandler(h))}catch(v){i.reject(v)}}return pi.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var i;const a={replaceUrl:!0},l=(null===(i=t.state)||void 0===i?void 0:i.navigationId)?t.state:null;if(l){const m=Object.assign({},l);delete m.navigationId,delete m.\u0275routerPageId,0!==Object.keys(m).length&&(a.state=m)}const h=this.parseUrl(t.url);this.scheduleNavigation(h,r,l,a)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Sl(t),this.config=t.map(aa),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:m}=r,v=i||this.routerState.root,b=m?this.currentUrlTree.fragment:l;let D=null;switch(h){case"merge":D=Object.assign(Object.assign({},this.currentUrlTree.queryParams),a);break;case"preserve":D=this.currentUrlTree.queryParams;break;default:D=a||null}return null!==D&&(D=this.removeEmptyProps(D)),function _d(n,e,t,r,i){if(0===t.length)return yd(e.root,e.root,e.root,r,i);const a=function Xf(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new I_(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return En(a.outlets,(m,v)=>{h[v]="string"==typeof m?m.split("/"):m}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((h,m)=>{0==m&&"."===h||(0==m&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new I_(t,e,r)}(t);if(a.toRoot())return yd(e.root,e.root,new Ot([],{}),r,i);const l=function C_(n,e,t){if(n.isAbsolute)return new ep(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const a=t.snapshot._urlSegment;return new ep(a,a===e.root,0)}const r=Ai(n.commands[0])?0:1;return function vd(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new ep(r,!1,i-a)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+r,n.numberOfDoubleDots)}(a,e,n),h=l.processChildren?Tl(l.segmentGroup,l.index,a.commands):tp(l.segmentGroup,l.index,a.commands);return yd(e.root,l.segmentGroup,h,r,i)}(v,this.currentUrlTree,t,D,null!=b?b:null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=Q(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function ST(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?Object.assign({},rw):!1===r?Object.assign({},AT):r,Q(t))return Jo(this.currentUrlTree,t,i);const a=this.parseUrl(t);return Jo(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Ti(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,i,a,l){var h,m;if(this.disposed)return Promise.resolve(!1);let v,b,D;l?(v=l.resolve,b=l.reject,D=l.promise):D=new Promise((G,ue)=>{v=G,b=ue});const x=++this.navigationId;let P;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),P=i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?null!==(h=this.browserPageId)&&void 0!==h?h:0:(null!==(m=this.browserPageId)&&void 0!==m?m:0)+1):P=0,this.setTransition({id:x,targetPageId:P,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:a,resolve:v,reject:b,promise:D,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),D.catch(G=>Promise.reject(G))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){var i,a;if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(i=this.currentNavigation)||void 0===i?void 0:i.finalUrl)||0===l?this.currentUrlTree===(null===(a=this.currentNavigation)||void 0===a?void 0:a.finalUrl)&&0===l&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(l)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r){const i=new g_(t.id,this.serializeUrl(t.extractedUrl),r);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){g.$Z()},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();function iw(n){return"imperative"!==n}class gp{}class mp{preload(e,t){return gt(null)}}let aw=(()=>{class n{constructor(t,r,i,a){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new fp(i,r,m=>t.triggerEvent(new Xr(m)),m=>t.triggerEvent(new ud(m)))}setUpPreloading(){this.subscription=this.router.events.pipe(tr(t=>t instanceof Ti),$i(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(g.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r)if(a.loadChildren&&!a.canLoad&&a._loadedConfig){const l=a._loadedConfig;i.push(this.processRoutes(l.module,l.routes))}else a.loadChildren&&!a.canLoad?i.push(this.preloadConfig(t,a)):a.children&&i.push(this.processRoutes(t,a.children));return(0,yn.D)(i).pipe((0,go.J)(),(0,Et.U)(a=>{}))}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?gt(r._loadedConfig):this.loader.load(t.injector,r)).pipe((0,zn.z)(a=>(r._loadedConfig=a,this.processRoutes(a.module,a.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(Nr),g.LFG(g.Sil),g.LFG(g.zs3),g.LFG(gp))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})(),V_=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof jf?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ti&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof $f&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new $f(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){g.$Z()},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();const ca=new g.OlP("ROUTER_CONFIGURATION"),da=new g.OlP("ROUTER_FORROOT_GUARD"),uw=[ge,{provide:Xo,useClass:ea},{provide:Nr,useFactory:function hw(n,e,t,r,i,a,l={},h,m){const v=new Nr(null,n,e,t,r,i,fl(a));return h&&(v.urlHandlingStrategy=h),m&&(v.routeReuseStrategy=m),function B_(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(l,v),l.enableTracing&&v.events.subscribe(b=>{var D,x;null===(D=console.group)||void 0===D||D.call(console,`Router Event: ${b.constructor.name}`),console.log(b.toString()),console.log(b),null===(x=console.groupEnd)||void 0===x||x.call(console)}),v},deps:[Xo,Hs,ge,g.zs3,g.Sil,hp,ca,[class O_{},new g.FiY],[class ew{},new g.FiY]]},Hs,{provide:$s,useFactory:function fw(n){return n.routerState.root},deps:[Nr]},aw,mp,class ow{preload(e,t){return t().pipe(ps(()=>gt(null)))}},{provide:ca,useValue:{enableTracing:!1}}];function lw(){return new g.PXZ("Router",Nr)}let cw=(()=>{class n{constructor(t,r){}static forRoot(t,r){return{ngModule:n,providers:[uw,U_(t),{provide:da,useFactory:dw,deps:[[Nr,new g.FiY,new g.tp0]]},{provide:ca,useValue:r||{}},{provide:ne,useFactory:RT,deps:[de,[new g.tBr(We),new g.FiY],ca]},{provide:V_,useFactory:_p,deps:[Nr,qu,ca]},{provide:gp,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:mp},{provide:g.PXZ,multi:!0,useFactory:lw},[Nl,{provide:g.ip1,multi:!0,useFactory:yp,deps:[Nl]},{provide:vp,useFactory:pw,deps:[Nl]},{provide:g.tb,multi:!0,useExisting:vp}]]}}static forChild(t){return{ngModule:n,providers:[U_(t)]}}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(da,8),g.LFG(Nr,8))},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({}),n})();function _p(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new V_(n,e,t)}function RT(n,e,t={}){return t.useHash?new Se(n,e):new $e(n,e)}function dw(n){return"guarded"}function U_(n){return[{provide:g.deG,multi:!0,useValue:n},{provide:hp,multi:!0,useValue:n}]}let Nl=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Bi.x}appInitializer(){return this.injector.get(H,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const i=new Promise(h=>r=h),a=this.injector.get(Nr),l=this.injector.get(ca);return"disabled"===l.initialNavigation?(a.setUpLocationChangeListener(),r(!0)):"enabled"===l.initialNavigation||"enabledBlocking"===l.initialNavigation?(a.hooks.afterPreactivation=()=>this.initNavigation?gt(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),a.initialNavigation()):r(!0),i})}bootstrapListener(t){const r=this.injector.get(ca),i=this.injector.get(aw),a=this.injector.get(V_),l=this.injector.get(Nr),h=this.injector.get(g.z2F);t===h.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&l.initialNavigation(),i.setUpPreloading(),a.init(),l.resetRootComponentType(h.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(g.zs3))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac}),n})();function yp(n){return n.appInitializer.bind(n)}function pw(n){return n.bootstrapListener.bind(n)}const vp=new g.OlP("Router Initializer");var K=F(5861);let j_=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(g.Qsj),g.Y36(g.SBq))},n.\u0275dir=g.lG2({type:n}),n})(),gu=(()=>{class n extends j_{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=g.n5z(n)))(r||n)}}(),n.\u0275dir=g.lG2({type:n,features:[g.qOj]}),n})();const Gs=new g.OlP("NgValueAccessor"),yw={provide:Gs,useExisting:(0,g.Gpc)(()=>Ad),multi:!0},vw=new g.OlP("CompositionEventMode");let Ad=(()=>{class n extends j_{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function tP(){const n=k()?k().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(g.Qsj),g.Y36(g.SBq),g.Y36(vw,8))},n.\u0275dir=g.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&g.NdJ("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},features:[g._Bn([yw]),g.qOj]}),n})();function wo(n){return null==n||0===n.length}function Ew(n){return null!=n&&"number"==typeof n.length}const Pr=new g.OlP("NgValidators"),hr=new g.OlP("NgAsyncValidators"),PT=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class $_{static min(e){return function ww(n){return e=>{if(wo(e.value)||wo(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function Iw(n){return e=>{if(wo(e.value)||wo(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return function Cw(n){return wo(n.value)?{required:!0}:null}(e)}static requiredTrue(e){return function bw(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function H_(n){return wo(n.value)||PT.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function Dw(n){return e=>wo(e.value)||!Ew(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function Tw(n){return e=>Ew(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function Aw(n){if(!n)return vt;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(wo(r.value))return null;const i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return Sw(e)}static composeAsync(e){return zs(e)}}function vt(n){return null}function W_(n){return null!=n}function G_(n){const e=(0,g.QGY)(n)?(0,yn.D)(n):n;return(0,g.CqO)(e),e}function z_(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Sd(n,e){return e.map(t=>t(n))}function q_(n){return n.map(e=>function vs(n){return!n.validate}(e)?e:t=>e.validate(t))}function Sw(n){if(!n)return null;const e=n.filter(W_);return 0==e.length?null:function(t){return z_(Sd(t,e))}}function xd(n){return null!=n?Sw(q_(n)):null}function zs(n){if(!n)return null;const e=n.filter(W_);return 0==e.length?null:function(t){return function NT(...n){const e=(0,ol.jO)(n),{args:t,keys:r}=Ff(n),i=new Jr.y(a=>{const{length:l}=t;if(!l)return void a.complete();const h=new Array(l);let m=l,v=l;for(let b=0;b<l;b++){let D=!1;(0,cl.Xf)(t[b]).subscribe((0,Un.x)(a,x=>{D||(D=!0,v--),h[b]=x},()=>m--,void 0,()=>{(!m||!D)&&(v||a.next(r?Vf(r,h):h),a.complete())}))}});return e?i.pipe(ul(e)):i}(Sd(t,e).map(G_)).pipe((0,Et.U)(z_))}}function Md(n){return null!=n?zs(q_(n)):null}function K_(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function wp(n){return n._rawValidators}function kT(n){return n._rawAsyncValidators}function Ip(n){return n?Array.isArray(n)?n:[n]:[]}function Z_(n,e){return Array.isArray(n)?n.includes(e):n===e}function Rd(n,e){const t=Ip(e);return Ip(n).forEach(i=>{Z_(t,i)||t.push(i)}),t}function Nd(n,e){return Ip(e).filter(t=>!Z_(n,t))}class Cp{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=xd(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Md(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class qs extends Cp{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class wr extends Cp{get formDirective(){return null}get path(){return null}}class OT{constructor(e){this._cd=e}is(e){var t,r,i;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(i=null===(r=this._cd)||void 0===r?void 0:r.control)||void 0===i?void 0:i[e])}}let Y_=(()=>{class n extends OT{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(qs,2))},n.\u0275dir=g.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&g.ekj("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))},features:[g.qOj]}),n})(),Q_=(()=>{class n extends OT{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(wr,10))},n.\u0275dir=g.lG2({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){2&t&&g.ekj("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))("ng-submitted",r.is("submitted"))},features:[g.qOj]}),n})();function Dp(n,e){Tp(n,e),e.valueAccessor.writeValue(n.value),function Nw(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&Pw(n,e)})}(n,e),function ha(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function ey(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&Pw(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function UT(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Es(n,e,t=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),kl(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Pl(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Tp(n,e){const t=wp(n);null!==e.validator?n.setValidators(K_(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=kT(n);null!==e.asyncValidator?n.setAsyncValidators(K_(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();Pl(e._rawValidators,i),Pl(e._rawAsyncValidators,i)}function kl(n,e){let t=!1;if(null!==n){if(null!==e.validator){const i=wp(n);if(Array.isArray(i)&&i.length>0){const a=i.filter(l=>l!==e.validator);a.length!==i.length&&(t=!0,n.setValidators(a))}}if(null!==e.asyncValidator){const i=kT(n);if(Array.isArray(i)&&i.length>0){const a=i.filter(l=>l!==e.asyncValidator);a.length!==i.length&&(t=!0,n.setAsyncValidators(a))}}}const r=()=>{};return Pl(e._rawValidators,r),Pl(e._rawAsyncValidators,r),t}function Pw(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function fa(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Od="VALID",Fd="INVALID",_u="PENDING",yu="DISABLED";function Sp(n){return(ay(n)?n.validators:n)||null}function Ld(n){return Array.isArray(n)?xd(n):n||null}function sy(n,e){return(ay(e)?e.asyncValidators:n)||null}function oy(n){return Array.isArray(n)?Md(n):n||null}function ay(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const xp=n=>n instanceof ly,Vd=n=>n instanceof Mp,Ow=n=>n instanceof $T;function uy(n){return xp(n)?n.value:n.getRawValue()}function Fw(n,e){const t=Vd(n),r=n.controls;if(!(t?Object.keys(r):r).length)throw new g.vHH(1e3,"");if(!r[e])throw new g.vHH(1001,"")}function Lw(n,e){Vd(n),n._forEachChild((r,i)=>{if(void 0===e[i])throw new g.vHH(1002,"")})}class ni{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=Ld(this._rawValidators),this._composedAsyncValidatorFn=oy(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Od}get invalid(){return this.status===Fd}get pending(){return this.status==_u}get disabled(){return this.status===yu}get enabled(){return this.status!==yu}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=Ld(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=oy(e)}addValidators(e){this.setValidators(Rd(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Rd(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Nd(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Nd(e,this._rawAsyncValidators))}hasValidator(e){return Z_(this._rawValidators,e)}hasAsyncValidator(e){return Z_(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=_u,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=yu,this.errors=null,this._forEachChild(r=>{r.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Od,this._forEachChild(r=>{r.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Od||this.status===_u)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?yu:Od}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=_u,this._hasOwnPendingAsyncValidator=!0;const t=G_(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function iy(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(t)),Array.isArray(e)&&0===e.length))return null;let r=n;return e.forEach(i=>{r=Vd(r)?r.controls.hasOwnProperty(i)?r.controls[i]:null:Ow(r)&&r.at(i)||null}),r}(this,e,".")}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new g.vpe,this.statusChanges=new g.vpe}_calculateStatus(){return this._allControlsDisabled()?yu:this.errors?Fd:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_u)?_u:this._anyControlsHaveStatus(Fd)?Fd:Od}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ay(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class ly extends ni{constructor(e=null,t,r){super(Sp(t),sy(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ay(t)&&t.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){fa(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){fa(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class Mp extends ni{constructor(e,t,r){super(Sp(t),sy(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){Lw(this,e),Object.keys(e).forEach(r=>{Fw(this,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{this.controls[r]&&this.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=uy(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const r=this.controls[t];if(this.contains(t)&&e(r))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,r)=>((t.enabled||this.disabled)&&(e[r]=t.value),e))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,a)=>{r=t(r,i,a)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class $T extends ni{constructor(e,t,r){super(Sp(t),sy(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){Lw(this,e),e.forEach((r,i)=>{Fw(this,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>uy(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}let hy=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=g.lG2({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),Rp=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({}),n})();const gy=new g.OlP("NgModelWithFormControlWarning"),my={provide:wr,useExisting:(0,g.Gpc)(()=>Ud)};let Ud=(()=>{class n extends wr{constructor(t,r){super(),this.validators=t,this.asyncValidators=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new g.vpe,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(kl(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const r=this.form.get(t.path);return Dp(r,t),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Es(t.control||null,t,!1),fa(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,function mu(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const r=t.control,i=this.form.get(t.path);r!==i&&(Es(r||null,t),xp(i)&&(Dp(i,t),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const r=this.form.get(t.path);(function ty(n,e){Tp(n,e)})(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const r=this.form.get(t.path);r&&function BT(n,e){return kl(n,e)}(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Tp(this.form,this),this._oldForm&&kl(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(Pr,10),g.Y36(hr,10))},n.\u0275dir=g.lG2({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,r){1&t&&g.NdJ("submit",function(a){return r.onSubmit(a)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[g._Bn([my]),g.qOj,g.TTD]}),n})();const vy={provide:qs,useExisting:(0,g.Gpc)(()=>Bd)};let Bd=(()=>{class n extends qs{constructor(t,r,i,a,l){super(),this._ngModelWarningConfig=l,this._added=!1,this.update=new g.vpe,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function kd(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(a=>{a.constructor===Ad?t=a:function Pd(n){return Object.getPrototypeOf(n.constructor)===gu}(a)?r=a:i=a}),i||r||t||null}(0,a)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),function ry(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return function X_(n,e){return[...e.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(g.Y36(wr,13),g.Y36(Pr,10),g.Y36(hr,10),g.Y36(Gs,10),g.Y36(gy,8))},n.\u0275dir=g.lG2({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[g._Bn([vy]),g.qOj,g.TTD]}),n})(),Jw=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[[Rp]]}),n})(),nA=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[Jw]}),n})(),Xw=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:gy,useValue:t.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[Jw]}),n})(),ws=(()=>{class n{group(t,r=null){const i=this._reduceControls(t);let h,a=null,l=null;return null!=r&&(function rA(n){return void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn}(r)?(a=null!=r.validators?r.validators:null,l=null!=r.asyncValidators?r.asyncValidators:null,h=null!=r.updateOn?r.updateOn:void 0):(a=null!=r.validator?r.validator:null,l=null!=r.asyncValidator?r.asyncValidator:null)),new Mp(i,{asyncValidators:l,updateOn:h,validators:a})}control(t,r,i){return new ly(t,r,i)}array(t,r,i){const a=t.map(l=>this._createControl(l));return new $T(a,r,i)}_reduceControls(t){const r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){return xp(t)||Vd(t)||Ow(t)?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:Xw}),n})();class tI extends id.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const Hd={setInterval(n,e,...t){const{delegate:r}=Hd;return(null==r?void 0:r.setInterval)?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=Hd;return((null==e?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0};var nI=F(8737);class My extends tI{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;const i=this.id,a=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(a,i,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(a,this.id,t),this}requestAsyncId(e,t,r=0){return Hd.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&Hd.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,r=!1;try{this.work(e)}catch(a){r=!0,i=a||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,nI.P)(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const Ry={now:()=>(Ry.delegate||Date).now(),delegate:void 0};class Wd{constructor(e,t=Wd.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}}Wd.now=Ry.now;class rI extends Wd{constructor(e,t=Wd.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}const iI=new rI(My);var bt=F(9681);(0,bt.registerVersion)("firebase","9.12.1","app");var W=F(2090),Is=F(4859),Wi=F(1877),ga=F(8766);const oI="@firebase/installations",Op="0.5.15",oA=`w:${Op}`,Gi="FIS_v2",bo=new W.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function aA(n){return n instanceof W.ZR&&n.code.includes("request-failed")}function Fp({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function Lp(n){return{token:n.token,requestStatus:2,expiresIn:uA(n.expiresIn),creationTime:Date.now()}}function Py(n,e){return Gd.apply(this,arguments)}function Gd(){return(Gd=(0,K.Z)(function*(n,e){const r=(yield e.json()).error;return bo.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})})).apply(this,arguments)}function cI({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function dI(n,{refreshToken:e}){const t=cI(n);return t.append("Authorization",function lA(n){return`${Gi} ${n}`}(e)),t}function ky(n){return Oy.apply(this,arguments)}function Oy(){return(Oy=(0,K.Z)(function*(n){const e=yield n();return e.status>=500&&e.status<600?n():e})).apply(this,arguments)}function uA(n){return Number(n.replace("s","000"))}function Vp(n,e){return ma.apply(this,arguments)}function ma(){return(ma=(0,K.Z)(function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=Fp(n),i=cI(n),a=e.getImmediate({optional:!0});if(a){const v=yield a.getHeartbeatsHeader();v&&i.append("x-firebase-client",v)}const h={method:"POST",headers:i,body:JSON.stringify({fid:t,authVersion:Gi,appId:n.appId,sdkVersion:oA})},m=yield ky(()=>fetch(r,h));if(m.ok){const v=yield m.json();return{fid:v.fid||t,registrationStatus:2,refreshToken:v.refreshToken,authToken:Lp(v.authToken)}}throw yield Py("Create Installation",m)})).apply(this,arguments)}function hI(n){return new Promise(e=>{setTimeout(e,n)})}const cA=/^[cdef][\w-]{21}$/;function Ly(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=function Ks(n){return function zd(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return cA.test(t)?t:""}catch(n){return""}}function Zs(n){return`${n.appName}!${n.appId}`}const jn=new Map;function _a(n,e){const t=Zs(n);Bp(t,e),function Bl(n,e){const t=function vu(){return!qi&&"BroadcastChannel"in self&&(qi=new BroadcastChannel("[Firebase] FID Change"),qi.onmessage=n=>{Bp(n.data.key,n.data.fid)}),qi}();t&&t.postMessage({key:n,fid:e}),function Eu(){0===jn.size&&qi&&(qi.close(),qi=null)}()}(t,e)}function Bp(n,e){const t=jn.get(n);if(t)for(const r of t)r(e)}let qi=null;const Ki="firebase-installations-store";let ya=null;function va(){return ya||(ya=(0,ga.X3)("firebase-installations-database",1,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Ki)}})),ya}function qd(n,e){return jp.apply(this,arguments)}function jp(){return(jp=(0,K.Z)(function*(n,e){const t=Zs(n),i=(yield va()).transaction(Ki,"readwrite"),a=i.objectStore(Ki),l=yield a.get(t);return yield a.put(e,t),yield i.done,(!l||l.fid!==e.fid)&&_a(n,e.fid),e})).apply(this,arguments)}function $p(n){return Hp.apply(this,arguments)}function Hp(){return(Hp=(0,K.Z)(function*(n){const e=Zs(n),r=(yield va()).transaction(Ki,"readwrite");yield r.objectStore(Ki).delete(e),yield r.done})).apply(this,arguments)}function Hl(n,e){return Wp.apply(this,arguments)}function Wp(){return(Wp=(0,K.Z)(function*(n,e){const t=Zs(n),i=(yield va()).transaction(Ki,"readwrite"),a=i.objectStore(Ki),l=yield a.get(t),h=e(l);return void 0===h?yield a.delete(t):yield a.put(h,t),yield i.done,h&&(!l||l.fid!==h.fid)&&_a(n,h.fid),h})).apply(this,arguments)}function Gp(n){return zp.apply(this,arguments)}function zp(){return(zp=(0,K.Z)(function*(n){let e;const t=yield Hl(n.appConfig,r=>{const i=fI(r),a=dA(n,i);return e=a.registrationPromise,a.installationEntry});return""===t.fid?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}})).apply(this,arguments)}function fI(n){return mI(n||{fid:Ly(),registrationStatus:0})}function dA(n,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(bo.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=function pI(n,e){return Vy.apply(this,arguments)}(n,t);return{installationEntry:t,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:hA(n)}:{installationEntry:e}}function Vy(){return(Vy=(0,K.Z)(function*(n,e){try{const t=yield Vp(n,e);return qd(n.appConfig,t)}catch(t){throw aA(t)&&409===t.customData.serverCode?yield $p(n.appConfig):yield qd(n.appConfig,{fid:e.fid,registrationStatus:0}),t}})).apply(this,arguments)}function hA(n){return qp.apply(this,arguments)}function qp(){return(qp=(0,K.Z)(function*(n){let e=yield gI(n.appConfig);for(;1===e.registrationStatus;)yield hI(100),e=yield gI(n.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:r}=yield Gp(n);return r||t}return e})).apply(this,arguments)}function gI(n){return Hl(n,e=>{if(!e)throw bo.create("installation-not-found");return mI(e)})}function mI(n){return function _I(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function fA(n,e){return Kp.apply(this,arguments)}function Kp(){return(Kp=(0,K.Z)(function*({appConfig:n,heartbeatServiceProvider:e},t){const r=pA(n,t),i=dI(n,t),a=e.getImmediate({optional:!0});if(a){const v=yield a.getHeartbeatsHeader();v&&i.append("x-firebase-client",v)}const h={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:oA,appId:n.appId}})},m=yield ky(()=>fetch(r,h));if(m.ok)return Lp(yield m.json());throw yield Py("Generate Auth Token",m)})).apply(this,arguments)}function pA(n,{fid:e}){return`${Fp(n)}/${e}/authTokens:generate`}function Uy(n){return yI.apply(this,arguments)}function yI(){return(yI=(0,K.Z)(function*(n,e=!1){let t;const r=yield Hl(n.appConfig,a=>{if(!_A(a))throw bo.create("not-registered");const l=a.authToken;if(!e&&vP(l))return a;if(1===l.requestStatus)return t=gA(n,e),a;{if(!navigator.onLine)throw bo.create("app-offline");const h=EI(a);return t=mA(n,h),h}});return t?yield t:r.authToken})).apply(this,arguments)}function gA(n,e){return Kd.apply(this,arguments)}function Kd(){return(Kd=(0,K.Z)(function*(n,e){let t=yield Zp(n.appConfig);for(;1===t.authToken.requestStatus;)yield hI(100),t=yield Zp(n.appConfig);const r=t.authToken;return 0===r.requestStatus?Uy(n,e):r})).apply(this,arguments)}function Zp(n){return Hl(n,e=>{if(!_A(e))throw bo.create("not-registered");return function EP(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function mA(n,e){return vI.apply(this,arguments)}function vI(){return(vI=(0,K.Z)(function*(n,e){try{const t=yield fA(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return yield qd(n.appConfig,r),t}catch(t){if(!aA(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield qd(n.appConfig,r)}else yield $p(n.appConfig);throw t}})).apply(this,arguments)}function _A(n){return void 0!==n&&2===n.registrationStatus}function vP(n){return 2===n.requestStatus&&!function yA(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+36e5}(n)}function EI(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function Ea(){return(Ea=(0,K.Z)(function*(n){const e=n,{installationEntry:t,registrationPromise:r}=yield Gp(e);return r?r.catch(console.error):Uy(e).catch(console.error),t.fid})).apply(this,arguments)}function Yp(){return(Yp=(0,K.Z)(function*(n,e=!1){const t=n;return yield wA(t),(yield Uy(t,e)).token})).apply(this,arguments)}function wA(n){return Qp.apply(this,arguments)}function Qp(){return(Qp=(0,K.Z)(function*(n){const{registrationPromise:e}=yield Gp(n);e&&(yield e)})).apply(this,arguments)}function Xp(n){return bo.create("missing-app-config-values",{valueName:n})}const II="installations",bI=n=>{const e=n.getProvider("app").getImmediate(),t=function IA(n){if(!n||!n.options)throw Xp("App Configuration");if(!n.name)throw Xp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Xp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:(0,bt._getProvider)(e,"heartbeat"),_delete:()=>Promise.resolve()}},$y=n=>{const e=n.getProvider("app").getImmediate(),t=(0,bt._getProvider)(e,II).getImmediate();return{getId:()=>function vA(n){return Ea.apply(this,arguments)}(t),getToken:i=>function EA(n){return Yp.apply(this,arguments)}(t,i)}};(function bP(){(0,bt._registerComponent)(new Is.wA(II,bI,"PUBLIC")),(0,bt._registerComponent)(new Is.wA("installations-internal",$y,"PRIVATE"))})(),(0,bt.registerVersion)(oI,Op),(0,bt.registerVersion)(oI,Op,"esm2017");const Zd="@firebase/remote-config",kr=new W.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Gy{constructor(e,t,r,i){this.client=e,this.storage=t,this.storageCache=r,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-t,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){var t=this;return(0,K.Z)(function*(){const[r,i]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(i&&t.isCachedDataFresh(e.cacheMaxAgeMillis,r))return i;e.eTag=i&&i.eTag;const a=yield t.client.fetch(e),l=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===a.status&&l.push(t.storage.setLastSuccessfulFetchResponse(a)),yield Promise.all(l),a})()}}function NI(n=navigator){return n.languages&&n.languages[0]||n.language}class SA{constructor(e,t,r,i,a,l){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=l}fetch(e){var t=this;return(0,K.Z)(function*(){var r,i,a;const[l,h]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),v=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,b={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},D={sdk_version:t.sdkVersion,app_instance_id:l,app_instance_id_token:h,app_id:t.appId,language_code:NI()},x={method:"POST",headers:b,body:JSON.stringify(D)},P=fetch(v,x),G=new Promise((ut,ft)=>{e.signal.addEventListener(()=>{const At=new Error("The operation was aborted.");At.name="AbortError",ft(At)})});let ue;try{yield Promise.race([P,G]),ue=yield P}catch(ut){let ft="fetch-client-network";throw"AbortError"===(null===(r=ut)||void 0===r?void 0:r.name)&&(ft="fetch-timeout"),kr.create(ft,{originalErrorMessage:null===(i=ut)||void 0===i?void 0:i.message})}let Ee=ue.status;const at=ue.headers.get("ETag")||void 0;let dt,ht;if(200===ue.status){let ut;try{ut=yield ue.json()}catch(ft){throw kr.create("fetch-client-parse",{originalErrorMessage:null===(a=ft)||void 0===a?void 0:a.message})}dt=ut.entries,ht=ut.state}if("INSTANCE_STATE_UNSPECIFIED"===ht?Ee=500:"NO_CHANGE"===ht?Ee=304:("NO_TEMPLATE"===ht||"EMPTY_CONFIG"===ht)&&(dt={}),304!==Ee&&200!==Ee)throw kr.create("fetch-status",{httpStatus:Ee});return{status:Ee,eTag:at,config:dt}})()}}class PI{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return(0,K.Z)(function*(){const r=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,r)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:r}){var i=this;return(0,K.Z)(function*(){yield function xA(n,e){return new Promise((t,r)=>{const i=Math.max(e-Date.now(),0),a=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(a),r(kr.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const a=yield i.client.fetch(e);return yield i.storage.deleteThrottleMetadata(),a}catch(a){if(!function MA(n){if(!(n instanceof W.ZR&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(a))throw a;const l={throttleEndTimeMillis:Date.now()+(0,W.$s)(r),backoffCount:r+1};return yield i.storage.setThrottleMetadata(l),i.attemptFetch(e,l)}})()}}class OI{constructor(e,t,r,i,a){this.app=e,this._client=t,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Jd(n,e){var t;const r=n.target.error||void 0;return kr.create(e,{originalErrorMessage:r&&(null===(t=r)||void 0===t?void 0:t.message)})}const wa="app_namespace_store";class UI{constructor(e,t,r,i=function VI(){return new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=i=>{e(Jd(i,"storage-open"))},r.onsuccess=i=>{n(i.target.result)},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(wa,{keyPath:"compositeKey"})}}catch(r){e(kr.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}})}()){this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return(0,K.Z)(function*(){const r=yield t.openDbPromise;return new Promise((i,a)=>{var l;const m=r.transaction([wa],"readonly").objectStore(wa),v=t.createCompositeKey(e);try{const b=m.get(v);b.onerror=D=>{a(Jd(D,"storage-get"))},b.onsuccess=D=>{const x=D.target.result;i(x?x.value:void 0)}}catch(b){a(kr.create("storage-get",{originalErrorMessage:null===(l=b)||void 0===l?void 0:l.message}))}})})()}set(e,t){var r=this;return(0,K.Z)(function*(){const i=yield r.openDbPromise;return new Promise((a,l)=>{var h;const v=i.transaction([wa],"readwrite").objectStore(wa),b=r.createCompositeKey(e);try{const D=v.put({compositeKey:b,value:t});D.onerror=x=>{l(Jd(x,"storage-set"))},D.onsuccess=()=>{a()}}catch(D){l(kr.create("storage-set",{originalErrorMessage:null===(h=D)||void 0===h?void 0:h.message}))}})})()}delete(e){var t=this;return(0,K.Z)(function*(){const r=yield t.openDbPromise;return new Promise((i,a)=>{var l;const m=r.transaction([wa],"readwrite").objectStore(wa),v=t.createCompositeKey(e);try{const b=m.delete(v);b.onerror=D=>{a(Jd(D,"storage-delete"))},b.onsuccess=()=>{i()}}catch(b){a(kr.create("storage-delete",{originalErrorMessage:null===(l=b)||void 0===l?void 0:l.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class AP{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return(0,K.Z)(function*(){const t=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),a=yield t;a&&(e.lastFetchStatus=a);const l=yield r;l&&(e.lastSuccessfulFetchTimestampMillis=l);const h=yield i;h&&(e.activeConfig=h)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function NA(){return $n.apply(this,arguments)}function $n(){return($n=(0,K.Z)(function*(){if(!(0,W.hl)())return!1;try{return yield(0,W.eu)()}catch(n){return!1}})).apply(this,arguments)}!function RA(){(0,bt._registerComponent)(new Is.wA("remote-config",function n(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw kr.create("registration-window");if(!(0,W.hl)())throw kr.create("indexed-db-unavailable");const{projectId:a,apiKey:l,appId:h}=r.options;if(!a)throw kr.create("registration-project-id");if(!l)throw kr.create("registration-api-key");if(!h)throw kr.create("registration-app-id");const m=new UI(h,r.name,t=t||"firebase"),v=new AP(m),b=new Wi.Yd(Zd);b.logLevel=Wi.in.ERROR;const D=new SA(i,bt.SDK_VERSION,t,a,l,h),x=new PI(D,m),P=new Gy(x,m,v,b),G=new OI(r,P,v,m,b);return function SI(n){const e=(0,W.m9)(n);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(G),G},"PUBLIC").setMultipleInstances(!0)),(0,bt.registerVersion)(Zd,"0.3.14"),(0,bt.registerVersion)(Zd,"0.3.14","esm2017")}();const BI="/firebase-messaging-sw.js",PA="/firebase-cloud-messaging-push-scope",jI="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",HI="google.c.a.c_id",WI="google.c.a.c_l",GI="google.c.a.ts",zl="google.c.a.e";var ql=(()=>{return(n=ql||(ql={})).PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",ql;var n})();function Ys(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function kA(n){const t=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),i=new Uint8Array(r.length);for(let a=0;a<r.length;++a)i[a]=r.charCodeAt(a);return i}const ig="fcm_token_details_db",qy="fcm_token_object_Store";function Ky(n){return Zi.apply(this,arguments)}function Zi(){return Zi=(0,K.Z)(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(a=>a.name).includes(ig))return null;let e=null;return(yield(0,ga.X3)(ig,5,{upgrade:(r=(0,K.Z)(function*(i,a,l,h){var m;if(a<2||!i.objectStoreNames.contains(qy))return;const v=h.objectStore(qy),b=yield v.index("fcmSenderId").get(n);if(yield v.clear(),b)if(2===a){const D=b;if(!D.auth||!D.p256dh||!D.endpoint)return;e={token:D.fcmToken,createTime:null!==(m=D.createTime)&&void 0!==m?m:Date.now(),subscriptionOptions:{auth:D.auth,p256dh:D.p256dh,endpoint:D.endpoint,swScope:D.swScope,vapidKey:"string"==typeof D.vapidKey?D.vapidKey:Ys(D.vapidKey)}}}else if(3===a){const D=b;e={token:D.fcmToken,createTime:D.createTime,subscriptionOptions:{auth:Ys(D.auth),p256dh:Ys(D.p256dh),endpoint:D.endpoint,swScope:D.swScope,vapidKey:Ys(D.vapidKey)}}}else if(4===a){const D=b;e={token:D.fcmToken,createTime:D.createTime,subscriptionOptions:{auth:Ys(D.auth),p256dh:Ys(D.p256dh),endpoint:D.endpoint,swScope:D.swScope,vapidKey:Ys(D.vapidKey)}}}}),function(a,l,h,m){return r.apply(this,arguments)})})).close(),yield(0,ga.Lj)(ig),yield(0,ga.Lj)("fcm_vapid_details_db"),yield(0,ga.Lj)("undefined"),OA(e)?e:null;var r}),Zi.apply(this,arguments)}function OA(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}const Ir="firebase-messaging-store";let xi=null;function sg(){return xi||(xi=(0,ga.X3)("firebase-messaging-database",1,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Ir)}})),xi}function Zy(n){return Yy.apply(this,arguments)}function Yy(){return(Yy=(0,K.Z)(function*(n){const e=wu(n),r=yield(yield sg()).transaction(Ir).objectStore(Ir).get(e);if(r)return r;{const i=yield Ky(n.appConfig.senderId);if(i)return yield Qy(n,i),i}})).apply(this,arguments)}function Qy(n,e){return Jy.apply(this,arguments)}function Jy(){return(Jy=(0,K.Z)(function*(n,e){const t=wu(n),i=(yield sg()).transaction(Ir,"readwrite");return yield i.objectStore(Ir).put(e,t),yield i.done,e})).apply(this,arguments)}function LA(n){return Xd.apply(this,arguments)}function Xd(){return(Xd=(0,K.Z)(function*(n){const e=wu(n),r=(yield sg()).transaction(Ir,"readwrite");yield r.objectStore(Ir).delete(e),yield r.done})).apply(this,arguments)}function wu({appConfig:n}){return n.appId}const fr=new W.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function UA(n,e){return og.apply(this,arguments)}function og(){return(og=(0,K.Z)(function*(n,e){var t;const r=yield lg(n),i=Xy(e),a={method:"POST",headers:r,body:JSON.stringify(i)};let l;try{l=yield(yield fetch(ug(n.appConfig),a)).json()}catch(h){throw fr.create("token-subscribe-failed",{errorInfo:null===(t=h)||void 0===t?void 0:t.toString()})}if(l.error)throw fr.create("token-subscribe-failed",{errorInfo:l.error.message});if(!l.token)throw fr.create("token-subscribe-no-token");return l.token})).apply(this,arguments)}function zI(n,e){return Kl.apply(this,arguments)}function Kl(){return(Kl=(0,K.Z)(function*(n,e){var t;const r=yield lg(n),i=Xy(e.subscriptionOptions),a={method:"PATCH",headers:r,body:JSON.stringify(i)};let l;try{l=yield(yield fetch(`${ug(n.appConfig)}/${e.token}`,a)).json()}catch(h){throw fr.create("token-update-failed",{errorInfo:null===(t=h)||void 0===t?void 0:t.toString()})}if(l.error)throw fr.create("token-update-failed",{errorInfo:l.error.message});if(!l.token)throw fr.create("token-update-no-token");return l.token})).apply(this,arguments)}function qI(n,e){return ag.apply(this,arguments)}function ag(){return(ag=(0,K.Z)(function*(n,e){var t;const i={method:"DELETE",headers:yield lg(n)};try{const l=yield(yield fetch(`${ug(n.appConfig)}/${e}`,i)).json();if(l.error)throw fr.create("token-unsubscribe-failed",{errorInfo:l.error.message})}catch(a){throw fr.create("token-unsubscribe-failed",{errorInfo:null===(t=a)||void 0===t?void 0:t.toString()})}})).apply(this,arguments)}function ug({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function lg(n){return Zl.apply(this,arguments)}function Zl(){return(Zl=(0,K.Z)(function*({appConfig:n,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})})).apply(this,arguments)}function Xy({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const i={web:{endpoint:t,auth:e,p256dh:n}};return r!==jI&&(i.web.applicationPubKey=r),i}const KI=6048e5;function ZI(n){return cg.apply(this,arguments)}function cg(){return(cg=(0,K.Z)(function*(n){const e=yield BA(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Ys(e.getKey("auth")),p256dh:Ys(e.getKey("p256dh"))},r=yield Zy(n.firebaseDependencies);if(r){if(jA(r.subscriptionOptions,t))return Date.now()>=r.createTime+KI?YI(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{yield qI(n.firebaseDependencies,r.token)}catch(i){console.warn(i)}return QI(n.firebaseDependencies,t)}return QI(n.firebaseDependencies,t)})).apply(this,arguments)}function ev(n){return dg.apply(this,arguments)}function dg(){return(dg=(0,K.Z)(function*(n){const e=yield Zy(n.firebaseDependencies);e&&(yield qI(n.firebaseDependencies,e.token),yield LA(n.firebaseDependencies));const t=yield n.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()})).apply(this,arguments)}function YI(n,e){return hg.apply(this,arguments)}function hg(){return(hg=(0,K.Z)(function*(n,e){try{const t=yield zI(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield Qy(n.firebaseDependencies,r),t}catch(t){throw yield ev(n),t}})).apply(this,arguments)}function QI(n,e){return tv.apply(this,arguments)}function tv(){return(tv=(0,K.Z)(function*(n,e){const r={token:yield UA(n,e),createTime:Date.now(),subscriptionOptions:e};return yield Qy(n,r),r.token})).apply(this,arguments)}function BA(n,e){return nv.apply(this,arguments)}function nv(){return(nv=(0,K.Z)(function*(n,e){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:kA(e)})})).apply(this,arguments)}function jA(n,e){return e.vapidKey===n.vapidKey&&e.endpoint===n.endpoint&&e.auth===n.auth&&e.p256dh===n.p256dh}function JI(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function $A(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const i=e.notification.image;i&&(n.notification.image=i)}(e,n),function HA(n,e){!e.data||(n.data=e.data)}(e,n),function WA(n,e){var t,r,i,a,l;if(!e.fcmOptions&&!(null===(t=e.notification)||void 0===t?void 0:t.click_action))return;n.fcmOptions={};const h=null!==(i=null===(r=e.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=e.notification)||void 0===a?void 0:a.click_action;h&&(n.fcmOptions.link=h);const m=null===(l=e.fcmOptions)||void 0===l?void 0:l.analytics_label;m&&(n.fcmOptions.analyticsLabel=m)}(e,n),e}function GA(n){return"object"==typeof n&&!!n&&HI in n}function XI(n,e){const t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}function rv(n){return fr.create("missing-app-config-values",{valueName:n})}XI("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),XI("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class qA{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function zA(n){if(!n||!n.options)throw rv("App Configuration Object");if(!n.name)throw rv("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw rv(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}function eC(n){return iv.apply(this,arguments)}function iv(){return(iv=(0,K.Z)(function*(n){var e;try{n.swRegistration=yield navigator.serviceWorker.register(BI,{scope:PA}),n.swRegistration.update().catch(()=>{})}catch(t){throw fr.create("failed-service-worker-registration",{browserErrorMessage:null===(e=t)||void 0===e?void 0:e.message})}})).apply(this,arguments)}function KA(n,e){return sv.apply(this,arguments)}function sv(){return(sv=(0,K.Z)(function*(n,e){if(!e&&!n.swRegistration&&(yield eC(n)),e||!n.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw fr.create("invalid-sw-registration");n.swRegistration=e}})).apply(this,arguments)}function tC(n,e){return fg.apply(this,arguments)}function fg(){return(fg=(0,K.Z)(function*(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=jI)})).apply(this,arguments)}function pg(){return(pg=(0,K.Z)(function*(n,e){if(!navigator)throw fr.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw fr.create("permission-blocked");return yield tC(n,null==e?void 0:e.vapidKey),yield KA(n,null==e?void 0:e.serviceWorkerRegistration),ZI(n)})).apply(this,arguments)}function nC(n,e,t){return gg.apply(this,arguments)}function gg(){return(gg=(0,K.Z)(function*(n,e,t){const r=rC(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[HI],message_name:t[WI],message_time:t[GI],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function rC(n){switch(n){case ql.NOTIFICATION_CLICKED:return"notification_open";case ql.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function mg(){return(mg=(0,K.Z)(function*(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===ql.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(JI(t)):n.onMessageHandler.next(JI(t)));const r=t.data;GA(r)&&"1"===r[zl]&&(yield nC(n,t.messageType,r))})).apply(this,arguments)}const av="@firebase/messaging",Iu=n=>{const e=new qA(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function iC(n,e){return mg.apply(this,arguments)}(e,t)),e},ZA=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>function ov(n,e){return pg.apply(this,arguments)}(e,r)}};function Cu(){return sC.apply(this,arguments)}function sC(){return(sC=(0,K.Z)(function*(){try{yield(0,W.eu)()}catch(n){return!1}return"undefined"!=typeof window&&(0,W.hl)()&&(0,W.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function YA(){(0,bt._registerComponent)(new Is.wA("messaging",Iu,"PUBLIC")),(0,bt._registerComponent)(new Is.wA("messaging-internal",ZA,"PRIVATE")),(0,bt.registerVersion)(av,"0.9.19"),(0,bt.registerVersion)(av,"0.9.19","esm2017")}();const _g="analytics",yg="firebase_id",Eg="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Sn="https://www.googletagmanager.com/gtag/js",Or=new Wi.Yd("@firebase/analytics");function cv(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function XA(n,e){const t=document.createElement("script");t.src=`${Sn}?l=${n}&id=${e}`,t.async=!0,document.head.appendChild(t)}function uC(n,e,t,r,i,a){return wg.apply(this,arguments)}function wg(){return(wg=(0,K.Z)(function*(n,e,t,r,i,a){const l=r[i];try{if(l)yield e[l];else{const m=(yield cv(t)).find(v=>v.measurementId===i);m&&(yield e[m.appId])}}catch(h){Or.error(h)}n("config",i,a)})).apply(this,arguments)}function lC(n,e,t,r,i){return Ig.apply(this,arguments)}function Ig(){return(Ig=(0,K.Z)(function*(n,e,t,r,i){try{let a=[];if(i&&i.send_to){let l=i.send_to;Array.isArray(l)||(l=[l]);const h=yield cv(t);for(const m of l){const v=h.find(D=>D.measurementId===m),b=v&&e[v.appId];if(!b){a=[];break}a.push(b)}}0===a.length&&(a=Object.values(e)),yield Promise.all(a),n("event",r,i||{})}catch(a){Or.error(a)}})).apply(this,arguments)}function rS(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Sn)&&t.src.includes(n))return t;return null}const Mi=new W.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),dv=new class Cg{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function cC(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function dC(n){return hv.apply(this,arguments)}function hv(){return(hv=(0,K.Z)(function*(n){var e;const{appId:t,apiKey:r}=n,i={method:"GET",headers:cC(r)},a=Eg.replace("{app-id}",t),l=yield fetch(a,i);if(200!==l.status&&304!==l.status){let h="";try{const m=yield l.json();(null===(e=m.error)||void 0===e?void 0:e.message)&&(h=m.error.message)}catch(m){}throw Mi.create("config-fetch-failed",{httpStatus:l.status,responseMessage:h})}return l.json()})).apply(this,arguments)}function th(n){return bu.apply(this,arguments)}function bu(){return(bu=(0,K.Z)(function*(n,e=dv,t){const{appId:r,apiKey:i,measurementId:a}=n.options;if(!r)throw Mi.create("no-app-id");if(!i){if(a)return{measurementId:a,appId:r};throw Mi.create("no-api-key")}const l=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new pC;return setTimeout((0,K.Z)(function*(){h.abort()}),void 0!==t?t:6e4),hC({appId:r,apiKey:i,measurementId:a},l,h,e)})).apply(this,arguments)}function hC(n,e,t){return fv.apply(this,arguments)}function fv(){return(fv=(0,K.Z)(function*(n,{throttleEndTimeMillis:e,backoffCount:t},r,i=dv){var a,l;const{appId:h,measurementId:m}=n;try{yield oS(r,e)}catch(v){if(m)return Or.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${null===(a=v)||void 0===a?void 0:a.message}]`),{appId:h,measurementId:m};throw v}try{const v=yield dC(n);return i.deleteThrottleMetadata(h),v}catch(v){const b=v;if(!fC(b)){if(i.deleteThrottleMetadata(h),m)return Or.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${null==b?void 0:b.message}]`),{appId:h,measurementId:m};throw v}const D=503===Number(null===(l=null==b?void 0:b.customData)||void 0===l?void 0:l.httpStatus)?(0,W.$s)(t,i.intervalMillis,30):(0,W.$s)(t,i.intervalMillis),x={throttleEndTimeMillis:Date.now()+D,backoffCount:t+1};return i.setThrottleMetadata(h,x),Or.debug(`Calling attemptFetch again in ${D} millis`),hC(n,x,r,i)}})).apply(this,arguments)}function oS(n,e){return new Promise((t,r)=>{const i=Math.max(e-Date.now(),0),a=setTimeout(t,i);n.addEventListener(()=>{clearTimeout(a),r(Mi.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function fC(n){if(!(n instanceof W.ZR&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}class pC{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let bg,gv;function Dg(){return(Dg=(0,K.Z)(function*(n,e,t,r,i){if(i&&i.global)n("event",t,r);else{const a=yield e;n("event",t,Object.assign(Object.assign({},r),{send_to:a}))}})).apply(this,arguments)}function yC(n){gv=n}function mv(n){bg=n}function nh(){return _v.apply(this,arguments)}function _v(){return(_v=(0,K.Z)(function*(){var n;if(!(0,W.hl)())return Or.warn(Mi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,W.eu)()}catch(e){return Or.warn(Mi.create("indexeddb-unavailable",{errorInfo:null===(n=e)||void 0===n?void 0:n.toString()}).message),!1}return!0})).apply(this,arguments)}function yv(){return(yv=(0,K.Z)(function*(n,e,t,r,i,a,l){var h;const m=th(n);m.then(P=>{t[P.measurementId]=P.appId,n.options.measurementId&&P.measurementId!==n.options.measurementId&&Or.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${P.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(P=>Or.error(P)),e.push(m);const v=nh().then(P=>{if(P)return r.getId()}),[b,D]=yield Promise.all([m,v]);rS(a)||XA(a,b.measurementId),gv&&(i("consent","default",gv),yC(void 0)),i("js",new Date);const x=null!==(h=null==l?void 0:l.config)&&void 0!==h?h:{};return x.origin="firebase",x.update=!0,null!=D&&(x[yg]=D),i("config",b.measurementId,x),bg&&(i("set",bg),mv(void 0)),b.measurementId})).apply(this,arguments)}class cS{constructor(e){this.app=e}_delete(){return delete Do[this.app.options.appId],Promise.resolve()}}let Do={},vv=[];const vC={};let EC,Js,Tg="dataLayer",Ev=!1;function wC(n,e,t){!function hS(){const n=[];if((0,W.ru)()&&n.push("This is a browser extension environment."),(0,W.zI)()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,i)=>`(${i+1}) ${r}`).join(" "),t=Mi.create("invalid-analytics-context",{errorInfo:e});Or.warn(t.message)}}();const r=n.options.appId;if(!r)throw Mi.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw Mi.create("no-api-key");Or.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Do[r])throw Mi.create("already-exists",{id:r});if(!Ev){!function eS(n){let e=[];Array.isArray(window[n])?e=window[n]:window[n]=e}(Tg);const{wrappedGtag:a,gtagCore:l}=function nS(n,e,t,r,i){let a=function(...l){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function tS(n,e,t,r){function a(){return(a=(0,K.Z)(function*(l,h,m){try{"event"===l?yield lC(n,e,t,h,m):"config"===l?yield uC(n,e,t,r,h,m):"consent"===l?n("consent","update",m):n("set",h)}catch(v){Or.error(v)}})).apply(this,arguments)}return function i(l,h,m){return a.apply(this,arguments)}}(a,n,e,t),{gtagCore:a,wrappedGtag:window[i]}}(Do,vv,vC,Tg,"gtag");Js=a,EC=l,Ev=!0}return Do[r]=function lS(n,e,t,r,i,a,l){return yv.apply(this,arguments)}(n,vv,vC,e,EC,Tg,t),new cS(n)}function fS(){return Ag.apply(this,arguments)}function Ag(){return(Ag=(0,K.Z)(function*(){if((0,W.ru)()||!(0,W.zI)()||!(0,W.hl)())return!1;try{return yield(0,W.eu)()}catch(n){return!1}})).apply(this,arguments)}const CC="@firebase/analytics";!function _S(){(0,bt._registerComponent)(new Is.wA(_g,(e,{options:t})=>wC(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),(0,bt._registerComponent)(new Is.wA("analytics-internal",function n(e){try{const t=e.getProvider(_g).getImmediate();return{logEvent:(r,i,a)=>function gS(n,e,t,r){n=(0,W.m9)(n),function aS(n,e,t,r,i){return Dg.apply(this,arguments)}(Js,Do[n.app.options.appId],e,t,r).catch(i=>Or.error(i))}(t,r,i,a)}}catch(t){throw Mi.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,bt.registerVersion)(CC,"0.8.3"),(0,bt.registerVersion)(CC,"0.8.3","esm2017")}();const ES=new class vS extends rI{}(class yS extends My{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}});var rh=F(9468),Tu=F(5363);const ih=new g.GfV("7.4.1"),Iv="__angularfire_symbol__analyticsIsSupportedValue",Cv="__angularfire_symbol__analyticsIsSupported",Sg="__angularfire_symbol__remoteConfigIsSupportedValue",bv="__angularfire_symbol__remoteConfigIsSupported",Dv="__angularfire_symbol__messagingIsSupportedValue",Tv="__angularfire_symbol__messagingIsSupported";function xg(n,e,t){if(e){if(1===e.length)return e[0];const a=e.filter(l=>l.app===t);if(1===a.length)return a[0]}return t.container.getProvider(n).getImmediate({optional:!0})}globalThis[Cv]||(globalThis[Cv]=fS().then(n=>globalThis[Iv]=n).catch(()=>globalThis[Iv]=!1)),globalThis[Tv]||(globalThis[Tv]=Cu().then(n=>globalThis[Dv]=n).catch(()=>globalThis[Dv]=!1)),globalThis[bv]||(globalThis[bv]=NA().then(n=>globalThis[Sg]=n).catch(()=>globalThis[Sg]=!1));const Mg=(n,e)=>{const t=e?[e]:(0,bt.getApps)(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(l=>{r.includes(l)||r.push(l)})}),r};function Ia(){}class AC{constructor(e,t=ES){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){const i=this.zone;return this.delegate.schedule(function(l){i.runGuarded(()=>{e.apply(this,[l])})},t,r)}}class SC{constructor(e){this.zone=e,this.task=null}call(e,t){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ia,{},Ia,Ia)),t.pipe(dr({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let oh=(()=>{class n{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new AC(Zone.current)),this.insideAngular=t.run(()=>new AC(Zone.current,iI)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(g.R0b))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ca(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function IS(n){return Ca().ngZone.runOutsideAngular(()=>n())}function ba(n){return Ca().ngZone.run(()=>n())}function Fr(n){return Ca(),function CS(n){return function(t){return(t=t.lift(new SC(n.ngZone))).pipe((0,rh.R)(n.outsideAngular),(0,Tu.Q)(n.insideAngular))}}(Ca())(n)}const Ql=(n,e)=>function(){const r=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),ba(()=>n.apply(void 0,r))},Au=(n,e)=>function(){let t;const r=arguments;for(let a=0;a<arguments.length;a++)"function"==typeof r[a]&&(e&&(t||(t=ba(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ia,{},Ia,Ia)))),r[a]=Ql(r[a],t));const i=IS(()=>n.apply(this,r));if(!e){if(i instanceof Jr.y){const a=Ca();return i.pipe((0,rh.R)(a.outsideAngular),(0,Tu.Q)(a.insideAngular))}return ba(()=>i)}return i instanceof Jr.y?i.pipe(Fr):i instanceof Promise?ba(()=>new Promise((a,l)=>i.then(h=>ba(()=>a(h)),h=>ba(()=>l(h))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:ba(()=>i)};function Av(){return(0,cr.e)((n,e)=>{let t,r=!1;n.subscribe((0,Un.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function xC(n,e){return n===e}var Xe,Cs=F(2011),bS=(F(5881),F(3942)),DS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Xs={},ah=ah||{},_t=DS||self;function Da(){}function Rg(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Jl(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Sv="closure_uid_"+(1e9*Math.random()>>>0),TS=0;function xv(n,e,t){return n.call.apply(n.bind,arguments)}function AS(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function ri(n,e,t){return(ri=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?xv:AS).apply(null,arguments)}function Ng(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Cr(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(r,i,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return e.prototype[i].apply(r,l)}}function Ri(){this.s=this.s,this.o=this.o}var Xl={};Ri.prototype.s=!1,Ri.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function MC(n){return Object.prototype.hasOwnProperty.call(n,Sv)&&n[Sv]||(n[Sv]=++TS)}(this);delete Xl[n]}},Ri.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const SS=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Pg(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function NC(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(Rg(r)){const i=n.length||0,a=r.length||0;n.length=i+a;for(let l=0;l<a;l++)n[i+l]=r[l]}else n.push(r)}}function ii(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}ii.prototype.h=function(){this.defaultPrevented=!0};var PC=function(){if(!_t.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{_t.addEventListener("test",Da,e),_t.removeEventListener("test",Da,e)}catch(t){}return n}();function Mv(n){return/^[\s\xa0]*$/.test(n)}var Rv=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function uh(n,e){return n<e?-1:n>e?1:0}function lh(){var n=_t.navigator;return n&&(n=n.userAgent)?n:""}function bs(n){return-1!=lh().indexOf(n)}function kg(n){return kg[" "](n),n}kg[" "]=Da;var ch,n,MS=bs("Opera"),Su=bs("Trident")||bs("MSIE"),kC=bs("Edge"),Nv=kC||Su,OC=bs("Gecko")&&!(-1!=lh().toLowerCase().indexOf("webkit")&&!bs("Edge"))&&!(bs("Trident")||bs("MSIE"))&&!bs("Edge"),RS=-1!=lh().toLowerCase().indexOf("webkit")&&!bs("Edge");function ec(){var n=_t.document;return n?n.documentMode:void 0}e:{var Og="",Fg=(n=lh(),OC?/rv:([^\);]+)(\)|;)/.exec(n):kC?/Edge\/([\d\.]+)/.exec(n):Su?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):RS?/WebKit\/(\S+)/.exec(n):MS?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Fg&&(Og=Fg?Fg[1]:""),Su){var Lg=ec();if(null!=Lg&&Lg>parseFloat(Og)){ch=String(Lg);break e}}ch=Og}var FC={};var NS=_t.document&&Su&&(ec()||parseInt(ch,10))||void 0;function dh(n,e){if(ii.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(OC){e:{try{kg(e.nodeName);var i=!0;break e}catch(a){}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:PS[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&dh.X.h.call(this)}}Cr(dh,ii);var PS={2:"touch",3:"pen",4:"mouse"};dh.prototype.h=function(){dh.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var hh="closure_listenable_"+(1e6*Math.random()|0),fh=0;function kS(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=i,this.key=++fh,this.ba=this.ea=!1}function tc(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function Yi(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function VC(n){const e={};for(const t in n)e[t]=n[t];return e}const Vg="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nc(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<Vg.length;a++)t=Vg[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Ug(n){this.src=n,this.g={},this.h=0}function Ov(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=SS(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(tc(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Fv(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ba&&a.listener==e&&a.capture==!!t&&a.ha==r)return i}return-1}Ug.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=Fv(n,e,r,i);return-1<l?(e=n[l],t||(e.ea=!1)):((e=new kS(e,this.src,a,!!r,i)).ea=t,n.push(e)),e};var rc="closure_lm_"+(1e6*Math.random()|0),ic={};function UC(n,e,t,r,i){if(r&&r.once)return Lv(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)UC(n,e[a],t,r,i);return null}return t=gh(t),n&&n[hh]?n.N(e,t,Jl(r)?!!r.capture:!!r,i):BC(n,e,t,!1,r,i)}function BC(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=Jl(i)?!!i.capture:!!i,h=HC(n);if(h||(n[rc]=h=new Ug(n)),(t=h.add(e,t,r,l,a)).proxy)return t;if(r=function jC(){const e=OS;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)PC||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent($C(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function Lv(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)Lv(n,e[a],t,r,i);return null}return t=gh(t),n&&n[hh]?n.O(e,t,Jl(r)?!!r.capture:!!r,i):BC(n,e,t,!0,r,i)}function Bg(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)Bg(n,e[a],t,r,i);else r=Jl(r)?!!r.capture:!!r,t=gh(t),n&&n[hh]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Fv(a=n.g[e],t,r,i))&&(tc(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=HC(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Fv(e,t,r,i)),(t=-1<n?e[n]:null)&&jg(t))}function jg(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[hh])Ov(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent($C(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=HC(e))?(Ov(t,n),0==t.h&&(t.src=null,e[rc]=null)):tc(n)}}}function $C(n){return n in ic?ic[n]:ic[n]="on"+n}function OS(n,e){if(n.ba)n=!0;else{e=new dh(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&jg(n),n=t.call(r,e)}return n}function HC(n){return(n=n[rc])instanceof Ug?n:null}var ph="__closure_events_fn_"+(1e9*Math.random()>>>0);function gh(n){return"function"==typeof n?n:(n[ph]||(n[ph]=function(e){return n.handleEvent(e)}),n[ph])}function rr(){Ri.call(this),this.i=new Ug(this),this.P=this,this.I=null}function ir(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new ii(e,n);else if(e instanceof ii)e.target=e.target||n;else{var i=e;nc(e=new ii(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=sc(l,r,!0,e)&&i}if(i=sc(l=e.g=n,r,!0,e)&&i,i=sc(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=sc(l=e.g=t[a],r,!1,e)&&i}function sc(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ba&&l.capture==t){var h=l.listener,m=l.ha||l.src;l.ea&&Ov(n.i,l),i=!1!==h.call(m,r)&&i}}return i&&!r.defaultPrevented}Cr(rr,Ri),rr.prototype[hh]=!0,rr.prototype.removeEventListener=function(n,e,t,r){Bg(this,n,e,t,r)},rr.prototype.M=function(){if(rr.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)tc(t[r]);delete n.g[e],n.h--}}this.I=null},rr.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},rr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Vv=_t.JSON.stringify;function FS(){var n=qC;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var jv,WC=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new GC,n=>n.reset());class GC{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Uv(n){_t.setTimeout(()=>{throw n},0)}function Bv(n,e){jv||function zC(){var n=_t.Promise.resolve(void 0);jv=function(){n.then(KC)}}(),$g||(jv(),$g=!0),qC.add(n,e)}var $g=!1,qC=new class LS{constructor(){this.h=this.g=null}add(e,t){const r=WC.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function KC(){for(var n;n=FS();){try{n.h.call(n.g)}catch(t){Uv(t)}var e=WC;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}$g=!1}function mh(n,e){rr.call(this),this.h=n||1,this.g=e||_t,this.j=ri(this.lb,this),this.l=Date.now()}function $v(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function Hg(n,e,t){if("function"==typeof n)t&&(n=ri(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=ri(n.handleEvent,n)}return 2147483647<Number(e)?-1:_t.setTimeout(n,e||0)}function ZC(n){n.g=Hg(()=>{n.g=null,n.i&&(n.i=!1,ZC(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Cr(mh,rr),(Xe=mh.prototype).ca=!1,Xe.R=null,Xe.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),ir(this,"tick"),this.ca&&($v(this),this.start()))}},Xe.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Xe.M=function(){mh.X.M.call(this),$v(this),delete this.g};class si extends Ri{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ZC(this)}M(){super.M(),this.g&&(_t.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eo(n){Ri.call(this),this.h=n,this.g={}}Cr(eo,Ri);var YC=[];function QC(n,e,t,r){Array.isArray(t)||(t&&(YC[0]=t.toString()),t=YC);for(var i=0;i<t.length;i++){var a=UC(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function VS(n){Yi(n.g,function(e,t){this.g.hasOwnProperty(t)&&jg(e)},n),n.g={}}function Ta(){this.g=!0}function oc(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function BS(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return Vv(t)}catch(h){return e}}(n,t)+(r?" "+r:"")})}eo.prototype.M=function(){eo.X.M.call(this),VS(this)},eo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ta.prototype.Aa=function(){this.g=!1},Ta.prototype.info=function(){};var xu={},Wg=null;function _h(){return Wg=Wg||new rr}function Wv(n){ii.call(this,xu.Pa,n)}function Aa(n){const e=_h();ir(e,new Wv(e,n))}function Gg(n,e){ii.call(this,xu.STAT_EVENT,n),this.stat=e}function _i(n){const e=_h();ir(e,new Gg(e,n))}function Gv(n,e){ii.call(this,xu.Qa,n),this.size=e}function yh(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return _t.setTimeout(function(){n()},e)}xu.Pa="serverreachability",Cr(Wv,ii),xu.STAT_EVENT="statevent",Cr(Gg,ii),xu.Qa="timingevent",Cr(Gv,ii);var vh={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},Eh={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function zg(){}function qg(){}zg.prototype.h=null;var qv,Mu={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function eb(){ii.call(this,"d")}function zv(){ii.call(this,"c")}function wh(){}function ac(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new eo(this),this.O=nb,this.T=new mh(n=Nv?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new tb}function tb(){this.i=null,this.g="",this.h=!1}Cr(eb,ii),Cr(zv,ii),Cr(wh,zg),wh.prototype.g=function(){return new XMLHttpRequest},wh.prototype.i=function(){return{}},qv=new wh;var nb=45e3,Kg={},Zg={};function Kv(n,e,t){n.K=1,n.v=dc(Sa(e)),n.s=t,n.P=!0,Zv(n,null)}function Zv(n,e){n.F=Date.now(),uc(n),n.A=Sa(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),GS(t.i,"t",r),n.C=0,t=n.l.H,n.h=new tb,n.g=nx(n.l,t?e:null,!n.s),0<n.N&&(n.L=new si(ri(n.La,n,n.g),n.N)),QC(n.S,n.g,"readystatechange",n.ib),e=n.H?VC(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Aa(1),function US(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),m=0;m<h.length;m++){var v=h[m].split("=");if(1<v.length){var b=v[0];v=v[1];var D=b.split("_");l=2<=D.length&&"type"==D[1]?l+(b+"=")+v+"&":l+(b+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.U,n.s)}function rb(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function Yv(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=ib(n,t),i==Zg){4==e&&(n.o=4,_i(14),r=!1),oc(n.j,n.m,null,"[Incomplete Response]");break}if(i==Kg){n.o=4,_i(15),oc(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}oc(n.j,n.m,i,null),Qg(n,i)}rb(n)&&i!=Zg&&i!=Kg&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,_i(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),wb(e),e.K=!0,_i(11))):(oc(n.j,n.m,t,"[Invalid Chunked Response]"),lc(n),Ih(n))}function ib(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Zg:(t=Number(e.substring(t,r)),isNaN(t)?Kg:(r+=1)+t>e.length?Zg:(e=e.substr(r,t),n.C=r+t,e))}function uc(n){n.V=Date.now()+n.O,Qv(n,n.O)}function Qv(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=yh(ri(n.gb,n),e)}function Yg(n){n.B&&(_t.clearTimeout(n.B),n.B=null)}function Ih(n){0==n.l.G||n.I||Ib(n.l,n)}function lc(n){Yg(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,$v(n.T),VS(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Qg(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Dh(t.h,n)))if(!n.J&&Dh(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch(v){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(t.u)t.Ba=i[1],0<t.Ba-t.T&&37500>i[2]&&t.L&&0==t.A&&!t.v&&(t.v=yh(ri(t.cb,t),6e3));else{if(t.g){if(!(t.g.F+3e3<n.F))break e;om(t),gc(t)}Eb(t),_i(18)}if(1>=lb(t.h)&&t.ja){try{t.ja()}catch(v){}t.ja=void 0}}else _c(t,11)}else if((n.J||t.g==n)&&om(t),!Mv(e))for(i=t.Fa.g.parse(e),e=0;e<i.length;e++){let v=i[e];if(t.T=v[0],v=v[1],2==t.G)if("c"==v[0]){t.I=v[1],t.ka=v[2];const b=v[3];null!=b&&(t.ma=b,t.j.info("VER="+t.ma));const D=v[4];null!=D&&(t.Ca=D,t.j.info("SVER="+t.Ca));const x=v[5];null!=x&&"number"==typeof x&&0<x&&(t.J=r=1.5*x,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const P=n.g;if(P){const G=P.g?P.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(G){var a=r.h;a.g||-1==G.indexOf("spdy")&&-1==G.indexOf("quic")&&-1==G.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(Xv(a,a.h),a.h=null))}if(r.D){const ue=P.g?P.g.getResponseHeader("X-HTTP-Session-Id"):null;ue&&(r.za=ue,mn(r.F,r.D,ue))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var l=n;if((r=t).sa=tx(r,r.H?r.ka:null,r.V),l.J){Qi(r.h,l);var h=l,m=r.J;m&&h.setTimeout(m),h.B&&(Yg(h),uc(h)),r.g=l}else vb(r);0<t.i.length&&Nh(t)}else"stop"!=v[0]&&"close"!=v[0]||_c(t,7);else 3==t.G&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?_c(t,7):im(t):"noop"!=v[0]&&t.l&&t.l.wa(v),t.A=0)}Aa(4)}catch(v){}}function jS(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Rg(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function WP(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if("undefined"!=typeof Map&&n instanceof Map)return Array.from(n.keys());if(!("undefined"!=typeof Set&&n instanceof Set)){if(Rg(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function HP(n){if(n.W&&"function"==typeof n.W)return n.W();if("undefined"!=typeof Map&&n instanceof Map||"undefined"!=typeof Set&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(Rg(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}(Xe=ac.prototype).setTimeout=function(n){this.O=n},Xe.ib=function(n){n=n.target;const e=this.L;e&&3==To(n)?e.l():this.La(n)},Xe.La=function(n){try{if(n==this.g)e:{const b=To(this.g);var e=this.g.Ea();const D=this.g.aa();if(!(3>b)&&(3!=b||Nv||this.g&&(this.h.h||this.g.fa()||JS(this.g)))){this.I||4!=b||7==e||Aa(8==e||0>=D?3:2),Yg(this);var t=this.g.aa();this.Y=t;t:if(rb(this)){var r=JS(this.g);n="";var i=r.length,a=4==To(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){lc(this),Ih(this);var l="";break t}this.h.i=new _t.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.fa();if(this.i=200==t,function Hv(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.U,b,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var h,m=this.g;if((h=m.g?m.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Mv(h)){var v=h;break t}}v=null}if(!(t=v)){this.i=!1,this.o=3,_i(12),lc(this),Ih(this);break e}oc(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Qg(this,t)}this.P?(Yv(this,b,l),Nv&&this.i&&3==b&&(QC(this.S,this.T,"tick",this.hb),this.T.start())):(oc(this.j,this.m,l,null),Qg(this,l)),4==b&&lc(this),this.i&&!this.I&&(4==b?Ib(this.l,this):(this.i=!1,uc(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,_i(12)):(this.o=0,_i(13)),lc(this),Ih(this)}}}catch(b){}},Xe.hb=function(){if(this.g){var n=To(this.g),e=this.g.fa();this.C<e.length&&(Yg(this),Yv(this,n,e),this.i&&4!=n&&uc(this))}},Xe.cancel=function(){this.I=!0,lc(this)},Xe.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function JC(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Aa(3),_i(17)),lc(this),this.o=2,Ih(this)):Qv(this,this.V-n)};var $S=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cc(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof cc){this.h=void 0!==e?e:n.h,Jv(this,n.j),this.s=n.s,this.g=n.g,Ru(this,n.m),this.l=n.l,e=n.i;var t=new Ch;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),HS(this,t),this.o=n.o}else n&&(t=String(n).match($S))?(this.h=!!e,Jv(this,t[1]||"",!0),this.s=hc(t[2]||""),this.g=hc(t[3]||"",!0),Ru(this,t[4]),this.l=hc(t[5]||"",!0),HS(this,t[6]||"",!0),this.o=hc(t[7]||"")):(this.h=!!e,this.i=new Ch(null,this.h))}function Sa(n){return new cc(n)}function Jv(n,e,t){n.j=t?hc(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Ru(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function HS(n,e,t){e instanceof Ch?(n.i=e,function KP(n,e){e&&!n.j&&(xa(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(Xg(this,r),GS(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=fc(e,ob)),n.i=new Ch(e,n.h))}function mn(n,e,t){n.i.set(e,t)}function dc(n){return mn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function hc(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function fc(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,zP),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function zP(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}cc.prototype.toString=function(){var n=[],e=this.j;e&&n.push(fc(e,Jg,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(fc(e,Jg,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(fc(t,"/"==t.charAt(0)?WS:sb,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",fc(t,qP)),n.join("")};var Jg=/[#\/\?@]/g,sb=/[#\?:]/g,WS=/[#\?]/g,ob=/[#\?@]/g,qP=/#/g;function Ch(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function xa(n){n.g||(n.g=new Map,n.h=0,n.i&&function GP(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Xg(n,e){xa(n),e=bh(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function ab(n,e){return xa(n),e=bh(n,e),n.g.has(e)}function GS(n,e,t){Xg(n,e),0<t.length&&(n.i=null,n.g.set(bh(n,e),Pg(t)),n.h+=t.length)}function bh(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function ub(n){this.l=n||qS,n=_t.PerformanceNavigationTiming?0<(n=_t.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(_t.g&&_t.g.Ga&&_t.g.Ga()&&_t.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Xe=Ch.prototype).add=function(n,e){xa(this),this.i=null,n=bh(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},Xe.forEach=function(n,e){xa(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},Xe.oa=function(){xa(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let a=0;a<i.length;a++)t.push(e[r])}return t},Xe.W=function(n){xa(this);let e=[];if("string"==typeof n)ab(this,n)&&(e=e.concat(this.g.get(bh(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},Xe.set=function(n,e){return xa(this),this.i=null,ab(this,n=bh(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},Xe.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},Xe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const a=encodeURIComponent(String(r)),l=this.W(r);for(r=0;r<l.length;r++){var i=a;""!==l[r]&&(i+="="+encodeURIComponent(String(l[r]))),n.push(i)}}return this.i=n.join("&")};var qS=10;function KS(n){return!!n.h||!!n.g&&n.g.size>=n.j}function lb(n){return n.h?1:n.g?n.g.size:0}function Dh(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Xv(n,e){n.g?n.g.add(e):n.h=e}function Qi(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function cb(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Pg(n.i)}function Th(){}function ZS(){this.g=new Th}function YS(n,e,t){const r=t||"";try{jS(n,function(i,a){let l=i;Jl(i)&&(l=Vv(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Ah(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(a){}}function pc(n){this.l=n.ac||null,this.j=n.jb||!1}function em(n,e){rr.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=tm,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ub.prototype.cancel=function(){if(this.i=cb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Th.prototype.stringify=function(n){return _t.JSON.stringify(n,void 0)},Th.prototype.parse=function(n){return _t.JSON.parse(n,void 0)},Cr(pc,zg),pc.prototype.g=function(){return new em(this.l,this.j)},pc.prototype.i=function(n){return function(){return n}}({}),Cr(em,rr);var tm=0;function db(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function Sh(n){n.readyState=4,n.l=null,n.j=null,n.A=null,xh(n)}function xh(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Xe=em.prototype).open=function(n,e){if(this.readyState!=tm)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,xh(this)},Xe.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||_t).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},Xe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Sh(this)),this.readyState=tm},Xe.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,xh(this)),this.g&&(this.readyState=3,xh(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==_t.ReadableStream&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;db(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},Xe.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Sh(this):xh(this),3==this.readyState&&db(this)}},Xe.Va=function(n){this.g&&(this.response=this.responseText=n,Sh(this))},Xe.Ua=function(n){this.g&&(this.response=n,Sh(this))},Xe.ga=function(){this.g&&Sh(this)},Xe.setRequestHeader=function(n,e){this.v.append(n,e)},Xe.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Xe.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(em.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var tE=_t.JSON.parse;function on(n){rr.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=nE,this.K=this.L=!1}Cr(on,rr);var nE="",hb=/^https?$/i,QS=["POST","PUT"];function fb(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,pb(n),Mh(n)}function pb(n){n.D||(n.D=!0,ir(n,"complete"),ir(n,"error"))}function gb(n){if(n.h&&void 0!==ah&&(!n.C[1]||4!=To(n)||2!=n.aa()))if(n.v&&4==To(n))Hg(n.Ha,0,n);else if(ir(n,"readystatechange"),4==To(n)){n.h=!1;try{const h=n.aa();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match($S)[1]||null;if(!i&&_t.self&&_t.self.location){var a=_t.self.location.protocol;i=a.substr(0,a.length-1)}r=!hb.test(i?i.toLowerCase():"")}t=r}if(t)ir(n,"complete"),ir(n,"success");else{n.m=6;try{var l=2<To(n)?n.g.statusText:""}catch(m){l=""}n.j=l+" ["+n.aa()+"]",pb(n)}}finally{Mh(n)}}}function Mh(n,e){if(n.g){mb(n);const t=n.g,r=n.C[0]?Da:null;n.g=null,n.C=null,e||ir(n,"ready");try{t.onreadystatechange=r}catch(i){}}}function mb(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(_t.clearTimeout(n.A),n.A=null)}function To(n){return n.g?n.g.readyState:0}function JS(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case nE:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}function nm(n){let e="";return Yi(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function rm(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=nm(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):mn(n,e,t))}function Rh(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function _b(n){this.Ca=0,this.i=[],this.j=new Ta,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Rh("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Rh("baseRetryDelayMs",5e3,n),this.bb=Rh("retryDelaySeedMs",1e4,n),this.$a=Rh("forwardChannelMaxRetries",2,n),this.ta=Rh("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new ub(n&&n.concurrentRequestLimit),this.Fa=new ZS,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function im(n){if(sm(n),3==n.G){var e=n.U++,t=Sa(n.F);mn(t,"SID",n.I),mn(t,"RID",e),mn(t,"TYPE","terminate"),mc(n,t),(e=new ac(n,n.j,e,void 0)).K=2,e.v=dc(Sa(t)),t=!1,_t.navigator&&_t.navigator.sendBeacon&&(t=_t.navigator.sendBeacon(e.v.toString(),"")),!t&&_t.Image&&((new Image).src=e.v,t=!0),t||(e.g=nx(e.l,null),e.g.da(e.v)),e.F=Date.now(),uc(e)}ex(n)}function gc(n){n.g&&(wb(n),n.g.cancel(),n.g=null)}function sm(n){gc(n),n.u&&(_t.clearTimeout(n.u),n.u=null),om(n),n.h.cancel(),n.m&&("number"==typeof n.m&&_t.clearTimeout(n.m),n.m=null)}function Nh(n){KS(n.h)||n.m||(n.m=!0,Bv(n.Ja,n),n.C=0)}function rE(n,e){var t;t=e?e.m:n.U++;const r=Sa(n.F);mn(r,"SID",n.I),mn(r,"RID",t),mn(r,"AID",n.T),mc(n,r),n.o&&n.s&&rm(r,n.o,n.s),t=new ac(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=yb(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),Xv(n.h,t),Kv(t,r,e)}function mc(n,e){n.ia&&Yi(n.ia,function(t,r){mn(e,r,t)}),n.l&&jS({},function(t,r){mn(e,r,t)})}function yb(n,e,t){t=Math.min(n.i.length,t);var r=n.l?ri(n.l.Ra,n.l,n):null;e:{var i=n.i;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let m=0;m<t;m++){let v=i[m].h;const b=i[m].g;if(v-=a,0>v)a=Math.max(0,i[m].h-100),h=!1;else try{YS(b,l,"req"+v+"_")}catch(D){r&&r(b)}}if(h){r=l.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function vb(n){n.g||n.u||(n.Z=1,Bv(n.Ia,n),n.A=0)}function Eb(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=yh(ri(n.Ia,n),Cb(n,n.A)),n.A++,0))}function wb(n){null!=n.B&&(_t.clearTimeout(n.B),n.B=null)}function iE(n){n.g=new ac(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=Sa(n.sa);mn(e,"RID","rpc"),mn(e,"SID",n.I),mn(e,"CI",n.L?"0":"1"),mn(e,"AID",n.T),mn(e,"TYPE","xmlhttp"),mc(n,e),n.o&&n.s&&rm(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=dc(Sa(e)),t.s=null,t.P=!0,Zv(t,n)}function om(n){null!=n.v&&(_t.clearTimeout(n.v),n.v=null)}function Ib(n,e){var t=null;if(n.g==e){om(n),wb(n),n.g=null;var r=2}else{if(!Dh(n.h,e))return;t=e.D,Qi(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;ir(r=_h(),new Gv(r,t,e,i)),Nh(n)}else vb(n);else if(3==(i=e.o)||0==i&&0<n.pa||!(1==r&&function XS(n,e){return!(lb(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=yh(ri(n.Ja,n,e),Cb(n,n.C)),n.C++,0)))}(n,e)||2==r&&Eb(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),i){case 1:_c(n,5);break;case 4:_c(n,10);break;case 3:_c(n,6);break;default:_c(n,2)}}function Cb(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function _c(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=ri(n.kb,n);t||(t=new cc("//www.google.com/images/cleardot.gif"),_t.location&&"http"==_t.location.protocol||Jv(t,"https"),dc(t)),function eE(n,e){const t=new Ta;if(_t.Image){const r=new Image;r.onload=Ng(Ah,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Ng(Ah,t,r,"TestLoadImage: error",!1,e),r.onabort=Ng(Ah,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ng(Ah,t,r,"TestLoadImage: timeout",!1,e),_t.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else _i(2);n.G=0,n.l&&n.l.va(e),ex(n),sm(n)}function ex(n){if(n.G=0,n.la=[],n.l){const e=cb(n.h);(0!=e.length||0!=n.i.length)&&(NC(n.la,e),NC(n.la,n.i),n.h.i.length=0,Pg(n.i),n.i.length=0),n.l.ua()}}function tx(n,e,t){var r=t instanceof cc?Sa(t):new cc(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),Ru(r,r.m);else{var i=_t.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var a=new cc(null,void 0);r&&Jv(a,r),e&&(a.g=e),i&&Ru(a,i),t&&(a.l=t),r=a}return e=n.za,(t=n.D)&&e&&mn(r,t,e),mn(r,"VER",n.ma),mc(n,r),r}function nx(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new on(t&&n.Da&&!n.ra?new pc({jb:!0}):n.ra)).Ka(n.H),e}function rx(){}function am(){if(Su&&!(10<=Number(NS)))throw Error("Environmental error: no available transport.")}function Lr(n,e){rr.call(this),this.g=new _b(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Mv(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Mv(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Nu(this)}function bb(n){eb.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Db(){zv.call(this),this.status=1}function Nu(n){this.g=n}(Xe=on.prototype).Ka=function(n){this.L=n},Xe.da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():qv.g(),this.C=function XC(n){return n.h||(n.h=n.i())}(this.u?this.u:qv),this.g.onreadystatechange=ri(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void fb(this,a)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const a of r.keys())t.set(a,r.get(a))}r=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),i=_t.FormData&&n instanceof _t.FormData,!(0<=SS(QS,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of t)this.g.setRequestHeader(a,l);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{mb(this),0<this.B&&((this.K=function ZP(n){return Su&&function LC(){return function xS(n){var e=FC;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=Rv(String(ch)).split("."),t=Rv("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=uh(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||uh(0==i[2].length,0==a[2].length)||uh(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ri(this.qa,this)):this.A=Hg(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){fb(this,a)}},Xe.qa=function(){void 0!==ah&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ir(this,"timeout"),this.abort(8))},Xe.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ir(this,"complete"),ir(this,"abort"),Mh(this))},Xe.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Mh(this,!0)),on.X.M.call(this)},Xe.Ha=function(){this.s||(this.F||this.v||this.l?gb(this):this.fb())},Xe.fb=function(){gb(this)},Xe.aa=function(){try{return 2<To(this)?this.g.status:-1}catch(n){return-1}},Xe.fa=function(){try{return this.g?this.g.responseText:""}catch(n){return""}},Xe.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),tE(e)}},Xe.Ea=function(){return this.m},Xe.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Xe=_b.prototype).ma=8,Xe.G=1,Xe.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const i=new ac(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=VC(a),nc(a,this.S)):a=this.S),null!==this.o||this.N||(i.H=a,a=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=yb(this,i,e),mn(t=Sa(this.F),"RID",n),mn(t,"CVER",22),this.D&&mn(t,"X-HTTP-Session-Id",this.D),mc(this,t),a&&(this.N?e="headers="+encodeURIComponent(String(nm(a)))+"&"+e:this.o&&rm(t,this.o,a)),Xv(this.h,i),this.Ya&&mn(t,"TYPE","init"),this.O?(mn(t,"$req",e),mn(t,"SID","null"),i.Z=!0,Kv(i,t,null)):Kv(i,t,e),this.G=2}}else 3==this.G&&(n?rE(this,n):0==this.i.length||KS(this.h)||rE(this))},Xe.Ia=function(){if(this.u=null,iE(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=yh(ri(this.eb,this),n)}},Xe.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,_i(10),gc(this),iE(this))},Xe.cb=function(){null!=this.v&&(this.v=null,gc(this),Eb(this),_i(19))},Xe.kb=function(n){n?(this.j.info("Successfully pinged google.com"),_i(2)):(this.j.info("Failed to ping google.com"),_i(1))},(Xe=rx.prototype).xa=function(){},Xe.wa=function(){},Xe.va=function(){},Xe.ua=function(){},Xe.Ra=function(){},am.prototype.g=function(n,e){return new Lr(n,e)},Cr(Lr,rr),Lr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;_i(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=tx(n,null,n.V),Nh(n)},Lr.prototype.close=function(){im(this.g)},Lr.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=Vv(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&Nh(e)},Lr.prototype.M=function(){this.g.l=null,delete this.j,im(this.g),delete this.g,Lr.X.M.call(this)},Cr(bb,eb),Cr(Db,zv),Cr(Nu,rx),Nu.prototype.xa=function(){ir(this.g,"a")},Nu.prototype.wa=function(n){ir(this.g,new bb(n))},Nu.prototype.va=function(n){ir(this.g,new Db(n))},Nu.prototype.ua=function(){ir(this.g,"b")},am.prototype.createWebChannel=am.prototype.g,Lr.prototype.send=Lr.prototype.u,Lr.prototype.open=Lr.prototype.m,Lr.prototype.close=Lr.prototype.close,vh.NO_ERROR=0,vh.TIMEOUT=8,vh.HTTP_ERROR=6,Eh.COMPLETE="complete",qg.EventType=Mu,Mu.OPEN="a",Mu.CLOSE="b",Mu.ERROR="c",Mu.MESSAGE="d",rr.prototype.listen=rr.prototype.N,on.prototype.listenOnce=on.prototype.O,on.prototype.getLastError=on.prototype.Oa,on.prototype.getLastErrorCode=on.prototype.Ea,on.prototype.getStatus=on.prototype.aa,on.prototype.getResponseJson=on.prototype.Sa,on.prototype.getResponseText=on.prototype.fa,on.prototype.send=on.prototype.da,on.prototype.setWithCredentials=on.prototype.Ka;var Pu=Xs.createWebChannelTransport=function(){return new am},Tb=Xs.getStatEventTarget=function(){return _h()},Ph=Xs.ErrorCode=vh,sE=Xs.EventType=Eh,ix=Xs.Event=xu,um=Xs.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},oE=Xs.FetchXmlHttpFactory=pc,ku=Xs.WebChannel=qg,YP=Xs.XhrIo=on;const sx="@firebase/firestore";class br{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}br.UNAUTHENTICATED=new br(null),br.GOOGLE_CREDENTIALS=new br("google-credentials-uid"),br.FIRST_PARTY=new br("first-party-uid"),br.MOCK_USER=new br("mock-user");let kh="9.12.1";const Ao=new Wi.Yd("@firebase/firestore");function aE(){return Ao.logLevel}function xe(n,...e){if(Ao.logLevel<=Wi.in.DEBUG){const t=e.map(lm);Ao.debug(`Firestore (${kh}): ${n}`,...t)}}function Hn(n,...e){if(Ao.logLevel<=Wi.in.ERROR){const t=e.map(lm);Ao.error(`Firestore (${kh}): ${n}`,...t)}}function Ma(n,...e){if(Ao.logLevel<=Wi.in.WARN){const t=e.map(lm);Ao.warn(`Firestore (${kh}): ${n}`,...t)}}function lm(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch(t){return n}}function Ye(n="Unexpected state"){const e=`FIRESTORE (${kh}) INTERNAL ASSERTION FAILED: `+n;throw Hn(e),new Error(e)}function pt(n,e){n||Ye()}function Be(n,e){return n}const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class be extends W.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class qn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class cm{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ux{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(br.UNAUTHENTICATED))}shutdown(){}}class lx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class QP{constructor(e){this.t=e,this.currentUser=br.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=v=>this.i!==i?(i=this.i,t(v)):Promise.resolve();let l=new qn;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new qn,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const v=l;e.enqueueRetryable((0,K.Z)(function*(){yield v.promise,yield a(r.currentUser)}))},m=v=>{xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=v,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(v=>m(v)),setTimeout(()=>{if(!this.auth){const v=this.t.getImmediate({optional:!0});v?m(v):(xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new qn)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(pt("string"==typeof r.accessToken),new cm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return pt(null===e||"string"==typeof e),new br(e)}}class JP{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i,this.type="FirstParty",this.user=br.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(pt(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class cx{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i}getToken(){return Promise.resolve(new JP(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(br.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ab{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class XP{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=a=>{null!=a.error&&xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.A;return this.A=a.token,xe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?i(a):xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(pt("string"==typeof t.token),this.A=t.token,new Ab(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function ek(n){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class dx{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=ek(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function It(n,e){return n<e?-1:n>e?1:0}function yc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function hx(n){return n+"\0"}class xn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new be(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new be(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new be(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new be(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return xn.fromMillis(Date.now())}static fromDate(e){return xn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new xn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?It(this.nanoseconds,e.nanoseconds):It(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class mt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new mt(e)}static min(){return new mt(new xn(0,0))}static max(){return new mt(new xn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class dm{constructor(e,t,r){void 0===t?t=0:t>e.length&&Ye(),void 0===r?r=e.length-t:r>e.length-t&&Ye(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===dm.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof dm?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class s extends dm{construct(e,t,r){return new s(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new be(se.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new s(t)}static emptyPath(){return new s([])}}const o=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class u extends dm{construct(e,t,r){return new u(e,t,r)}static isValidIdentifier(e){return o.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),u.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new u(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new be(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new be(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[i+1];if("\\"!==m&&"."!==m&&"`"!==m)throw new be(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,i+=2}else"`"===h?(l=!l,i++):"."!==h||l?(r+=h,i++):(a(),i++)}if(a(),l)throw new be(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new u(t)}static emptyPath(){return new u([])}}class c{constructor(e){this.path=e}static fromPath(e){return new c(s.fromString(e))}static fromName(e){return new c(s.fromString(e).popFirst(5))}static empty(){return new c(s.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===s.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return s.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new c(new s(e.slice()))}}class d{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function f(n){return n.fields.find(e=>2===e.kind)}function y(n){return n.fields.filter(e=>2!==e.kind)}d.UNKNOWN_ID=-1;class C{constructor(e,t){this.fieldPath=e,this.kind=t}}class S{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new S(0,Z.min())}}function N(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=mt.fromTimestamp(1e9===r?new xn(t+1,0):new xn(t,r));return new Z(i,c.empty(),e)}function j(n){return new Z(n.readTime,n.key,-1)}class Z{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Z(mt.min(),c.empty(),-1)}static max(){return new Z(mt.max(),c.empty(),-1)}}function le(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=c.comparator(n.documentKey,e.documentKey),0!==t?t:It(n.largestBatchId,e.largestBatchId))}const Ne="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ve{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function qe(n){return _e.apply(this,arguments)}function _e(){return _e=(0,K.Z)(function*(n){if(n.code!==se.FAILED_PRECONDITION||n.message!==Ne)throw n;xe("LocalStore","Unexpectedly lost primary lease")}),_e.apply(this,arguments)}class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ye(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):z.reject(t)}static resolve(e){return new z((t,r)=>{t(e)})}static reject(e){return new z((t,r)=>{r(e)})}static waitFor(e){return new z((t,r)=>{let i=0,a=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++a,l&&a===i&&t()},m=>r(m))}),l=!0,a===i&&t()})}static or(e){let t=z.resolve(!1);for(const r of e)t=t.next(i=>i?z.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new z((r,i)=>{const a=e.length,l=new Array(a);let h=0;for(let m=0;m<a;m++){const v=m;t(e[v]).next(b=>{l[v]=b,++h,h===a&&r(l)},b=>i(b))}})}static doWhile(e,t){return new z((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class Rt{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new qn,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new Ds(e,t.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=Oh(r.target.error);this.P.reject(new Ds(e,i))}}static open(e,t,r,i){try{return new Rt(t,e.transaction(i,r))}catch(a){throw new Ds(t,a)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(xe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new uE(t)}}class Nt{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===Nt.D((0,W.z$)())&&Hn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return xe("SimpleDb","Removing database:",e),So(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,W.hl)())return!1;if(Nt.N())return!0;const e=(0,W.z$)(),t=Nt.D(e),r=0<t&&t<10,i=Nt.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static N(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.O)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}F(e){var t=this;return(0,K.Z)(function*(){return t.db||(xe("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new Ds(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const h=l.target.error;i("VersionError"===h.name?new be(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new be(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new Ds(e,h))},a.onupgradeneeded=l=>{xe("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.S.$(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{xe("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,K.Z)(function*(){const l="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.F(e);const m=Rt.open(a.db,e,l?"readonly":"readwrite",r),v=i(m).next(b=>(m.V(),b)).catch(b=>(m.abort(b),z.reject(b))).toPromise();return v.catch(()=>{}),yield m.v,v}catch(m){const v=m,b="FirebaseError"!==v.name&&h<3;if(xe("SimpleDb","Transaction failed with error:",v.message,"Retrying:",b),a.close(),!b)return Promise.reject(v)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Ni{constructor(e){this.U=e,this.q=!1,this.K=null}get isDone(){return this.q}get G(){return this.K}set cursor(e){this.U=e}done(){this.q=!0}j(e){this.K=e}delete(){return So(this.U.delete())}}class Ds extends be{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function to(n){return"IndexedDbTransactionError"===n.name}class uE{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(xe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(xe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),So(r)}add(e){return xe("SimpleDb","ADD",this.store.name,e,e),So(this.store.add(e))}get(e){return So(this.store.get(e)).next(t=>(void 0===t&&(t=null),xe("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return xe("SimpleDb","DELETE",this.store.name,e),So(this.store.delete(e))}count(){return xe("SimpleDb","COUNT",this.store.name),So(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.H(i,(l,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new z((a,l)=>{i.onerror=h=>{l(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new z((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}Y(e,t){xe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,(a,l,h)=>h.delete())}Z(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}tt(e){const t=this.cursor({});return new z((r,i)=>{t.onerror=a=>{const l=Oh(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}H(e,t){const r=[];return new z((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const m=new Ni(h),v=t(h.primaryKey,h.value,m);if(v instanceof z){const b=v.catch(D=>(m.done(),z.reject(D)));r.push(b)}m.isDone?i():null===m.G?h.continue():h.continue(m.G)}}).next(()=>z.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function So(n){return new z((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=Oh(r.target.error);t(i)}})}let hm=!1;function Oh(n){const e=Nt.D((0,W.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new be("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hm||(hm=!0,setTimeout(()=>{throw r},0)),r}}return n}class lE{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;xe("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,K.Z)(function*(){t.task=null;try{xe("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){to(r)?xe("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield qe(r)}yield t.nt(6e4)}))}}class cE{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,K.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let i=t,a=!0;return z.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return xe("IndexBackiller",`Processing collection: ${l}`),this.rt(e,l,i).next(h=>{i-=h,r.add(l)});a=!1})).next(()=>t-i)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.ot(i,a)).next(h=>(xe("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>l.size)}))}ot(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=j(a);le(l,r)>0&&(r=l)}),new Z(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Vr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>t.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function fm(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Fh(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function tk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}Vr.at=-1;class Kn{constructor(e,t){this.comparator=e,this.root=t||oi.EMPTY}insert(e,t){return new Kn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,oi.BLACK,null,null))}remove(e){return new Kn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,oi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sb(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sb(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sb(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sb(this.root,e,this.comparator,!0)}}class Sb{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class oi{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=null!=r?r:oi.RED,this.left=null!=i?i:oi.EMPTY,this.right=null!=a?a:oi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new oi(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return oi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return oi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,oi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,oi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ye();const e=this.left.check();if(e!==this.right.check())throw Ye();return e+(this.isRed()?0:1)}}oi.EMPTY=null,oi.RED=!0,oi.BLACK=!1,oi.EMPTY=new class{constructor(){this.size=0}get key(){throw Ye()}get value(){throw Ye()}get color(){throw Ye()}get left(){throw Ye()}get right(){throw Ye()}copy(n,e,t,r,i){return this}insert(n,e,t){return new oi(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class hn{constructor(e){this.comparator=e,this.data=new Kn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nk(this.data.getIterator())}getIteratorFrom(e){return new nk(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof hn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new hn(this.comparator);return t.data=e,t}}class nk{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function pm(n){return n.hasNext()?n.getNext():void 0}class Ts{constructor(e){this.fields=e,e.sort(u.comparator)}static empty(){return new Ts([])}unionWith(e){let t=new hn(u.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ts(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return yc(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Dr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Dr(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new Dr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return It(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dr.EMPTY_BYTE_STRING=new Dr("");const sU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vc(n){if(pt(!!n),"string"==typeof n){let e=0;const t=sU.exec(n);if(pt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Zn(n.seconds),nanos:Zn(n.nanos)}}function Zn(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Lh(n){return"string"==typeof n?Dr.fromBase64String(n):Dr.fromUint8Array(n)}function fx(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function rk(n){const e=n.mapValue.fields.__previous_value__;return fx(e)?rk(e):e}function dE(n){const e=vc(n.mapValue.fields.__local_write_time__.timestampValue);return new xn(e.seconds,e.nanos)}class oU{constructor(e,t,r,i,a,l,h,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.useFetchStreams=m}}class Ec{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ec("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ec&&e.projectId===this.projectId&&e.database===this.database}}function hE(n){return null==n}function fE(n){return 0===n&&1/n==-1/0}function ik(n){return"number"==typeof n&&Number.isInteger(n)&&!fE(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const wc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},xb={nullValue:"NULL_VALUE"};function Vh(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?fx(n)?4:uk(n)?9007199254740991:10:Ye()}function Ra(n,e){if(n===e)return!0;const t=Vh(n);if(t!==Vh(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return dE(n).isEqual(dE(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=vc(r.timestampValue),l=vc(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Lh(n.bytesValue).isEqual(Lh(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return Zn(r.geoPointValue.latitude)===Zn(i.geoPointValue.latitude)&&Zn(r.geoPointValue.longitude)===Zn(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Zn(r.integerValue)===Zn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=Zn(r.doubleValue),l=Zn(i.doubleValue);return a===l?fE(a)===fE(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return yc(n.arrayValue.values||[],e.arrayValue.values||[],Ra);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(fm(a)!==fm(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===l[h]||!Ra(a[h],l[h])))return!1;return!0}(n,e);default:return Ye()}var i}function pE(n,e){return void 0!==(n.values||[]).find(t=>Ra(t,e))}function Ic(n,e){if(n===e)return 0;const t=Vh(n),r=Vh(e);if(t!==r)return It(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return It(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Zn(i.integerValue||i.doubleValue),h=Zn(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return sk(n.timestampValue,e.timestampValue);case 4:return sk(dE(n),dE(e));case 5:return It(n.stringValue,e.stringValue);case 6:return function(i,a){const l=Lh(i),h=Lh(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),h=a.split("/");for(let m=0;m<l.length&&m<h.length;m++){const v=It(l[m],h[m]);if(0!==v)return v}return It(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=It(Zn(i.latitude),Zn(a.latitude));return 0!==l?l:It(Zn(i.longitude),Zn(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],h=a.values||[];for(let m=0;m<l.length&&m<h.length;++m){const v=Ic(l[m],h[m]);if(v)return v}return It(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===wc.mapValue&&a===wc.mapValue)return 0;if(i===wc.mapValue)return 1;if(a===wc.mapValue)return-1;const l=i.fields||{},h=Object.keys(l),m=a.fields||{},v=Object.keys(m);h.sort(),v.sort();for(let b=0;b<h.length&&b<v.length;++b){const D=It(h[b],v[b]);if(0!==D)return D;const x=Ic(l[h[b]],m[v[b]]);if(0!==x)return x}return It(h.length,v.length)}(n.mapValue,e.mapValue);default:throw Ye()}}function sk(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return It(n,e);const t=vc(n),r=vc(e),i=It(t.seconds,r.seconds);return 0!==i?i:It(t.nanos,r.nanos)}function gm(n){return px(n)}function px(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=vc(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Lh(n.bytesValue).toBase64():"referenceValue"in n?c.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=px(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const h of i)l?l=!1:a+=",",a+=`${h}:${px(r.fields[h])}`;return a+"}"}(n.mapValue):Ye();var e}function Uh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gx(n){return!!n&&"integerValue"in n}function gE(n){return!!n&&"arrayValue"in n}function ok(n){return!!n&&"nullValue"in n}function ak(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Mb(n){return!!n&&"mapValue"in n}function mE(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Fh(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=mE(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mE(n.arrayValue.values[t]);return e}return Object.assign({},n)}function uk(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function aU(n){return"nullValue"in n?xb:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Uh(Ec.empty(),c.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:Ye()}function uU(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Uh(Ec.empty(),c.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?wc:Ye()}function lk(n,e){const t=Ic(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function ck(n,e){const t=Ic(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ai{constructor(e){this.value=e}static empty(){return new ai({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Mb(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mE(t)}setAll(e){let t=u.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,r,i),r={},i=[],t=h.popLast()}l?r[h.lastSegment()]=mE(l):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());Mb(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ra(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Mb(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Fh(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new ai(mE(this.value))}}function dk(n){const e=[];return Fh(n.fields,(t,r)=>{const i=new u([t]);if(Mb(r)){const a=dk(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new Ts(e)}class In{constructor(e,t,r,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new In(e,0,mt.min(),mt.min(),ai.empty(),0)}static newFoundDocument(e,t,r){return new In(e,1,t,mt.min(),r,0)}static newNoDocument(e,t){return new In(e,2,t,mt.min(),ai.empty(),0)}static newUnknownDocument(e,t){return new In(e,3,t,mt.min(),ai.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ai.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ai.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class lU{constructor(e,t=null,r=[],i=[],a=null,l=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=h,this.ht=null}}function hk(n,e=null,t=[],r=[],i=null,a=null,l=null){return new lU(n,e,t,r,i,a,l)}function Bh(n){const e=Be(n);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+gm(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),hE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>gm(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>gm(r)).join(",")),e.ht=t}return e.ht}function _E(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!yU(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Ra(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!_k(n.startAt,e.startAt)&&_k(n.endAt,e.endAt)}function Rb(n){return c.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Nb(n,e){return n.filters.filter(t=>t instanceof ui&&t.field.isEqual(e))}function fk(n,e,t){let r=xb,i=!0;for(const a of Nb(n,e)){let l=xb,h=!0;switch(a.op){case"<":case"<=":l=aU(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,h=!1;break;case"!=":case"not-in":l=xb}lk({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];lk({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function pk(n,e,t){let r=wc,i=!0;for(const a of Nb(n,e)){let l=wc,h=!0;switch(a.op){case">=":case">":l=uU(a.value),h=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,h=!1;break;case"!=":case"not-in":l=wc}ck({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];ck({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class ui extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,r):new dU(e,t,r):"array-contains"===t?new pU(e,r):"in"===t?new gU(e,r):"not-in"===t?new mU(e,r):"array-contains-any"===t?new _U(e,r):new ui(e,t,r)}static lt(e,t,r){return"in"===t?new hU(e,r):new fU(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(Ic(t,this.value)):null!==t&&Vh(this.value)===Vh(t)&&this.ft(Ic(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ye()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class dU extends ui{constructor(e,t,r){super(e,t,r),this.key=c.fromName(r.referenceValue)}matches(e){const t=c.comparator(e.key,this.key);return this.ft(t)}}class hU extends ui{constructor(e,t){super(e,"in",t),this.keys=gk(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class fU extends ui{constructor(e,t){super(e,"not-in",t),this.keys=gk(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function gk(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>c.fromName(r.referenceValue))}class pU extends ui{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return gE(t)&&pE(t.arrayValue,this.value)}}class gU extends ui{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&pE(this.value.arrayValue,t)}}class mU extends ui{constructor(e,t){super(e,"not-in",t)}matches(e){if(pE(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!pE(this.value.arrayValue,t)}}class _U extends ui{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!gE(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>pE(this.value.arrayValue,r))}}class Cc{constructor(e,t){this.position=e,this.inclusive=t}}class mm{constructor(e,t="asc"){this.field=e,this.dir=t}}function yU(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function mk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?c.comparator(c.fromName(l.referenceValue),t.key):Ic(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function _k(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ra(n.position[t],e.position[t]))return!1;return!0}class Ou{constructor(e,t=null,r=[],i=[],a=null,l="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=m,this._t=null,this.wt=null}}function yk(n,e,t,r,i,a,l,h){return new Ou(n,e,t,r,i,a,l,h)}function _m(n){return new Ou(n)}function vk(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function mx(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function _x(n){for(const e of n.filters)if(e.dt())return e.field;return null}function yx(n){return null!==n.collectionGroup}function ym(n){const e=Be(n);if(null===e._t){e._t=[];const t=_x(e),r=mx(e);if(null!==t&&null===r)t.isKeyField()||e._t.push(new mm(t)),e._t.push(new mm(u.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e._t.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new mm(u.keyField(),a))}}}return e._t}function Pi(n){const e=Be(n);if(!e.wt)if("F"===e.limitType)e.wt=hk(e.path,e.collectionGroup,ym(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of ym(e))t.push(new mm(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new Cc(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Cc(e.startAt.position,e.startAt.inclusive):null;e.wt=hk(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.wt}function Pb(n,e,t){return new Ou(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yE(n,e){return _E(Pi(n),Pi(e))&&n.limitType===e.limitType}function Ek(n){return`${Bh(Pi(n))}|lt:${n.limitType}`}function vx(n){return`Query(target=${function cU(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${gm(r.value)}`;var r}).join(", ")}]`),hE(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>gm(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>gm(t)).join(",")),`Target(${e})`}(Pi(n))}; limitType=${n.limitType})`}function Ex(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):c.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const h=mk(i,a,l);return i.inclusive?h<=0:h<0}(t.startAt,ym(t),r)||t.endAt&&!function(i,a,l){const h=mk(i,a,l);return i.inclusive?h>=0:h>0}(t.endAt,ym(t),r)));var t,r}function wk(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Ik(n){return(e,t)=>{let r=!1;for(const i of ym(n)){const a=vU(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function vU(n,e,t){const r=n.field.isKeyField()?c.comparator(e.key,t.key):function(i,a,l){const h=a.data.field(i),m=l.data.field(i);return null!==h&&null!==m?Ic(h,m):Ye()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ye()}}function Ck(n,e){if(n.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fE(e)?"-0":e}}function bk(n){return{integerValue:""+n}}function Dk(n,e){return ik(e)?bk(e):Ck(n,e)}class kb{constructor(){this._=void 0}}function EU(n,e,t){return n instanceof vm?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof jh?Ak(n,e):n instanceof $h?Sk(n,e):function(r,i){const a=Tk(r,i),l=xk(a)+xk(r.yt);return gx(a)&&gx(r.yt)?bk(l):Ck(r.It,l)}(n,e)}function wU(n,e,t){return n instanceof jh?Ak(n,e):n instanceof $h?Sk(n,e):t}function Tk(n,e){return n instanceof Em?gx(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class vm extends kb{}class jh extends kb{constructor(e){super(),this.elements=e}}function Ak(n,e){const t=Mk(e);for(const r of n.elements)t.some(i=>Ra(i,r))||t.push(r);return{arrayValue:{values:t}}}class $h extends kb{constructor(e){super(),this.elements=e}}function Sk(n,e){let t=Mk(e);for(const r of n.elements)t=t.filter(i=>!Ra(i,r));return{arrayValue:{values:t}}}class Em extends kb{constructor(e,t){super(),this.It=e,this.yt=t}}function xk(n){return Zn(n.integerValue||n.doubleValue)}function Mk(n){return gE(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class vE{constructor(e,t){this.field=e,this.transform=t}}class CU{constructor(e,t){this.version=e,this.transformResults=t}}class kn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kn}static exists(e){return new kn(void 0,e)}static updateTime(e){return new kn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ob(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Fb{}function Rk(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Im(n.key,kn.none()):new wm(n.key,n.data,kn.none());{const t=n.data,r=ai.empty();let i=new hn(u.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new Fu(n.key,r,new Ts(i.toArray()),kn.none())}}function bU(n,e,t){n instanceof wm?function(r,i,a){const l=r.value.clone(),h=kk(r.fieldTransforms,i,a.transformResults);l.setAll(h),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Fu?function(r,i,a){if(!Ob(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=kk(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(Pk(r)),h.setAll(l),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function EE(n,e,t,r){return n instanceof wm?function(i,a,l,h){if(!Ob(i.precondition,a))return l;const m=i.value.clone(),v=Ok(i.fieldTransforms,h,a);return m.setAll(v),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Fu?function(i,a,l,h){if(!Ob(i.precondition,a))return l;const m=Ok(i.fieldTransforms,h,a),v=a.data;return v.setAll(Pk(i)),v.setAll(m),a.convertToFoundDocument(a.version,v).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(b=>b.field))}(n,e,t,r):(l=t,Ob(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function DU(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=Tk(r.transform,i||null);null!=a&&(null===t&&(t=ai.empty()),t.set(r.field,a))}return t||null}function Nk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&yc(t,r,(i,a)=>function IU(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof jh&&r instanceof jh||t instanceof $h&&r instanceof $h?yc(t.elements,r.elements,Ra):t instanceof Em&&r instanceof Em?Ra(t.yt,r.yt):t instanceof vm&&r instanceof vm);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class wm extends Fb{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Fu extends Fb{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Pk(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function kk(n,e,t){const r=new Map;pt(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,h=e.data.field(a.field);r.set(a.field,wU(l,h,t[i]))}return r}function Ok(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,EU(a,l,e))}return r}class Im extends Fb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wx extends Fb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class TU{constructor(e){this.count=e}}var pr,Zt;function Fk(n){switch(n){default:return Ye();case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0}}function Lk(n){if(void 0===n)return Hn("GRPC error has no .code"),se.UNKNOWN;switch(n){case pr.OK:return se.OK;case pr.CANCELLED:return se.CANCELLED;case pr.UNKNOWN:return se.UNKNOWN;case pr.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case pr.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case pr.INTERNAL:return se.INTERNAL;case pr.UNAVAILABLE:return se.UNAVAILABLE;case pr.UNAUTHENTICATED:return se.UNAUTHENTICATED;case pr.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case pr.NOT_FOUND:return se.NOT_FOUND;case pr.ALREADY_EXISTS:return se.ALREADY_EXISTS;case pr.PERMISSION_DENIED:return se.PERMISSION_DENIED;case pr.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case pr.ABORTED:return se.ABORTED;case pr.OUT_OF_RANGE:return se.OUT_OF_RANGE;case pr.UNIMPLEMENTED:return se.UNIMPLEMENTED;case pr.DATA_LOSS:return se.DATA_LOSS;default:return Ye()}}(Zt=pr||(pr={}))[Zt.OK=0]="OK",Zt[Zt.CANCELLED=1]="CANCELLED",Zt[Zt.UNKNOWN=2]="UNKNOWN",Zt[Zt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zt[Zt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zt[Zt.NOT_FOUND=5]="NOT_FOUND",Zt[Zt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zt[Zt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zt[Zt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zt[Zt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zt[Zt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zt[Zt.ABORTED=10]="ABORTED",Zt[Zt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zt[Zt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zt[Zt.INTERNAL=13]="INTERNAL",Zt[Zt.UNAVAILABLE=14]="UNAVAILABLE",Zt[Zt.DATA_LOSS=15]="DATA_LOSS";class bc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Fh(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return tk(this.inner)}size(){return this.innerSize}}const AU=new Kn(c.comparator);function Ji(){return AU}const Vk=new Kn(c.comparator);function wE(...n){let e=Vk;for(const t of n)e=e.insert(t.key,t);return e}function Uk(n){let e=Vk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Na(){return IE()}function Bk(){return IE()}function IE(){return new bc(n=>n.toString(),(n,e)=>n.isEqual(e))}const SU=new Kn(c.comparator),xU=new hn(c.comparator);function Pt(...n){let e=xU;for(const t of n)e=e.add(t);return e}const MU=new hn(It);function Lb(){return MU}class CE{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,bE.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new CE(mt.min(),i,Lb(),Ji(),Pt())}}class bE{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new bE(r,t,Pt(),Pt(),Pt())}}class Vb{constructor(e,t,r,i){this.Tt=e,this.removedTargetIds=t,this.key=r,this.Et=i}}class jk{constructor(e,t){this.targetId=e,this.At=t}}class $k{constructor(e,t,r=Dr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Hk{constructor(){this.Rt=0,this.bt=Gk(),this.Pt=Dr.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=Pt(),t=Pt(),r=Pt();return this.bt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ye()}}),new bE(this.Pt,this.vt,e,t,r)}Nt(){this.Vt=!1,this.bt=Gk()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Ot(e){this.Vt=!0,this.bt=this.bt.remove(e)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class RU{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=Ji(),this.qt=Wk(),this.Kt=new hn(It)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,t=>{const r=this.zt(t);switch(e.state){case 0:this.Ht(t)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),r.Ct(e.resumeToken));break;default:Ye()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((r,i)=>{this.Ht(i)&&t(i)})}Yt(e){const t=e.targetId,r=e.At.count,i=this.Xt(t);if(i){const a=i.target;if(Rb(a))if(0===r){const l=new c(a.path);this.jt(t,l,In.newNoDocument(l,mt.min()))}else pt(1===r);else this.Zt(t)!==r&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach((a,l)=>{const h=this.Xt(l);if(h){if(a.current&&Rb(h.target)){const m=new c(h.target.path);null!==this.Ut.get(m)||this.ee(l,m)||this.jt(l,m,In.newNoDocument(m,e))}a.Dt&&(t.set(l,a.xt()),a.Nt())}});let r=Pt();this.qt.forEach((a,l)=>{let h=!0;l.forEachWhile(m=>{const v=this.Xt(m);return!v||2===v.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.Ut.forEach((a,l)=>l.setReadTime(e));const i=new CE(e,t,this.Kt,this.Ut,r);return this.Ut=Ji(),this.qt=Wk(),this.Kt=new hn(It),i}Qt(e,t){if(!this.Ht(e))return;const r=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,r){if(!this.Ht(e))return;const i=this.zt(e);this.ee(e,t)?i.kt(t,1):i.Ot(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Mt(e){this.zt(e).Mt()}zt(e){let t=this.Lt.get(e);return t||(t=new Hk,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new hn(It),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||xe("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new Hk),this.Bt.getRemoteKeysForTarget(e).forEach(t=>{this.jt(e,t,null)})}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function Wk(){return new Kn(c.comparator)}function Gk(){return new Kn(c.comparator)}const NU={asc:"ASCENDING",desc:"DESCENDING"},PU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class kU{constructor(e,t){this.databaseId=e,this.gt=t}}function DE(n,e){return n.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zk(n,e){return n.gt?e.toBase64():e.toUint8Array()}function OU(n,e){return DE(n,e.toTimestamp())}function Ur(n){return pt(!!n),mt.fromTimestamp(function(e){const t=vc(e);return new xn(t.seconds,t.nanos)}(n))}function Ix(n,e){return(t=n,new s(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function qk(n){const e=s.fromString(n);return pt(tO(e)),e}function TE(n,e){return Ix(n.databaseId,e.path)}function Pa(n,e){const t=qk(e);if(t.get(1)!==n.databaseId.projectId)throw new be(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new be(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new c(Zk(t))}function Cx(n,e){return Ix(n.databaseId,e)}function Kk(n){const e=qk(n);return 4===e.length?s.emptyPath():Zk(e)}function AE(n){return new s(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Zk(n){return pt(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Yk(n,e,t){return{name:TE(n,e),fields:t.value.mapValue.fields}}function Qk(n,e,t){const r=Pa(n,e.name),i=Ur(e.updateTime),a=new ai({mapValue:{fields:e.fields}}),l=In.newFoundDocument(r,i,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function SE(n,e){let t;if(e instanceof wm)t={update:Yk(n,e.key,e.value)};else if(e instanceof Im)t={delete:TE(n,e.key)};else if(e instanceof Fu)t={update:Yk(n,e.key,e.data),updateMask:WU(e.fieldMask)};else{if(!(e instanceof wx))return Ye();t={verify:TE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof vm)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof jh)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $h)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Em)return{fieldPath:a.field.canonicalString(),increment:l.yt};throw Ye()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:OU(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:Ye()),t;var i}function bx(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?kn.updateTime(Ur(i.updateTime)):void 0!==i.exists?kn.exists(i.exists):kn.none():kn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;"setToServerValue"in l?(pt("REQUEST_TIME"===l.setToServerValue),h=new vm):"appendMissingElements"in l?h=new jh(l.appendMissingElements.values||[]):"removeAllFromArray"in l?h=new $h(l.removeAllFromArray.values||[]):"increment"in l?h=new Em(a,l.increment):Ye();const m=u.fromServerFormat(l.fieldPath);return new vE(m,h)}(n,i)):[];var i;if(e.update){const i=Pa(n,e.update.name),a=new ai({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new Ts((e.updateMask.fieldPaths||[]).map(v=>u.fromServerFormat(v)));return new Fu(i,a,l,t,r)}return new wm(i,a,t,r)}if(e.delete){const i=Pa(n,e.delete);return new Im(i,t)}if(e.verify){const i=Pa(n,e.verify);return new wx(i,t)}return Ye()}function Jk(n,e){return{documents:[Cx(n,e.path)]}}function Dx(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=Cx(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Cx(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(m){if(0===m.length)return;const v=m.map(b=>function(D){if("=="===D.op){if(ak(D.value))return{unaryFilter:{field:Cm(D.field),op:"IS_NAN"}};if(ok(D.value))return{unaryFilter:{field:Cm(D.field),op:"IS_NULL"}}}else if("!="===D.op){if(ak(D.value))return{unaryFilter:{field:Cm(D.field),op:"IS_NOT_NAN"}};if(ok(D.value))return{unaryFilter:{field:Cm(D.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cm(D.field),op:jU(D.op),value:D.value}}}(b));return 1===v.length?v[0]:{compositeFilter:{op:"AND",filters:v}}}(e.filters);i&&(t.structuredQuery.where=i);const a=function(m){if(0!==m.length)return m.map(v=>{return{field:Cm((b=v).field),direction:BU(b.dir)};var b})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(v=e.limit,n.gt||hE(v)?v:{value:v});var v,h,m;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(m=e.endAt).inclusive,values:m.position}),t}function Xk(n){let e=Kk(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){pt(1===r);const b=t.from[0];b.allDescendants?i=b.collectionId:e=e.child(b.collectionId)}let a=[];t.where&&(a=eO(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(b=>{return new mm(bm((D=b).field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction));var D}));let h=null;t.limit&&(h=function(b){let D;return D="object"==typeof b?b.value:b,hE(D)?null:D}(t.limit));let m=null;var b;t.startAt&&(m=new Cc((b=t.startAt).values||[],!!b.before));let v=null;return t.endAt&&(v=function(b){return new Cc(b.values||[],!b.before)}(t.endAt)),yk(e,i,l,a,h,"F",m,v)}function eO(n){return n?void 0!==n.unaryFilter?[HU(n)]:void 0!==n.fieldFilter?[$U(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>eO(e)).reduce((e,t)=>e.concat(t)):Ye():[]}function BU(n){return NU[n]}function jU(n){return PU[n]}function Cm(n){return{fieldPath:n.canonicalString()}}function bm(n){return u.fromServerFormat(n.fieldPath)}function $U(n){return ui.create(bm(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ye()}}(n.fieldFilter.op),n.fieldFilter.value)}function HU(n){switch(n.unaryFilter.op){case"IS_NAN":const e=bm(n.unaryFilter.field);return ui.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=bm(n.unaryFilter.field);return ui.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=bm(n.unaryFilter.field);return ui.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=bm(n.unaryFilter.field);return ui.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ye()}}function WU(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function tO(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function ki(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=nO(e)),e=GU(n.get(t),e);return nO(e)}function GU(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function nO(n){return n+"\x01\x01"}function ka(n){const e=n.length;if(pt(e>=2),2===e)return pt("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),s.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&Ye(),n.charAt(l+1)){case"\x01":const h=n.substring(a,l);let m;0===i.length?m=h:(i+=h,m=i,i=""),r.push(m);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:Ye()}a=l+2}return new s(r)}const rO=["userId","batchId"];function Ub(n,e){return[n,ki(e)]}function iO(n,e,t){return[n,ki(e),t]}const zU={},qU=["prefixPath","collectionGroup","readTime","documentId"],KU=["prefixPath","collectionGroup","documentId"],ZU=["collectionGroup","readTime","prefixPath","documentId"],YU=["canonicalId","targetId"],QU=["targetId","path"],JU=["path","targetId"],XU=["collectionId","parent"],eB=["indexId","uid"],tB=["uid","sequenceNumber"],nB=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rB=["indexId","uid","orderedDocumentKey"],iB=["userId","collectionPath","documentId"],sB=["userId","collectionPath","largestBatchId"],oB=["userId","collectionGroup","largestBatchId"],sO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],aB=[...sO,"documentOverlays"],oO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],aO=oO,uB=[...aO,"indexConfiguration","indexState","indexEntries"];class Tx extends Ve{constructor(e,t){super(),this.ie=e,this.currentSequenceNumber=t}}function Br(n,e){const t=Be(n);return Nt.M(t.ie,e)}class Ax{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&bU(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=EE(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=EE(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Bk();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=t.has(i.key)?null:h;const m=Rk(l,h);null!==m&&r.set(i.key,m),l.isValidDocument()||l.convertToNoDocument(mt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Pt())}isEqual(e){return this.batchId===e.batchId&&yc(this.mutations,e.mutations,(t,r)=>Nk(t,r))&&yc(this.baseMutations,e.baseMutations,(t,r)=>Nk(t,r))}}class Sx{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){pt(e.mutations.length===r.length);let i=SU;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new Sx(e,t,r,i)}}class xx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Dc{constructor(e,t,r,i,a=mt.min(),l=mt.min(),h=Dr.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h}withSequenceNumber(e){return new Dc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Dc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Dc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class uO{constructor(e){this.re=e}}function lO(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Bb(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:TE(i=n.re,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:DE(i,a.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Hh(e.version)};else{if(!e.isUnknownDocument())return Ye();r.unknownDocument={path:t.path.toArray(),version:Hh(e.version)}}var i,a;return r}function Bb(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Hh(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Wh(n){const e=new xn(n.seconds,n.nanoseconds);return mt.fromTimestamp(e)}function Gh(n,e){const t=(e.baseMutations||[]).map(a=>bx(n.re,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(l.updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a)}const r=e.mutations.map(a=>bx(n.re,a)),i=xn.fromMillis(e.localWriteTimeMs);return new Ax(e.batchId,i,t,r)}function xE(n){const e=Wh(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Wh(n.lastLimboFreeSnapshotVersion):mt.min();let r;var i;return void 0!==n.query.documents?(pt(1===(i=n.query).documents.length),r=Pi(_m(Kk(i.documents[0])))):r=Pi(Xk(n.query)),new Dc(r,n.targetId,0,n.lastListenSequenceNumber,e,t,Dr.fromBase64String(n.resumeToken))}function cO(n,e){const t=Hh(e.snapshotVersion),r=Hh(e.lastLimboFreeSnapshotVersion);let i;i=Rb(e.target)?Jk(n.re,e.target):Dx(n.re,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Bh(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Mx(n){const e=Xk({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Pb(e,e.limit,"L"):e}function Rx(n,e){return new xx(e.largestBatchId,bx(n.re,e.overlayMutation))}function dO(n,e){const t=e.path.lastSegment();return[n,ki(e.path.popLast()),t]}function hO(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Hh(r.readTime),documentKey:ki(r.documentKey.path),largestBatchId:r.largestBatchId}}class cB{getBundleMetadata(e,t){return fO(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Wh(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return fO(e).put({bundleId:(r=t).id,createTime:Hh(Ur(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return pO(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:Mx(i.bundledQuery),readTime:Wh(i.readTime)};var i})}saveNamedQuery(e,t){return pO(e).put({name:(r=t).name,readTime:Hh(Ur(r.readTime)),bundledQuery:r.bundledQuery});var r}}function fO(n){return Br(n,"bundles")}function pO(n){return Br(n,"namedQueries")}class jb{constructor(e,t){this.It=e,this.userId=t}static oe(e,t){return new jb(e,t.uid||"")}getOverlay(e,t){return ME(e).get(dO(this.userId,t)).next(r=>r?Rx(this.It,r):null)}getOverlays(e,t){const r=Na();return z.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const h=new xx(t,l);i.push(this.ue(e,h))}),z.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(ki(l.getCollectionPath())));const a=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(ME(e).Y("collectionPathOverlayIndex",h))}),z.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Na(),a=ki(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ME(e).W("collectionPathOverlayIndex",l).next(h=>{for(const m of h){const v=Rx(this.It,m);i.set(v.getKey(),v)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=Na();let l;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ME(e).Z({index:"collectionGroupOverlayIndex",range:h},(m,v,b)=>{const D=Rx(this.It,v);a.size()<i||D.largestBatchId===l?(a.set(D.getKey(),D),l=D.largestBatchId):b.done()}).next(()=>a)}ue(e,t){return ME(e).put(function(r,i,a){const[l,h,m]=dO(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:SE(r.re,a.mutation)}}(this.It,this.userId,t))}}function ME(n){return Br(n,"documentOverlays")}class zh{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(Zn(e.integerValue));else if("doubleValue"in e){const r=Zn(e.doubleValue);isNaN(r)?this.le(t,13):(this.le(t,15),fE(r)?t.fe(0):t.fe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de(`${r.seconds||""}`),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(Lh(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.le(t,45),t.fe(r.latitude||0),t.fe(r.longitude||0)}else"mapValue"in e?uk(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):Ye()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const r=e.fields||{};this.le(t,55);for(const i of Object.keys(r))this._e(i,t),this.ae(r[i],t)}pe(e,t){const r=e.values||[];this.le(t,50);for(const i of r)this.ae(i,t)}ge(e,t){this.le(t,37),c.fromName(e).path.forEach(r=>{this.le(t,60),this.Ie(r,t)})}le(e,t){e.fe(t)}we(e){e.fe(2)}}function dB(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function gO(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=dB(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}zh.Te=new zh;class hB{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Pe(r.value),r=t.next();this.ve()}Ve(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}Se(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Pe(r);else if(r<2048)this.Pe(960|r>>>6),this.Pe(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Pe(480|r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r);else{const i=t.codePointAt(0);this.Pe(240|i>>>18),this.Pe(128|63&i>>>12),this.Pe(128|63&i>>>6),this.Pe(128|63&i)}}this.ve()}De(e){const t=this.Ce(e),r=gO(t);this.xe(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Ne(e){const t=this.Ce(e),r=gO(t);this.xe(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}ke(){this.Oe(255),this.Oe(255)}Me(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Ce(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ae(e){const t=255&e;0===t?(this.Oe(0),this.Oe(255)):255===t?(this.Oe(255),this.Oe(0)):this.Oe(t)}Pe(e){const t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}Re(){this.Oe(0),this.Oe(1)}ve(){this.Fe(0),this.Fe(1)}Oe(e){this.xe(1),this.buffer[this.position++]=e}Fe(e){this.xe(1),this.buffer[this.position++]=~e}xe(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class fB{constructor(e){this.Be=e}me(e){this.Be.Ee(e)}de(e){this.Be.Ve(e)}fe(e){this.Be.De(e)}he(){this.Be.ke()}}class pB{constructor(e){this.Be=e}me(e){this.Be.be(e)}de(e){this.Be.Se(e)}fe(e){this.Be.Ne(e)}he(){this.Be.Me()}}class RE{constructor(){this.Be=new hB,this.Le=new fB(this.Be),this.Ue=new pB(this.Be)}seed(e){this.Be.seed(e)}qe(e){return 0===e?this.Le:this.Ue}$e(){return this.Be.$e()}reset(){this.Be.reset()}}class qh{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ke(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new qh(this.indexId,this.documentKey,this.arrayValue,r)}}function Kh(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=mO(n.arrayValue,e.arrayValue),0!==t?t:(t=mO(n.directionalValue,e.directionalValue),0!==t?t:c.comparator(n.documentKey,e.documentKey)))}function mO(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class gB{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ge=e.orderBy,this.Qe=[];for(const t of e.filters){const r=t;r.dt()?this.je=r:this.Qe.push(r)}}We(e){const t=f(e);if(void 0!==t&&!this.ze(t))return!1;const r=y(e);let i=0,a=0;for(;i<r.length&&this.ze(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.je){const l=r[i];if(!this.He(this.je,l)||!this.Je(this.Ge[a++],l))return!1;++i}for(;i<r.length;++i){const l=r[i];if(a>=this.Ge.length||!this.Je(this.Ge[a++],l))return!1}return!0}ze(e){for(const t of this.Qe)if(this.He(t,e))return!0;return!1}He(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Je(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class mB{constructor(){this.Ye=new Nx}addToCollectionParentIndex(e,t){return this.Ye.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(Z.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(Z.min())}updateCollectionGroup(e,t,r){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class Nx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new hn(s.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new hn(s.comparator)).toArray()}}const $b=new Uint8Array(0);class _B{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new Nx,this.Ze=new bc(r=>Bh(r),(r,i)=>_E(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const a={collectionId:r,parent:ki(i)};return _O(e).put(a)}return z.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[hx(t),""],!1,!0);return _O(e).W(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(ka(l.parent))}return r})}addFieldIndex(e,t){const r=Hb(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=PE(e);return a.next(h=>{l.put(hO(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=Hb(e),i=PE(e),a=NE(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=NE(e);let i=!0;const a=new Map;return z.forEach(this.tn(t),l=>this.en(e,l).next(h=>{i&&(i=!!h),a.set(l,h)})).next(()=>{if(i){let l=Pt();const h=[];return z.forEach(a,(m,v)=>{var b;xe("IndexedDbIndexManager",`Using index ${b=m,`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(ht=>`${ht.fieldPath}:${ht.kind}`).join(",")}`} to execute ${Bh(t)}`);const D=function(ht,ut){const ft=f(ut);if(void 0===ft)return null;for(const At of Nb(ht,ft.fieldPath))switch(At.op){case"array-contains-any":return At.value.arrayValue.values||[];case"array-contains":return[At.value]}return null}(v,m),x=function(ht,ut){const ft=new Map;for(const At of y(ut))for(const Tr of Nb(ht,At.fieldPath))switch(Tr.op){case"==":case"in":ft.set(At.fieldPath.canonicalString(),Tr.value);break;case"not-in":case"!=":return ft.set(At.fieldPath.canonicalString(),Tr.value),Array.from(ft.values())}return null}(v,m),P=function(ht,ut){const ft=[];let At=!0;for(const Tr of y(ut)){const D0=0===Tr.kind?fk(ht,Tr.fieldPath,ht.startAt):pk(ht,Tr.fieldPath,ht.startAt);ft.push(D0.value),At&&(At=D0.inclusive)}return new Cc(ft,At)}(v,m),G=function(ht,ut){const ft=[];let At=!0;for(const Tr of y(ut)){const D0=0===Tr.kind?pk(ht,Tr.fieldPath,ht.endAt):fk(ht,Tr.fieldPath,ht.endAt);ft.push(D0.value),At&&(At=D0.inclusive)}return new Cc(ft,At)}(v,m),ue=this.nn(m,v,P),Ee=this.nn(m,v,G),at=this.sn(m,v,x),dt=this.rn(m.indexId,D,ue,P.inclusive,Ee,G.inclusive,at);return z.forEach(dt,ht=>r.J(ht,t.limit).next(ut=>{ut.forEach(ft=>{const At=c.fromSegments(ft.documentKey);l.has(At)||(l=l.add(At),h.push(At))})}))}).next(()=>h)}return z.resolve(null)})}tn(e){let t=this.Ze.get(e);return t||(t=[e],this.Ze.set(e,t),t)}rn(e,t,r,i,a,l,h){const m=(null!=t?t.length:1)*Math.max(r.length,a.length),v=m/(null!=t?t.length:1),b=[];for(let D=0;D<m;++D){const x=t?this.on(t[D/v]):$b,P=this.un(e,x,r[D%v],i),G=this.cn(e,x,a[D%v],l),ue=h.map(Ee=>this.un(e,x,Ee,!0));b.push(...this.createRange(P,G,ue))}return b}un(e,t,r,i){const a=new qh(e,c.empty(),t,r);return i?a:a.Ke()}cn(e,t,r,i){const a=new qh(e,c.empty(),t,r);return i?a.Ke():a}en(e,t){const r=new gB(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const h of a)r.We(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,t){let r=2;return z.forEach(this.tn(t),i=>this.en(e,i).next(a=>{a?0!==r&&a.fields.length<function(l){let h=new hn(u.comparator),m=!1;for(const v of l.filters){const b=v;b.field.isKeyField()||("array-contains"===b.op||"array-contains-any"===b.op?m=!0:h=h.add(b.field))}for(const v of l.orderBy)v.field.isKeyField()||(h=h.add(v.field));return h.size+(m?1:0)}(i)&&(r=1):r=0})).next(()=>r)}an(e,t){const r=new RE;for(const i of y(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.qe(i.kind);zh.Te.ce(a,l)}return r.$e()}on(e){const t=new RE;return zh.Te.ce(e,t.qe(0)),t.$e()}hn(e,t){const r=new RE;return zh.Te.ce(Uh(this.databaseId,t),r.qe(function(i){const a=y(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.$e()}sn(e,t,r){if(null===r)return[];let i=[];i.push(new RE);let a=0;for(const l of y(e)){const h=r[a++];for(const m of i)if(this.ln(t,l.fieldPath)&&gE(h))i=this.fn(i,l,h);else{const v=m.qe(l.kind);zh.Te.ce(h,v)}}return this.dn(i)}nn(e,t,r){return this.sn(e,t,r.position)}dn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].$e();return t}fn(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const h of i){const m=new RE;m.seed(h.$e()),zh.Te.ce(l,m.qe(t.kind)),a.push(m)}return a}ln(e,t){return!!e.filters.find(r=>r instanceof ui&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=Hb(e),i=PE(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(a=>{const l=[];return z.forEach(a,h=>i.get([h.indexId,this.uid]).next(m=>{l.push(function(v,b){const D=b?new S(b.sequenceNumber,new Z(Wh(b.readTime),new c(ka(b.documentKey)),b.largestBatchId)):S.empty(),x=v.fields.map(([P,G])=>new C(u.fromServerFormat(P),G));return new d(v.indexId,v.collectionGroup,x,D)}(h,m))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:It(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Hb(e),a=PE(e);return this._n(e).next(l=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>z.forEach(h,m=>a.put(hO(m.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return z.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?z.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),z.forEach(h,m=>this.wn(e,i,m).next(v=>{const b=this.mn(a,m);return v.isEqual(b)?z.resolve():this.gn(e,a,m,v,b)}))))})}yn(e,t,r,i){return NE(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.hn(r,t.key),documentKey:t.key.path.toArray()})}pn(e,t,r,i){return NE(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.hn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=NE(e);let a=new hn(Kh);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.hn(r,t)])},(l,h)=>{a=a.add(new qh(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}mn(e,t){let r=new hn(Kh);const i=this.an(t,e);if(null==i)return r;const a=f(t);if(null!=a){const l=e.data.field(a.fieldPath);if(gE(l))for(const h of l.arrayValue.values||[])r=r.add(new qh(t.indexId,e.key,this.on(h),i))}else r=r.add(new qh(t.indexId,e.key,$b,i));return r}gn(e,t,r,i,a){xe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(h,m,v,b,D){const x=h.getIterator(),P=m.getIterator();let G=pm(x),ue=pm(P);for(;G||ue;){let Ee=!1,at=!1;if(G&&ue){const dt=v(G,ue);dt<0?at=!0:dt>0&&(Ee=!0)}else null!=G?at=!0:Ee=!0;Ee?(b(ue),ue=pm(P)):at?(D(G),G=pm(x)):(G=pm(x),ue=pm(P))}}(i,a,Kh,h=>{l.push(this.yn(e,t,r,h))},h=>{l.push(this.pn(e,t,r,h))}),z.waitFor(l)}_n(e){let t=1;return PE(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,h)=>Kh(l,h)).filter((l,h,m)=>!h||0!==Kh(l,m[h-1]));const i=[];i.push(e);for(const l of r){const h=Kh(l,e),m=Kh(l,t);if(0===h)i[0]=e.Ke();else if(h>0&&m<0)i.push(l),i.push(l.Ke());else if(m>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2)a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,$b,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,$b,[]]));return a}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(yO)}getMinOffset(e,t){return z.mapArray(this.tn(t),r=>this.en(e,r).next(i=>i||Ye())).next(yO)}}function _O(n){return Br(n,"collectionParents")}function NE(n){return Br(n,"indexEntries")}function Hb(n){return Br(n,"indexConfiguration")}function PE(n){return Br(n,"indexState")}function yO(n){pt(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;le(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Z(e.readTime,e.documentKey,t)}const vO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Xi{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Xi(e,Xi.DEFAULT_COLLECTION_PERCENTILE,Xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function EO(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let h=0;const m=r.Z({range:l},(b,D,x)=>(h++,x.delete()));a.push(m.next(()=>{pt(1===h)}));const v=[];for(const b of t.mutations){const D=iO(e,b.key.path,t.batchId);a.push(i.delete(D)),v.push(b.key)}return z.waitFor(a).next(()=>v)}function Wb(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ye();e=n.noDocument}return JSON.stringify(e).length}Xi.DEFAULT_COLLECTION_PERCENTILE=10,Xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xi.DEFAULT=new Xi(41943040,Xi.DEFAULT_COLLECTION_PERCENTILE,Xi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xi.DISABLED=new Xi(-1,0,0);class Gb{constructor(e,t,r,i){this.userId=e,this.It=t,this.indexManager=r,this.referenceDelegate=i,this.In={}}static oe(e,t,r,i){pt(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new Gb(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Tc(e).Z({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=Dm(e),l=Tc(e);return l.add({}).next(h=>{pt("number"==typeof h);const m=new Ax(h,t,r,i),v=function(x,P,G){const ue=G.baseMutations.map(at=>SE(x.re,at)),Ee=G.mutations.map(at=>SE(x.re,at));return{userId:P,batchId:G.batchId,localWriteTimeMs:G.localWriteTime.toMillis(),baseMutations:ue,mutations:Ee}}(this.It,this.userId,m),b=[];let D=new hn((x,P)=>It(x.canonicalString(),P.canonicalString()));for(const x of i){const P=iO(this.userId,x.key.path,h);D=D.add(x.key.path.popLast()),b.push(l.put(v)),b.push(a.put(P,zU))}return D.forEach(x=>{b.push(this.indexManager.addToCollectionParentIndex(e,x))}),e.addOnCommittedListener(()=>{this.In[h]=m.keys()}),z.waitFor(b).next(()=>m)})}lookupMutationBatch(e,t){return Tc(e).get(t).next(r=>r?(pt(r.userId===this.userId),Gh(this.It,r)):null)}Tn(e,t){return this.In[t]?z.resolve(this.In[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.In[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Tc(e).Z({index:"userMutationsIndex",range:i},(l,h,m)=>{h.userId===this.userId&&(pt(h.batchId>=r),a=Gh(this.It,h)),m.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Tc(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Tc(e).W("userMutationsIndex",t).next(r=>r.map(i=>Gh(this.It,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Ub(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Dm(e).Z({range:i},(l,h,m)=>{const[v,b,D]=l,x=ka(b);if(v===this.userId&&t.path.isEqual(x))return Tc(e).get(D).next(P=>{if(!P)throw Ye();pt(P.userId===this.userId),a.push(Gh(this.It,P))});m.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new hn(It);const i=[];return t.forEach(a=>{const l=Ub(this.userId,a.path),h=IDBKeyRange.lowerBound(l),m=Dm(e).Z({range:h},(v,b,D)=>{const[x,P,G]=v,ue=ka(P);x===this.userId&&a.path.isEqual(ue)?r=r.add(G):D.done()});i.push(m)}),z.waitFor(i).next(()=>this.En(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=Ub(this.userId,r),l=IDBKeyRange.lowerBound(a);let h=new hn(It);return Dm(e).Z({range:l},(m,v,b)=>{const[D,x,P]=m,G=ka(x);D===this.userId&&r.isPrefixOf(G)?G.length===i&&(h=h.add(P)):b.done()}).next(()=>this.En(e,h))}En(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Tc(e).get(a).next(l=>{if(null===l)throw Ye();pt(l.userId===this.userId),r.push(Gh(this.It,l))}))}),z.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return EO(e.ie,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.An(t.batchId)}),z.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return z.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Dm(e).Z({range:r},(a,l,h)=>{if(a[0]===this.userId){const m=ka(a[1]);i.push(m)}else h.done()}).next(()=>{pt(0===i.length)})})}containsKey(e,t){return wO(e,this.userId,t)}Rn(e){return IO(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function wO(n,e,t){const r=Ub(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return Dm(n).Z({range:a,X:!0},(h,m,v)=>{const[b,D,x]=h;b===e&&D===i&&(l=!0),v.done()}).next(()=>l)}function Tc(n){return Br(n,"mutations")}function Dm(n){return Br(n,"documentMutations")}function IO(n){return Br(n,"mutationQueues")}class Zh{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Zh(0)}static vn(){return new Zh(-1)}}class yB{constructor(e,t){this.referenceDelegate=e,this.It=t}allocateTargetId(e){return this.Vn(e).next(t=>{const r=new Zh(t.highestTargetId);return t.highestTargetId=r.next(),this.Sn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(t=>mt.fromTimestamp(new xn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Vn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Sn(e,i)))}addTargetData(e,t){return this.Dn(e,t).next(()=>this.Vn(e).next(r=>(r.targetCount+=1,this.Cn(t,r),this.Sn(e,r))))}updateTargetData(e,t){return this.Dn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Tm(e).delete(t.targetId)).next(()=>this.Vn(e)).next(r=>(pt(r.targetCount>0),r.targetCount-=1,this.Sn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return Tm(e).Z((l,h)=>{const m=xE(h);m.sequenceNumber<=t&&null===r.get(m.targetId)&&(i++,a.push(this.removeTargetData(e,m)))}).next(()=>z.waitFor(a)).next(()=>i)}forEachTarget(e,t){return Tm(e).Z((r,i)=>{const a=xE(i);t(a)})}Vn(e){return CO(e).get("targetGlobalKey").next(t=>(pt(null!==t),t))}Sn(e,t){return CO(e).put("targetGlobalKey",t)}Dn(e,t){return Tm(e).put(cO(this.It,t))}Cn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Vn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Bh(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Tm(e).Z({range:i,index:"queryTargetsIndex"},(l,h,m)=>{const v=xE(h);_E(t,v.target)&&(a=v,m.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=Ac(e);return t.forEach(l=>{const h=ki(l.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),z.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ac(e);return z.forEach(t,a=>{const l=ki(a.path);return z.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=Ac(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ac(e);let a=Pt();return i.Z({range:r,X:!0},(l,h,m)=>{const v=ka(l[1]),b=new c(v);a=a.add(b)}).next(()=>a)}containsKey(e,t){const r=ki(t.path),i=IDBKeyRange.bound([r],[hx(r)],!1,!0);let a=0;return Ac(e).Z({index:"documentTargetsIndex",X:!0,range:i},([l,h],m,v)=>{0!==l&&(a++,v.done())}).next(()=>a>0)}se(e,t){return Tm(e).get(t).next(r=>r?xE(r):null)}}function Tm(n){return Br(n,"targets")}function CO(n){return Br(n,"targetGlobal")}function Ac(n){return Br(n,"targetDocuments")}function bO([n,e],[t,r]){const i=It(n,t);return 0===i?It(e,r):i}class vB{constructor(e){this.xn=e,this.buffer=new hn(bO),this.Nn=0}kn(){return++this.Nn}On(e){const t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();bO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class EB{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Mn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return null!==this.Mn}Fn(e){var t=this;xe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,K.Z)(function*(){t.Mn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){to(r)?xe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield qe(r)}yield t.Fn(3e5)}))}}class wB{constructor(e,t){this.$n=e,this.params=t}calculateTargetCount(e,t){return this.$n.Bn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return z.resolve(Vr.at);const r=new vB(t);return this.$n.forEachTarget(e,i=>r.On(i.sequenceNumber)).next(()=>this.$n.Ln(e,i=>r.On(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.$n.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.$n.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(xe("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(vO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vO):this.Un(e,t))}getCacheSize(e){return this.$n.getCacheSize(e)}Un(e,t){let r,i,a,l,h,m,v;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(D=>(D>this.params.maximumSequenceNumbersToCollect?(xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${D}`),i=this.params.maximumSequenceNumbersToCollect):i=D,l=Date.now(),this.nthSequenceNumber(e,i))).next(D=>(r=D,h=Date.now(),this.removeTargets(e,r,t))).next(D=>(a=D,m=Date.now(),this.removeOrphanedDocuments(e,r))).next(D=>(v=Date.now(),aE()<=Wi.in.DEBUG&&xe("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-b}ms\n\tDetermined least recently used ${i} in `+(h-l)+`ms\n\tRemoved ${a} targets in `+(m-h)+`ms\n\tRemoved ${D} documents in `+(v-m)+`ms\nTotal Duration: ${v-b}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:D})))}}class IB{constructor(e,t){this.db=e,this.garbageCollector=new wB(this,t)}Bn(e){const t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}qn(e){let t=0;return this.Ln(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ln(e,t){return this.Kn(e,(r,i)=>t(i))}addReference(e,t,r){return zb(e,r)}removeReference(e,t,r){return zb(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return zb(e,t)}Gn(e,t){return function(r,i){let a=!1;return IO(r).tt(l=>wO(r,l,i).next(h=>(h&&(a=!0),z.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Kn(e,(l,h)=>{if(h<=t){const m=this.Gn(e,l).next(v=>{if(!v)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,mt.min()),Ac(e).delete([0,ki(l.path)])))});i.push(m)}}).next(()=>z.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return zb(e,t)}Kn(e,t){const r=Ac(e);let i,a=Vr.at;return r.Z({index:"documentTargetsIndex"},([l,h],{path:m,sequenceNumber:v})=>{0===l?(a!==Vr.at&&t(new c(ka(i)),a),a=v,i=m):a=Vr.at}).next(()=>{a!==Vr.at&&t(new c(ka(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function zb(n,e){return Ac(n).put((r=n.currentSequenceNumber,{targetId:0,path:ki(e.path),sequenceNumber:r}));var r}class DO{constructor(){this.changes=new bc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,In.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class CB{constructor(e){this.It=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Yh(e).put(r)}removeEntry(e,t,r){return Yh(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Bb(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Qn(e,r)))}getEntry(e,t){let r=In.newInvalidDocument(t);return Yh(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(kE(t))},(i,a)=>{r=this.jn(t,a)}).next(()=>r)}Wn(e,t){let r={size:0,document:In.newInvalidDocument(t)};return Yh(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(kE(t))},(i,a)=>{r={document:this.jn(t,a),size:Wb(a)}}).next(()=>r)}getEntries(e,t){let r=Ji();return this.zn(e,t,(i,a)=>{const l=this.jn(i,a);r=r.insert(i,l)}).next(()=>r)}Hn(e,t){let r=Ji(),i=new Kn(c.comparator);return this.zn(e,t,(a,l)=>{const h=this.jn(a,l);r=r.insert(a,h),i=i.insert(a,Wb(l))}).next(()=>({documents:r,Jn:i}))}zn(e,t,r){if(t.isEmpty())return z.resolve();let i=new hn(xO);t.forEach(m=>i=i.add(m));const a=IDBKeyRange.bound(kE(i.first()),kE(i.last())),l=i.getIterator();let h=l.getNext();return Yh(e).Z({index:"documentKeyIndex",range:a},(m,v,b)=>{const D=c.fromSegments([...v.prefixPath,v.collectionGroup,v.documentId]);for(;h&&xO(h,D)<0;)r(h,null),h=l.getNext();h&&h.isEqual(D)&&(r(h,v),h=l.hasNext()?l.getNext():null),h?b.j(kE(h)):b.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),Bb(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Yh(e).W(IDBKeyRange.bound(i,a,!0)).next(l=>{let h=Ji();for(const m of l){const v=this.jn(c.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);h=h.insert(v.key,v)}return h})}getAllFromCollectionGroup(e,t,r,i){let a=Ji();const l=SO(t,r),h=SO(t,Z.max());return Yh(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(m,v,b)=>{const D=this.jn(c.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);a=a.insert(D.key,D),a.size===i&&b.done()}).next(()=>a)}newChangeBuffer(e){return new bB(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return AO(e).get("remoteDocumentGlobalKey").next(t=>(pt(!!t),t))}Qn(e,t){return AO(e).put("remoteDocumentGlobalKey",t)}jn(e,t){if(t){const r=function lB(n,e){let t;if(e.document)t=Qk(n.re,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=c.fromSegments(e.noDocument.path),i=Wh(e.noDocument.readTime);t=In.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ye();{const r=c.fromSegments(e.unknownDocument.path),i=Wh(e.unknownDocument.version);t=In.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new xn(r[0],r[1]);return mt.fromTimestamp(i)}(e.readTime)),t}(this.It,t);if(!r.isNoDocument()||!r.version.isEqual(mt.min()))return r}return In.newInvalidDocument(e)}}function TO(n){return new CB(n)}class bB extends DO{constructor(e,t){super(),this.Yn=e,this.trackRemovals=t,this.Xn=new bc(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new hn((a,l)=>It(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const h=this.Xn.get(a);if(t.push(this.Yn.removeEntry(e,a,h.readTime)),l.isValidDocument()){const m=lO(this.Yn.It,l);i=i.add(a.path.popLast()),r+=Wb(m)-h.size,t.push(this.Yn.addEntry(e,a,m))}else if(r-=h.size,this.trackRemovals){const m=lO(this.Yn.It,l.convertToNoDocument(mt.min()));t.push(this.Yn.addEntry(e,a,m))}}),i.forEach(a=>{t.push(this.Yn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Yn.updateMetadata(e,r)),z.waitFor(t)}getFromCache(e,t){return this.Yn.Wn(e,t).next(r=>(this.Xn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Yn.Hn(e,t).next(({documents:r,Jn:i})=>(i.forEach((a,l)=>{this.Xn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function AO(n){return Br(n,"remoteDocumentGlobal")}function Yh(n){return Br(n,"remoteDocumentsV14")}function kE(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function SO(n,e){const t=e.documentKey.path.toArray();return[n,Bb(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function xO(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=It(t[a],r[a]),i)return i;return i=It(t.length,r.length),i||(i=It(t[t.length-2],r[r.length-2]),i||It(t[t.length-1],r[r.length-1]))}class DB{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class MO{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&EE(r.mutation,i,Ts.empty(),xn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Pt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Pt()){const i=Na();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=wE();return a.forEach((h,m)=>{l=l.insert(h,m.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=Na();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Pt()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,h)=>{t.set(l,h)})})}computeViews(e,t,r,i){let a=Ji();const l=IE(),h=IE();return t.forEach((m,v)=>{const b=r.get(v.key);i.has(v.key)&&(void 0===b||b.mutation instanceof Fu)?a=a.insert(v.key,v):void 0!==b&&(l.set(v.key,b.mutation.getFieldMask()),EE(b.mutation,v,b.mutation.getFieldMask(),xn.now()))}),this.recalculateAndSaveOverlays(e,a).next(m=>(m.forEach((v,b)=>l.set(v,b)),t.forEach((v,b)=>{var D;return h.set(v,new DB(b,null!==(D=l.get(v))&&void 0!==D?D:null))}),h))}recalculateAndSaveOverlays(e,t){const r=IE();let i=new Kn((l,h)=>l-h),a=Pt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const h of l)h.keys().forEach(m=>{const v=t.get(m);if(null===v)return;let b=r.get(m)||Ts.empty();b=h.applyToLocalView(v,b),r.set(m,b);const D=(i.get(h.batchId)||Pt()).add(m);i=i.insert(h.batchId,D)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),v=m.key,b=m.value,D=Bk();b.forEach(x=>{if(!a.has(x)){const P=Rk(t.get(x),r.get(x));null!==P&&D.set(x,P),a=a.add(x)}}),l.push(this.documentOverlayCache.saveOverlays(e,v,D))}return z.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return c.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):yx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):z.resolve(Na());let h=-1,m=a;return l.next(v=>z.forEach(v,(b,D)=>(h<D.largestBatchId&&(h=D.largestBatchId),a.get(b)?z.resolve():this.getBaseDocument(e,b,D).next(x=>{m=m.insert(b,x)}))).next(()=>this.populateOverlays(e,v,a)).next(()=>this.computeViews(e,m,v,Pt())).next(b=>({batchId:h,changes:Uk(b)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new c(t)).next(r=>{let i=wE();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=wE();return this.indexManager.getCollectionParents(e,i).next(l=>z.forEach(l,h=>{const m=(v=t,b=h.child(i),new Ou(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt));var v,b;return this.getDocumentsMatchingCollectionQuery(e,m,r).next(v=>{v.forEach((b,D)=>{a=a.insert(b,D)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((h,m)=>{const v=m.getKey();null===i.get(v)&&(i=i.insert(v,In.newInvalidDocument(v)))});let l=wE();return i.forEach((h,m)=>{const v=a.get(h);void 0!==v&&EE(v.mutation,m,Ts.empty(),xn.now()),Ex(t,m)&&(l=l.insert(h,m))}),l})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):z.resolve(In.newInvalidDocument(t))}}class TB{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return z.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var r;return this.Zn.set(t.id,{id:(r=t).id,version:r.version,createTime:Ur(r.createTime)}),z.resolve()}getNamedQuery(e,t){return z.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(r=t).name,query:Mx(r.bundledQuery),readTime:Ur(r.readTime)}),z.resolve();var r}}class AB{constructor(){this.overlays=new Kn(c.comparator),this.es=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Na();return z.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ue(e,t,a)}),z.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.es.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(r)),z.resolve()}getOverlaysForCollection(e,t,r){const i=Na(),a=t.length+1,l=new c(t.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const m=h.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===a&&m.largestBatchId>r&&i.set(m.getKey(),m)}return z.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Kn((v,b)=>v-b);const l=this.overlays.getIterator();for(;l.hasNext();){const v=l.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>r){let b=a.get(v.largestBatchId);null===b&&(b=Na(),a=a.insert(v.largestBatchId,b)),b.set(v.getKey(),v)}}const h=Na(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((v,b)=>h.set(v,b)),!(h.size()>=i)););return z.resolve(h)}ue(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.es.get(i.largestBatchId).delete(r.key);this.es.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new xx(t,r));let a=this.es.get(t);void 0===a&&(a=Pt(),this.es.set(t,a)),this.es.set(t,a.add(r.key))}}class Px{constructor(){this.ns=new hn(jr.ss),this.rs=new hn(jr.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const r=new jr(e,t);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.cs(new jr(e,t))}hs(e,t){e.forEach(r=>this.removeReference(r,t))}ls(e){const t=new c(new s([])),r=new jr(t,e),i=new jr(t,e+1),a=[];return this.rs.forEachInRange([r,i],l=>{this.cs(l),a.push(l.key)}),a}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new c(new s([])),r=new jr(t,e),i=new jr(t,e+1);let a=Pt();return this.rs.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new jr(e,0),r=this.ns.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class jr{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return c.comparator(e.key,t.key)||It(e._s,t._s)}static os(e,t){return It(e._s,t._s)||c.comparator(e.key,t.key)}}class SB{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new hn(jr.ss)}checkEmpty(e){return z.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.ws;this.ws++;const l=new Ax(a,t,r,i);this.mutationQueue.push(l);for(const h of i)this.gs=this.gs.add(new jr(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return z.resolve(l)}lookupMutationBatch(e,t){return z.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ps(t+1),a=i<0?0:i;return z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new jr(t,0),i=new jr(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],l=>{const h=this.ys(l._s);a.push(h)}),z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new hn(It);return t.forEach(i=>{const a=new jr(i,0),l=new jr(i,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,l],h=>{r=r.add(h._s)})}),z.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;c.isDocumentKey(a)||(a=a.child(""));const l=new jr(new c(a),0);let h=new hn(It);return this.gs.forEachWhile(m=>{const v=m.key.path;return!!r.isPrefixOf(v)&&(v.length===i&&(h=h.add(m._s)),!0)},l),z.resolve(this.Is(h))}Is(e){const t=[];return e.forEach(r=>{const i=this.ys(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){pt(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return z.forEach(t.mutations,i=>{const a=new jr(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,t){const r=new jr(t,0),i=this.gs.firstAfterOrEqual(r);return z.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return z.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class xB{constructor(e){this.Es=e,this.docs=new Kn(c.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.Es(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return z.resolve(r?r.document.mutableCopy():In.newInvalidDocument(t))}getEntries(e,t){let r=Ji();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():In.newInvalidDocument(i))}),z.resolve(r)}getAllFromCollection(e,t,r){let i=Ji();const a=new c(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:m}}=l.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||le(j(m),r)<=0||(i=i.insert(m.key,m.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,t,r,i){Ye()}As(e,t){return z.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new MB(this)}getSize(e){return z.resolve(this.size)}}class MB extends DO{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(r)}),z.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class RB{constructor(e){this.persistence=e,this.Rs=new bc(t=>Bh(t),_E),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Px,this.targetCount=0,this.vs=Zh.Pn()}forEachTarget(e,t){return this.Rs.forEach((r,i)=>t(i)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),z.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Zh(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.Dn(t),z.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Rs.forEach((l,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Rs.delete(l),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),z.waitFor(a).next(()=>i)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const r=this.Rs.get(t)||null;return z.resolve(r)}addMatchingKeys(e,t,r){return this.Ps.us(t,r),z.resolve()}removeMatchingKeys(e,t,r){this.Ps.hs(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),z.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),z.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ps.ds(t);return z.resolve(r)}containsKey(e,t){return z.resolve(this.Ps.containsKey(t))}}class RO{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new Vr(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new RB(this),this.indexManager=new mB,this.remoteDocumentCache=new xB(r=>this.referenceDelegate.xs(r)),this.It=new uO(t),this.Ns=new TB(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AB,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Vs[e.toKey()];return r||(r=new SB(t,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,r){xe("MemoryPersistence","Starting transaction:",e);const i=new NB(this.Ss.next());return this.referenceDelegate.ks(),r(i).next(a=>this.referenceDelegate.Os(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ms(e,t){return z.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,t)))}}class NB extends Ve{constructor(e){super(),this.currentSequenceNumber=e}}class qb{constructor(e){this.persistence=e,this.Fs=new Px,this.$s=null}static Bs(e){return new qb(e)}get Ls(){if(this.$s)return this.$s;throw Ye()}addReference(e,t,r){return this.Fs.addReference(r,t),this.Ls.delete(r.toString()),z.resolve()}removeReference(e,t,r){return this.Fs.removeReference(r,t),this.Ls.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),z.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(i=>this.Ls.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Ls.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Ls,r=>{const i=c.fromPath(r);return this.Us(e,i).next(a=>{a||t.removeEntry(i,mt.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.Us(e,t).next(r=>{r?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}Us(e,t){return z.or([()=>z.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class PB{constructor(e){this.It=e}$(e,t,r,i){const a=new Rt("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",rO,{unique:!0}),h.createObjectStore("documentMutations"),NO(e),function(h){h.createObjectStore("remoteDocuments")}(e));let l=z.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),NO(e)),l=l.next(()=>function(h){const m=h.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:mt.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",v)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(h,m){return m.store("mutations").W().next(v=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",rO,{unique:!0});const b=m.store("mutations"),D=v.map(x=>b.put(x));return z.waitFor(D)})}(e,a))),l=l.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.qs(a))),r<6&&i>=6&&(l=l.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(a)))),r<7&&i>=7&&(l=l.next(()=>this.Gs(a))),r<8&&i>=8&&(l=l.next(()=>this.Qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.js(a))),r<11&&i>=11&&(l=l.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(h){const m=h.createObjectStore("documentOverlays",{keyPath:iB});m.createIndex("collectionPathOverlayIndex",sB,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",oB,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(h){const m=h.createObjectStore("remoteDocumentsV14",{keyPath:qU});m.createIndex("documentKeyIndex",KU),m.createIndex("collectionGroupIndex",ZU)}(e)).next(()=>this.Ws(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.zs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:eB}).createIndex("sequenceNumberIndex",tB,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:nB}).createIndex("documentKeyIndex",rB,{unique:!1})}(e))),l}Ks(e){let t=0;return e.store("remoteDocuments").Z((r,i)=>{t+=Wb(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}qs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>z.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",l).next(h=>z.forEach(h,m=>{pt(m.userId===a.userId);const v=Gh(this.It,m);return EO(e,a.userId,v).next(()=>{})}))}))}Gs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.Z((l,h)=>{const m=new s(l),v=[0,ki(m)];a.push(t.get(v).next(b=>b?z.resolve():t.put({targetId:0,path:ki(m),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>z.waitFor(a))})}Qs(e,t){e.createObjectStore("collectionParents",{keyPath:XU});const r=t.store("collectionParents"),i=new Nx,a=l=>{if(i.add(l)){const h=l.lastSegment(),m=l.popLast();return r.put({collectionId:h,parent:ki(m)})}};return t.store("remoteDocuments").Z({X:!0},(l,h)=>{const m=new s(l);return a(m.popLast())}).next(()=>t.store("documentMutations").Z({X:!0},([l,h,m],v)=>{const b=ka(h);return a(b.popLast())}))}js(e){const t=e.store("targets");return t.Z((r,i)=>{const a=xE(i),l=cO(this.It,a);return t.put(l)})}Ws(e,t){const r=t.store("remoteDocuments"),i=[];return r.Z((a,l)=>{const h=t.store("remoteDocumentsV14"),m=(v=l,v.document?new c(s.fromString(v.document.name).popFirst(5)):v.noDocument?c.fromSegments(v.noDocument.path):v.unknownDocument?c.fromSegments(v.unknownDocument.path):Ye()).path.toArray();var v;const b={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(b))}).next(()=>z.waitFor(i))}zs(e,t){const r=t.store("mutations"),i=TO(this.It),a=new RO(qb.Bs,this.It.re);return r.W().next(l=>{const h=new Map;return l.forEach(m=>{var v;let b=null!==(v=h.get(m.userId))&&void 0!==v?v:Pt();Gh(this.It,m).keys().forEach(D=>b=b.add(D)),h.set(m.userId,b)}),z.forEach(h,(m,v)=>{const b=new br(v),D=jb.oe(this.It,b),x=a.getIndexManager(b),P=Gb.oe(b,this.It,x,a.referenceDelegate);return new MO(i,P,D,x).recalculateAndSaveOverlaysForDocumentKeys(new Tx(t,Vr.at),m).next()})})}}function NO(n){n.createObjectStore("targetDocuments",{keyPath:QU}).createIndex("documentTargetsIndex",JU,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",YU,{unique:!0}),n.createObjectStore("targetGlobal")}const kx="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Ox{constructor(e,t,r,i,a,l,h,m,v,b,D=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Hs=a,this.window=l,this.document=h,this.Js=v,this.Ys=b,this.Xs=D,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=x=>Promise.resolve(),!Ox.C())throw new be(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new IB(this,i),this.ii=t+"main",this.It=new uO(m),this.ri=new Nt(this.ii,this.Xs,new PB(this.It)),this.Cs=new yB(this.referenceDelegate,this.It),this.remoteDocumentCache=TO(this.It),this.Ns=new cB,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===b&&Hn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new be(se.FAILED_PRECONDITION,kx);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new Vr(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){var t=this;return this.si=function(){var r=(0,K.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(function(){var t=(0,K.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,K.Z)(function*(){t.started&&(yield t.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Kb(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(t=>this.isPrimary&&!t?this._i(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(to(e))return xe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return xe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return OE(e).get("owner").next(t=>z.resolve(this.mi(t)))}gi(e){return Kb(e).delete(this.clientId)}yi(){var e=this;return(0,K.Z)(function*(){if(e.isPrimary&&!e.pi(e.ni,18e5)){e.ni=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Br(r,"clientMetadata");return i.W().next(a=>{const l=e.Ii(a,18e5),h=a.filter(m=>-1===l.indexOf(m));return z.forEach(h,m=>i.delete(m.clientId)).next(()=>h)})}).catch(()=>[]);if(e.oi)for(const r of t)e.oi.removeItem(e.Ti(r.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?z.resolve(!0):OE(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)){if(this.mi(t)&&this.networkEnabled)return!0;if(!this.mi(t)){if(!t.allowTabSynchronization)throw new be(se.FAILED_PRECONDITION,kx);return!1}}return!(!this.networkEnabled||!this.inForeground)||Kb(e).W().next(r=>void 0===this.Ii(r,5e3).find(i=>{if(this.clientId!==i.clientId){const l=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||l&&h)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&xe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,K.Z)(function*(){e.Ds=!1,e.Ai(),e.ei&&(e.ei.cancel(),e.ei=null),e.Ri(),e.bi(),yield e.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Tx(t,Vr.at);return e._i(r).next(()=>e.gi(r))}),e.ri.close(),e.Pi()})()}Ii(e,t){return e.filter(r=>this.pi(r.updateTimeMs,t)&&!this.Ei(r.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>Kb(e).W().next(t=>this.Ii(t,18e5).map(r=>r.clientId)))}get started(){return this.Ds}getMutationQueue(e,t){return Gb.oe(e,this.It,t,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new _B(e,this.It.re.databaseId)}getDocumentOverlayCache(e){return jb.oe(this.It,e)}getBundleCache(){return this.Ns}runTransaction(e,t,r){xe("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Xs)?uB:14===l?aO:13===l?oO:12===l?aB:11===l?sO:void Ye();var l;let h;return this.ri.runTransaction(e,i,a,m=>(h=new Tx(m,this.Ss?this.Ss.next():Vr.at),"readwrite-primary"===t?this.fi(h).next(v=>!!v||this.di(h)).next(v=>{if(!v)throw Hn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new be(se.FAILED_PRECONDITION,Ne);return r(h)}).next(v=>this.wi(h).next(()=>v)):this.Vi(h).next(()=>r(h)))).then(m=>(h.raiseOnCommittedEvent(),m))}Vi(e){return OE(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new be(se.FAILED_PRECONDITION,kx)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return OE(e).put("owner",t)}static C(){return Nt.C()}_i(e){const t=OE(e);return t.get("owner").next(r=>this.mi(r)?(xe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):z.resolve())}pi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Hn(`Detected an update time that is in the future: ${e} > ${r}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,W.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var t;try{const r=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return xe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Hn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Hn("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(e){}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function OE(n){return Br(n,"owner")}function Kb(n){return Br(n,"clientMetadata")}function Fx(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Lx{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Si=r,this.Di=i}static Ci(e,t){let r=Pt(),i=Pt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Lx(e,t.fromCache,r,i)}}class PO{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.ki(e,t).next(a=>a||this.Oi(e,t,i,r)).next(a=>a||this.Mi(e,t))}ki(e,t){if(vk(t))return z.resolve(null);let r=Pi(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Pb(t,null,"F"),r=Pi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const l=Pt(...a);return this.Ni.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(m=>{const v=this.Fi(t,h);return this.$i(t,v,l,m.readTime)?this.ki(e,Pb(t,null,"F")):this.Bi(e,v,t,m)}))})))}Oi(e,t,r,i){return vk(t)||i.isEqual(mt.min())?this.Mi(e,t):this.Ni.getDocuments(e,r).next(a=>{const l=this.Fi(t,a);return this.$i(t,l,r,i)?this.Mi(e,t):(aE()<=Wi.in.DEBUG&&xe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),vx(t)),this.Bi(e,l,t,N(i,-1)))})}Fi(e,t){let r=new hn(Ik(e));return t.forEach((i,a)=>{Ex(e,a)&&(r=r.add(a))}),r}$i(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Mi(e,t){return aE()<=Wi.in.DEBUG&&xe("QueryEngine","Using full collection scan to execute query:",vx(t)),this.Ni.getDocumentsMatchingQuery(e,t,Z.min())}Bi(e,t,r,i){return this.Ni.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class kB{constructor(e,t,r,i){this.persistence=e,this.Li=t,this.It=i,this.Ui=new Kn(It),this.qi=new bc(a=>Bh(a),_E),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MO(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ui))}}function kO(n,e,t,r){return new kB(n,e,t,r)}function OO(n,e){return Vx.apply(this,arguments)}function Vx(){return Vx=(0,K.Z)(function*(n,e){const t=Be(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.Qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],h=[];let m=Pt();for(const v of i){l.push(v.batchId);for(const b of v.mutations)m=m.add(b.key)}for(const v of a){h.push(v.batchId);for(const b of v.mutations)m=m.add(b.key)}return t.localDocuments.getDocuments(r,m).next(v=>({ji:v,removedBatchIds:l,addedBatchIds:h}))})})}),Vx.apply(this,arguments)}function OB(n,e){const t=Be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Gi.newChangeBuffer({trackRemovals:!0});return function(l,h,m,v){const b=m.batch,D=b.keys();let x=z.resolve();return D.forEach(P=>{x=x.next(()=>v.getEntry(h,P)).next(G=>{const ue=m.docVersions.get(P);pt(null!==ue),G.version.compareTo(ue)<0&&(b.applyToRemoteDocument(G,m),G.isValidDocument()&&(G.setReadTime(m.commitVersion),v.addEntry(G)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(h,b))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=Pt();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(h=h.add(l.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function FO(n){const e=Be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function FB(n,e){const t=Be(n),r=e.snapshotVersion;let i=t.Ui;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Gi.newChangeBuffer({trackRemovals:!0});i=t.Ui;const h=[];e.targetChanges.forEach((b,D)=>{const x=i.get(D);if(!x)return;h.push(t.Cs.removeMatchingKeys(a,b.removedDocuments,D).next(()=>t.Cs.addMatchingKeys(a,b.addedDocuments,D)));let P=x.withSequenceNumber(a.currentSequenceNumber);var G,ue,Ee;e.targetMismatches.has(D)?P=P.withResumeToken(Dr.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):b.resumeToken.approximateByteSize()>0&&(P=P.withResumeToken(b.resumeToken,r)),i=i.insert(D,P),ue=P,Ee=b,(0===(G=x).resumeToken.approximateByteSize()||ue.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=3e8||Ee.addedDocuments.size+Ee.modifiedDocuments.size+Ee.removedDocuments.size>0)&&h.push(t.Cs.updateTargetData(a,P))});let m=Ji(),v=Pt();if(e.documentUpdates.forEach(b=>{e.resolvedLimboDocuments.has(b)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,b))}),h.push(LO(a,l,e.documentUpdates).next(b=>{m=b.Wi,v=b.zi})),!r.isEqual(mt.min())){const b=t.Cs.getLastRemoteSnapshotVersion(a).next(D=>t.Cs.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(b)}return z.waitFor(h).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,m,v)).next(()=>m)}).then(a=>(t.Ui=i,a))}function LO(n,e,t){let r=Pt(),i=Pt();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Ji();return t.forEach((h,m)=>{const v=a.get(h);m.isFoundDocument()!==v.isFoundDocument()&&(i=i.add(h)),m.isNoDocument()&&m.version.isEqual(mt.min())?(e.removeEntry(h,m.readTime),l=l.insert(h,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||0===m.version.compareTo(v.version)&&v.hasPendingWrites?(e.addEntry(m),l=l.insert(h,m)):xe("LocalStore","Ignoring outdated watch update for ",h,". Current version:",v.version," Watch version:",m.version)}),{Wi:l,zi:i}})}function LB(n,e){const t=Be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Am(n,e){const t=Be(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Cs.getTargetData(r,e).next(a=>a?(i=a,z.resolve(i)):t.Cs.allocateTargetId(r).next(l=>(i=new Dc(e,l,0,r.currentSequenceNumber),t.Cs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ui.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ui=t.Ui.insert(r.targetId,r),t.qi.set(e,r.targetId)),r})}function Sm(n,e,t){return Ux.apply(this,arguments)}function Ux(){return Ux=(0,K.Z)(function*(n,e,t){const r=Be(n),i=r.Ui.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!to(l))throw l;xe("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ui=r.Ui.remove(e),r.qi.delete(i.target)}),Ux.apply(this,arguments)}function Zb(n,e,t){const r=Be(n);let i=mt.min(),a=Pt();return r.persistence.runTransaction("Execute query","readonly",l=>function(h,m,v){const b=Be(h),D=b.qi.get(v);return void 0!==D?z.resolve(b.Ui.get(D)):b.Cs.getTargetData(m,v)}(r,l,Pi(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(l,h.targetId).next(m=>{a=m})}).next(()=>r.Li.getDocumentsMatchingQuery(l,e,t?i:mt.min(),t?a:Pt())).next(h=>(BO(r,wk(e),h),{documents:h,Hi:a})))}function VO(n,e){const t=Be(n),r=Be(t.Cs),i=t.Ui.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.se(a,e).next(l=>l?l.target:null))}function UO(n,e){const t=Be(n),r=t.Ki.get(e)||mt.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Gi.getAllFromCollectionGroup(i,e,N(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(BO(t,e,i),i))}function BO(n,e,t){let r=n.Ki.get(e)||mt.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ki.set(e,r)}function Bx(){return Bx=(0,K.Z)(function*(n,e,t,r){const i=Be(n);let a=Pt(),l=Ji();for(const v of t){const b=e.Ji(v.metadata.name);v.document&&(a=a.add(b));const D=e.Yi(v);D.setReadTime(e.Xi(v.metadata.readTime)),l=l.insert(b,D)}const h=i.Gi.newChangeBuffer({trackRemovals:!0}),m=yield Am(i,(v=r,Pi(_m(s.fromString(`__bundle__/docs/${v}`)))));var v;return i.persistence.runTransaction("Apply bundle documents","readwrite",v=>LO(v,h,l).next(b=>(h.apply(v),b)).next(b=>i.Cs.removeMatchingKeysForTargetId(v,m.targetId).next(()=>i.Cs.addMatchingKeys(v,a,m.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(v,b.Wi,b.zi)).next(()=>b.Wi)))}),Bx.apply(this,arguments)}function UB(n,e){return jx.apply(this,arguments)}function jx(){return jx=(0,K.Z)(function*(n,e,t=Pt()){const r=yield Am(n,Pi(Mx(e.bundledQuery))),i=Be(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=Ur(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ns.saveNamedQuery(a,e);const h=r.withResumeToken(Dr.EMPTY_BYTE_STRING,l);return i.Ui=i.Ui.insert(h.targetId,h),i.Cs.updateTargetData(a,h).next(()=>i.Cs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Cs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ns.saveNamedQuery(a,e))})}),jx.apply(this,arguments)}function jO(n,e){return`firestore_clients_${n}_${e}`}function $O(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function $x(n,e){return`firestore_targets_${n}_${e}`}class Yb{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Zi(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new be(i.error.code,i.error.message))),l?new Yb(e,t,i.state,a):(Hn("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class FE{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Zi(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new be(r.error.code,r.error.message))),a?new FE(e,r.state,i):(Hn("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qb{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Lb();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=ik(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new Qb(e,a):(Hn("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Hx{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Hx(t.clientId,t.onlineState):(Hn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Wx{constructor(){this.activeTargetIds=Lb()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gx{constructor(e,t,r,i,a){this.window=e,this.Hs=t,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Kn(It),this.started=!1,this.cr=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=jO(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new Wx),this.lr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,K.Z)(function*(){const t=yield e.syncEngine.vi();for(const i of t){if(i===e.sr)continue;const a=e.getItem(jO(e.persistenceKey,i));if(a){const l=Qb.Zi(i,a);l&&(e.ur=e.ur.insert(l.clientId,l))}}e.gr();const r=e.storage.getItem(e.wr);if(r){const i=e.yr(r);i&&e.pr(i)}for(const i of e.cr)e.rr(i);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let t=!1;return this.ur.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,t,r){this.Tr(e,t,r),this.Er(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem($x(this.persistenceKey,e));if(r){const i=FE.Zi(e,r);i&&(t=i.state)}}return this.Ar.er(e),this.gr(),t}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem($x(this.persistenceKey,e))}updateQueryState(e,t,r){this.Rr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Er(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return xe("SharedClientState","READ",e,t),t}setItem(e,t){xe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){xe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(xe("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ar)return void Hn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,K.Z)(function*(){if(t.started){if(null!==r.key)if(t.lr.test(r.key)){if(null==r.newValue){const i=t.vr(r.key);return t.Vr(i,null)}{const i=t.Sr(r.key,r.newValue);if(i)return t.Vr(i.clientId,i)}}else if(t.dr.test(r.key)){if(null!==r.newValue){const i=t.Dr(r.key,r.newValue);if(i)return t.Cr(i)}}else if(t._r.test(r.key)){if(null!==r.newValue){const i=t.Nr(r.key,r.newValue);if(i)return t.kr(i)}}else if(r.key===t.wr){if(null!==r.newValue){const i=t.yr(r.newValue);if(i)return t.pr(i)}}else if(r.key===t.hr){const i=function(a){let l=Vr.at;if(null!=a)try{const h=JSON.parse(a);pt("number"==typeof h),l=h}catch(h){Hn("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(r.newValue);i!==Vr.at&&t.sequenceNumberHandler(i)}else if(r.key===t.mr){const i=t.Or(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Mr(a)))}}else t.cr.push(r)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,t,r){const i=new Yb(this.currentUser,e,t,r),a=$O(this.persistenceKey,this.currentUser,e);this.setItem(a,i.tr())}Er(e){const t=$O(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:e}))}Rr(e,t,r){const i=$x(this.persistenceKey,e),a=new FE(e,t,r);this.setItem(i,a.tr())}Pr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}vr(e){const t=this.lr.exec(e);return t?t[1]:null}Sr(e,t){const r=this.vr(e);return Qb.Zi(r,t)}Dr(e,t){const r=this.dr.exec(e),i=Number(r[1]);return Yb.Zi(new br(void 0!==r[2]?r[2]:null),i,t)}Nr(e,t){const r=this._r.exec(e),i=Number(r[1]);return FE.Zi(i,t)}yr(e){return Hx.Zi(e)}Or(e){return JSON.parse(e)}Cr(e){var t=this;return(0,K.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Fr(e.batchId,e.state,e.error);xe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,t){const r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),l=[],h=[];return a.forEach(m=>{i.has(m)||l.push(m)}),i.forEach(m=>{a.has(m)||h.push(m)}),this.syncEngine.Br(l,h).then(()=>{this.ur=r})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let t=Lb();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class HO{constructor(){this.Lr=new Wx,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,r){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new Wx,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class BB{qr(e){}shutdown(){}}class WO{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){xe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){xe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const jB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $B{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class HB extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,r,i,a){const l=this.ho(e,t);xe("RestConnection","Sending: ",l,r);const h={};return this.lo(h,i,a),this.fo(e,l,h,r).then(m=>(xe("RestConnection","Received: ",m),m),m=>{throw Ma("RestConnection",`${e} failed with error: `,m,"url: ",l,"request:",r),m})}_o(e,t,r,i,a,l){return this.ao(e,t,r,i,a)}lo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+kh,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}ho(e,t){return`${this.oo}/v1/${t}:${jB[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,r,i){return new Promise((a,l)=>{const h=new YP;h.setWithCredentials(!0),h.listenOnce(sE.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ph.NO_ERROR:const v=h.getResponseJson();xe("Connection","XHR received:",JSON.stringify(v)),a(v);break;case Ph.TIMEOUT:xe("Connection",'RPC "'+e+'" timed out'),l(new be(se.DEADLINE_EXCEEDED,"Request time out"));break;case Ph.HTTP_ERROR:const b=h.getStatus();if(xe("Connection",'RPC "'+e+'" failed with status:',b,"response text:",h.getResponseText()),b>0){const D=h.getResponseJson().error;if(D&&D.status&&D.message){const x=function(P){const G=P.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(G)>=0?G:se.UNKNOWN}(D.status);l(new be(x,D.message))}else l(new be(se.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new be(se.UNAVAILABLE,"Connection failed."));break;default:Ye()}}finally{xe("Connection",'RPC "'+e+'" completed.')}});const m=JSON.stringify(i);h.send(t,"POST",m,r,15)})}wo(e,t,r){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Pu(),l=Tb(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new oE({})),this.lo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const m=i.join("");xe("Connection","Creating WebChannel: "+m,h);const v=a.createWebChannel(m,h);let b=!1,D=!1;const x=new $B({Hr:G=>{D?xe("Connection","Not sending because WebChannel is closed:",G):(b||(xe("Connection","Opening WebChannel transport."),v.open(),b=!0),xe("Connection","WebChannel sending:",G),v.send(G))},Jr:()=>v.close()}),P=(G,ue,Ee)=>{G.listen(ue,at=>{try{Ee(at)}catch(dt){setTimeout(()=>{throw dt},0)}})};return P(v,ku.EventType.OPEN,()=>{D||xe("Connection","WebChannel transport opened.")}),P(v,ku.EventType.CLOSE,()=>{D||(D=!0,xe("Connection","WebChannel transport closed"),x.io())}),P(v,ku.EventType.ERROR,G=>{D||(D=!0,Ma("Connection","WebChannel transport errored:",G),x.io(new be(se.UNAVAILABLE,"The operation could not be completed")))}),P(v,ku.EventType.MESSAGE,G=>{var ue;if(!D){const Ee=G.data[0];pt(!!Ee);const at=Ee,dt=at.error||(null===(ue=at[0])||void 0===ue?void 0:ue.error);if(dt){xe("Connection","WebChannel received error:",dt);const ht=dt.status;let ut=function(At){const Tr=pr[At];if(void 0!==Tr)return Lk(Tr)}(ht),ft=dt.message;void 0===ut&&(ut=se.INTERNAL,ft="Unknown error status: "+ht+" with message "+dt.message),D=!0,x.io(new be(ut,ft)),v.close()}else xe("Connection","WebChannel received:",Ee),x.ro(Ee)}}),P(l,ix.STAT_EVENT,G=>{G.stat===um.PROXY?xe("Connection","Detected buffering proxy"):G.stat===um.NOPROXY&&xe("Connection","Detected no buffering proxy")}),setTimeout(()=>{x.so()},0),x}}function GO(){return"undefined"!=typeof window?window:null}function Jb(){return"undefined"!=typeof document?document:null}function LE(n){return new kU(n,!0)}class zx{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Hs=e,this.timerId=t,this.mo=r,this.yo=i,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,t-r);i>0&&xe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class zO{constructor(e,t,r,i,a,l,h,m){this.Hs=e,this.vo=r,this.Vo=i,this.So=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.Do=0,this.Co=null,this.xo=null,this.stream=null,this.No=new zx(e,t)}ko(){return 1===this.state||5===this.state||this.Oo()}Oo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Mo()}stop(){var e=this;return(0,K.Z)(function*(){e.ko()&&(yield e.close(0))})()}Fo(){this.state=0,this.No.reset()}$o(){this.Oo()&&null===this.Co&&(this.Co=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.Bo()))}Lo(e){this.Uo(),this.stream.send(e)}Bo(){var e=this;return(0,K.Z)(function*(){if(e.Oo())return e.close(0)})()}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}qo(){this.xo&&(this.xo.cancel(),this.xo=null)}close(e,t){var r=this;return(0,K.Z)(function*(){r.Uo(),r.qo(),r.No.cancel(),r.Do++,4!==e?r.No.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(Hn(t.toString()),Hn("Using maximum backoff delay to prevent overloading the backend."),r.No.Ao()):t&&t.code===se.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Ko(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(t)})()}Ko(){}auth(){this.state=1;const e=this.Go(this.Do),t=this.Do;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Do===t&&this.Qo(r,i)},r=>{e(()=>{const i=new be(se.UNKNOWN,"Fetching auth token failed: "+r.message);return this.jo(i)})})}Qo(e,t){const r=this.Go(this.Do);this.stream=this.Wo(e,t),this.stream.Yr(()=>{r(()=>(this.state=2,this.xo=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.Oo()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(i=>{r(()=>this.jo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Mo(){var e=this;this.state=5,this.No.Ro((0,K.Z)(function*(){e.state=0,e.start()}))}jo(e){return xe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Go(e){return t=>{this.Hs.enqueueAndForget(()=>this.Do===e?t():(xe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class WB extends zO{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.It=a}Wo(e,t){return this.So.wo("Listen",e,t)}onMessage(e){this.No.reset();const t=function LU(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(m=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===m?1:"REMOVE"===m?2:"CURRENT"===m?3:"RESET"===m?4:Ye(),i=e.targetChange.targetIds||[],a=function(m,v){return m.gt?(pt(void 0===v||"string"==typeof v),Dr.fromBase64String(v||"")):(pt(void 0===v||v instanceof Uint8Array),Dr.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){const v=void 0===m.code?se.UNKNOWN:Lk(m.code);return new be(v,m.message||"")}(l);t=new $k(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Pa(n,r.document.name),a=Ur(r.document.updateTime),l=new ai({mapValue:{fields:r.document.fields}}),h=In.newFoundDocument(i,a,l);t=new Vb(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=Pa(n,r.document),a=r.readTime?Ur(r.readTime):mt.min(),l=In.newNoDocument(i,a);t=new Vb([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=Pa(n,r.document);t=new Vb([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return Ye();{const r=e.filter,a=new TU(r.count||0);t=new jk(r.targetId,a)}}var m;return t}(this.It,e),r=function(i){if(!("targetChange"in i))return mt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?mt.min():a.readTime?Ur(a.readTime):mt.min()}(e);return this.listener.zo(t,r)}Ho(e){const t={};t.database=AE(this.It),t.addTarget=function(i,a){let l;const h=a.target;return l=Rb(h)?{documents:Jk(i,h)}:{query:Dx(i,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=zk(i,a.resumeToken):a.snapshotVersion.compareTo(mt.min())>0&&(l.readTime=DE(i,a.snapshotVersion.toTimestamp())),l}(this.It,e);const r=function UU(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ye()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Lo(t)}Jo(e){const t={};t.database=AE(this.It),t.removeTarget=e,this.Lo(t)}}class GB extends zO{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.It=a,this.Yo=!1}get Xo(){return this.Yo}start(){this.Yo=!1,this.lastStreamToken=void 0,super.start()}Ko(){this.Yo&&this.Zo([])}Wo(e,t){return this.So.wo("Write",e,t)}onMessage(e){if(pt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Yo){this.No.reset();const t=function VU(n,e){return n&&n.length>0?(pt(void 0!==e),n.map(t=>function(r,i){let a=Ur(r.updateTime?r.updateTime:i);return a.isEqual(mt.min())&&(a=Ur(i)),new CU(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Ur(e.commitTime);return this.listener.tu(r,t)}return pt(!e.writeResults||0===e.writeResults.length),this.Yo=!0,this.listener.eu()}nu(){const e={};e.database=AE(this.It),this.Lo(e)}Zo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>SE(this.It,r))};this.Lo(t)}}class zB extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.So=r,this.It=i,this.su=!1}iu(){if(this.su)throw new be(se.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,r){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.So.ao(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new be(se.UNKNOWN,i.toString())})}_o(e,t,r,i){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.So._o(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new be(se.UNKNOWN,a.toString())})}terminate(){this.su=!0}}class KB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ru=0,this.ou=null,this.uu=!0}cu(){0===this.ru&&(this.au("Unknown"),this.ou=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ou=null,this.hu("Backend didn't respond within 10 seconds."),this.au("Offline"),Promise.resolve())))}lu(e){"Online"===this.state?this.au("Unknown"):(this.ru++,this.ru>=1&&(this.fu(),this.hu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.au("Offline")))}set(e){this.fu(),this.ru=0,"Online"===e&&(this.uu=!1),this.au(e)}au(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}hu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.uu?(Hn(t),this.uu=!1):xe("OnlineStateTracker",t)}fu(){null!==this.ou&&(this.ou.cancel(),this.ou=null)}}class ZB{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.du=[],this._u=new Map,this.wu=new Set,this.mu=[],this.gu=a,this.gu.qr(h=>{r.enqueueAndForget((0,K.Z)(function*(){var m;Lu(l)&&(xe("RemoteStore","Restarting streams for network reachability change."),yield(m=(0,K.Z)(function*(v){const b=Be(v);b.wu.add(4),yield xm(b),b.yu.set("Unknown"),b.wu.delete(4),yield VE(b)}),function(v){return m.apply(this,arguments)})(l))}))}),this.yu=new KB(r,i)}}function VE(n){return Kx.apply(this,arguments)}function Kx(){return Kx=(0,K.Z)(function*(n){if(Lu(n))for(const e of n.mu)yield e(!0)}),Kx.apply(this,arguments)}function xm(n){return Zx.apply(this,arguments)}function Zx(){return Zx=(0,K.Z)(function*(n){for(const e of n.mu)yield e(!1)}),Zx.apply(this,arguments)}function Xb(n,e){const t=Be(n);t._u.has(e.targetId)||(t._u.set(e.targetId,e),Jx(t)?Qx(t):Rm(t).Oo()&&Yx(t,e))}function UE(n,e){const t=Be(n),r=Rm(t);t._u.delete(e),r.Oo()&&qO(t,e),0===t._u.size&&(r.Oo()?r.$o():Lu(t)&&t.yu.set("Unknown"))}function Yx(n,e){n.pu.Mt(e.targetId),Rm(n).Ho(e)}function qO(n,e){n.pu.Mt(e),Rm(n).Jo(e)}function Qx(n){n.pu=new RU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),se:e=>n._u.get(e)||null}),Rm(n).start(),n.yu.cu()}function Jx(n){return Lu(n)&&!Rm(n).ko()&&n._u.size>0}function Lu(n){return 0===Be(n).wu.size}function KO(n){n.pu=void 0}function YB(n){return Xx.apply(this,arguments)}function Xx(){return Xx=(0,K.Z)(function*(n){n._u.forEach((e,t)=>{Yx(n,e)})}),Xx.apply(this,arguments)}function QB(n,e){return eM.apply(this,arguments)}function eM(){return eM=(0,K.Z)(function*(n,e){KO(n),Jx(n)?(n.yu.lu(e),Qx(n)):n.yu.set("Unknown")}),eM.apply(this,arguments)}function JB(n,e,t){return tM.apply(this,arguments)}function tM(){return tM=(0,K.Z)(function*(n,e,t){if(n.yu.set("Online"),e instanceof $k&&2===e.state&&e.cause)try{yield(r=(0,K.Z)(function*(i,a){const l=a.cause;for(const h of a.targetIds)i._u.has(h)&&(yield i.remoteSyncer.rejectListen(h,l),i._u.delete(h),i.pu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){xe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield eD(n,r)}else if(e instanceof Vb?n.pu.Gt(e):e instanceof jk?n.pu.Yt(e):n.pu.Wt(e),!t.isEqual(mt.min()))try{const r=yield FO(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.pu.te(a);return l.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const v=i._u.get(m);v&&i._u.set(m,v.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach(h=>{const m=i._u.get(h);if(!m)return;i._u.set(h,m.withResumeToken(Dr.EMPTY_BYTE_STRING,m.snapshotVersion)),qO(i,h);const v=new Dc(m.target,h,1,m.sequenceNumber);Yx(i,v)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){xe("RemoteStore","Failed to raise snapshot:",r),yield eD(n,r)}var r}),tM.apply(this,arguments)}function eD(n,e,t){return nM.apply(this,arguments)}function nM(){return nM=(0,K.Z)(function*(n,e,t){if(!to(e))throw e;n.wu.add(1),yield xm(n),n.yu.set("Offline"),t||(t=()=>FO(n.localStore)),n.asyncQueue.enqueueRetryable((0,K.Z)(function*(){xe("RemoteStore","Retrying IndexedDB access"),yield t(),n.wu.delete(1),yield VE(n)}))}),nM.apply(this,arguments)}function ZO(n,e){return e().catch(t=>eD(n,t,e))}function Mm(n){return rM.apply(this,arguments)}function rM(){return rM=(0,K.Z)(function*(n){const e=Be(n),t=Sc(e);let r=e.du.length>0?e.du[e.du.length-1].batchId:-1;for(;XB(e);)try{const i=yield LB(e.localStore,r);if(null===i){0===e.du.length&&t.$o();break}r=i.batchId,e2(e,i)}catch(i){yield eD(e,i)}YO(e)&&QO(e)}),rM.apply(this,arguments)}function XB(n){return Lu(n)&&n.du.length<10}function e2(n,e){n.du.push(e);const t=Sc(n);t.Oo()&&t.Xo&&t.Zo(e.mutations)}function YO(n){return Lu(n)&&!Sc(n).ko()&&n.du.length>0}function QO(n){Sc(n).start()}function t2(n){return iM.apply(this,arguments)}function iM(){return iM=(0,K.Z)(function*(n){Sc(n).nu()}),iM.apply(this,arguments)}function n2(n){return sM.apply(this,arguments)}function sM(){return sM=(0,K.Z)(function*(n){const e=Sc(n);for(const t of n.du)e.Zo(t.mutations)}),sM.apply(this,arguments)}function r2(n,e,t){return oM.apply(this,arguments)}function oM(){return oM=(0,K.Z)(function*(n,e,t){const r=n.du.shift(),i=Sx.from(r,e,t);yield ZO(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Mm(n)}),oM.apply(this,arguments)}function i2(n,e){return aM.apply(this,arguments)}function aM(){return aM=(0,K.Z)(function*(n,e){var t;e&&Sc(n).Xo&&(yield(t=(0,K.Z)(function*(r,i){if(Fk(a=i.code)&&a!==se.ABORTED){const l=r.du.shift();Sc(r).Fo(),yield ZO(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield Mm(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),YO(n)&&QO(n)}),aM.apply(this,arguments)}function JO(n,e){return uM.apply(this,arguments)}function uM(){return uM=(0,K.Z)(function*(n,e){const t=Be(n);t.asyncQueue.verifyOperationInProgress(),xe("RemoteStore","RemoteStore received new credentials");const r=Lu(t);t.wu.add(3),yield xm(t),r&&t.yu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.wu.delete(3),yield VE(t)}),uM.apply(this,arguments)}function lM(n,e){return cM.apply(this,arguments)}function cM(){return cM=(0,K.Z)(function*(n,e){const t=Be(n);e?(t.wu.delete(2),yield VE(t)):e||(t.wu.add(2),yield xm(t),t.yu.set("Unknown"))}),cM.apply(this,arguments)}function Rm(n){return n.Iu||(n.Iu=function(e,t,r){const i=Be(e);return i.iu(),new WB(t,i.So,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:YB.bind(null,n),Zr:QB.bind(null,n),zo:JB.bind(null,n)}),n.mu.push(function(){var e=(0,K.Z)(function*(t){t?(n.Iu.Fo(),Jx(n)?Qx(n):n.yu.set("Unknown")):(yield n.Iu.stop(),KO(n))});return function(t){return e.apply(this,arguments)}}())),n.Iu}function Sc(n){return n.Tu||(n.Tu=function(e,t,r){const i=Be(e);return i.iu(),new GB(t,i.So,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:t2.bind(null,n),Zr:i2.bind(null,n),eu:n2.bind(null,n),tu:r2.bind(null,n)}),n.mu.push(function(){var e=(0,K.Z)(function*(t){t?(n.Tu.Fo(),yield Mm(n)):(yield n.Tu.stop(),n.du.length>0&&(xe("RemoteStore",`Stopping write stream with ${n.du.length} pending writes`),n.du=[]))});return function(t){return e.apply(this,arguments)}}())),n.Tu}class dM{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new qn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,h=new dM(e,t,l,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new be(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nm(n,e){if(Hn("AsyncQueue",`${e}: ${n}`),to(n))return new be(se.UNAVAILABLE,`${e}: ${n}`);throw n}class Pm{constructor(e){this.comparator=e?(t,r)=>e(t,r)||c.comparator(t.key,r.key):(t,r)=>c.comparator(t.key,r.key),this.keyedMap=wE(),this.sortedSet=new Kn(this.comparator)}static emptySet(e){return new Pm(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Pm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Pm;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class XO{constructor(){this.Eu=new Kn(c.comparator)}track(e){const t=e.doc.key,r=this.Eu.get(t);r?0!==e.type&&3===r.type?this.Eu=this.Eu.insert(t,e):3===e.type&&1!==r.type?this.Eu=this.Eu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Eu=this.Eu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Eu=this.Eu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Eu=this.Eu.remove(t):1===e.type&&2===r.type?this.Eu=this.Eu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Eu=this.Eu.insert(t,{type:2,doc:e.doc}):Ye():this.Eu=this.Eu.insert(t,e)}Au(){const e=[];return this.Eu.inorderTraversal((t,r)=>{e.push(r)}),e}}class km{constructor(e,t,r,i,a,l,h,m,v){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,r,i,a){const l=[];return t.forEach(h=>{l.push({type:0,doc:h})}),new km(e,t,Pm.emptySet(t),l,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class s2{constructor(){this.Ru=void 0,this.listeners=[]}}class o2{constructor(){this.queries=new bc(e=>Ek(e),yE),this.onlineState="Unknown",this.bu=new Set}}function hM(n,e){return fM.apply(this,arguments)}function fM(){return fM=(0,K.Z)(function*(n,e){const t=Be(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new s2),i)try{a.Ru=yield t.onListen(r)}catch(l){const h=Nm(l,`Initialization of query '${vx(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.Pu(t.onlineState),a.Ru&&e.vu(a.Ru)&&mM(t)}),fM.apply(this,arguments)}function pM(n,e){return gM.apply(this,arguments)}function gM(){return gM=(0,K.Z)(function*(n,e){const t=Be(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),gM.apply(this,arguments)}function a2(n,e){const t=Be(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const h of l.listeners)h.vu(i)&&(r=!0);l.Ru=i}}r&&mM(t)}function u2(n,e,t){const r=Be(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function mM(n){n.bu.forEach(e=>{e.next()})}class _M{constructor(e,t,r){this.query=e,this.Vu=t,this.Su=!1,this.Du=null,this.onlineState="Unknown",this.options=r||{}}vu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new km(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Su?this.Cu(e)&&(this.Vu.next(e),t=!0):this.xu(e,this.onlineState)&&(this.Nu(e),t=!0),this.Du=e,t}onError(e){this.Vu.error(e)}Pu(e){this.onlineState=e;let t=!1;return this.Du&&!this.Su&&this.xu(this.Du,e)&&(this.Nu(this.Du),t=!0),t}xu(e,t){return!e.fromCache||(!this.options.ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Cu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Du&&this.Du.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Nu(e){e=km.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Su=!0,this.Vu.next(e)}}class l2{constructor(e,t){this.payload=e,this.byteLength=t}Ou(){return"metadata"in this.payload}}class e1{constructor(e){this.It=e}Ji(e){return Pa(this.It,e)}Yi(e){return e.metadata.exists?Qk(this.It,e.document,!1):In.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return Ur(e)}}class c2{constructor(e,t,r){this.Mu=e,this.localStore=t,this.It=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=t1(e)}Fu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const r=s.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}$u(e){const t=new Map,r=new e1(this.It);for(const i of e)if(i.metadata.queries){const a=r.Ji(i.metadata.name);for(const l of i.metadata.queries){const h=(t.get(l)||Pt()).add(a);t.set(l,h)}}return t}complete(){var e=this;return(0,K.Z)(function*(){const t=yield function VB(n,e,t,r){return Bx.apply(this,arguments)}(e.localStore,new e1(e.It),e.documents,e.Mu.id),r=e.$u(e.documents);for(const i of e.queries)yield UB(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Bu:e.collectionGroups,Lu:t}})()}}function t1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class n1{constructor(e){this.key=e}}class r1{constructor(e){this.key=e}}class i1{constructor(e,t){this.query=e,this.Uu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Pt(),this.mutatedKeys=Pt(),this.Gu=Ik(e),this.Qu=new Pm(this.Gu)}get ju(){return this.Uu}Wu(e,t){const r=t?t.zu:new XO,i=t?t.Qu:this.Qu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,h=!1;const m="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,v="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((b,D)=>{const x=i.get(b),P=Ex(this.query,D)?D:null,G=!!x&&this.mutatedKeys.has(x.key),ue=!!P&&(P.hasLocalMutations||this.mutatedKeys.has(P.key)&&P.hasCommittedMutations);let Ee=!1;x&&P?x.data.isEqual(P.data)?G!==ue&&(r.track({type:3,doc:P}),Ee=!0):this.Hu(x,P)||(r.track({type:2,doc:P}),Ee=!0,(m&&this.Gu(P,m)>0||v&&this.Gu(P,v)<0)&&(h=!0)):!x&&P?(r.track({type:0,doc:P}),Ee=!0):x&&!P&&(r.track({type:1,doc:x}),Ee=!0,(m||v)&&(h=!0)),Ee&&(P?(l=l.add(P),a=ue?a.add(b):a.delete(b)):(l=l.delete(b),a=a.delete(b)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const b="F"===this.query.limitType?l.last():l.first();l=l.delete(b.key),a=a.delete(b.key),r.track({type:1,doc:b})}return{Qu:l,zu:r,$i:h,mutatedKeys:a}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const a=e.zu.Au();a.sort((v,b)=>function(D,x){const P=G=>{switch(G){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ye()}};return P(D)-P(x)}(v.type,b.type)||this.Gu(v.doc,b.doc)),this.Ju(r);const l=t?this.Yu():[],h=0===this.Ku.size&&this.current?1:0,m=h!==this.qu;return this.qu=h,0!==a.length||m?{snapshot:new km(this.query,e.Qu,i,a,e.mutatedKeys,0===h,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:l}:{Xu:l}}Pu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new XO,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.Uu=this.Uu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Uu=this.Uu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Pt(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const t=[];return e.forEach(r=>{this.Ku.has(r)||t.push(new r1(r))}),this.Ku.forEach(r=>{e.has(r)||t.push(new n1(r))}),t}tc(e){this.Uu=e.Hi,this.Ku=Pt();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return km.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class d2{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class h2{constructor(e){this.key=e,this.nc=!1}}class f2{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.sc={},this.ic=new bc(h=>Ek(h),yE),this.rc=new Map,this.oc=new Set,this.uc=new Kn(c.comparator),this.cc=new Map,this.ac=new Px,this.hc={},this.lc=new Map,this.fc=Zh.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function p2(n,e){return yM.apply(this,arguments)}function yM(){return yM=(0,K.Z)(function*(n,e){const t=jM(n);let r,i;const a=t.ic.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.ec();else{const l=yield Am(t.localStore,Pi(e));t.isPrimaryClient&&Xb(t.remoteStore,l);const h=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield vM(t,e,r,"current"===h,l.resumeToken)}return i}),yM.apply(this,arguments)}function vM(n,e,t,r,i){return EM.apply(this,arguments)}function EM(){return EM=(0,K.Z)(function*(n,e,t,r,i){n._c=(D,x,P)=>{return(G=(0,K.Z)(function*(ue,Ee,at,dt){let ht=Ee.view.Wu(at);ht.$i&&(ht=yield Zb(ue.localStore,Ee.query,!1).then(({documents:At})=>Ee.view.Wu(At,ht)));const ut=dt&&dt.targetChanges.get(Ee.targetId),ft=Ee.view.applyChanges(ht,ue.isPrimaryClient,ut);return MM(ue,Ee.targetId,ft.Xu),ft.snapshot}),function(ue,Ee,at,dt){return G.apply(this,arguments)})(n,D,x,P);var G};const a=yield Zb(n.localStore,e,!0),l=new i1(e,a.Hi),h=l.Wu(a.documents),m=bE.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),v=l.applyChanges(h,n.isPrimaryClient,m);MM(n,t,v.Xu);const b=new d2(e,t,l);return n.ic.set(e,b),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),v.snapshot}),EM.apply(this,arguments)}function g2(n,e){return wM.apply(this,arguments)}function wM(){return wM=(0,K.Z)(function*(n,e){const t=Be(n),r=t.ic.get(e),i=t.rc.get(r.targetId);if(i.length>1)return t.rc.set(r.targetId,i.filter(a=>!yE(a,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Sm(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),UE(t.remoteStore,r.targetId),Om(t,r.targetId)}).catch(qe))):(Om(t,r.targetId),yield Sm(t.localStore,r.targetId,!0))}),wM.apply(this,arguments)}function IM(){return IM=(0,K.Z)(function*(n,e,t){const r=$M(n);try{const i=yield function(a,l){const h=Be(a),m=xn.now(),v=l.reduce((x,P)=>x.add(P.key),Pt());let b,D;return h.persistence.runTransaction("Locally write mutations","readwrite",x=>{let P=Ji(),G=Pt();return h.Gi.getEntries(x,v).next(ue=>{P=ue,P.forEach((Ee,at)=>{at.isValidDocument()||(G=G.add(Ee))})}).next(()=>h.localDocuments.getOverlayedDocuments(x,P)).next(ue=>{b=ue;const Ee=[];for(const at of l){const dt=DU(at,b.get(at.key).overlayedDocument);null!=dt&&Ee.push(new Fu(at.key,dt,dk(dt.value.mapValue),kn.exists(!0)))}return h.mutationQueue.addMutationBatch(x,m,Ee,l)}).next(ue=>{D=ue;const Ee=ue.applyToLocalDocumentSet(b,G);return h.documentOverlayCache.saveOverlays(x,ue.batchId,Ee)})}).then(()=>({batchId:D.batchId,changes:Uk(b)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let m=a.hc[a.currentUser.toKey()];m||(m=new Kn(It)),m=m.insert(l,h),a.hc[a.currentUser.toKey()]=m}(r,i.batchId,t),yield Vu(r,i.changes),yield Mm(r.remoteStore)}catch(i){const a=Nm(i,"Failed to persist write");t.reject(a)}}),IM.apply(this,arguments)}function s1(n,e){return CM.apply(this,arguments)}function CM(){return CM=(0,K.Z)(function*(n,e){const t=Be(n);try{const r=yield FB(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.cc.get(a);l&&(pt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.nc=!0:i.modifiedDocuments.size>0?pt(l.nc):i.removedDocuments.size>0&&(pt(l.nc),l.nc=!1))}),yield Vu(t,r,e)}catch(r){yield qe(r)}}),CM.apply(this,arguments)}function o1(n,e,t){const r=Be(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ic.forEach((a,l)=>{const h=l.view.Pu(e);h.snapshot&&i.push(h.snapshot)}),function(a,l){const h=Be(a);h.onlineState=l;let m=!1;h.queries.forEach((v,b)=>{for(const D of b.listeners)D.Pu(l)&&(m=!0)}),m&&mM(h)}(r.eventManager,e),i.length&&r.sc.zo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function _2(n,e,t){return bM.apply(this,arguments)}function bM(){return bM=(0,K.Z)(function*(n,e,t){const r=Be(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.cc.get(e),a=i&&i.key;if(a){let l=new Kn(c.comparator);l=l.insert(a,In.newNoDocument(a,mt.min()));const h=Pt().add(a),m=new CE(mt.min(),new Map,new hn(It),l,h);yield s1(r,m),r.uc=r.uc.remove(a),r.cc.delete(e),RM(r)}else yield Sm(r.localStore,e,!1).then(()=>Om(r,e,t)).catch(qe)}),bM.apply(this,arguments)}function y2(n,e){return DM.apply(this,arguments)}function DM(){return DM=(0,K.Z)(function*(n,e){const t=Be(n),r=e.batch.batchId;try{const i=yield OB(t.localStore,e);xM(t,r,null),SM(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Vu(t,i)}catch(i){yield qe(i)}}),DM.apply(this,arguments)}function v2(n,e,t){return TM.apply(this,arguments)}function TM(){return TM=(0,K.Z)(function*(n,e,t){const r=Be(n);try{const i=yield function(a,l){const h=Be(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let v;return h.mutationQueue.lookupMutationBatch(m,l).next(b=>(pt(null!==b),v=b.keys(),h.mutationQueue.removeMutationBatch(m,b))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,v,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v)).next(()=>h.localDocuments.getDocuments(m,v))})}(r.localStore,e);xM(r,e,t),SM(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Vu(r,i)}catch(i){yield qe(i)}}),TM.apply(this,arguments)}function AM(){return AM=(0,K.Z)(function*(n,e){const t=Be(n);Lu(t.remoteStore)||xe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=Be(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.lc.get(r)||[];i.push(e),t.lc.set(r,i)}catch(r){const i=Nm(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),AM.apply(this,arguments)}function SM(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function xM(n,e,t){const r=Be(n);let i=r.hc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.hc[r.currentUser.toKey()]=i}}function Om(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.rc.get(e))n.ic.delete(r),t&&n.sc.wc(r,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(r=>{n.ac.containsKey(r)||a1(n,r)})}function a1(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);null!==t&&(UE(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),RM(n))}function MM(n,e,t){for(const r of t)r instanceof n1?(n.ac.addReference(r.key,e),w2(n,r)):r instanceof r1?(xe("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,e),n.ac.containsKey(r.key)||a1(n,r.key)):Ye()}function w2(n,e){const t=e.key,r=t.path.canonicalString();n.uc.get(t)||n.oc.has(r)||(xe("SyncEngine","New document in limbo: "+t),n.oc.add(r),RM(n))}function RM(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new c(s.fromString(e)),r=n.fc.next();n.cc.set(r,new h2(t)),n.uc=n.uc.insert(t,r),Xb(n.remoteStore,new Dc(Pi(_m(t.path)),r,2,Vr.at))}}function Vu(n,e,t){return NM.apply(this,arguments)}function NM(){return NM=(0,K.Z)(function*(n,e,t){const r=Be(n),i=[],a=[],l=[];var h;r.ic.isEmpty()||(r.ic.forEach((h,m)=>{l.push(r._c(m,e,t).then(v=>{if((v||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(m.targetId,(null==v?void 0:v.fromCache)?"not-current":"current"),v){i.push(v);const b=Lx.Ci(m.targetId,v);a.push(b)}}))}),yield Promise.all(l),r.sc.zo(i),yield(h=(0,K.Z)(function*(m,v){const b=Be(m);try{yield b.persistence.runTransaction("notifyLocalViewChanges","readwrite",D=>z.forEach(v,x=>z.forEach(x.Si,P=>b.persistence.referenceDelegate.addReference(D,x.targetId,P)).next(()=>z.forEach(x.Di,P=>b.persistence.referenceDelegate.removeReference(D,x.targetId,P)))))}catch(D){if(!to(D))throw D;xe("LocalStore","Failed to update sequence numbers: "+D)}for(const D of v){const x=D.targetId;if(!D.fromCache){const P=b.Ui.get(x),ue=P.withLastLimboFreeSnapshotVersion(P.snapshotVersion);b.Ui=b.Ui.insert(x,ue)}}}),function(m,v){return h.apply(this,arguments)})(r.localStore,a))}),NM.apply(this,arguments)}function I2(n,e){return PM.apply(this,arguments)}function PM(){return PM=(0,K.Z)(function*(n,e){const t=Be(n);if(!t.currentUser.isEqual(e)){xe("SyncEngine","User change. New user:",e.toKey());const r=yield OO(t.localStore,e);t.currentUser=e,(i=t).lc.forEach(l=>{l.forEach(h=>{h.reject(new be(se.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.lc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Vu(t,r.ji)}var i}),PM.apply(this,arguments)}function C2(n,e){const t=Be(n),r=t.cc.get(e);if(r&&r.nc)return Pt().add(r.key);{let i=Pt();const a=t.rc.get(e);if(!a)return i;for(const l of a){const h=t.ic.get(l);i=i.unionWith(h.view.ju)}return i}}function b2(n,e){return kM.apply(this,arguments)}function kM(){return kM=(0,K.Z)(function*(n,e){const t=Be(n),r=yield Zb(t.localStore,e.query,!0),i=e.view.tc(r);return t.isPrimaryClient&&MM(t,e.targetId,i.Xu),i}),kM.apply(this,arguments)}function D2(n,e){return OM.apply(this,arguments)}function OM(){return OM=(0,K.Z)(function*(n,e){const t=Be(n);return UO(t.localStore,e).then(r=>Vu(t,r))}),OM.apply(this,arguments)}function T2(n,e,t,r){return FM.apply(this,arguments)}function FM(){return FM=(0,K.Z)(function*(n,e,t,r){const i=Be(n),a=yield function(l,h){const m=Be(l),v=Be(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",b=>v.Tn(b,h).next(D=>D?m.localDocuments.getDocuments(b,D):z.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield Mm(i.remoteStore):"acknowledged"===t||"rejected"===t?(xM(i,e,r||null),SM(i,e),h=e,Be(Be(i.localStore).mutationQueue).An(h)):Ye(),yield Vu(i,a)):xe("SyncEngine","Cannot apply mutation batch with id: "+e)}),FM.apply(this,arguments)}function LM(){return LM=(0,K.Z)(function*(n,e){const t=Be(n);if(jM(t),$M(t),!0===e&&!0!==t.dc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield u1(t,r.toArray());t.dc=!0,yield lM(t.remoteStore,!0);for(const a of i)Xb(t.remoteStore,a)}else if(!1===e&&!1!==t.dc){const r=[];let i=Promise.resolve();t.rc.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(Om(t,l),Sm(t.localStore,l,!0))),UE(t.remoteStore,l)}),yield i,yield u1(t,r),function(a){const l=Be(a);l.cc.forEach((h,m)=>{UE(l.remoteStore,m)}),l.ac.fs(),l.cc=new Map,l.uc=new Kn(c.comparator)}(t),t.dc=!1,yield lM(t.remoteStore,!1)}}),LM.apply(this,arguments)}function u1(n,e,t){return VM.apply(this,arguments)}function VM(){return VM=(0,K.Z)(function*(n,e,t){const r=Be(n),i=[],a=[];for(const l of e){let h;const m=r.rc.get(l);if(m&&0!==m.length){h=yield Am(r.localStore,Pi(m[0]));for(const v of m){const b=r.ic.get(v),D=yield b2(r,b);D.snapshot&&a.push(D.snapshot)}}else{const v=yield VO(r.localStore,l);h=yield Am(r.localStore,v),yield vM(r,l1(v),l,!1,h.resumeToken)}i.push(h)}return r.sc.zo(a),i}),VM.apply(this,arguments)}function l1(n){return yk(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function S2(n){const e=Be(n);return Be(Be(e.localStore).persistence).vi()}function x2(n,e,t,r){return UM.apply(this,arguments)}function UM(){return UM=(0,K.Z)(function*(n,e,t,r){const i=Be(n);if(i.dc)return void xe("SyncEngine","Ignoring unexpected query state notification.");const a=i.rc.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield UO(i.localStore,wk(a[0])),h=CE.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Dr.EMPTY_BYTE_STRING);yield Vu(i,l,h);break}case"rejected":yield Sm(i.localStore,e,!0),Om(i,e,r);break;default:Ye()}}),UM.apply(this,arguments)}function M2(n,e,t){return BM.apply(this,arguments)}function BM(){return BM=(0,K.Z)(function*(n,e,t){const r=jM(n);if(r.dc){for(const i of e){if(r.rc.has(i)){xe("SyncEngine","Adding an already active target "+i);continue}const a=yield VO(r.localStore,i),l=yield Am(r.localStore,a);yield vM(r,l1(a),l.targetId,!1,l.resumeToken),Xb(r.remoteStore,l)}for(const i of t)r.rc.has(i)&&(yield Sm(r.localStore,i,!1).then(()=>{UE(r.remoteStore,i),Om(r,i)}).catch(qe))}}),BM.apply(this,arguments)}function jM(n){const e=Be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=s1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=C2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_2.bind(null,e),e.sc.zo=a2.bind(null,e.eventManager),e.sc.wc=u2.bind(null,e.eventManager),e}function $M(n){const e=Be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=y2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=v2.bind(null,e),e}class c1{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,K.Z)(function*(){t.It=LE(e.databaseInfo.databaseId),t.sharedClientState=t.gc(e),t.persistence=t.yc(e),yield t.persistence.start(),t.localStore=t.Ic(e),t.gcScheduler=t.Tc(e,t.localStore),t.indexBackfillerScheduler=t.Ec(e,t.localStore)})()}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return kO(this.persistence,new PO,e.initialUser,this.It)}yc(e){return new RO(qb.Bs,this.It)}gc(e){return new HO}terminate(){var e=this;return(0,K.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class d1 extends c1{constructor(e,t,r){super(),this.Ac=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,K.Z)(function*(){yield t().call(r,e),yield r.Ac.initialize(r,e),yield $M(r.Ac.syncEngine),yield Mm(r.Ac.remoteStore),yield r.persistence.li(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ic(e){return kO(this.persistence,new PO,e.initialUser,this.It)}Tc(e,t){return new EB(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Ec(e,t){const r=new cE(t,this.persistence);return new lE(e.asyncQueue,r)}yc(e){const t=Fx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Xi.withCacheSize(this.cacheSizeBytes):Xi.DEFAULT;return new Ox(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,GO(),Jb(),this.It,this.sharedClientState,!!this.forceOwnership)}gc(e){return new HO}}class N2 extends d1{constructor(e,t){super(e,t,!1),this.Ac=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,K.Z)(function*(){yield t().call(r,e);const i=r.Ac.syncEngine;r.sharedClientState instanceof Gx&&(r.sharedClientState.syncEngine={Fr:T2.bind(null,i),$r:x2.bind(null,i),Br:M2.bind(null,i),vi:S2.bind(null,i),Mr:D2.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.li(function(){var a=(0,K.Z)(function*(l){yield function A2(n,e){return LM.apply(this,arguments)}(r.Ac.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}gc(e){const t=GO();if(!Gx.C(t))throw new be(se.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Fx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Gx(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class HM{initialize(e,t){var r=this;return(0,K.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>o1(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=I2.bind(null,r.syncEngine),yield lM(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new o2}createDatastore(e){const t=LE(e.databaseInfo.databaseId),r=new HB(e.databaseInfo);return new zB(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>o1(this.syncEngine,h,0),l=WO.C()?new WO:new BB,new ZB(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,h,m,v){const b=new f2(r,i,a,l,h,m);return v&&(b.dc=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,K.Z)(function*(t){const r=Be(t);xe("RemoteStore","RemoteStore shutting down."),r.wu.add(5),yield xm(r),r.gu.shutdown(),r.yu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function WM(n,e,t){if(!t)throw new be(se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function h1(n,e,t,r){if(!0===e&&!0===r)throw new be(se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function f1(n){if(!c.isDocumentKey(n))throw new be(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function p1(n){if(c.isDocumentKey(n))throw new be(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function tD(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":Ye()}function Gt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new be(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tD(n);throw new be(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function g1(n,e){if(e<=0)throw new be(se.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}const m1=new Map;class _1{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new be(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new be(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,h1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class BE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _1({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new be(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new be(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _1(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new ux;switch(t.type){case"gapi":return new cx(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new be(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=m1.get(e);t&&(xe("ComponentProvider","Removing Datastore"),m1.delete(e),t.terminate())}(this),Promise.resolve()}}function y1(n,e,t,r={}){var i;const a=(n=Gt(n,BE))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&Ma("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,h;if("string"==typeof r.mockUserToken)l=r.mockUserToken,h=br.MOCK_USER;else{l=(0,W.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new be(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new br(m)}n._authCredentials=new lx(new cm(l,h))}}class Mn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Oa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mn(this.firestore,e,this._key)}}class yi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new yi(this.firestore,e,this._query)}}class Oa extends yi{constructor(e,t,r){super(e,t,_m(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mn(this.firestore,null,new c(e))}withConverter(e){return new Oa(this.firestore,e,this._path)}}function v1(n,e,...t){if(n=(0,W.m9)(n),WM("collection","path",e),n instanceof BE){const r=s.fromString(e,...t);return p1(r),new Oa(n,null,r)}{if(!(n instanceof Mn||n instanceof Oa))throw new be(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(s.fromString(e,...t));return p1(r),new Oa(n.firestore,null,r)}}function nD(n,e,...t){if(n=(0,W.m9)(n),1===arguments.length&&(e=dx.R()),WM("doc","path",e),n instanceof BE){const r=s.fromString(e,...t);return f1(r),new Mn(n,null,new c(r))}{if(!(n instanceof Mn||n instanceof Oa))throw new be(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(s.fromString(e,...t));return f1(r),new Mn(n.firestore,n instanceof Oa?n.converter:null,new c(r))}}function E1(n,e){return n=(0,W.m9)(n),e=(0,W.m9)(e),(n instanceof Mn||n instanceof Oa)&&(e instanceof Mn||e instanceof Oa)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function GM(n,e){return n=(0,W.m9)(n),e=(0,W.m9)(e),n instanceof yi&&e instanceof yi&&n.firestore===e.firestore&&yE(n._query,e._query)&&n.converter===e.converter}function w1(n,e=10240){let t=0;return{read:()=>(0,K.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,K.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class rD{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Hn("Uncaught Error in snapshot listener:",e)}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class k2{constructor(e,t){this.Pc=e,this.It=t,this.metadata=new qn,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(r=>{r&&r.Ou()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==r?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Pc.cancel()}getMetadata(){var e=this;return(0,K.Z)(function*(){return e.metadata.promise})()}mc(){var e=this;return(0,K.Z)(function*(){return yield e.getMetadata(),e.Vc()})()}Vc(){var e=this;return(0,K.Z)(function*(){const t=yield e.Sc();if(null===t)return null;const r=e.vc.decode(t),i=Number(r);isNaN(i)&&e.Dc(`length string (${r}) is not valid number`);const a=yield e.Cc(i);return new l2(JSON.parse(a),t.length+i)})()}xc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Sc(){var e=this;return(0,K.Z)(function*(){for(;e.xc()<0&&!(yield e.Nc()););if(0===e.buffer.length)return null;const t=e.xc();t<0&&e.Dc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Cc(e){var t=this;return(0,K.Z)(function*(){for(;t.buffer.length<e;)(yield t.Nc())&&t.Dc("Reached the end of bundle when more is expected.");const r=t.vc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Dc(e){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${e}`)}Nc(){var e=this;return(0,K.Z)(function*(){const t=yield e.Pc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class L2{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,K.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new be(se.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,K.Z)(function*(a,l){const h=Be(a),m=AE(h.It)+"/documents",v={documents:l.map(P=>TE(h.It,P))},b=yield h._o("BatchGetDocuments",m,v,l.length),D=new Map;b.forEach(P=>{const G=function FU(n,e){return"found"in e?function(t,r){pt(!!r.found);const i=Pa(t,r.found.name),a=Ur(r.found.updateTime),l=new ai({mapValue:{fields:r.found.fields}});return In.newFoundDocument(i,a,l)}(n,e):"missing"in e?function(t,r){pt(!!r.missing),pt(!!r.readTime);const i=Pa(t,r.missing),a=Ur(r.readTime);return In.newNoDocument(i,a)}(n,e):Ye()}(h.It,P);D.set(G.key.toString(),G)});const x=[];return l.forEach(P=>{const G=D.get(P.toString());pt(!!G),x.push(G)}),x}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Im(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,K.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=c.fromPath(i);e.mutations.push(new wx(a,e.precondition(a)))}),yield(r=(0,K.Z)(function*(i,a){const l=Be(i),h=AE(l.It)+"/documents",m={writes:a.map(v=>SE(l.It,v))};yield l.ao("Commit",h,m)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ye();t=mt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new be(se.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(mt.min())?kn.exists(!1):kn.updateTime(t):kn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(mt.min()))throw new be(se.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return kn.updateTime(t)}return kn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class V2{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.kc=r.maxAttempts,this.No=new zx(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){var e=this;this.No.Ro((0,K.Z)(function*(){const t=new L2(e.datastore),r=e.Mc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Fc(a)}))}).catch(i=>{e.Fc(i)})}))}Mc(e){try{const t=this.updateFunction(e);return!hE(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Fc(e){this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(e)}$c(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!Fk(t)}return!1}}class U2{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=br.UNAUTHENTICATED,this.clientId=dx.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,K.Z)(function*(h){xe("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(xe("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,K.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new be(se.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new qn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,K.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Nm(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function I1(n,e){return zM.apply(this,arguments)}function zM(){return zM=(0,K.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),xe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,K.Z)(function*(a){r.isEqual(a)||(yield OO(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),zM.apply(this,arguments)}function C1(n,e){return qM.apply(this,arguments)}function qM(){return qM=(0,K.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield KM(n);xe("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>JO(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>JO(e.remoteStore,a)),n.onlineComponents=e}),qM.apply(this,arguments)}function KM(n){return ZM.apply(this,arguments)}function ZM(){return ZM=(0,K.Z)(function*(n){return n.offlineComponents||(xe("FirestoreClient","Using default OfflineComponentProvider"),yield I1(n,new c1)),n.offlineComponents}),ZM.apply(this,arguments)}function iD(n){return YM.apply(this,arguments)}function YM(){return YM=(0,K.Z)(function*(n){return n.onlineComponents||(xe("FirestoreClient","Using default OnlineComponentProvider"),yield C1(n,new HM)),n.onlineComponents}),YM.apply(this,arguments)}function b1(n){return KM(n).then(e=>e.persistence)}function sD(n){return KM(n).then(e=>e.localStore)}function QM(n){return iD(n).then(e=>e.remoteStore)}function JM(n){return iD(n).then(e=>e.syncEngine)}function Fm(n){return XM.apply(this,arguments)}function XM(){return XM=(0,K.Z)(function*(n){const e=yield iD(n),t=e.eventManager;return t.onListen=p2.bind(null,e.syncEngine),t.onUnlisten=g2.bind(null,e.syncEngine),t}),XM.apply(this,arguments)}function T1(n,e,t={}){const r=new qn;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function(i,a,l,h,m){const v=new rD({next:D=>{a.enqueueAndForget(()=>pM(i,b));const x=D.docs.has(l);!x&&D.fromCache?m.reject(new be(se.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&D.fromCache&&h&&"server"===h.source?m.reject(new be(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(D)},error:D=>m.reject(D)}),b=new _M(_m(l.path),v,{includeMetadataChanges:!0,ku:!0});return hM(i,b)}(yield Fm(n),n.asyncQueue,e,t,r)})),r.promise}function A1(n,e,t={}){const r=new qn;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function(i,a,l,h,m){const v=new rD({next:D=>{a.enqueueAndForget(()=>pM(i,b)),D.fromCache&&"server"===h.source?m.reject(new be(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(D)},error:D=>m.reject(D)}),b=new _M(l,v,{includeMetadataChanges:!0,ku:!0});return hM(i,b)}(yield Fm(n),n.asyncQueue,e,t,r)})),r.promise}class q2{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.No=new zx(this,"async_queue_retry"),this.Wc=()=>{const t=Jb();t&&xe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.No.Po()};const e=Jb();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;const t=Jb();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.Uc)return new Promise(()=>{});const t=new qn;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}Jc(){var e=this;return(0,K.Z)(function*(){if(0!==e.Lc.length){try{yield e.Lc[0](),e.Lc.shift(),e.No.reset()}catch(t){if(!to(t))throw t;xe("AsyncQueue","Operation failed with retryable error: "+t)}e.Lc.length>0&&e.No.Ro(()=>e.Jc())}})()}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(r=>{throw this.Kc=r,this.Gc=!1,Hn("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=t,t}enqueueAfterDelay(e,t,r){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const i=dM.createAndSchedule(this,e,t,r,a=>this.Yc(a));return this.qc.push(i),i}zc(){this.Kc&&Ye()}verifyOperationInProgress(){}Xc(){var e=this;return(0,K.Z)(function*(){let t;do{t=e.Bc,yield t}while(t!==e.Bc)})()}Zc(e){for(const t of this.qc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.qc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.qc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.qc.indexOf(e);this.qc.splice(t,1)}}function eR(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class K2{constructor(){this._progressObserver={},this._taskCompletionResolver=new qn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Rn extends BE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new q2,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||S1(this),this._firestoreClient.terminate()}}function Y2(n,e){const t="object"==typeof n?n:(0,bt.getApp)(),r="string"==typeof n?n:e||"(default)",i=(0,bt._getProvider)(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const a=(0,W.P0)("firestore");a&&y1(i,...a)}return i}function sr(n){return n._firestoreClient||S1(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function S1(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new oU(n._databaseId,a,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var a,h;n._firestoreClient=new U2(n._authCredentials,n._appCheckCredentials,n._queue,r)}function x1(n,e,t){const r=new qn;return n.asyncQueue.enqueue((0,K.Z)(function*(){try{yield I1(n,t),yield C1(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===se.FAILED_PRECONDITION||l.code===se.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;Ma("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function M1(n){if(n._initialized||n._terminated)throw new be(se.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Fa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fa(Dr.fromBase64String(e))}catch(t){throw new be(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fa(Dr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Uu{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new be(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new u(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Qh{constructor(e){this._methodName=e}}class oD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new be(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new be(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return It(this._lat,e._lat)||It(this._long,e._long)}}const sj=/^__.*__$/;class oj{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Fu(e,this.data,this.fieldMask,t,this.fieldTransforms):new wm(e,this.data,t,this.fieldTransforms)}}class R1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Fu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function N1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ye()}}class aD{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.It=r,this.ignoreUndefinedProperties=i,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new aD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.ua(e),i}ca(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.na(),i}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return cD(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(N1(this.sa)&&sj.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class aj{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=r||LE(e)}da(e,t,r,i=!1){return new aD({sa:e,methodName:t,fa:r,path:u.emptyPath(),oa:!1,la:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Jh(n){const e=n._freezeSettings(),t=LE(n._databaseId);return new aj(n._databaseId,!!e.ignoreUndefinedProperties,t)}function uD(n,e,t,r,i,a={}){const l=n.da(a.merge||a.mergeFields?2:0,e,t,i);iR("Data must be an object, but it was:",l,r);const h=O1(r,l);let m,v;if(a.merge)m=new Ts(l.fieldMask),v=l.fieldTransforms;else if(a.mergeFields){const b=[];for(const D of a.mergeFields){const x=sR(e,D,t);if(!l.contains(x))throw new be(se.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);L1(b,x)||b.push(x)}m=new Ts(b),v=l.fieldTransforms.filter(D=>m.covers(D.field))}else m=null,v=l.fieldTransforms;return new oj(new ai(h),m,v)}class jE extends Qh{_toFieldTransform(e){if(2!==e.sa)throw e.ha(1===e.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jE}}function P1(n,e,t){return new aD({sa:3,fa:e.settings.fa,methodName:n._methodName,oa:t},e.databaseId,e.It,e.ignoreUndefinedProperties)}class tR extends Qh{_toFieldTransform(e){return new vE(e.path,new vm)}isEqual(e){return e instanceof tR}}class uj extends Qh{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=P1(this,e,!0),r=this._a.map(a=>Xh(a,t)),i=new jh(r);return new vE(e.path,i)}isEqual(e){return this===e}}class lj extends Qh{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=P1(this,e,!0),r=this._a.map(a=>Xh(a,t)),i=new $h(r);return new vE(e.path,i)}isEqual(e){return this===e}}class cj extends Qh{constructor(e,t){super(e),this.wa=t}_toFieldTransform(e){const t=new Em(e.It,Dk(e.It,this.wa));return new vE(e.path,t)}isEqual(e){return this===e}}function nR(n,e,t,r){const i=n.da(1,e,t);iR("Data must be an object, but it was:",i,r);const a=[],l=ai.empty();Fh(r,(m,v)=>{const b=lD(e,m,t);v=(0,W.m9)(v);const D=i.ca(b);if(v instanceof jE)a.push(b);else{const x=Xh(v,D);null!=x&&(a.push(b),l.set(b,x))}});const h=new Ts(a);return new R1(l,h,i.fieldTransforms)}function rR(n,e,t,r,i,a){const l=n.da(1,e,t),h=[sR(e,r,t)],m=[i];if(a.length%2!=0)throw new be(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)h.push(sR(e,a[x])),m.push(a[x+1]);const v=[],b=ai.empty();for(let x=h.length-1;x>=0;--x)if(!L1(v,h[x])){const P=h[x];let G=m[x];G=(0,W.m9)(G);const ue=l.ca(P);if(G instanceof jE)v.push(P);else{const Ee=Xh(G,ue);null!=Ee&&(v.push(P),b.set(P,Ee))}}const D=new Ts(v);return new R1(b,D,l.fieldTransforms)}function k1(n,e,t,r=!1){return Xh(t,n.da(r?4:3,e))}function Xh(n,e){if(F1(n=(0,W.m9)(n)))return iR("Unsupported field value:",e,n),O1(n,e);if(n instanceof Qh)return function(t,r){if(!N1(r.sa))throw r.ha(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let h=Xh(l,r.aa(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,W.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Dk(r.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=xn.fromDate(t);return{timestampValue:DE(r.It,i)}}if(t instanceof xn){const i=new xn(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:DE(r.It,i)}}if(t instanceof oD)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fa)return{bytesValue:zk(r.It,t._byteString)};if(t instanceof Mn){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.ha(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ix(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.ha(`Unsupported field value: ${tD(t)}`)}(n,e)}function O1(n,e){const t={};return tk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fh(n,(r,i)=>{const a=Xh(i,e.ra(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function F1(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof xn||n instanceof oD||n instanceof Fa||n instanceof Mn||n instanceof Qh)}function iR(n,e,t){if(!F1(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=tD(t);throw e.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function sR(n,e,t){if((e=(0,W.m9)(e))instanceof Uu)return e._internalPath;if("string"==typeof e)return lD(n,e);throw cD("Field path arguments must be of type string or ",n,!1,void 0,t)}const dj=new RegExp("[~\\*/\\[\\]]");function lD(n,e,t){if(e.search(dj)>=0)throw cD(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Uu(...e.split("."))._internalPath}catch(r){throw cD(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function cD(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(a||l)&&(m+=" (found",a&&(m+=` in field ${r}`),l&&(m+=` in document ${i}`),m+=")"),new be(se.INVALID_ARGUMENT,h+n+m)}function L1(n,e){return n.some(t=>t.isEqual(e))}class $E{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Mn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new hj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(dD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class hj extends $E{data(){return super.data()}}function dD(n,e){return"string"==typeof e?lD(n,e):e instanceof Uu?e._internalPath:e._delegate._internalPath}function V1(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new be(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class HE{}function xc(n,...e){for(const t of e)n=t._apply(n);return n}class fj extends HE{constructor(e,t,r){super(),this.ma=e,this.ga=t,this.ya=r,this.type="where"}_apply(e){const t=Jh(e.firestore),r=function(i,a,l,h,m,v,b){let D;if(m.isKeyField()){if("array-contains"===v||"array-contains-any"===v)throw new be(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if("in"===v||"not-in"===v){W1(b,v);const P=[];for(const G of b)P.push(H1(h,i,G));D={arrayValue:{values:P}}}else D=H1(h,i,b)}else"in"!==v&&"not-in"!==v&&"array-contains-any"!==v||W1(b,v),D=k1(l,"where",b,"in"===v||"not-in"===v);const x=ui.create(m,v,D);return function(P,G){if(G.dt()){const Ee=_x(P);if(null!==Ee&&!Ee.isEqual(G.field))throw new be(se.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Ee.toString()}' and '${G.field.toString()}'`);const at=mx(P);null!==at&&G1(0,G.field,at)}const ue=function(Ee,at){for(const dt of Ee.filters)if(at.indexOf(dt.op)>=0)return dt.op;return null}(P,function(Ee){switch(Ee){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(G.op));if(null!==ue)throw new be(se.INVALID_ARGUMENT,ue===G.op?`Invalid query. You cannot use more than one '${G.op.toString()}' filter.`:`Invalid query. You cannot use '${G.op.toString()}' filters with '${ue.toString()}' filters.`)}(i,x),x}(e._query,0,t,e.firestore._databaseId,this.ma,this.ga,this.ya);return new yi(e.firestore,e.converter,function(i,a){const l=i.filters.concat([a]);return new Ou(i.path,i.collectionGroup,i.explicitOrderBy.slice(),l,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class gj extends HE{constructor(e,t){super(),this.ma=e,this.pa=t,this.type="orderBy"}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new be(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new be(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new mm(i,a);return function(h,m){if(null===mx(h)){const v=_x(h);null!==v&&G1(0,v,m.field)}}(r,l),l}(e._query,this.ma,this.pa);return new yi(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Ou(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class U1 extends HE{constructor(e,t,r){super(),this.type=e,this.Ia=t,this.Ta=r}_apply(e){return new yi(e.firestore,e.converter,Pb(e._query,this.Ia,this.Ta))}}class B1 extends HE{constructor(e,t,r){super(),this.type=e,this.Ea=t,this.Aa=r}_apply(e){const t=$1(e,this.type,this.Ea,this.Aa);return new yi(e.firestore,e.converter,(i=t,new Ou((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class j1 extends HE{constructor(e,t,r){super(),this.type=e,this.Ea=t,this.Aa=r}_apply(e){const t=$1(e,this.type,this.Ea,this.Aa);return new yi(e.firestore,e.converter,(i=t,new Ou((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function $1(n,e,t,r){if(t[0]=(0,W.m9)(t[0]),t[0]instanceof $E)return function(i,a,l,h,m){if(!h)throw new be(se.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const v=[];for(const b of ym(i))if(b.field.isKeyField())v.push(Uh(a,h.key));else{const D=h.data.field(b.field);if(fx(D))throw new be(se.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+b.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===D){const x=b.field.canonicalString();throw new be(se.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}v.push(D)}return new Cc(v,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Jh(n.firestore);return function(a,l,h,m,v,b){const D=a.explicitOrderBy;if(v.length>D.length)throw new be(se.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let P=0;P<v.length;P++){const G=v[P];if(D[P].field.isKeyField()){if("string"!=typeof G)throw new be(se.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof G}`);if(!yx(a)&&-1!==G.indexOf("/"))throw new be(se.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${G}' contains a slash.`);const ue=a.path.child(s.fromString(G));if(!c.isDocumentKey(ue))throw new be(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${ue}' is not because it contains an odd number of segments.`);const Ee=new c(ue);x.push(Uh(l,Ee))}else{const ue=k1(h,m,G);x.push(ue)}}return new Cc(x,b)}(n._query,n.firestore._databaseId,i,e,t,r)}}function H1(n,e,t){if("string"==typeof(t=(0,W.m9)(t))){if(""===t)throw new be(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yx(e)&&-1!==t.indexOf("/"))throw new be(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(s.fromString(t));if(!c.isDocumentKey(r))throw new be(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Uh(n,new c(r))}if(t instanceof Mn)return Uh(n,t._key);throw new be(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tD(t)}.`)}function W1(n,e){if(!Array.isArray(n)||0===n.length)throw new be(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new be(se.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function G1(n,e,t){if(!t.isEqual(e))throw new be(se.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class oR{convertValue(e,t="none"){switch(Vh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Zn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Lh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ye()}}convertObject(e,t){const r={};return Fh(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new oD(Zn(e.latitude),Zn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=rk(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(dE(e));default:return null}}convertTimestamp(e){const t=vc(e);return new xn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=s.fromString(e);pt(tO(r));const i=new Ec(r.get(1),r.get(3)),a=new c(r.popFirst(5));return i.isEqual(t)||Hn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function hD(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Cj extends oR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mn(this.firestore,null,t)}}class ef{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bu extends $E{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new WE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(dD("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class WE extends Bu{data(e={}){return super.data(e)}}class Mc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ef(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new WE(this._firestore,this._userDataWriter,r.key,r,new ef(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new be(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new WE(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ef(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const h=new WE(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ef(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,v=-1;return 0!==l.type&&(m=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),v=a.indexOf(l.doc.key)),{type:bj(l.type),doc:h,oldIndex:m,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function bj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ye()}}function z1(n,e){return n instanceof Bu&&e instanceof Bu?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Mc&&e instanceof Mc&&n._firestore===e._firestore&&GM(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Rc extends oR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mn(this.firestore,null,t)}}function q1(n,e,t){n=Gt(n,Mn);const r=Gt(n.firestore,Rn),i=hD(n.converter,e,t);return Lm(r,[uD(Jh(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,kn.none())])}function K1(n,e,t,...r){n=Gt(n,Mn);const i=Gt(n.firestore,Rn),a=Jh(i);let l;return l="string"==typeof(e=(0,W.m9)(e))||e instanceof Uu?rR(a,"updateDoc",n._key,e,t,r):nR(a,"updateDoc",n._key,e),Lm(i,[l.toMutation(n._key,kn.exists(!0))])}function Z1(n,...e){var t,r,i;n=(0,W.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||eR(e[l])||(a=e[l],l++);const h={includeMetadataChanges:a.includeMetadataChanges};if(eR(e[l])){const D=e[l];e[l]=null===(t=D.next)||void 0===t?void 0:t.bind(D),e[l+1]=null===(r=D.error)||void 0===r?void 0:r.bind(D),e[l+2]=null===(i=D.complete)||void 0===i?void 0:i.bind(D)}let m,v,b;if(n instanceof Mn)v=Gt(n.firestore,Rn),b=_m(n._key.path),m={next:D=>{e[l]&&e[l](aR(v,n,D))},error:e[l+1],complete:e[l+2]};else{const D=Gt(n,yi);v=Gt(D.firestore,Rn),b=D._query;const x=new Rc(v);m={next:P=>{e[l]&&e[l](new Mc(v,x,D,P))},error:e[l+1],complete:e[l+2]},V1(n._query)}return function(D,x,P,G){const ue=new rD(G),Ee=new _M(x,ue,P);return D.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return hM(yield Fm(D),Ee)})),()=>{ue.bc(),D.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return pM(yield Fm(D),Ee)}))}}(sr(v),b,h,m)}function Lm(n,e){return function(t,r){const i=new qn;return t.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function m2(n,e,t){return IM.apply(this,arguments)}(yield JM(t),r,i)})),i.promise}(sr(n),e)}function aR(n,e,t){const r=t.docs.get(e._key),i=new Rc(n);return new Bu(n,i,e._key,r,new ef(t.hasPendingWrites,t.fromCache),e.converter)}const kj={maxAttempts:5};class Y1{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Jh(e)}set(e,t,r){this._verifyNotCommitted();const i=Nc(e,this._firestore),a=hD(i.converter,t,r),l=uD(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,kn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Nc(e,this._firestore);let l;return l="string"==typeof(t=(0,W.m9)(t))||t instanceof Uu?rR(this._dataReader,"WriteBatch.update",a._key,t,r,i):nR(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Nc(e,this._firestore);return this._mutations=this._mutations.concat(new Im(t._key,kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new be(se.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Nc(n,e){if((n=(0,W.m9)(n)).firestore!==e)throw new be(se.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class Oj extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Jh(e)}get(e){const t=Nc(e,this._firestore),r=new Cj(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return Ye();const a=i[0];if(a.isFoundDocument())return new $E(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new $E(this._firestore,r,t._key,null,t.converter);throw Ye()})}set(e,t,r){const i=Nc(e,this._firestore),a=hD(i.converter,t,r),l=uD(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=Nc(e,this._firestore);let l;return l="string"==typeof(t=(0,W.m9)(t))||t instanceof Uu?rR(this._dataReader,"Transaction.update",a._key,t,r,i):nR(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Nc(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Nc(e,this._firestore),r=new Rc(this._firestore);return super.get(e).then(i=>new Bu(this._firestore,r,t._key,i._document,new ef(!1,!1),t.converter))}}function uR(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new be("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function J1(){if("undefined"==typeof Uint8Array)throw new be("unimplemented","Uint8Arrays are not available in this environment.")}function X1(){if(!function iU(){return"undefined"!=typeof atob}())throw new be("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){kh=bt.SDK_VERSION,(0,bt._registerComponent)(new Is.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),l=new Rn(new QP(t.getProvider("auth-internal")),new XP(t.getProvider("app-check-internal")),function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new be(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ec(h.options.projectId,m)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),(0,bt.registerVersion)(sx,"3.7.1",n),(0,bt.registerVersion)(sx,"3.7.1","esm2017")}();class GE{constructor(e){this._delegate=e}static fromBase64String(e){return X1(),new GE(Fa.fromBase64String(e))}static fromUint8Array(e){return J1(),new GE(Fa.fromUint8Array(e))}toBase64(){return X1(),this._delegate.toBase64()}toUint8Array(){return J1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function lR(n){return function Wj(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class Gj{enableIndexedDbPersistence(e,t){return function Q2(n,e){M1(n=Gt(n,Rn));const t=sr(n),r=n._freezeSettings(),i=new HM;return x1(t,i,new d1(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function J2(n){M1(n=Gt(n,Rn));const e=sr(n),t=n._freezeSettings(),r=new HM;return x1(e,r,new N2(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function X2(n){if(n._initialized&&!n._terminated)throw new be(se.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new qn;return n._queue.enqueueAndForgetEvenWhileRestricted((0,K.Z)(function*(){try{yield(t=(0,K.Z)(function*(r){if(!Nt.C())return Promise.resolve();const i=r+"main";yield Nt.delete(i)}),function(r){return t.apply(this,arguments)})(Fx(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class eF{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ec||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ma("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){y1(this._delegate,e,t,r)}enableNetwork(){return function tj(n){return function B2(n){return n.asyncQueue.enqueue((0,K.Z)(function*(){const e=yield b1(n),t=yield QM(n);return e.setNetworkEnabled(!0),function(r){const i=Be(r);return i.wu.delete(0),VE(i)}(t)}))}(sr(n=Gt(n,Rn)))}(this._delegate)}disableNetwork(){return function nj(n){return function j2(n){return n.asyncQueue.enqueue((0,K.Z)(function*(){const e=yield b1(n),t=yield QM(n);return e.setNetworkEnabled(!1),(r=(0,K.Z)(function*(i){const a=Be(i);a.wu.add(0),yield xm(a),a.yu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(sr(n=Gt(n,Rn)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,h1("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function ej(n){return function(e){const t=new qn;return e.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return function E2(n,e){return AM.apply(this,arguments)}(yield JM(e),t)})),t.promise}(sr(n=Gt(n,Rn)))}(this._delegate)}onSnapshotsInSync(e){return function Pj(n,e){return function W2(n,e){const t=new rD(e);return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return r=yield Fm(n),i=t,Be(r).bu.add(i),void i.next();var r,i})),()=>{t.bc(),n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return r=yield Fm(n),i=t,void Be(r).bu.delete(i);var r,i}))}}(sr(n=Gt(n,Rn)),eR(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new be("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Vm(this,v1(this._delegate,e))}catch(t){throw Oi(t,"collection()","Firestore.collection()")}}doc(e){try{return new no(this,nD(this._delegate,e))}catch(t){throw Oi(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Fi(this,function P2(n,e){if(n=Gt(n,BE),WM("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new be(se.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new yi(n,null,(t=e,new Ou(s.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Oi(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function Fj(n,e,t){n=Gt(n,Rn);const r=Object.assign(Object.assign({},kj),t);return function(i){if(i.maxAttempts<1)throw new be(se.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,l){const h=new qn;return i.asyncQueue.enqueueAndForget((0,K.Z)(function*(){const m=yield function D1(n){return iD(n).then(e=>e.datastore)}(i);new V2(i.asyncQueue,m,l,a,h).run()})),h.promise}(sr(n),i=>e(new Oj(n,i)),r)}(this._delegate,t=>e(new tF(this,t)))}batch(){return sr(this._delegate),new nF(new Y1(this._delegate,e=>Lm(this._delegate,e)))}loadBundle(e){return function rj(n,e){const t=sr(n=Gt(n,Rn)),r=new K2;return function G2(n,e,t,r){const i=function(a,l){let h;return h="string"==typeof a?(new TextEncoder).encode(a):a,m=function(m,v){if(m instanceof Uint8Array)return w1(m,v);if(m instanceof ArrayBuffer)return w1(new Uint8Array(m),v);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new k2(m,l);var m}(t,LE(e));n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){!function R2(n,e,t){const r=Be(n);var i;(i=(0,K.Z)(function*(a,l,h){try{const m=yield l.getMetadata();if(yield function(x,P){const G=Be(x),ue=Ur(P.createTime);return G.persistence.runTransaction("hasNewerBundle","readonly",Ee=>G.Ns.getBundleMetadata(Ee,P.id)).then(Ee=>!!Ee&&Ee.createTime.compareTo(ue)>=0)}(a.localStore,m))return yield l.close(),h._completeWith({taskState:"Success",documentsLoaded:(x=m).totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}),Promise.resolve(new Set);h._updateProgress(t1(m));const v=new c2(m,a.localStore,l.It);let b=yield l.mc();for(;b;){const x=yield v.Fu(b);x&&h._updateProgress(x),b=yield l.mc()}const D=yield v.complete();return yield Vu(a,D.Lu,void 0),yield function(x,P){const G=Be(x);return G.persistence.runTransaction("Save bundle","readwrite",ue=>G.Ns.saveBundleMetadata(ue,P))}(a.localStore,m),h._completeWith(D.progress),Promise.resolve(D.Bu)}catch(m){return Ma("SyncEngine",`Loading bundle failed with ${m}`),h._failWith(m),Promise.resolve(new Set)}var x}),function(a,l,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield JM(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function ij(n,e){return function z2(n,e){return n.asyncQueue.enqueue((0,K.Z)(function*(){return function(t,r){const i=Be(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ns.getNamedQuery(a,r))}(yield sD(n),e)}))}(sr(n=Gt(n,Rn)),e).then(t=>t?new yi(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Fi(this,t):null)}}class fD extends oR{constructor(e){super(),this.firestore=e}convertBytes(e){return new GE(new Fa(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return no.forKey(t,this.firestore,null)}}class tF{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new fD(e)}get(e){const t=nf(e);return this._delegate.get(t).then(r=>new zE(this._firestore,new Bu(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=nf(e);return r?(uR("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=nf(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=nf(e);return this._delegate.delete(t),this}}class nF{constructor(e){this._delegate=e}set(e,t,r){const i=nf(e);return r?(uR("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=nf(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=nf(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class tf{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new WE(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new qE(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=tf.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new tf(e,new fD(e),t),i.set(t,a)),a}}tf.INSTANCES=new WeakMap;class no{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fD(e)}static forPath(e,t,r){if(e.length%2!=0)throw new be("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new no(t,new Mn(t._delegate,r,new c(e)))}static forKey(e,t,r){return new no(t,new Mn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Vm(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Vm(this.firestore,v1(this._delegate,e))}catch(t){throw Oi(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,W.m9)(e))instanceof Mn&&E1(this._delegate,e)}set(e,t){t=uR("DocumentReference.set",t);try{return t?q1(this._delegate,e,t):q1(this._delegate,e)}catch(r){throw Oi(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?K1(this._delegate,e):K1(this._delegate,e,t,...r)}catch(i){throw Oi(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Rj(n){return Lm(Gt(n.firestore,Rn),[new Im(n._key,kn.none())])}(this._delegate)}onSnapshot(...e){const t=rF(e),r=iF(e,i=>new zE(this.firestore,new Bu(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Z1(this._delegate,t,r)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function Tj(n){n=Gt(n,Mn);const e=Gt(n.firestore,Rn),t=sr(e),r=new Rc(e);return function $2(n,e){const t=new qn;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return(r=(0,K.Z)(function*(i,a,l){try{const h=yield function(m,v){const b=Be(m);return b.persistence.runTransaction("read document","readonly",D=>b.localDocuments.getDocument(D,v))}(i,a);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new be(se.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const m=Nm(h,`Failed to get document '${a} from cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield sD(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Bu(e,r,n._key,i,new ef(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function Aj(n){n=Gt(n,Mn);const e=Gt(n.firestore,Rn);return T1(sr(e),n._key,{source:"server"}).then(t=>aR(e,n,t))}(this._delegate):function Dj(n){n=Gt(n,Mn);const e=Gt(n.firestore,Rn);return T1(sr(e),n._key).then(t=>aR(e,n,t))}(this._delegate),t.then(r=>new zE(this.firestore,new Bu(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new no(this.firestore,this._delegate.withConverter(e?tf.getInstance(this.firestore,e):null))}}function Oi(n,e,t){return n.message=n.message.replace(e,t),n}function rF(n){for(const e of n)if("object"==typeof e&&!lR(e))return e;return{}}function iF(n,e){var t,r;let i;return i=lR(n[0])?n[0]:lR(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class zE{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new no(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return z1(this._delegate,e._delegate)}}class qE extends zE{data(e){const t=this._delegate.data(e);return function ax(n,e){n||Ye()}(void 0!==t),t}}class Fi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fD(e)}where(e,t,r){try{return new Fi(this.firestore,xc(this._delegate,function pj(n,e,t){const r=e,i=dD("where",n);return new fj(i,r,t)}(e,t,r)))}catch(i){throw Oi(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Fi(this.firestore,xc(this._delegate,function mj(n,e="asc"){const t=e,r=dD("orderBy",n);return new gj(r,t)}(e,t)))}catch(r){throw Oi(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Fi(this.firestore,xc(this._delegate,function _j(n){return g1("limit",n),new U1("limit",n,"F")}(e)))}catch(t){throw Oi(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Fi(this.firestore,xc(this._delegate,function yj(n){return g1("limitToLast",n),new U1("limitToLast",n,"L")}(e)))}catch(t){throw Oi(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Fi(this.firestore,xc(this._delegate,function vj(...n){return new B1("startAt",n,!0)}(...e)))}catch(t){throw Oi(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Fi(this.firestore,xc(this._delegate,function Ej(...n){return new B1("startAfter",n,!1)}(...e)))}catch(t){throw Oi(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Fi(this.firestore,xc(this._delegate,function wj(...n){return new j1("endBefore",n,!1)}(...e)))}catch(t){throw Oi(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Fi(this.firestore,xc(this._delegate,function Ij(...n){return new j1("endAt",n,!0)}(...e)))}catch(t){throw Oi(t,"endAt()","Query.endAt()")}}isEqual(e){return GM(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function xj(n){n=Gt(n,yi);const e=Gt(n.firestore,Rn),t=sr(e),r=new Rc(e);return function H2(n,e){const t=new qn;return n.asyncQueue.enqueueAndForget((0,K.Z)(function*(){return(r=(0,K.Z)(function*(i,a,l){try{const h=yield Zb(i,a,!0),m=new i1(a,h.Hi),v=m.Wu(h.documents),b=m.applyChanges(v,!1);l.resolve(b.snapshot)}catch(h){const m=Nm(h,`Failed to execute query '${a} against cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield sD(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Mc(e,r,n,i))}(this._delegate):"server"===(null==e?void 0:e.source)?function Mj(n){n=Gt(n,yi);const e=Gt(n.firestore,Rn),t=sr(e),r=new Rc(e);return A1(t,n._query,{source:"server"}).then(i=>new Mc(e,r,n,i))}(this._delegate):function Sj(n){n=Gt(n,yi);const e=Gt(n.firestore,Rn),t=sr(e),r=new Rc(e);return V1(n._query),A1(t,n._query).then(i=>new Mc(e,r,n,i))}(this._delegate),t.then(r=>new cR(this.firestore,new Mc(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=rF(e),r=iF(e,i=>new cR(this.firestore,new Mc(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Z1(this._delegate,t,r)}withConverter(e){return new Fi(this.firestore,this._delegate.withConverter(e?tf.getInstance(this.firestore,e):null))}}class qj{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new qE(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class cR{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Fi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new qE(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new qj(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new qE(this._firestore,r))})}isEqual(e){return z1(this._delegate,e._delegate)}}class Vm extends Fi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new no(this.firestore,e):null}doc(e){try{return new no(this.firestore,void 0===e?nD(this._delegate):nD(this._delegate,e))}catch(t){throw Oi(t,"doc()","CollectionReference.doc()")}}add(e){return function Nj(n,e){const t=Gt(n.firestore,Rn),r=nD(n),i=hD(n.converter,e);return Lm(t,[uD(Jh(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,kn.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new no(this.firestore,t))}isEqual(e){return E1(this._delegate,e._delegate)}withConverter(e){return new Vm(this.firestore,this._delegate.withConverter(e?tf.getInstance(this.firestore,e):null))}}function nf(n){return Gt(n,Mn)}class dR{constructor(...e){this._delegate=new Uu(...e)}static documentId(){return new dR(u.keyField().canonicalString())}isEqual(e){return(e=(0,W.m9)(e))instanceof Uu&&this._delegate._internalPath.isEqual(e._internalPath)}}class rf{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Vj(){return new tR("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new rf(e)}static delete(){const e=function Lj(){return new jE("deleteField")}();return e._methodName="FieldValue.delete",new rf(e)}static arrayUnion(...e){const t=function Uj(...n){return new uj("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new rf(t)}static arrayRemove(...e){const t=function Bj(...n){return new lj("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new rf(t)}static increment(e){const t=function jj(n){return new cj("increment",n)}(e);return t._methodName="FieldValue.increment",new rf(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Kj={Firestore:eF,GeoPoint:oD,Timestamp:xn,Blob:GE,Transaction:tF,WriteBatch:nF,DocumentReference:no,DocumentSnapshot:zE,Query:Fi,QueryDocumentSnapshot:qE,QuerySnapshot:cR,CollectionReference:Vm,FieldPath:dR,FieldValue:rf,setLogLevel:function zj(n){!function ox(n){Ao.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function Yj(n){(function Zj(n,e){n.INTERNAL.registerComponent(new Is.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Kj)))})(n,(e,t)=>new eF(e,t,new Gj)),n.registerVersion("@firebase/firestore-compat","0.2.1")}(bS.Z);var Qj=F(6451);class Jj extends Bi.x{constructor(e=1/0,t=1/0,r=Ry){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let h=0;for(let m=1;m<r.length&&r[m]<=l;m+=2)h=m;h&&r.splice(0,h+1)}}}var Xj=F(3099);function sF(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=null!=n?n:1/0,(0,Xj.B)({connector:()=>new Jj(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function oF(n,e){return(0,fs.m)(e)?er(()=>n,e):er(()=>n)}class sf{constructor(e){return e}}class hR{constructor(){return(0,bt.getApps)()}}const fR=new g.OlP("angularfire2._apps"),t$={provide:sf,useFactory:function e$(n){return n&&1===n.length?n[0]:new sf((0,bt.getApp)())},deps:[[new g.FiY,fR]]},n$={provide:hR,deps:[[new g.FiY,fR]]};function r$(n){return(e,t)=>{const r=e.runOutsideAngular(()=>n(t));return new sf(r)}}let i$=(()=>{class n{constructor(t){(0,bt.registerVersion)("angularfire",ih.full,"core"),(0,bt.registerVersion)("angularfire",ih.full,"app"),(0,bt.registerVersion)("angular",g.q4F.full,t.toString())}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(g.Lbi))},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[t$,n$]}),n})();function s$(n,...e){return{ngModule:i$,providers:[{provide:fR,useFactory:r$(n),multi:!0,deps:[g.R0b,g.zs3,oh,...e]}]}}const o$=Au(bt.initializeApp,!0),aF=new Map,a$={activated:!1,tokenObservers:[]},u$={initialized:!1,enabled:!1};function $r(n){return aF.get(n)||a$}function ro(n,e){aF.set(n,e)}function pD(){return u$}class f${constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,K.Z)(function*(){t.stop();try{t.pending=new W.BH,yield function p$(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new W.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Li=new W.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function lF(n){if(!$r(n).activated)throw Li.create("use-before-activation",{appName:n.name})}function mR(n,e){return _R.apply(this,arguments)}function _R(){return _R=(0,K.Z)(function*({url:n,body:e},t){var r,i;const a={"Content-Type":"application/json"},l=t.getImmediate({optional:!0});if(l){const P=yield l.getHeartbeatsHeader();P&&(a["X-Firebase-Client"]=P)}const h={method:"POST",body:JSON.stringify(e),headers:a};let m,v;try{m=yield fetch(n,h)}catch(P){throw Li.create("fetch-network-error",{originalErrorMessage:null===(r=P)||void 0===r?void 0:r.message})}if(200!==m.status)throw Li.create("fetch-status-error",{httpStatus:m.status});try{v=yield m.json()}catch(P){throw Li.create("fetch-parse-error",{originalErrorMessage:null===(i=P)||void 0===i?void 0:i.message})}const b=v.ttl.match(/^([\d.]+)(s)$/);if(!b||!b[2]||isNaN(Number(b[1])))throw Li.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${v.ttl}`});const D=1e3*Number(b[1]),x=Date.now();return{token:v.token,expireTimeMillis:x+D,issuedAtTimeMillis:x}}),_R.apply(this,arguments)}function y$(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const KE="firebase-app-check-store";let _D=null;function dF(){return _D||(_D=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var a;e(Li.create("storage-open",{originalErrorMessage:null===(a=i.target.error)||void 0===a?void 0:a.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(KE,{keyPath:"compositeKey"})}}catch(r){e(Li.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),_D)}function yR(){return yR=(0,K.Z)(function*(n,e){const r=(yield dF()).transaction(KE,"readwrite"),a=r.objectStore(KE).put({compositeKey:n,value:e});return new Promise((l,h)=>{a.onsuccess=m=>{l()},r.onerror=m=>{var v;h(Li.create("storage-set",{originalErrorMessage:null===(v=m.target.error)||void 0===v?void 0:v.message}))}})}),yR.apply(this,arguments)}const ZE=new Wi.Yd("@firebase/app-check");function wR(n,e){return(0,W.hl)()?function I$(n,e){return function hF(n,e){return yR.apply(this,arguments)}(function pF(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{ZE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function gF(){return pD().enabled}function mF(){return CR.apply(this,arguments)}function CR(){return CR=(0,K.Z)(function*(){const n=pD();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),CR.apply(this,arguments)}const S$={error:"UNKNOWN_ERROR"};function x$(n){return W.US.encodeString(JSON.stringify(n),!1)}function yD(n){return bR.apply(this,arguments)}function bR(){return bR=(0,K.Z)(function*(n,e=!1){const t=n.app;lF(t);const r=$r(t);let a,i=r.token;if(i&&!Um(i)&&(ro(t,Object.assign(Object.assign({},r),{token:void 0})),i=void 0),!i){const m=yield r.cachedTokenPromise;m&&(Um(m)?i=m:yield wR(t,void 0))}if(!e&&i&&Um(i))return{token:i.token};let h,l=!1;if(gF()){r.exchangeTokenPromise||(r.exchangeTokenPromise=mR(y$(t,yield mF()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),l=!0);const m=yield r.exchangeTokenPromise;return yield wR(t,m),ro(t,Object.assign(Object.assign({},r),{token:m})),{token:m.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),l=!0),i=yield r.exchangeTokenPromise}catch(m){"appCheck/throttled"===m.code?ZE.warn(m.message):ZE.error(m),a=m}return i?a?h=Um(i)?{token:i.token,internalError:a}:vF(a):(h={token:i.token},ro(t,Object.assign(Object.assign({},r),{token:i})),yield wR(t,i)):h=vF(a),l&&yF(t,h),h}),bR.apply(this,arguments)}function TR(n,e){const t=$r(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),ro(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function _F(n){const{app:e}=n,t=$r(e);let r=t.tokenRefresher;r||(r=function M$(n){const{app:e}=n;return new f$((0,K.Z)(function*(){let r;if(r=$r(e).token?yield yD(n,!0):yield yD(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=$r(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),ro(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function yF(n,e){const t=$r(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch(i){}}function Um(n){return n.expireTimeMillis-Date.now()>0}function vF(n){return{token:x$(S$),error:n}}class R${constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=$r(this.app);for(const t of e)TR(this.app,t.next);return Promise.resolve()}}const AF="app-check-internal";!function G$(){(0,bt._registerComponent)(new Is.wA("app-check",n=>function N$(n,e){return new R$(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(AF).initialize()})),(0,bt._registerComponent)(new Is.wA(AF,n=>function P$(n){return{getToken:e=>yD(n,e),addTokenListener:e=>function DR(n,e,t,r){const{app:i}=n,a=$r(i),l={next:t,error:r,type:e};if(ro(i,Object.assign(Object.assign({},a),{tokenObservers:[...a.tokenObservers,l]})),a.token&&Um(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),_F(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>_F(n))}(n,"INTERNAL",e),removeTokenListener:e=>TR(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,bt.registerVersion)("@firebase/app-check","0.5.15")}();class YE{constructor(){return Mg("app-check")}}"undefined"!=typeof window&&window,F(127);const xF=new g.OlP("angularfire2.auth.use-emulator"),MF=new g.OlP("angularfire2.auth.settings"),RF=new g.OlP("angularfire2.auth.tenant-id"),NF=new g.OlP("angularfire2.auth.langugage-code"),PF=new g.OlP("angularfire2.auth.use-device-language"),kF=new g.OlP("angularfire.auth.persistence"),OF=(n,e,t,r,i,a,l,h)=>(0,Cs.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const m=e.runOutsideAngular(()=>n.auth());if(t&&m.useEmulator(...t),r&&(m.tenantId=r),m.languageCode=i,a&&m.useDeviceLanguage(),l)for(const[v,b]of Object.entries(l))m.settings[v]=b;return h&&m.setPersistence(h),m},[t,r,i,a,l,h]);let FF=(()=>{class n{constructor(t,r,i,a,l,h,m,v,b,D,x,P){const G=new Bi.x,ue=gt(void 0).pipe((0,Tu.Q)(l.outsideAngular),er(()=>a.runOutsideAngular(()=>Promise.resolve().then(F.bind(F,5881)))),(0,Et.U)(()=>(0,Cs.on)(t,a,r)),(0,Et.U)(Ee=>OF(Ee,a,h,v,b,D,m,x)),sF({bufferSize:1,refCount:!1}));if(mr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=gt(null);else{ue.pipe(Zo()).subscribe();const at=ue.pipe(er(ut=>ut.getRedirectResult().then(ft=>ft,()=>null)),Fr,sF({bufferSize:1,refCount:!1})),dt=ue.pipe(er(ut=>new Jr.y(ft=>({unsubscribe:a.runOutsideAngular(()=>ut.onAuthStateChanged(At=>ft.next(At),At=>ft.error(At),()=>ft.complete()))})))),ht=ue.pipe(er(ut=>new Jr.y(ft=>({unsubscribe:a.runOutsideAngular(()=>ut.onIdTokenChanged(At=>ft.next(At),At=>ft.error(At),()=>ft.complete()))}))));this.authState=at.pipe(oF(dt),(0,rh.R)(l.outsideAngular),(0,Tu.Q)(l.insideAngular)),this.user=at.pipe(oF(ht),(0,rh.R)(l.outsideAngular),(0,Tu.Q)(l.insideAngular)),this.idToken=this.user.pipe(er(ut=>ut?(0,yn.D)(ut.getIdToken()):gt(null))),this.idTokenResult=this.user.pipe(er(ut=>ut?(0,yn.D)(ut.getIdTokenResult()):gt(null))),this.credential=(0,Qj.T)(at,G,this.authState.pipe(tr(ut=>!ut))).pipe((0,Et.U)(ut=>(null==ut?void 0:ut.user)?ut:null),(0,rh.R)(l.outsideAngular),(0,Tu.Q)(l.insideAngular))}return(0,Cs.pX)(this,ue,a,{spy:{apply:(Ee,at,dt)=>{(Ee.startsWith("signIn")||Ee.startsWith("createUser"))&&dt.then(ht=>G.next(ht))}}})}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(Cs.Dh),g.LFG(Cs.xv,8),g.LFG(g.Lbi),g.LFG(g.R0b),g.LFG(oh),g.LFG(xF,8),g.LFG(MF,8),g.LFG(RF,8),g.LFG(NF,8),g.LFG(PF,8),g.LFG(kF,8),g.LFG(YE,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function LF(n,e){return function Q$(n,e=iI){return new Jr.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=r&&r()}})}(n,e)}function RR(n,e){return LF(n,e).pipe((0,Et.U)(t=>({payload:t,type:"query"})))}function ED(n,e){return RR(n,e).pipe(mo(void 0),Av(),(0,Et.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,h)=>{const m=i.find(b=>b.doc.ref.isEqual(l.ref)),v=null==t?void 0:t.payload.docs.find(b=>b.ref.isEqual(l.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(l.metadata)||!m&&v&&JSON.stringify(v.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:l}})}),a}))}function VF(n,e,t){return ED(n,t).pipe(ji((r,i)=>function X$(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function eH(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return NR(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return NR(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return NR(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),function jP(n,e=Os.y){return n=null!=n?n:xC,(0,cr.e)((t,r)=>{let i,a=!0;t.subscribe((0,Un.x)(r,l=>{const h=e(l);(a||!n(i,h))&&(a=!1,i=h,r.next(l))}))})}(),(0,Et.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function NR(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function UF(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class BF{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=ED(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Et.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(mo(void 0),Av(),tr(([r,i])=>i.length>0||!r),(0,Et.U)(([r,i])=>i),Fr)}auditTrail(e){return this.stateChanges(e).pipe(ji((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=UF(e);return VF(this.query,t,this.afs.schedulers.outsideAngular).pipe(Fr)}valueChanges(e={}){return RR(this.query,this.afs.schedulers.outsideAngular).pipe((0,Et.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),Fr)}get(e){return(0,yn.D)(this.query.get(e)).pipe(Fr)}add(e){return this.ref.add(e)}doc(e){return new jF(this.ref.doc(e),this.afs)}}class jF{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=$F(r,t);return new BF(i,a,this.afs)}snapshotChanges(){return function J$(n,e){return LF(n,e).pipe(mo(void 0),Av(),(0,Et.U)(([t,r])=>r.exists?(null==t?void 0:t.exists)?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Fr)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Et.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,yn.D)(this.ref.get(e)).pipe(Fr)}}class tH{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?ED(this.query,this.afs.schedulers.outsideAngular).pipe((0,Et.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),tr(t=>t.length>0),Fr):ED(this.query,this.afs.schedulers.outsideAngular).pipe(Fr)}auditTrail(e){return this.stateChanges(e).pipe(ji((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=UF(e);return VF(this.query,t,this.afs.schedulers.outsideAngular).pipe(Fr)}valueChanges(e={}){return RR(this.query,this.afs.schedulers.outsideAngular).pipe((0,Et.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),Fr)}get(e){return(0,yn.D)(this.query.get(e)).pipe(Fr)}}const nH=new g.OlP("angularfire2.enableFirestorePersistence"),rH=new g.OlP("angularfire2.firestore.persistenceSettings"),iH=new g.OlP("angularfire2.firestore.settings"),sH=new g.OlP("angularfire2.firestore.use-emulator");function $F(n,e=(t=>t)){return{query:e(n),ref:n}}let oH=(()=>{class n{constructor(t,r,i,a,l,h,m,v,b,D,x,P,G,ue,Ee,at,dt){this.schedulers=m;const ht=(0,Cs.on)(t,h,r),ut=b;D&&OF(ht,h,x,G,ue,Ee,P,at),[this.firestore,this.persistenceEnabled$]=(0,Cs.cc)(`${ht.name}.firestore`,"AngularFirestore",ht.name,()=>{const ft=h.runOutsideAngular(()=>ht.firestore());if(a&&ft.settings(a),ut&&ft.useEmulator(...ut),i&&!mr(l)){const At=()=>{try{return(0,yn.D)(ft.enablePersistence(v||void 0).then(()=>!0,()=>!1))}catch(Tr){return"undefined"!=typeof console&&console.warn(Tr),gt(!1)}};return[ft,h.runOutsideAngular(At)]}return[ft,gt(!1)]},[a,ut,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=$F(i,r),h=this.schedulers.ngZone.run(()=>a);return new BF(h,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new tH(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new jF(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(Cs.Dh),g.LFG(Cs.xv,8),g.LFG(nH,8),g.LFG(iH,8),g.LFG(g.Lbi),g.LFG(g.R0b),g.LFG(oh),g.LFG(rH,8),g.LFG(sH,8),g.LFG(FF,8),g.LFG(xF,8),g.LFG(MF,8),g.LFG(RF,8),g.LFG(NF,8),g.LFG(PF,8),g.LFG(kF,8),g.LFG(YE,8))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),QE=(()=>{class n{constructor(t){this.afs=t,this.handleCreateRoom=({roomName:r})=>{const i=this.afs.createId();return Promise.all([this.afs.collection("tictactoeRooms").doc(i).set({roomName:r,id:i,table:[...Array(3)].map(()=>({0:null,1:null,2:null})),currentTurn:"x",admin:"x",visitor:"o",adminScore:0,visitorScore:0}).then(()=>i),this.afs.collection("tictactoeRoomMessages").doc(i).set({messages:[],id:i})])},this.handleGetRoom=r=>this.afs.collection("tictactoeRooms").doc(r).valueChanges(),this.handleModifyRoom=r=>this.afs.collection("tictactoeRooms").doc(r.id).set(Object.assign({},r)),this.handleGetChat=r=>this.afs.collection("tictactoeRoomMessages").doc(r).valueChanges(),this.handleModifyChat=r=>this.afs.collection("tictactoeRoomMessages").doc(r.id).set(Object.assign({},r))}}return n.\u0275fac=function(t){return new(t||n)(g.LFG(oH))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const aH=function(n){return["rounded-md","w-full",n,"border-2","transition-all"]};function uH(n,e){1&n&&g._UZ(0,"input",4),2&n&&g.Q6J("ngClass",g.VKq(1,aH,e.ngIf.valid?"border-green-400":"border-red-700"))}let lH=(()=>{class n{constructor(t,r,i){this.formBuilder=t,this.roomService=r,this.router=i,this.form=this.formBuilder.group({roomName:[null,$_.required]})}handleSubmit(t){var r=this;return(0,K.Z)(function*(){const[i]=yield r.roomService.handleCreateRoom(t);r.router.navigate(["room-admin",i])})()}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(ws),g.Y36(QE),g.Y36(Nr))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-home"]],decls:5,vars:2,consts:[[1,"w-full","min-h-screen","flex","items-center","justify-center"],[1,"w-11/12","p-4","gap-x-4","bg-slate-100","rounded-3xl","flex",3,"formGroup","submit"],["type","text","placeholder","Nombre unico","formControlName","roomName",3,"ngClass",4,"ngIf"],[1,"bg-green-500","pl-4","pr-4","pt-2","pb-2","rounded-md","whitespace-nowrap","hover:bg-green-900","transition-all"],["type","text","placeholder","Nombre unico","formControlName","roomName",3,"ngClass"]],template:function(t,r){1&t&&(g.TgZ(0,"div",0)(1,"form",1),g.NdJ("submit",function(){return r.handleSubmit(r.form.value)}),g.YNc(2,uH,1,3,"input",2),g.TgZ(3,"button",3),g._uU(4," crear tablero "),g.qZA()()()),2&t&&(g.xp6(1),g.Q6J("formGroup",r.form),g.xp6(1),g.Q6J("ngIf",r.form.get("roomName")))},directives:[hy,Q_,Ud,ur,Ad,Y_,Bd,ss],encapsulation:2}),n})();const cH=function(n,e,t,r,i){return["w-full","text-9xl"," text-center",n,e,t,r,"border-black","hover:bg-slate-500","transition-all","grid","content-center","justify-center",i]};function dH(n,e){if(1&n){const t=g.EpF();g.ynx(0),g.TgZ(1,"div",5),g.NdJ("click",function(){const a=g.CHM(t).index,l=g.oxw().index,h=g.oxw().ngIf;return g.oxw().handleSelect(h.room,l,a)}),g._uU(2),g.qZA(),g.BQk()}if(2&n){const t=e.$implicit,r=e.index,i=g.oxw().index,a=g.oxw().ngIf,l=g.oxw();g.xp6(1),g.Q6J("ngClass",g.qbA(2,cH,1===i?"border-t-2":"",1===i?"border-b-2":"",1===r?"border-r-2":"",1===r?"border-l-2":"",t===a.room[l.player]?"text-green-800":"text-red-800")),g.xp6(1),g.hij(" ",t," ")}}function hH(n,e){if(1&n&&(g.ynx(0),g.YNc(1,dH,3,8,"ng-container",2),g.BQk()),2&n){const t=e.$implicit;g.xp6(1),g.Q6J("ngForOf",t)}}const fH=function(n){return["absolute","top-0","w-full","h-full",n,"opacity-90","grid","content-center","justify-center"]};function pH(n,e){if(1&n){const t=g.EpF();g.TgZ(0,"div",1),g.YNc(1,hH,2,1,"ng-container",2),g.TgZ(2,"div",3)(3,"button",4),g.NdJ("click",function(){const a=g.CHM(t).ngIf;return g.oxw().handleResetTable(a.room)}),g._uU(4," Reset! "),g.qZA()()()}if(2&n){const t=e.ngIf,r=g.oxw();g.xp6(1),g.Q6J("ngForOf",t.table),g.xp6(1),g.Q6J("ngClass",g.VKq(2,fH,t.room.winner?t.room[r.player]===t.room.winner?"bg-green-500":"tie"===t.room.winner?"bg-yellow-500":"bg-red-500":"hidden"))}}const gH=function(n,e){return{table:n,room:e}};let HF=(()=>{class n{constructor(t){var r=this;this.roomService=t,this.newTable$=new Xn(null),this.newRoom$=new Xn([]),this.player="",this.isVictory=i=>{let a=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(let l of a)if(i[l[0]]==i[l[1]]&&i[l[1]]==i[l[2]]&&null!=i[l[0]])return!0;return!1},this.handleResetTable=function(){var i=(0,K.Z)(function*(a){const l=a.winner&&a[r.player]!==a.currentTurn?"x":a[r.player],h="admin"===r.player?"visitor":"admin";return yield r.roomService.handleModifyRoom(Object.assign(Object.assign({},a),{winner:null,table:[...Array(3)].map(()=>({0:null,1:null,2:null})),currentTurn:"x",[r.player]:l,[h]:"x"===l?"o":"x"}))});return function(a){return i.apply(this,arguments)}}()}set room(t){this.newRoom$.next(t),this.newTable$.next(t.table.map(r=>Object.values(r)))}handleSelect(t,r,i){var a=this;return(0,K.Z)(function*(){if(t[a.player]!==t.currentTurn||t.table[r][i])return;t.table[r]=Object.assign(Object.assign({},t.table[r]),{[i]:t[a.player]});const l=t.table.map(v=>Object.values(v)).reduce((v,b)=>v.concat(b),[]),h=a.isVictory(l),m=l.filter(v=>v).length===l.length&&!h;t=Object.assign(Object.assign({},t),{table:[...t.table],currentTurn:"x"===t.currentTurn?"o":"x",winner:h?t[a.player]:m?"tie":null,adminScore:"admin"===a.player&&h?t.adminScore+1:t.adminScore,visitorScore:"visitor"===a.player&&h?t.visitorScore+1:t.visitorScore}),console.log(t),yield a.roomService.handleModifyRoom(t)})()}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(QE))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-table"]],inputs:{room:"room",player:"player"},decls:3,vars:8,consts:[["class","w-full bg-slate-100 rounded-3xl  grid-cols-3 grid-rows-3 h-full grid content-center justify-center p-4 relative overflow-hidden",4,"ngIf"],[1,"w-full","bg-slate-100","rounded-3xl","grid-cols-3","grid-rows-3","h-full","grid","content-center","justify-center","p-4","relative","overflow-hidden"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"bg-slate-900","p-10","rounded-md","whitespace-nowrap","hover:bg-green-900","transition-all","text-white",3,"click"],[3,"ngClass","click"]],template:function(t,r){1&t&&(g.YNc(0,pH,5,4,"div",0),g.ALo(1,"async"),g.ALo(2,"async")),2&t&&g.Q6J("ngIf",g.WLB(5,gH,g.lcZ(1,1,r.newTable$),g.lcZ(2,3,r.newRoom$)))},directives:[ur,Gn,ss],pipes:[ko],encapsulation:2}),n})();const mH=function(n){return["flex",n,"mb-4"]},_H=function(n){return[n,"p-4","text-xl","text-white","rounded-2xl"]};function yH(n,e){if(1&n&&(g.ynx(0),g.TgZ(1,"div",7)(2,"div",8),g._uU(3),g.qZA()(),g.BQk()),2&n){const t=e.$implicit,r=e.index,i=g.oxw().ngIf,a=g.oxw();g.xp6(1),g.Q6J("ngClass",g.VKq(4,mH,t.player===a.player?"justify-end":"justify-start")),g.xp6(1),g.Q6J("ngClass",g.VKq(6,_H,t.player===a.player?"bg-green-600":"bg-yellow-600"))("id",r===i.chat.messages.length-1?"last":""),g.xp6(1),g.hij(" ",t.message," ")}}const vH=function(){return["rounded-md","w-full","border-2","transition-all"]};function EH(n,e){if(1&n){const t=g.EpF();g.TgZ(0,"div",1)(1,"div",2),g.YNc(2,yH,4,8,"ng-container",3),g.qZA(),g.TgZ(3,"form",4),g.NdJ("submit",function(){const a=g.CHM(t).ngIf,l=g.oxw();return l.handleSend(l.form.value,a.chat)}),g._UZ(4,"input",5),g.TgZ(5,"button",6),g._uU(6," Enviar "),g.qZA()()()}if(2&n){const t=e.ngIf,r=g.oxw();g.xp6(2),g.Q6J("ngForOf",null==t.chat?null:t.chat.messages),g.xp6(1),g.Q6J("formGroup",r.form),g.xp6(1),g.Q6J("ngClass",g.DdM(3,vH))}}const wH=function(n){return{chat:n}};let WF=(()=>{class n{constructor(t,r){this.roomService=t,this.formBuilder=r,this.newId$=new Xn(null),this.chat$=this.newId$.pipe(er(i=>this.roomService.handleGetChat(i).pipe()),dr(()=>{setTimeout(()=>{var i;return null===(i=document.getElementById("last"))||void 0===i?void 0:i.scrollIntoView()},500)})),this.player=null,this.form=this.formBuilder.group({message:[null,$_.required]})}set id(t){this.newId$.next(t)}handleSend(t,r){var i=this;return(0,K.Z)(function*(){r.messages.push(Object.assign(Object.assign({},t),{player:i.player})),yield i.roomService.handleModifyChat(r)})()}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(QE),g.Y36(ws))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-chat"]],inputs:{player:"player",id:"id"},decls:2,vars:5,consts:[["class","w-full bg-slate-100 rounded-3xl   h-full p-4 relative",4,"ngIf"],[1,"w-full","bg-slate-100","rounded-3xl","h-full","p-4","relative"],[1,"h-5/6","overflow-y-scroll"],[4,"ngFor","ngForOf"],[1,"w-full","p-4","gap-x-4","rounded-3xl","flex",3,"formGroup","submit"],["type","text","placeholder","mensaje","formControlName","message",3,"ngClass"],["type","submit",1,"bg-green-500","pl-4","pr-4","pt-2","pb-2","rounded-md","whitespace-nowrap","hover:bg-green-900","transition-all"],[3,"ngClass"],[3,"ngClass","id"]],template:function(t,r){1&t&&(g.YNc(0,EH,7,4,"div",0),g.ALo(1,"async")),2&t&&g.Q6J("ngIf",g.VKq(3,wH,g.lcZ(1,1,r.chat$)))},directives:[ur,Gn,ss,hy,Q_,Ud,Ad,Y_,Bd],pipes:[ko],encapsulation:2}),n})();function IH(n,e){if(1&n){const t=g.EpF();g.TgZ(0,"div",1)(1,"div",2),g.NdJ("click",function(){g.CHM(t);const i=g.oxw();return i.handleCopyUrl(i.url)}),g._uU(2),g.qZA(),g.TgZ(3,"div",3)(4,"div",4),g._uU(5),g.qZA(),g.TgZ(6,"div",4),g._uU(7),g.qZA()(),g.TgZ(8,"div",5)(9,"div"),g._uU(10),g.ALo(11,"uppercase"),g.qZA(),g.TgZ(12,"div"),g._uU(13),g.ALo(14,"uppercase"),g.qZA()(),g.TgZ(15,"div",6),g._UZ(16,"app-table",7)(17,"app-chat",8),g.qZA()()}if(2&n){const t=e.ngIf,r=g.oxw();g.xp6(2),g.hij(" ",t.room.roomName," "),g.xp6(3),g.hij(" player A ",t.room.adminScore," "),g.xp6(2),g.hij(" player B ",t.room.visitorScore," "),g.xp6(3),g.hij("Turn: ",g.lcZ(11,9,t.room.currentTurn),""),g.xp6(3),g.hij("player: ",g.lcZ(14,11,t.room.admin),""),g.xp6(3),g.Q6J("room",null==t?null:t.room)("player",r.player),g.xp6(1),g.Q6J("player",r.player)("id",r.id)}}const CH=function(n){return{room:n}};let bH=(()=>{class n{constructor(t,r){this.roomService=t,this.route=r,this.player="admin",this.id=this.route.snapshot.paramMap.get("id"),this.room$=this.roomService.handleGetRoom(this.id),this.url=`${(window.location+"").replace("admin","visitor")}`}handleCopyUrl(t){navigator.clipboard.writeText(t),alert("Copiado!")}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(QE),g.Y36($s))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-room-admin"]],decls:2,vars:5,consts:[["class","min-h-screen w-full flex flex-col p-4 gap-y-4",4,"ngIf"],[1,"min-h-screen","w-full","flex","flex-col","p-4","gap-y-4"],[1,"bg-slate-100","w-full","p-10","max-h-min","flex","justify-center","rounded-3xl","cursor-pointer","text-center","font-bold","text-lg",3,"click"],[1,"bg-slate-100","w-full","p-10","max-h-min","justify-center","rounded-3xl","text-center","font-bold","text-lg","grid","grid-cols-2"],[1,"w-full"],[1,"bg-slate-100","w-full","p-10","max-h-min","grid","justify-center","rounded-3xl","text-center","font-bold","text-3xl"],[1,"grid","lg:grid-cols-2","lg:grid-rows-1","grid-rows-2","h-screen","gap-4"],[3,"room","player"],[3,"player","id"]],template:function(t,r){1&t&&(g.YNc(0,IH,18,13,"div",0),g.ALo(1,"async")),2&t&&g.Q6J("ngIf",g.VKq(3,CH,g.lcZ(1,1,r.room$)))},directives:[ur,HF,WF],pipes:[ko,Wu],encapsulation:2}),n})();function DH(n,e){if(1&n&&(g.TgZ(0,"div",1)(1,"div",2)(2,"div",3),g._uU(3),g.qZA(),g.TgZ(4,"div",3),g._uU(5),g.qZA()(),g.TgZ(6,"div",4)(7,"div"),g._uU(8),g.ALo(9,"uppercase"),g.qZA(),g.TgZ(10,"div"),g._uU(11),g.ALo(12,"uppercase"),g.qZA()(),g.TgZ(13,"div",5),g._UZ(14,"app-table",6)(15,"app-chat",7),g.qZA()()),2&n){const t=e.ngIf,r=g.oxw();g.xp6(3),g.hij(" player A ",t.room.adminScore," "),g.xp6(2),g.hij(" player B ",t.room.visitorScore," "),g.xp6(3),g.hij("Turn: ",g.lcZ(9,8,t.room.currentTurn),""),g.xp6(3),g.hij("player: ",g.lcZ(12,10,t.room.visitor),""),g.xp6(3),g.Q6J("room",null==t?null:t.room)("player",r.player),g.xp6(1),g.Q6J("player",r.player)("id",r.id)}}const TH=function(n){return{room:n}},AH=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",component:lH},{path:"room-admin/:id",component:bH},{path:"room-visitor/:id",component:(()=>{class n{constructor(t,r){this.roomService=t,this.route=r,this.player="visitor",this.id=this.route.snapshot.paramMap.get("id"),this.room$=this.roomService.handleGetRoom(this.id).pipe(dr(i=>{console.log(i)}))}}return n.\u0275fac=function(t){return new(t||n)(g.Y36(QE),g.Y36($s))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-room-visitor"]],decls:2,vars:5,consts:[["class","min-h-screen w-full flex flex-col p-4 gap-y-4",4,"ngIf"],[1,"min-h-screen","w-full","flex","flex-col","p-4","gap-y-4"],[1,"bg-slate-100","w-full","p-10","max-h-min","justify-center","rounded-3xl","cursor-pointer","text-center","font-bold","text-lg","grid","grid-cols-2"],[1,"w-full"],[1,"bg-slate-100","w-full","p-10","max-h-min","grid","justify-center","rounded-3xl","cursor-pointer","text-center","font-bold","text-lg"],[1,"grid","lg:grid-cols-2","lg:grid-rows-1","grid-rows-2","h-screen","gap-4"],[3,"room","player"],[3,"player","id"]],template:function(t,r){1&t&&(g.YNc(0,DH,16,12,"div",0),g.ALo(1,"async")),2&t&&g.Q6J("ngIf",g.VKq(3,TH,g.lcZ(1,1,r.room$)))},directives:[ur,HF,WF],pipes:[ko,Wu],encapsulation:2}),n})()}];let SH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[[cw.forRoot(AH,{useHash:!0})],cw]}),n})(),xH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"bg-slate-400"]],template:function(t,r){1&t&&(g.TgZ(0,"main",0),g._UZ(1,"router-outlet"),g.qZA())},directives:[Al],styles:[""]}),n})();const PR={firebase:{projectId:"trivia-9c64e",appId:"1:179978647682:web:b090619eadaacab4ee1c9b",databaseURL:"https://trivia-9c64e-default-rtdb.firebaseio.com",storageBucket:"trivia-9c64e.appspot.com",apiKey:"AIzaSyAAK9-dk0I9kHPTOnd2UTGPEtjW1D6dJX8",authDomain:"trivia-9c64e.firebaseapp.com",messagingSenderId:"179978647682",measurementId:"G-6F3CT5F8VX"},production:!0};F(7573);class OR{constructor(){return Mg("auth")}}const zF="@firebase/database";let LR="";class kH{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,W.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,W.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class OH{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,W.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const KF=function(n){try{if("undefined"!=typeof window&&void 0!==window[n]){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new kH(e)}}catch(e){}return new OH},of=KF("localStorage"),VR=KF("sessionStorage"),Bm=new Wi.Yd("@firebase/database"),ZF=function(){let n=1;return function(){return n++}}(),YF=function(n){const e=(0,W.dS)(n),t=new W.gQ;t.update(e);const r=t.digest();return W.US.encodeByteArray(r)},JE=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=JE.apply(null,r):e+="object"==typeof r?(0,W.Wl)(r):r,e+=" "}return e};let af=null,QF=!0;const Hr=function(...n){if(!0===QF&&(QF=!1,null===af&&!0===VR.get("logging_enabled")&&function(n,e){(0,W.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Bm.logLevel=Wi.in.VERBOSE,af=Bm.log.bind(Bm),e&&VR.set("logging_enabled",!0)):"function"==typeof n?af=n:(af=null,VR.remove("logging_enabled"))}(!0)),af){const e=JE.apply(null,n);af(e)}},XE=function(n){return function(...e){Hr(n,...e)}},UR=function(...n){const e="FIREBASE INTERNAL ERROR: "+JE(...n);Bm.error(e)},La=function(...n){const e=`FIREBASE FATAL ERROR: ${JE(...n)}`;throw Bm.error(e),new Error(e)},vi=function(...n){const e="FIREBASE WARNING: "+JE(...n);Bm.warn(e)},wD=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},ju="[MIN_NAME]",Va="[MAX_NAME]",uf=function(n,e){if(n===e)return 0;if(n===ju||e===Va)return-1;if(e===ju||n===Va)return 1;{const t=ID(n),r=ID(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},VH=function(n,e){return n===e?0:n<e?-1:1},e0=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,W.Wl)(e))},BR=function(n){if("object"!=typeof n||null===n)return(0,W.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,W.Wl)(e[r]),t+=":",t+=BR(n[e[r]]);return t+="}",t},XF=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Wr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const eL=function(n){(0,W.hu)(!wD(n),"Invalid JSON number");const r=1023;let i,a,l,h,m;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,l=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const v=[];for(m=52;m;m-=1)v.push(l%2?1:0),l=Math.floor(l/2);for(m=11;m;m-=1)v.push(a%2?1:0),a=Math.floor(a/2);v.push(i?1:0),v.reverse();const b=v.join("");let D="";for(m=0;m<64;m+=8){let x=parseInt(b.substr(m,8),2).toString(16);1===x.length&&(x="0"+x),D+=x}return D.toLowerCase()},$H=new RegExp("^-?(0*)\\d{1,10}$"),ID=function(n){if($H.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},jm=function(n){try{n()}catch(e){setTimeout(()=>{throw vi("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},t0=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class WH{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){vi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class GH{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Hr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vi(e)}}let n0=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const oL=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,lL="websocket",cL="long_polling";class HR{constructor(e,t,r,i,a=!1,l="",h=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=of.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&of.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function dL(n,e,t){let r;if((0,W.hu)("string"==typeof e,"typeof type must == string"),(0,W.hu)("object"==typeof t,"typeof params must == object"),e===lL)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==cL)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function zH(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Wr(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class qH{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,W.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,W.p$)(this.counters_)}}const WR={},GR={};function zR(n){const e=n.toString();return WR[e]||(WR[e]=new qH),WR[e]}class ZH{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&jm(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Pc{constructor(e,t,r,i,a,l,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=XE(e),this.stats_=zR(t),this.urlFn=m=>(this.appCheckToken&&(m.ac=this.appCheckToken),dL(t,cL,m))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ZH(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,W.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new qR((...a)=>{const[l,h,m,v,b]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=h,this.password=m;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&oL.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Pc.forceAllow_=!0}static forceDisallow(){Pc.forceDisallow_=!0}static isAvailable(){return!((0,W.Yr)()||!Pc.forceAllow_&&(Pc.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,W.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,W.h$)(t),i=XF(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,W.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,W.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class qR{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,W.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=ZF(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=qR.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(h){Hr("frame writing exception"),h.stack&&Hr(h.stack),Hr(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Hr("No IE domain setting required")}catch(t){const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,W.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Hr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch(r){}},Math.floor(1))}}let bD=null;"undefined"!=typeof MozWebSocket?bD=MozWebSocket:"undefined"!=typeof WebSocket&&(bD=WebSocket);let $m=(()=>{class n{constructor(t,r,i,a,l,h,m){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=XE(this.connId),this.stats_=zR(r),this.connURL=n.connectionURL_(r,h,m,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const h={v:"5"};return!(0,W.Yr)()&&"undefined"!=typeof location&&location.hostname&&oL.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),l&&(h.p=l),dL(t,lL,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,of.set("previous_websocket_failure",!0);try{let i;if((0,W.Yr)()){i={headers:{"User-Agent":`Firebase/5/${LR}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,h=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new bD(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==bD&&!n.forceDisallow_}static previouslyFailed(){return of.isInMemoryStorage||!0===of.get("previous_websocket_failure")}markConnectionHealthy(){of.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,W.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,W.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,W.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=XF(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),yL=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Pc,$m]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=$m&&$m.isAvailable();let i=r&&!$m.previouslyFailed();if(t.webSocketOnly&&(r||vi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[$m];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class DL{constructor(e,t,r,i,a,l,h,m,v,b){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=h,this.onDisconnect_=m,this.onKill_=v,this.lastSessionId=b,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=XE("c:"+this.id+":"),this.transportManager_=new yL(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=t0(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=e0("t",e),r=e0("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=e0("t",e),r=e0("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=e0("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?UR("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):UR("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&vi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),t0(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):t0(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(of.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class TL{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class AL{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,W.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,W.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class DD extends AL{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!(0,W.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new DD}getInitialEvent(e){return(0,W.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class an{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function en(){return new an("")}function jt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function kc(n){return n.pieces_.length-n.pieceNum_}function _n(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new an(n.pieces_,e)}function ZR(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function r0(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function ML(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new an(e,0)}function On(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof an)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new an(t,0)}function $t(n){return n.pieceNum_>=n.pieces_.length}function Vi(n,e){const t=jt(n),r=jt(e);if(null===t)return e;if(t===r)return Vi(_n(n),_n(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function YR(n,e){if(kc(n)!==kc(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function io(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(kc(n)>kc(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class yW{constructor(e,t){this.errorPrefix_=t,this.parts_=r0(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,W.ug)(this.parts_[r]);RL(this)}}function RL(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+lf(n))}function lf(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class QR extends AL{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new QR}getInitialEvent(e){return(0,W.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const s0=1e3;let AD,cf=(()=>{class n extends TL{constructor(t,r,i,a,l,h,m,v){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=h,this.appCheckTokenProvider_=m,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=XE("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=s0,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,W.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");QR.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&DD.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,W.Wl)(l)),(0,W.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new W.BH,i={p:t._path.toString(),q:t._queryObject};return this.outstandingGets_.push({action:"g",request:i,onComplete:h=>{const m=h.d;"ok"===h.s?r.resolve(m):r.reject(m)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+l),this.listens.has(h)||this.listens.set(h,new Map),(0,W.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,W.hu)(!this.listens.get(h).has(l),"listen() called twice for same path/queryId.");const m={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(l,m),this.connected_&&this.sendListen_(m)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,m=>{const v=m.d,b=m.s;n.warnOnListenWarnings_(v,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",m),"ok"!==b&&this.removeListen_(i,a),t.onComplete&&t.onComplete(b,v))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,W.r3)(t,"w")){const i=(0,W.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();vi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,W.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,W.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,h=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,W.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const h={p:r,d:i};void 0!==l&&(h.h=l),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,W.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):UR("Unrecognized action received from server: "+(0,W.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,W.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=s0,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=s0,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=s0),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,K.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let m=!1,v=null;const b=function(){v?v.close():(m=!0,a())};t.realtime_={close:b,sendRequest:function(P){(0,W.hu)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest(P)}};const x=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[P,G]=yield Promise.all([t.authTokenProvider_.getToken(x),t.appCheckTokenProvider_.getToken(x)]);m?Hr("getToken() completed but was canceled"):(Hr("getToken() completed. Creating connection."),t.authToken_=P&&P.accessToken,t.appCheckToken_=G&&G.token,v=new DL(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,ue=>{vi(ue+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch(P){t.log_("Failed to get token: "+P),m||(t.repoInfo_.nodeAdmin&&vi(P),b())}}})()}interrupt(t){Hr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Hr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,W.xb)(this.interruptReasons_)&&(this.reconnectDelay_=s0,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>BR(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new an(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){Hr("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Hr("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,W.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+LR.replace(/\./g,"-")]=1,(0,W.uI)()?t["framework.cordova"]=1:(0,W.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=DD.getInstance().currentlyOnline();return(0,W.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class Ht{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ht(e,t)}}class TD{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Ht(ju,e),i=new Ht(ju,t);return 0!==this.compare(r,i)}minPost(){return Ht.MIN}}class kL extends TD{static get __EMPTY_NODE(){return AD}static set __EMPTY_NODE(e){AD=e}compare(e,t){return uf(e.name,t.name)}isDefinedOn(e){throw(0,W.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ht.MIN}maxPost(){return new Ht(Va,AD)}makePost(e,t){return(0,W.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Ht(e,AD)}toString(){return".key"}}const Ua=new kL;class SD{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let XR,xo=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=null!=i?i:n.RED,this.left=null!=a?a:es.EMPTY_NODE,this.right=null!=l?l:es.EMPTY_NODE}copy(t,r,i,a,l){return new n(null!=t?t:this.key,null!=r?r:this.value,null!=i?i:this.color,null!=a?a:this.left,null!=l?l:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return es.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return es.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class es{constructor(e,t=es.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new es(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,xo.BLACK,null,null))}remove(e){return new es(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,xo.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new SD(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new SD(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new SD(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new SD(this.root_,null,this.comparator_,!0,e)}}function TW(n,e){return uf(n.name,e.name)}function JR(n,e){return uf(n,e)}es.EMPTY_NODE=new class DW{copy(e,t,r,i,a){return this}insert(e,t,r){return new xo(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const OL=function(n){return"number"==typeof n?"number:"+eL(n):"string:"+n},FL=function(n){if(n.isLeafNode()){const e=n.val();(0,W.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,W.r3)(e,".sv"),"Priority must be a string or number.")}else(0,W.hu)(n===XR||n.isEmpty(),"priority of unexpected type.");(0,W.hu)(n===XR||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let LL,VL,UL,Hm=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,W.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),FL(this.priorityNode_)}static set __childrenNodeConstructor(t){LL=t}static get __childrenNodeConstructor(){return LL}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return $t(t)?this:".priority"===jt(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=jt(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,W.hu)(".priority"!==i||1===kc(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(_n(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+OL(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?eL(this.value_):this.value_,this.lazyHash_=YF(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,W.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,W.hu)(a>=0,"Unknown leaf type: "+r),(0,W.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Cn=new class MW extends TD{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?uf(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ht.MIN}maxPost(){return new Ht(Va,new Hm("[PRIORITY-POST]",UL))}makePost(e,t){const r=VL(e);return new Ht(t,new Hm("[PRIORITY-POST]",r))}toString(){return".priority"}},RW=Math.log(2);class NW{constructor(e){this.count=parseInt(Math.log(e+1)/RW,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const xD=function(n,e,t,r){n.sort(e);const i=function(m,v){const b=v-m;let D,x;if(0===b)return null;if(1===b)return D=n[m],x=t?t(D):D,new xo(x,D.node,xo.BLACK,null,null);{const P=parseInt(b/2,10)+m,G=i(m,P),ue=i(P+1,v);return D=n[P],x=t?t(D):D,new xo(x,D.node,xo.BLACK,G,ue)}},h=function(m){let v=null,b=null,D=n.length;const x=function(G,ue){const Ee=D-G,at=D;D-=G;const dt=i(Ee+1,at),ht=n[Ee],ut=t?t(ht):ht;P(new xo(ut,ht.node,ue,null,dt))},P=function(G){v?(v.left=G,v=G):(b=G,v=G)};for(let G=0;G<m.count;++G){const ue=m.nextBitIsOne(),Ee=Math.pow(2,m.count-(G+1));ue?x(Ee,xo.BLACK):(x(Ee,xo.BLACK),x(Ee,xo.RED))}return b}(new NW(n.length));return new es(r||e,h)};let eN;const Wm={};class $u{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,W.hu)(Wm&&Cn,"ChildrenNode.ts has not been loaded"),eN=eN||new $u({".priority":Wm},{".priority":Cn}),eN}get(e){const t=(0,W.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof es?t:null}hasIndex(e){return(0,W.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,W.hu)(e!==Ua,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(Ht.Wrap);let h,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();h=i?xD(r,e.getCompare()):Wm;const m=e.toString(),v=Object.assign({},this.indexSet_);v[m]=e;const b=Object.assign({},this.indexes_);return b[m]=h,new $u(b,v)}addToIndexes(e,t){const r=(0,W.UI)(this.indexes_,(i,a)=>{const l=(0,W.DV)(this.indexSet_,a);if((0,W.hu)(l,"Missing index implementation for "+a),i===Wm){if(l.isDefinedOn(e.node)){const h=[],m=t.getIterator(Ht.Wrap);let v=m.getNext();for(;v;)v.name!==e.name&&h.push(v),v=m.getNext();return h.push(e),xD(h,l.getCompare())}return Wm}{const h=t.get(e.name);let m=i;return h&&(m=m.remove(new Ht(e.name,h))),m.insert(e,e.node)}});return new $u(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,W.UI)(this.indexes_,i=>{if(i===Wm)return i;{const a=t.get(e.name);return a?i.remove(new Ht(e.name,a)):i}});return new $u(r,this.indexSet_)}}let o0,Tt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&FL(this.priorityNode_),this.children_.isEmpty()&&(0,W.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return o0||(o0=new n(new es(JR),null,$u.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||o0}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?o0:r}}getChild(t){const r=jt(t);return null===r?this:this.getImmediateChild(r).getChild(_n(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,W.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new Ht(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?o0:this.priorityNode_;return new n(a,h,l)}}updateChild(t,r){const i=jt(t);if(null===i)return r;{(0,W.hu)(".priority"!==jt(t)||1===kc(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(_n(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(Cn,(h,m)=>{r[h]=m.val(t),i++,l&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):l=!1}),!t&&l&&a<2*i){const h=[];for(const m in r)h[m]=r[m];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+OL(this.getPriority().val())+":"),this.forEachChild(Cn,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":YF(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new Ht(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new Ht(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new Ht(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,Ht.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,Ht.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===a0?-1:0}withIndex(t){if(t===Ua||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Ua||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(Cn),a=r.getIterator(Cn);let l=i.getNext(),h=a.getNext();for(;l&&h;){if(l.name!==h.name||!l.node.equals(h.node))return!1;l=i.getNext(),h=a.getNext()}return null===l&&null===h}return!1}return!1}}resolveIndex_(t){return t===Ua?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const a0=new class PW extends Tt{constructor(){super(new es(JR),Tt.EMPTY_NODE,$u.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Tt.EMPTY_NODE}isEmpty(){return!1}};function Wn(n,e=null){if(null===n)return Tt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,W.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Hm(n,Wn(e));if(n instanceof Array){let t=Tt.EMPTY_NODE;return Wr(n,(r,i)=>{if((0,W.r3)(n,r)&&"."!==r.substring(0,1)){const a=Wn(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(Wn(e))}{const t=[];let r=!1;if(Wr(n,(l,h)=>{if("."!==l.substring(0,1)){const m=Wn(h);m.isEmpty()||(r=r||!m.getPriority().isEmpty(),t.push(new Ht(l,m)))}}),0===t.length)return Tt.EMPTY_NODE;const a=xD(t,TW,l=>l.name,JR);if(r){const l=xD(t,Cn.getCompare());return new Tt(a,Wn(e),new $u({".priority":l},{".priority":Cn}))}return new Tt(a,Wn(e),$u.Default)}}Object.defineProperties(Ht,{MIN:{value:new Ht(ju,Tt.EMPTY_NODE)},MAX:{value:new Ht(Va,a0)}}),kL.__EMPTY_NODE=Tt.EMPTY_NODE,Hm.__childrenNodeConstructor=Tt,function AW(n){XR=n}(a0),function xW(n){UL=n}(a0),function SW(n){VL=n}(Wn);class tN extends TD{constructor(e){super(),this.indexPath_=e,(0,W.hu)(!$t(e)&&".priority"!==jt(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?uf(e.name,t.name):a}makePost(e,t){const r=Wn(e),i=Tt.EMPTY_NODE.updateChild(this.indexPath_,r);return new Ht(t,i)}maxPost(){const e=Tt.EMPTY_NODE.updateChild(this.indexPath_,a0);return new Ht(Va,e)}toString(){return r0(this.indexPath_,0).join("/")}}const nN=new class OW extends TD{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?uf(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ht.MIN}maxPost(){return Ht.MAX}makePost(e,t){const r=Wn(e);return new Ht(t,r)}toString(){return".value"}};function l0(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class sN{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Cn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,W.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,W.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ju}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,W.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,W.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Va}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,W.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Cn}copy(){const e=new sN;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function GL(n){const e={};if(n.isDefault())return e;let t;return n.index_===Cn?t="$priority":n.index_===nN?t="$value":n.index_===Ua?t="$key":((0,W.hu)(n.index_ instanceof tN,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,W.Wl)(t),n.startSet_&&(e.startAt=(0,W.Wl)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,W.Wl)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,W.Wl)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,W.Wl)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function zL(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Cn&&(e.i=n.index_.toString()),e}class RD extends TL{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=XE("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,W.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=RD.getListenId_(e,r),h={};this.listens_[l]=h;const m=GL(e._queryParams);this.restRequest_(a+".json",m,(v,b)=>{let D=b;if(404===v&&(D=null,v=null),null===v&&this.onDataUpdate_(a,D,!1,r),(0,W.DV)(this.listens_,l)===h){let x;x=v?401===v?"permission_denied":"rest_error:"+v:"ok",i(x,null)}})}unlisten(e,t){const r=RD.getListenId_(e,t);delete this.listens_[r]}get(e){const t=GL(e._queryParams),r=e._path.toString(),i=new W.BH;return this.restRequest_(r+".json",t,(a,l)=>{let h=l;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,W.xO)(t);this.log_("Sending REST request for "+l);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);let m=null;if(h.status>=200&&h.status<300){try{m=(0,W.cI)(h.responseText)}catch(v){vi("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,m)}else 401!==h.status&&404!==h.status&&vi("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()})}}class WW{constructor(){this.rootNode_=Tt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function ND(){return{value:null,children:new Map}}function qm(n,e,t){if($t(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=jt(e);n.children.has(r)||n.children.set(r,ND()),qm(n.children.get(r),e=_n(e),t)}}function lN(n,e,t){null!==n.value?t(e,n.value):function GW(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{lN(i,new an(e.toString()+"/"+r),t)})}class zW{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Wr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class ZW{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new zW(e);const r=1e4+2e4*Math.random();t0(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Wr(e,(i,a)=>{a>0&&(0,W.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),t0(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var so=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(so||(so={})),so))();function hN(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class PD{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=so.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if($t(this.path)){if(null!=this.affectedTree.value)return(0,W.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new an(e));return new PD(en(),t,this.revert)}}return(0,W.hu)(jt(this.path)===e,"operationForChild called for unrelated child."),new PD(_n(this.path),this.affectedTree,this.revert)}}class df{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=so.OVERWRITE}operationForChild(e){return $t(this.path)?new df(this.source,en(),this.snap.getImmediateChild(e)):new df(this.source,_n(this.path),this.snap)}}class Km{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=so.MERGE}operationForChild(e){if($t(this.path)){const t=this.children.subtree(new an(e));return t.isEmpty()?null:t.value?new df(this.source,en(),t.value):new Km(this.source,en(),t)}return(0,W.hu)(jt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Km(this.source,_n(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Oc{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if($t(e))return this.isFullyInitialized()&&!this.filtered_;const t=jt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function h0(n,e,t,r,i,a){const l=r.filter(h=>h.type===t);l.sort((h,m)=>function XW(n,e,t){if(null==e.childName||null==t.childName)throw(0,W.g5)("Should only compare child_ events.");const r=new Ht(e.childName,e.snapshotNode),i=new Ht(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,m)),l.forEach(h=>{const m=function JW(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(v=>{v.respondsTo(h.type)&&e.push(v.createEvent(m,n.query_))})})}function kD(n,e){return{eventCache:n,serverCache:e}}function f0(n,e,t,r){return kD(new Oc(e,t,r),n.serverCache)}function KL(n,e,t,r){return kD(n.eventCache,new Oc(e,t,r))}function OD(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function hf(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let fN;class bn{constructor(e,t=(()=>(fN||(fN=new es(VH)),fN))()){this.value=e,this.children=t}static fromObject(e){let t=new bn(null);return Wr(e,(r,i)=>{t=t.set(new an(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:en(),value:this.value};if($t(e))return null;{const r=jt(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(_n(e),t);return null!=a?{path:On(new an(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if($t(e))return this;{const t=jt(e),r=this.children.get(t);return null!==r?r.subtree(_n(e)):new bn(null)}}set(e,t){if($t(e))return new bn(t,this.children);{const r=jt(e),a=(this.children.get(r)||new bn(null)).set(_n(e),t),l=this.children.insert(r,a);return new bn(this.value,l)}}remove(e){if($t(e))return this.children.isEmpty()?new bn(null):new bn(null,this.children);{const t=jt(e),r=this.children.get(t);if(r){const i=r.remove(_n(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new bn(null):new bn(this.value,a)}return this}}get(e){if($t(e))return this.value;{const t=jt(e),r=this.children.get(t);return r?r.get(_n(e)):null}}setTree(e,t){if($t(e))return t;{const r=jt(e),a=(this.children.get(r)||new bn(null)).setTree(_n(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new bn(this.value,l)}}fold(e){return this.fold_(en(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(On(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,en(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if($t(e))return null;{const a=jt(e),l=this.children.get(a);return l?l.findOnPath_(_n(e),On(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,en(),t)}foreachOnPath_(e,t,r){if($t(e))return this;{this.value&&r(t,this.value);const i=jt(e),a=this.children.get(i);return a?a.foreachOnPath_(_n(e),On(t,i),r):new bn(null)}}foreach(e){this.foreach_(en(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(On(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Mo{constructor(e){this.writeTree_=e}static empty(){return new Mo(new bn(null))}}function p0(n,e,t){if($t(e))return new Mo(new bn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=Vi(i,e);return a=a.updateChild(l,t),new Mo(n.writeTree_.set(i,a))}{const i=new bn(t),a=n.writeTree_.setTree(e,i);return new Mo(a)}}}function pN(n,e,t){let r=n;return Wr(t,(i,a)=>{r=p0(r,On(e,i),a)}),r}function ZL(n,e){if($t(e))return Mo.empty();{const t=n.writeTree_.setTree(e,new bn(null));return new Mo(t)}}function gN(n,e){return null!=ff(n,e)}function ff(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Vi(t.path,e)):null}function YL(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Cn,(r,i)=>{e.push(new Ht(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new Ht(r,i.value))}),e}function Fc(n,e){if($t(e))return n;{const t=ff(n,e);return new Mo(null!=t?new bn(t):n.writeTree_.subtree(e))}}function mN(n){return n.writeTree_.isEmpty()}function Zm(n,e){return QL(en(),n.writeTree_,e)}function QL(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,W.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=QL(On(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(On(n,".priority"),r)),t}}function FD(n,e){return nV(e,n)}function sG(n,e){if(n.snap)return io(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&io(On(n.path,t),e))return!0;return!1}function aG(n){return n.visible}function JL(n,e,t){let r=Mo.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let h;if(a.snap)io(t,l)?(h=Vi(t,l),r=p0(r,h,a.snap)):io(l,t)&&(h=Vi(l,t),r=p0(r,en(),a.snap.getChild(h)));else{if(!a.children)throw(0,W.g5)("WriteRecord should have .snap or .children");if(io(t,l))h=Vi(t,l),r=pN(r,h,a.children);else if(io(l,t))if(h=Vi(l,t),$t(h))r=pN(r,en(),a.children);else{const m=(0,W.DV)(a.children,jt(h));if(m){const v=m.getChild(_n(h));r=p0(r,en(),v)}}}}}return r}function XL(n,e,t,r,i){if(r||i){const a=Fc(n.visibleWrites,e);return!i&&mN(a)?t:i||null!=t||gN(a,en())?Zm(JL(n.allWrites,function(v){return(v.visible||i)&&(!r||!~r.indexOf(v.writeId))&&(io(v.path,e)||io(e,v.path))},e),t||Tt.EMPTY_NODE):null}{const a=ff(n.visibleWrites,e);if(null!=a)return a;{const l=Fc(n.visibleWrites,e);return mN(l)?t:null!=t||gN(l,en())?Zm(l,t||Tt.EMPTY_NODE):null}}}function LD(n,e,t,r){return XL(n.writeTree,n.treePath,e,t,r)}function _N(n,e){return function uG(n,e,t){let r=Tt.EMPTY_NODE;const i=ff(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Cn,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=Fc(n.visibleWrites,e);return t.forEachChild(Cn,(l,h)=>{const m=Zm(Fc(a,new an(l)),h);r=r.updateImmediateChild(l,m)}),YL(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return YL(Fc(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function eV(n,e,t,r){return function lG(n,e,t,r,i){(0,W.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=On(e,t);if(gN(n.visibleWrites,a))return null;{const l=Fc(n.visibleWrites,a);return mN(l)?i.getChild(t):Zm(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function VD(n,e){return function dG(n,e){return ff(n.visibleWrites,e)}(n.writeTree,On(n.treePath,e))}function yN(n,e,t){return function cG(n,e,t,r){const i=On(e,t),a=ff(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?Zm(Fc(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function tV(n,e){return nV(On(n.treePath,e),n.writeTree)}function nV(n,e){return{treePath:n,writeTree:e}}class gG{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,W.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,W.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,l0(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,function u0(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,function zm(n,e){return{type:"child_added",snapshotNode:e,childName:n}}(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,W.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,l0(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const rV=new class mG{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class vN{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Oc(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yN(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:hf(this.viewCache_),a=function pG(n,e,t,r,i,a){return function hG(n,e,t,r,i,a,l){let h;const m=Fc(n.visibleWrites,e),v=ff(m,en());if(null!=v)h=v;else{if(null==t)return[];h=Zm(m,t)}if(h=h.withIndex(l),h.isEmpty()||h.isLeafNode())return[];{const b=[],D=l.getCompare(),x=a?h.getReverseIteratorFrom(r,l):h.getIteratorFrom(r,l);let P=x.getNext();for(;P&&b.length<i;)0!==D(P,r)&&b.push(P),P=x.getNext();return b}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function iV(n,e,t,r,i,a){const l=e.eventCache;if(null!=VD(r,t))return e;{let h,m;if($t(t))if((0,W.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const v=hf(e),D=_N(r,v instanceof Tt?v:Tt.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),D,a)}else{const v=LD(r,hf(e));h=n.filter.updateFullNode(e.eventCache.getNode(),v,a)}else{const v=jt(t);if(".priority"===v){(0,W.hu)(1===kc(t),"Can't have a priority with additional path components");const b=l.getNode();m=e.serverCache.getNode();const D=eV(r,t,b,m);h=null!=D?n.filter.updatePriority(b,D):l.getNode()}else{const b=_n(t);let D;if(l.isCompleteForChild(v)){m=e.serverCache.getNode();const x=eV(r,t,l.getNode(),m);D=null!=x?l.getNode().getImmediateChild(v).updateChild(b,x):l.getNode().getImmediateChild(v)}else D=yN(r,v,e.serverCache);h=null!=D?n.filter.updateChild(l.getNode(),v,D,b,i,a):l.getNode()}}return f0(e,h,l.isFullyInitialized()||$t(t),n.filter.filtersNodes())}}function UD(n,e,t,r,i,a,l,h){const m=e.serverCache;let v;const b=l?n.filter:n.filter.getIndexedFilter();if($t(t))v=b.updateFullNode(m.getNode(),r,null);else if(b.filtersNodes()&&!m.isFiltered()){const P=m.getNode().updateChild(t,r);v=b.updateFullNode(m.getNode(),P,null)}else{const P=jt(t);if(!m.isCompleteForPath(t)&&kc(t)>1)return e;const G=_n(t),Ee=m.getNode().getImmediateChild(P).updateChild(G,r);v=".priority"===P?b.updatePriority(m.getNode(),Ee):b.updateChild(m.getNode(),P,Ee,G,rV,null)}const D=KL(e,v,m.isFullyInitialized()||$t(t),b.filtersNodes());return iV(n,D,t,i,new vN(i,D,a),h)}function EN(n,e,t,r,i,a,l){const h=e.eventCache;let m,v;const b=new vN(i,e,a);if($t(t))v=n.filter.updateFullNode(e.eventCache.getNode(),r,l),m=f0(e,v,!0,n.filter.filtersNodes());else{const D=jt(t);if(".priority"===D)v=n.filter.updatePriority(e.eventCache.getNode(),r),m=f0(e,v,h.isFullyInitialized(),h.isFiltered());else{const x=_n(t),P=h.getNode().getImmediateChild(D);let G;if($t(x))G=r;else{const ue=b.getCompleteChild(D);G=null!=ue?".priority"===ZR(x)&&ue.getChild(ML(x)).isEmpty()?ue:ue.updateChild(x,r):Tt.EMPTY_NODE}m=P.equals(G)?e:f0(e,n.filter.updateChild(h.getNode(),D,G,x,b,l),h.isFullyInitialized(),n.filter.filtersNodes())}}return m}function sV(n,e){return n.eventCache.isCompleteForChild(e)}function oV(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function wN(n,e,t,r,i,a,l,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let v,m=e;v=$t(t)?r:new bn(null).setTree(t,r);const b=e.serverCache.getNode();return v.children.inorderTraversal((D,x)=>{if(b.hasChild(D)){const G=oV(0,e.serverCache.getNode().getImmediateChild(D),x);m=UD(n,m,new an(D),G,i,a,l,h)}}),v.children.inorderTraversal((D,x)=>{const P=!e.serverCache.isCompleteForChild(D)&&null===x.value;if(!b.hasChild(D)&&!P){const ue=oV(0,e.serverCache.getNode().getImmediateChild(D),x);m=UD(n,m,new an(D),ue,i,a,l,h)}}),m}function SG(n,e){const t=hf(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!$t(e)&&!t.getImmediateChild(jt(e)).isEmpty())?t.getChild(e):null}function lV(n,e,t,r){e.type===so.MERGE&&null!==e.source.queryId&&((0,W.hu)(hf(n.viewCache_),"We should always have a full cache before handling merges"),(0,W.hu)(OD(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function vG(n,e,t,r,i){const a=new gG;let l,h;if(t.type===so.OVERWRITE){const v=t;v.source.fromUser?l=EN(n,e,v.path,v.snap,r,i,a):((0,W.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered()&&!$t(v.path),l=UD(n,e,v.path,v.snap,r,i,h,a))}else if(t.type===so.MERGE){const v=t;v.source.fromUser?l=function wG(n,e,t,r,i,a,l){let h=e;return r.foreach((m,v)=>{const b=On(t,m);sV(e,jt(b))&&(h=EN(n,h,b,v,i,a,l))}),r.foreach((m,v)=>{const b=On(t,m);sV(e,jt(b))||(h=EN(n,h,b,v,i,a,l))}),h}(n,e,v.path,v.children,r,i,a):((0,W.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered(),l=wN(n,e,v.path,v.children,r,i,h,a))}else if(t.type===so.ACK_USER_WRITE){const v=t;l=v.revert?function bG(n,e,t,r,i,a){let l;if(null!=VD(r,t))return e;{const h=new vN(r,e,i),m=e.eventCache.getNode();let v;if($t(t)||".priority"===jt(t)){let b;if(e.serverCache.isFullyInitialized())b=LD(r,hf(e));else{const D=e.serverCache.getNode();(0,W.hu)(D instanceof Tt,"serverChildren would be complete if leaf node"),b=_N(r,D)}v=n.filter.updateFullNode(m,b,a)}else{const b=jt(t);let D=yN(r,b,e.serverCache);null==D&&e.serverCache.isCompleteForChild(b)&&(D=m.getImmediateChild(b)),v=null!=D?n.filter.updateChild(m,b,D,_n(t),h,a):e.eventCache.getNode().hasChild(b)?n.filter.updateChild(m,b,Tt.EMPTY_NODE,_n(t),h,a):m,v.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=LD(r,hf(e)),l.isLeafNode()&&(v=n.filter.updateFullNode(v,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=VD(r,en()),f0(e,v,l,n.filter.filtersNodes())}}(n,e,v.path,r,i,a):function IG(n,e,t,r,i,a,l){if(null!=VD(i,t))return e;const h=e.serverCache.isFiltered(),m=e.serverCache;if(null!=r.value){if($t(t)&&m.isFullyInitialized()||m.isCompleteForPath(t))return UD(n,e,t,m.getNode().getChild(t),i,a,h,l);if($t(t)){let v=new bn(null);return m.getNode().forEachChild(Ua,(b,D)=>{v=v.set(new an(b),D)}),wN(n,e,t,v,i,a,h,l)}return e}{let v=new bn(null);return r.foreach((b,D)=>{const x=On(t,b);m.isCompleteForPath(x)&&(v=v.set(b,m.getNode().getChild(x)))}),wN(n,e,t,v,i,a,h,l)}}(n,e,v.path,v.affectedTree,r,i,a)}else{if(t.type!==so.LISTEN_COMPLETE)throw(0,W.g5)("Unknown operation type: "+t.type);l=function CG(n,e,t,r,i){const a=e.serverCache;return iV(n,KL(e,a.getNode(),a.isFullyInitialized()||$t(t),a.isFiltered()),t,r,rV,i)}(n,e,t.path,r,a)}const m=a.getChanges();return function EG(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=OD(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(function WL(n){return{type:"value",snapshotNode:n}}(OD(e)))}}(e,l,m),{viewCache:l,changes:m}}(n.processor_,i,e,t,r);return function yG(n,e){(0,W.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,W.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,W.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,function cV(n,e,t,r){return function QW(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function LW(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),h0(n,i,"child_removed",e,r,t),h0(n,i,"child_added",e,r,t),h0(n,i,"child_moved",a,r,t),h0(n,i,"child_changed",e,r,t),h0(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}(n,a.changes,a.viewCache.eventCache.getNode(),null)}let BD,$D;function IN(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,W.hu)(null!=a,"SyncTree gave us an op for an invalid query."),lV(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(lV(l,e,t,r));return a}}function Lc(n,e){let t=null;for(const r of n.views.values())t=t||SG(r,e);return t}class mV{constructor(e){this.listenProvider_=e,this.syncPointTree_=new bn(null),this.pendingWriteTree_=function fG(){return{visibleWrites:Mo.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function CN(n,e,t,r,i){return function tG(n,e,t,r,i){(0,W.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=p0(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?Ym(n,new df({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Uc(n,e,t=!1){const r=function rG(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function iG(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,W.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const h=n.allWrites[l];h.visible&&(l>=t&&sG(h,r.path)?i=!1:io(r.path,h.path)&&(a=!0)),l--}return!!i&&(a?(function oG(n){n.visibleWrites=JL(n.allWrites,aG,en()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=ZL(n.visibleWrites,r.path):Wr(r.children,m=>{n.visibleWrites=ZL(n.visibleWrites,On(r.path,m))}),!0))}(n.pendingWriteTree_,e)){let a=new bn(null);return null!=r.snap?a=a.set(en(),!0):Wr(r.children,l=>{a=a.set(new an(l),!0)}),Ym(n,new PD(r.path,a,t))}return[]}function g0(n,e,t){return Ym(n,new df({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function WD(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,h)=>{const v=Lc(h,Vi(l,e));if(v)return v});return XL(i,e,a,t,!0)}function Ym(n,e){return yV(e,n.syncPointTree_,null,FD(n.pendingWriteTree_,en()))}function yV(n,e,t,r){if($t(n.path))return vV(n,e,t,r);{const i=e.get(en());null==t&&null!=i&&(t=Lc(i,en()));let a=[];const l=jt(n.path),h=n.operationForChild(l),m=e.children.get(l);if(m&&h){const v=t?t.getImmediateChild(l):null,b=tV(r,l);a=a.concat(yV(h,m,v,b))}return i&&(a=a.concat(IN(i,n,r,t))),a}}function vV(n,e,t,r){const i=e.get(en());null==t&&null!=i&&(t=Lc(i,en()));let a=[];return e.children.inorderTraversal((l,h)=>{const m=t?t.getImmediateChild(l):null,v=tV(r,l),b=n.operationForChild(l);b&&(a=a.concat(vV(b,h,m,v)))}),i&&(a=a.concat(IN(i,n,r,t))),a}function DN(n,e){return n.tagToQueryMap.get(e)}function TN(n){const e=n.indexOf("$");return(0,W.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new an(n.substr(0,e))}}function AN(n,e,t){const r=n.syncPointTree_.get(e);return(0,W.hu)(r,"Missing sync point for query tag that we're tracking"),IN(r,t,FD(n.pendingWriteTree_,e),null)}class SN{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new SN(t)}node(){return this.node_}}class xN{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=On(this.path_,e);return new xN(this.syncTree_,t)}node(){return WD(this.syncTree_,this.path_)}}const wV=function(n,e,t){return n&&"object"==typeof n?((0,W.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?YG(n[".sv"],e,t):"object"==typeof n[".sv"]?QG(n[".sv"],e):void(0,W.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},YG=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,W.hu)(!1,"Unexpected server value: "+n)},QG=function(n,e,t){n.hasOwnProperty("increment")||(0,W.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,W.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,W.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},MN=function(n,e,t){return RN(n,new SN(e),t)};function RN(n,e,t){const r=n.getPriority().val(),i=wV(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,h=wV(l.getValue(),e,t);return h!==l.getValue()||i!==l.getPriority().val()?new Hm(h,Wn(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new Hm(i))),l.forEachChild(Cn,(h,m)=>{const v=RN(m,e.getImmediateChild(h),t);v!==m&&(a=a.updateImmediateChild(h,v))}),a}}class NN{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function zD(n,e){let t=e instanceof an?e:new an(e),r=n,i=jt(t);for(;null!==i;){const a=(0,W.DV)(r.node.children,i)||{children:{},childCount:0};r=new NN(i,r,a),t=_n(t),i=jt(t)}return r}function pf(n){return n.node.value}function PN(n,e){n.node.value=e,kN(n)}function CV(n){return n.node.childCount>0}function qD(n,e){Wr(n.node.children,(t,r)=>{e(new NN(t,n,r))})}function bV(n,e,t,r){t&&!r&&e(n),qD(n,i=>{bV(i,e,!0,r)}),t&&r&&e(n)}function y0(n){return new an(null===n.parent?n.name:y0(n.parent)+"/"+n.name)}function kN(n){null!==n.parent&&function ez(n,e,t){const r=function JG(n){return void 0===pf(n)&&!CV(n)}(t),i=(0,W.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,kN(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,kN(n))}(n.parent,n.name,n)}const tz=/[\[\].#$\/\u0000-\u001F\u007F]/,nz=/[\[\].#$\u0000-\u001F\u007F]/,ON=10485760,KD=function(n){return"string"==typeof n&&0!==n.length&&!tz.test(n)},E0=function(n,e,t){const r=t instanceof an?new yW(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+lf(r));if("function"==typeof e)throw new Error(n+"contains a function "+lf(r)+" with contents = "+e.toString());if(wD(e))throw new Error(n+"contains "+e.toString()+" "+lf(r));if("string"==typeof e&&e.length>ON/3&&(0,W.ug)(e)>ON)throw new Error(n+"contains a string greater than "+ON+" utf8 bytes "+lf(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Wr(e,(l,h)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!KD(l)))throw new Error(n+" contains an invalid key ("+l+") "+lf(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function vW(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,W.ug)(e),RL(n)})(r,l),E0(n,h,r),function EW(n){const e=n.parts_.pop();n.byteLength_-=(0,W.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+lf(r)+" in addition to actual children.")}},AV=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!KD(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),function(n){return"string"==typeof n&&0!==n.length&&!nz.test(n)}(n)}(t))throw new Error((0,W.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class oz{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function As(n,e,t){(function ZD(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!YR(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)})(n,t),function xV(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(az(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}(n,r=>io(r,e)||io(e,r))}function az(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();af&&Hr("event: "+t.toString()),jm(r)}}}class lz{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new oz,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ND(),this.transactionQueueTree_=new NN,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function RV(n){const t=n.infoData_.getNode(new an(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function I0(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:RV(n)})}function NV(n,e,t,r,i){n.dataUpdateCount++;const a=new an(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const m=(0,W.UI)(t,v=>Wn(v));l=function HG(n,e,t,r){const i=DN(n,r);if(i){const a=TN(i),l=a.path,h=a.queryId,m=Vi(l,e),v=bn.fromObject(t);return AN(n,l,new Km(hN(h),m,v))}return[]}(n.serverSyncTree_,a,m,i)}else{const m=Wn(t);l=function _V(n,e,t,r){const i=DN(n,r);if(null!=i){const a=TN(i),l=a.path,h=a.queryId,m=Vi(l,e);return AN(n,l,new df(hN(h),m,t))}return[]}(n.serverSyncTree_,a,m,i)}else if(r){const m=(0,W.UI)(t,v=>Wn(v));l=function BG(n,e,t){const r=bn.fromObject(t);return Ym(n,new Km({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,m)}else{const m=Wn(t);l=g0(n.serverSyncTree_,a,m)}let h=a;l.length>0&&(h=Jm(n,a)),As(n.eventQueue_,h,l)}function PV(n,e){VN(n,"connected",e),!1===e&&function pz(n){Qm(n,"onDisconnectEvents");const e=I0(n),t=ND();lN(n.onDisconnect_,en(),(i,a)=>{const l=function(n,e,t,r){return RN(e,new xN(t,n),r)}(i,a,n.serverSyncTree_,e);qm(t,i,l)});let r=[];lN(t,en(),(i,a)=>{r=r.concat(g0(n.serverSyncTree_,i,a));const l=function $N(n,e){const t=y0(FV(n,e)),r=zD(n.transactionQueueTree_,e);return function XG(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{HN(n,i)}),HN(n,r),bV(r,i=>{HN(n,i)}),t}(n,i);Jm(n,l)}),n.onDisconnect_=ND(),As(n.eventQueue_,en(),r)}(n)}function VN(n,e,t){const r=new an("/.info/"+e),i=Wn(t);n.infoData_.updateSnapshot(r,i);const a=g0(n.infoSyncTree_,r,i);As(n.eventQueue_,r,a)}function YD(n){return n.nextWriteId_++}function Qm(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Hr(t,...e)}function jN(n,e,t){return WD(n.serverSyncTree_,e,t)||Tt.EMPTY_NODE}function QD(n,e=n.transactionQueueTree_){if(e||JD(n,e),pf(e)){const t=LV(n,e);(0,W.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function wz(n,e,t){const r=t.map(v=>v.currentWriteId),i=jN(n,e,r);let a=i;const l=i.hash();for(let v=0;v<t.length;v++){const b=t[v];(0,W.hu)(0===b.status,"tryToSendTransactionQueue_: items in queue should all be run."),b.status=1,b.retryCount++;const D=Vi(e,b.path);a=a.updateChild(D,b.currentOutputSnapshotRaw)}const h=a.val(!0),m=e;n.server_.put(m.toString(),h,v=>{Qm(n,"transaction put response",{path:m.toString(),status:v});let b=[];if("ok"===v){const D=[];for(let x=0;x<t.length;x++)t[x].status=2,b=b.concat(Uc(n.serverSyncTree_,t[x].currentWriteId)),t[x].onComplete&&D.push(()=>t[x].onComplete(null,!0,t[x].currentOutputSnapshotResolved)),t[x].unwatcher();JD(n,zD(n.transactionQueueTree_,e)),QD(n,n.transactionQueueTree_),As(n.eventQueue_,e,b);for(let x=0;x<D.length;x++)jm(D[x])}else{if("datastale"===v)for(let D=0;D<t.length;D++)t[D].status=3===t[D].status?4:0;else{vi("transaction at "+m.toString()+" failed: "+v);for(let D=0;D<t.length;D++)t[D].status=4,t[D].abortReason=v}Jm(n,e)}},l)}(n,y0(e),t)}else CV(e)&&qD(e,t=>{QD(n,t)})}function Jm(n,e){const t=FV(n,e),r=y0(t);return function Iz(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const m=e[h],v=Vi(t,m.path);let D,b=!1;if((0,W.hu)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===m.status)b=!0,D=m.abortReason,i=i.concat(Uc(n.serverSyncTree_,m.currentWriteId,!0));else if(0===m.status)if(m.retryCount>=25)b=!0,D="maxretry",i=i.concat(Uc(n.serverSyncTree_,m.currentWriteId,!0));else{const x=jN(n,m.path,l);m.currentInputSnapshot=x;const P=e[h].update(x.val());if(void 0!==P){E0("transaction failed: Data returned ",P,m.path);let G=Wn(P);"object"==typeof P&&null!=P&&(0,W.r3)(P,".priority")||(G=G.updatePriority(x.getPriority()));const Ee=m.currentWriteId,at=I0(n),dt=MN(G,x,at);m.currentOutputSnapshotRaw=G,m.currentOutputSnapshotResolved=dt,m.currentWriteId=YD(n),l.splice(l.indexOf(Ee),1),i=i.concat(CN(n.serverSyncTree_,m.path,dt,m.currentWriteId,m.applyLocally)),i=i.concat(Uc(n.serverSyncTree_,Ee,!0))}else b=!0,D="nodata",i=i.concat(Uc(n.serverSyncTree_,m.currentWriteId,!0))}As(n.eventQueue_,t,i),i=[],b&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===D?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(D),!1,null)))}JD(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)jm(r[h]);QD(n,n.transactionQueueTree_)}(n,LV(n,t),r),r}function FV(n,e){let t,r=n.transactionQueueTree_;for(t=jt(e);null!==t&&void 0===pf(r);)r=zD(r,t),t=jt(e=_n(e));return r}function LV(n,e){const t=[];return VV(n,e,t),t.sort((r,i)=>r.order-i.order),t}function VV(n,e,t){const r=pf(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);qD(e,i=>{VV(n,i,t)})}function JD(n,e){const t=pf(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,PN(e,t.length>0?t:void 0)}qD(e,r=>{JD(n,r)})}function HN(n,e){const t=pf(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,W.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,W.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(Uc(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?PN(e,void 0):t.length=a+1,As(n.eventQueue_,y0(e),i);for(let l=0;l<r.length;l++)jm(r[l])}}const WN=function(n,e){const t=Dz(n),r=t.namespace;return"firebase.com"===t.domain&&La(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&La("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&vi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new HR(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new an(t.pathString)}},Dz=function(n){let e="",t="",r="",i="",a="",l=!0,h="https",m=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let b=n.indexOf("/");-1===b&&(b=n.length);let D=n.indexOf("?");-1===D&&(D=n.length),e=n.substring(0,Math.min(b,D)),b<D&&(i=function Cz(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}e+="/"+i}return e}(n.substring(b,D)));const x=function bz(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):vi(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,D)));v=e.indexOf(":"),v>=0?(l="https"===h||"wss"===h,m=parseInt(e.substring(v+1),10)):v=e.length;const P=e.slice(0,v);if("localhost"===P.toLowerCase())t="localhost";else if(P.split(".").length<=2)t=P;else{const G=e.indexOf(".");r=e.substring(0,G).toLowerCase(),t=e.substring(G+1),a=r}"ns"in x&&(a=x.ns)}return{host:e,port:m,domain:t,subdomain:r,secure:l,scheme:h,pathString:i,namespace:a}};class Ss{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return $t(this._path)?null:ZR(this._path)}get ref(){return new Ro(this._repo,this._path)}get _queryIdentifier(){const e=zL(this._queryParams),t=BR(e);return"{}"===t?"default":t}get _queryObject(){return zL(this._queryParams)}isEqual(e){if(!((e=(0,W.m9)(e))instanceof Ss))return!1;const t=this._repo===e._repo,r=YR(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function mW(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}class Ro extends Ss{constructor(e,t){super(e,t,new sN,!1)}get parent(){const e=ML(this._path);return null===e?null:new Ro(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}(function RG(n){(0,W.hu)(!BD,"__referenceConstructor has already been defined"),BD=n})(Ro),function FG(n){(0,W.hu)(!$D,"__referenceConstructor has already been defined"),$D=n}(Ro);const zN={};class Wz{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function cz(n,e,t){if(n.stats_=zR(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new RD(n.repoInfo_,(r,i,a,l)=>{NV(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>PV(n,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,W.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new cf(n.repoInfo_,e,(r,i,a,l)=>{NV(n,r,i,a,l)},r=>{PV(n,r)},r=>{!function dz(n,e){Wr(e,(t,r)=>{VN(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function KH(n,e){const t=n.toString();return GR[t]||(GR[t]=e()),GR[t]}(n.repoInfo_,()=>new ZW(n.stats_,n.server_)),n.infoData_=new WW,n.infoSyncTree_=new mV({startListening:(r,i,a,l)=>{let h=[];const m=n.infoData_.getNode(r._path);return m.isEmpty()||(h=g0(n.infoSyncTree_,r._path,m),setTimeout(()=>{l("ok")},0)),h},stopListening:()=>{}}),VN(n,"connected",!1),n.serverSyncTree_=new mV({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(h,m)=>{const v=l(h,m);As(n.eventQueue_,r._path,v)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ro(this._repo,en())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function jz(n,e){const t=zN[e];(!t||t[n.key]!==n)&&La(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function OV(n){n.persistentConnection_&&n.persistentConnection_.interrupt("repo_interrupt")}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&La("Cannot call "+e+" on a deleted database.")}}function Gz(n=(0,bt.getApp)(),e){const t=(0,bt._getProvider)(n,"database").getImmediate({identifier:e}),r=(0,W.P0)("database");return r&&function zz(n,e,t,r={}){(n=(0,W.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&La("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&La('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new n0(n0.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,W.Sg)(r.mockUserToken,n.app.options.projectId);a=new n0(l)}!function Uz(n,e,t,r){n.repoInfo_=new HR(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(t,...r),t}cf.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},cf.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function qz(n){(function PH(n){LR=n})(bt.SDK_VERSION),(0,bt._registerComponent)(new Is.wA("database",(e,{instanceIdentifier:t})=>function Bz(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||La("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Hr("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let m,v,l=WN(a,i),h=l.repoInfo;"undefined"!=typeof process&&process.env&&(v=process.env.FIREBASE_DATABASE_EMULATOR_HOST),v?(m=!0,a=`http://${v}?ns=${h.namespace}`,l=WN(a,i),h=l.repoInfo):m=!l.repoInfo.secure;const b=i&&m?new n0(n0.OWNER):new GH(n.name,n.options,e);AV("Invalid Firebase Database URL",l),$t(l.path)||La("Database URL must point to the root of a Firebase Database (not including a child path).");const D=function $z(n,e,t,r){let i=zN[e.name];i||(i={},zN[e.name]=i);let a=i[n.toURLString()];return a&&La("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new lz(n,!1,t,r),i[n.toURLString()]=a,a}(h,n,b,new WH(n.name,t));return new Wz(D,n)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,bt.registerVersion)(zF,"0.13.9",n),(0,bt.registerVersion)(zF,"0.13.9","esm2017")}();class qN{constructor(e){return e}}const zV="database",KN=new g.OlP("angularfire2.database-instances");function Jz(n){return(e,t)=>{const r=e.runOutsideAngular(()=>n(t));return new qN(r)}}const Xz={provide:class Yz{constructor(){return Mg(zV)}},deps:[[new g.FiY,KN]]},e3={provide:qN,useFactory:function Qz(n,e){const t=xg(zV,n,e);return t&&new qN(t)},deps:[[new g.FiY,KN],sf]};let t3=(()=>{class n{constructor(){(0,bt.registerVersion)("angularfire",ih.full,"rtdb")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[e3,Xz]}),n})();function n3(n,...e){return{ngModule:t3,providers:[{provide:KN,useFactory:Jz(n),multi:!0,deps:[g.R0b,g.zs3,oh,hR,[new g.FiY,OR],[new g.FiY,YE],...e]}]}}const r3=Au(Gz,!0);class ZN{constructor(e){return e}}const qV="firestore",YN=new g.OlP("angularfire2.firestore-instances");function o3(n){return(e,t)=>{const r=e.runOutsideAngular(()=>n(t));return new ZN(r)}}const a3={provide:class i3{constructor(){return Mg(qV)}},deps:[[new g.FiY,YN]]},u3={provide:ZN,useFactory:function s3(n,e){const t=xg(qV,n,e);return t&&new ZN(t)},deps:[[new g.FiY,YN],sf]};let l3=(()=>{class n{constructor(){(0,bt.registerVersion)("angularfire",ih.full,"fst")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({providers:[u3,a3]}),n})();function c3(n,...e){return{ngModule:l3,providers:[{provide:YN,useFactory:o3(n),multi:!0,deps:[g.R0b,g.zs3,oh,hR,[new g.FiY,OR],[new g.FiY,YE],...e]}]}}const d3=Au(Y2,!0);let h3=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=g.oAB({type:n,bootstrap:[xH]}),n.\u0275inj=g.cJS({providers:[{provide:Cs.Dh,useValue:PR.firebase}],imports:[[Jc,SH,s$(()=>o$(PR.firebase)),n3(()=>r3()),c3(()=>d3()),nA,Xw]]}),n})();PR.production&&(0,g.G48)(),l_().bootstrapModule(h3).catch(n=>console.error(n))},127:(Qe,ve,F)=>{F.d(ve,{Z:()=>g.Z});var g=F(3942);g.Z.registerVersion("firebase","9.12.1","app-compat")},5881:(Qe,ve,F)=>{F.r(ve);var g=F(5861),U=F(3942),k=F(7573),ae=F(2090),De=(F(9681),F(1877),F(4859));function de(){return window}function $(){return($=(0,g.Z)(function*(L,M,O){var re;const{BuildInfo:Te}=de();(0,k.aq)(M.sessionId,"AuthEvent did not contain a session ID");const ze=yield ye(M.sessionId),Je={};return(0,k.ar)()?Je.ibi=Te.packageName:(0,k.as)()?Je.apn=Te.packageName:(0,k.at)(L,"operation-not-supported-in-this-environment"),Te.displayName&&(Je.appDisplayName=Te.displayName),Je.sessionId=ze,(0,k.au)(L,O,M.type,void 0,null!==(re=M.eventId)&&void 0!==re?re:void 0,Je)})).apply(this,arguments)}function Oe(){return(Oe=(0,g.Z)(function*(L){const{BuildInfo:M}=de(),O={};(0,k.ar)()?O.iosBundleId=M.packageName:(0,k.as)()?O.androidPackageName=M.packageName:(0,k.at)(L,"operation-not-supported-in-this-environment"),yield(0,k.av)(L,O)})).apply(this,arguments)}function ke(){return(ke=(0,g.Z)(function*(L,M,O){const{cordova:re}=de();let Te=()=>{};try{yield new Promise((ze,Je)=>{let yt=null;function Ze(){var Mt;ze();const ar=null===(Mt=re.plugins.browsertab)||void 0===Mt?void 0:Mt.close;"function"==typeof ar&&ar(),"function"==typeof(null==O?void 0:O.close)&&O.close()}function Kt(){yt||(yt=window.setTimeout(()=>{Je((0,k.aw)(L,"redirect-cancelled-by-user"))},2e3))}function Fn(){"visible"===(null==document?void 0:document.visibilityState)&&Kt()}M.addPassiveListener(Ze),document.addEventListener("resume",Kt,!1),(0,k.as)()&&document.addEventListener("visibilitychange",Fn,!1),Te=()=>{M.removePassiveListener(Ze),document.removeEventListener("resume",Kt,!1),document.removeEventListener("visibilitychange",Fn,!1),yt&&window.clearTimeout(yt)}})}finally{Te()}})).apply(this,arguments)}function ye(L){return We.apply(this,arguments)}function We(){return(We=(0,g.Z)(function*(L){const M=$e(L),O=yield crypto.subtle.digest("SHA-256",M);return Array.from(new Uint8Array(O)).map(Te=>Te.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function $e(L){if((0,k.aq)(/[0-9a-zA-Z]+/.test(L),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(L);const M=new ArrayBuffer(L.length),O=new Uint8Array(M);for(let re=0;re<L.length;re++)O[re]=L.charCodeAt(re);return O}class ge extends k.aA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(M=>{this.resolveInialized=M})}addPassiveListener(M){this.passiveListeners.add(M)}removePassiveListener(M){this.passiveListeners.delete(M)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(M){return this.resolveInialized(),this.passiveListeners.forEach(O=>O(M)),super.onEvent(M)}initialized(){var M=this;return(0,g.Z)(function*(){yield M.initPromise})()}}function X(L){return oe.apply(this,arguments)}function oe(){return(oe=(0,g.Z)(function*(L){const M=yield J()._get(ee(L));return M&&(yield J()._remove(ee(L))),M})).apply(this,arguments)}function Y(){const L=[],M="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let O=0;O<20;O++){const re=Math.floor(Math.random()*M.length);L.push(M.charAt(re))}return L.join("")}function J(){return(0,k.ay)(k.b)}function ee(L){return(0,k.az)("authEvent",L.config.apiKey,L.name)}function Me(L){if(!(null==L?void 0:L.includes("?")))return{};const[M,...O]=L.split("?");return(0,ae.zd)(O.join("?"))}function je(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,k.aw)("no-auth-event")}}function xt(){var L;return(null===(L=null==self?void 0:self.location)||void 0===L?void 0:L.protocol)||null}function fn(L=(0,ae.z$)()){return!("file:"!==xt()&&"ionic:"!==xt()&&"capacitor:"!==xt()||!L.toLowerCase().match(/iphone|ipad|ipod|android/))}function li(){try{const L=self.localStorage,M=k.aI();if(L)return L.setItem(M,"1"),L.removeItem(M),!function ts(L=(0,ae.z$)()){return function oo(){return(0,ae.w1)()&&11===(null==document?void 0:document.documentMode)}()||function Dn(L=(0,ae.z$)()){return/Edge\/\d+/.test(L)}(L)}()||(0,ae.hl)()}catch(L){return ci()&&(0,ae.hl)()}return!1}function ci(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function gr(){return(function Lt(){return"http:"===xt()||"https:"===xt()}()||(0,ae.ru)()||fn())&&!function Ar(){return(0,ae.b$)()||(0,ae.UG)()}()&&li()&&!ci()}function xs(){return fn()&&"undefined"!=typeof document}function Gr(){return(Gr=(0,g.Z)(function*(){return!!xs()&&new Promise(L=>{const M=setTimeout(()=>{L(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(M),L(!0)})})})).apply(this,arguments)}const tn={LOCAL:"local",NONE:"none",SESSION:"session"},Sr=k.ax,Ei="persistence";function pn(L){return or.apply(this,arguments)}function or(){return(or=(0,g.Z)(function*(L){yield L._initializationPromise;const M=Ft(),O=k.az(Ei,L.config.apiKey,L.name);M&&M.setItem(O,L._getPersistence())})).apply(this,arguments)}function Ft(){var L;try{return(null===(L=function ln(){return"undefined"!=typeof window?window:null}())||void 0===L?void 0:L.sessionStorage)||null}catch(M){return null}}const tt=k.ax;class Ke{constructor(){this.browserResolver=k.ay(k.k),this.cordovaResolver=k.ay(class Wt{constructor(){this._redirectPersistence=k.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=k.aB,this._overrideRedirectResult=k.aC}_initialize(M){var O=this;return(0,g.Z)(function*(){const re=M._key();let Te=O.eventManagers.get(re);return Te||(Te=new ge(M),O.eventManagers.set(re,Te),O.attachCallbackListeners(M,Te)),Te})()}_openPopup(M){(0,k.at)(M,"operation-not-supported-in-this-environment")}_openRedirect(M,O,re,Te){var ze=this;return(0,g.Z)(function*(){!function ne(L){var M,O,re,Te,ze,Je,yt,Ze,Kt,Fn;const Mt=de();(0,k.ax)("function"==typeof(null===(M=null==Mt?void 0:Mt.universalLinks)||void 0===M?void 0:M.subscribe),L,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,k.ax)(void 0!==(null===(O=null==Mt?void 0:Mt.BuildInfo)||void 0===O?void 0:O.packageName),L,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,k.ax)("function"==typeof(null===(ze=null===(Te=null===(re=null==Mt?void 0:Mt.cordova)||void 0===re?void 0:re.plugins)||void 0===Te?void 0:Te.browsertab)||void 0===ze?void 0:ze.openUrl),L,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,k.ax)("function"==typeof(null===(Ze=null===(yt=null===(Je=null==Mt?void 0:Mt.cordova)||void 0===Je?void 0:Je.plugins)||void 0===yt?void 0:yt.browsertab)||void 0===Ze?void 0:Ze.isAvailable),L,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,k.ax)("function"==typeof(null===(Fn=null===(Kt=null==Mt?void 0:Mt.cordova)||void 0===Kt?void 0:Kt.InAppBrowser)||void 0===Fn?void 0:Fn.open),L,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(M);const Je=yield ze._initialize(M);yield Je.initialized(),Je.resetRedirect(),(0,k.aD)(),yield ze._originValidation(M);const yt=function he(L,M,O=null){return{type:M,eventId:O,urlResponse:null,sessionId:Y(),postBody:null,tenantId:L.tenantId,error:(0,k.aw)(L,"no-auth-event")}}(M,re,Te);yield function Fe(L,M){return J()._set(ee(L),M)}(M,yt);const Ze=yield function H(L,M,O){return $.apply(this,arguments)}(M,yt,O),Kt=yield function Ae(L){const{cordova:M}=de();return new Promise(O=>{M.plugins.browsertab.isAvailable(re=>{let Te=null;re?M.plugins.browsertab.openUrl(L):Te=M.InAppBrowser.open(L,(0,k.ap)()?"_blank":"_system","location=yes"),O(Te)})})}(Ze);return function Le(L,M,O){return ke.apply(this,arguments)}(M,Je,Kt)})()}_isIframeWebStorageSupported(M,O){throw new Error("Method not implemented.")}_originValidation(M){const O=M._key();return this.originValidationPromises[O]||(this.originValidationPromises[O]=function te(L){return Oe.apply(this,arguments)}(M)),this.originValidationPromises[O]}attachCallbackListeners(M,O){const{universalLinks:re,handleOpenURL:Te,BuildInfo:ze}=de(),Je=setTimeout((0,g.Z)(function*(){yield X(M),O.onEvent(je())}),500),yt=function(){var Fn=(0,g.Z)(function*(Mt){clearTimeout(Je);const ar=yield X(M);let Ii=null;ar&&(null==Mt?void 0:Mt.url)&&(Ii=function fe(L,M){var O,re;const Te=function ie(L){const M=Me(L),O=M.link?decodeURIComponent(M.link):void 0,re=Me(O).link,Te=M.deep_link_id?decodeURIComponent(M.deep_link_id):void 0;return Me(Te).link||Te||re||O||L}(M);if(Te.includes("/__/auth/callback")){const ze=Me(Te),Je=ze.firebaseError?function ce(L){try{return JSON.parse(L)}catch(M){return null}}(decodeURIComponent(ze.firebaseError)):null,yt=null===(re=null===(O=null==Je?void 0:Je.code)||void 0===O?void 0:O.split("auth/"))||void 0===re?void 0:re[1],Ze=yt?(0,k.aw)(yt):null;return Ze?{type:L.type,eventId:L.eventId,tenantId:L.tenantId,error:Ze,urlResponse:null,sessionId:null,postBody:null}:{type:L.type,eventId:L.eventId,tenantId:L.tenantId,sessionId:L.sessionId,urlResponse:Te,postBody:null}}return null}(ar,Mt.url)),O.onEvent(Ii||je())});return function(ar){return Fn.apply(this,arguments)}}();void 0!==re&&"function"==typeof re.subscribe&&re.subscribe(null,yt);const Ze=Te,Kt=`${ze.packageName.toLowerCase()}://`;de().handleOpenURL=function(){var Fn=(0,g.Z)(function*(Mt){if(Mt.toLowerCase().startsWith(Kt)&&yt({url:Mt}),"function"==typeof Ze)try{Ze(Mt)}catch(ar){console.error(ar)}});return function(Mt){return Fn.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=k.a,this._completeRedirectFn=k.aB,this._overrideRedirectResult=k.aC}_initialize(M){var O=this;return(0,g.Z)(function*(){return yield O.selectUnderlyingResolver(),O.assertedUnderlyingResolver._initialize(M)})()}_openPopup(M,O,re,Te){var ze=this;return(0,g.Z)(function*(){return yield ze.selectUnderlyingResolver(),ze.assertedUnderlyingResolver._openPopup(M,O,re,Te)})()}_openRedirect(M,O,re,Te){var ze=this;return(0,g.Z)(function*(){return yield ze.selectUnderlyingResolver(),ze.assertedUnderlyingResolver._openRedirect(M,O,re,Te)})()}_isIframeWebStorageSupported(M,O){this.assertedUnderlyingResolver._isIframeWebStorageSupported(M,O)}_originValidation(M){return this.assertedUnderlyingResolver._originValidation(M)}get _shouldInitProactively(){return xs()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return tt(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var M=this;return(0,g.Z)(function*(){if(M.underlyingResolver)return;const O=yield function it(){return Gr.apply(this,arguments)}();M.underlyingResolver=O?M.cordovaResolver:M.browserResolver})()}}function wi(L){return L.unwrap()}function Vt(L){return Pn(L)}function Pn(L){const{_tokenResponse:M}=L instanceof ae.ZR?L.customData:L;if(!M)return null;if(!(L instanceof ae.ZR)&&"temporaryProof"in M&&"phoneNumber"in M)return k.P.credentialFromResult(L);const O=M.providerId;if(!O||O===k.o.PASSWORD)return null;let re;switch(O){case k.o.GOOGLE:re=k.Q;break;case k.o.FACEBOOK:re=k.N;break;case k.o.GITHUB:re=k.T;break;case k.o.TWITTER:re=k.W;break;default:const{oauthIdToken:Te,oauthAccessToken:ze,oauthTokenSecret:Je,pendingToken:yt,nonce:Ze}=M;return ze||Je||Te||yt?yt?O.startsWith("saml.")?k.aL._create(O,yt):k.J._fromParams({providerId:O,signInMethod:O,pendingToken:yt,idToken:Te,accessToken:ze}):new k.U(O).credential({idToken:Te,accessToken:ze,rawNonce:Ze}):null}return L instanceof ae.ZR?re.credentialFromError(L):re.credentialFromResult(L)}function Qt(L,M){return M.catch(O=>{throw O instanceof ae.ZR&&function rs(L,M){var O,re;const Te=null===(O=M.customData)||void 0===O?void 0:O._tokenResponse;if("auth/multi-factor-auth-required"===(null===(re=M)||void 0===re?void 0:re.code))M.resolver=new Ut(L,k.an(L,M));else if(Te){const ze=Pn(M),Je=M;ze&&(Je.credential=ze,Je.tenantId=Te.tenantId||void 0,Je.email=Te.email||void 0,Je.phoneNumber=Te.phoneNumber||void 0)}}(L,O),O}).then(O=>{const Te=O.user;return{operationType:O.operationType,credential:Vt(O),additionalUserInfo:k.al(O),user:Yn.getOrCreate(Te)}})}function rt(L,M){return Kr.apply(this,arguments)}function Kr(){return(Kr=(0,g.Z)(function*(L,M){const O=yield M;return{verificationId:O.verificationId,confirm:re=>Qt(L,O.confirm(re))}})).apply(this,arguments)}class Ut{constructor(M,O){this.resolver=O,this.auth=function qr(L){return L.wrapped()}(M)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(M){return Qt(wi(this.auth),this.resolver.resolveSignIn(M))}}class Yn{constructor(M){this._delegate=M,this.multiFactor=k.ao(M)}static getOrCreate(M){return Yn.USER_MAP.has(M)||Yn.USER_MAP.set(M,new Yn(M)),Yn.USER_MAP.get(M)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(M){return this._delegate.getIdTokenResult(M)}getIdToken(M){return this._delegate.getIdToken(M)}linkAndRetrieveDataWithCredential(M){return this.linkWithCredential(M)}linkWithCredential(M){var O=this;return(0,g.Z)(function*(){return Qt(O.auth,k.Z(O._delegate,M))})()}linkWithPhoneNumber(M,O){var re=this;return(0,g.Z)(function*(){return rt(re.auth,k.l(re._delegate,M,O))})()}linkWithPopup(M){var O=this;return(0,g.Z)(function*(){return Qt(O.auth,k.d(O._delegate,M,Ke))})()}linkWithRedirect(M){var O=this;return(0,g.Z)(function*(){return yield pn(k.aE(O.auth)),k.g(O._delegate,M,Ke)})()}reauthenticateAndRetrieveDataWithCredential(M){return this.reauthenticateWithCredential(M)}reauthenticateWithCredential(M){var O=this;return(0,g.Z)(function*(){return Qt(O.auth,k._(O._delegate,M))})()}reauthenticateWithPhoneNumber(M,O){return rt(this.auth,k.r(this._delegate,M,O))}reauthenticateWithPopup(M){return Qt(this.auth,k.e(this._delegate,M,Ke))}reauthenticateWithRedirect(M){var O=this;return(0,g.Z)(function*(){return yield pn(k.aE(O.auth)),k.h(O._delegate,M,Ke)})()}sendEmailVerification(M){return k.ab(this._delegate,M)}unlink(M){var O=this;return(0,g.Z)(function*(){return yield k.ak(O._delegate,M),O})()}updateEmail(M){return k.ag(this._delegate,M)}updatePassword(M){return k.ah(this._delegate,M)}updatePhoneNumber(M){return k.u(this._delegate,M)}updateProfile(M){return k.af(this._delegate,M)}verifyBeforeUpdateEmail(M,O){return k.ac(this._delegate,M,O)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Yn.USER_MAP=new WeakMap;const He=k.ax;let pe=(()=>{class L{constructor(O,re){if(this.app=O,re.isInitialized())return this._delegate=re.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:Te}=O.options;He(Te,"invalid-api-key",{appName:O.name}),He(Te,"invalid-api-key",{appName:O.name});const ze="undefined"!=typeof window?Ke:void 0;this._delegate=re.initialize({options:{persistence:ot(Te,O.name),popupRedirectResolver:ze}}),this._delegate._updateErrorMap(k.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Yn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(O){this._delegate.languageCode=O}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(O){this._delegate.tenantId=O}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(O,re){k.G(this._delegate,O,re)}applyActionCode(O){return k.a2(this._delegate,O)}checkActionCode(O){return k.a3(this._delegate,O)}confirmPasswordReset(O,re){return k.a1(this._delegate,O,re)}createUserWithEmailAndPassword(O,re){var Te=this;return(0,g.Z)(function*(){return Qt(Te._delegate,k.a5(Te._delegate,O,re))})()}fetchProvidersForEmail(O){return this.fetchSignInMethodsForEmail(O)}fetchSignInMethodsForEmail(O){return k.aa(this._delegate,O)}isSignInWithEmailLink(O){return k.a8(this._delegate,O)}getRedirectResult(){var O=this;return(0,g.Z)(function*(){He(gr(),O._delegate,"operation-not-supported-in-this-environment");const re=yield k.j(O._delegate,Ke);return re?Qt(O._delegate,Promise.resolve(re)):{credential:null,user:null}})()}addFrameworkForLogging(O){!function Yt(L,M){(0,k.aE)(L)._logFramework(M)}(this._delegate,O)}onAuthStateChanged(O,re,Te){const{next:ze,error:Je,complete:yt}=Ue(O,re,Te);return this._delegate.onAuthStateChanged(ze,Je,yt)}onIdTokenChanged(O,re,Te){const{next:ze,error:Je,complete:yt}=Ue(O,re,Te);return this._delegate.onIdTokenChanged(ze,Je,yt)}sendSignInLinkToEmail(O,re){return k.a7(this._delegate,O,re)}sendPasswordResetEmail(O,re){return k.a0(this._delegate,O,re||void 0)}setPersistence(O){var re=this;return(0,g.Z)(function*(){let Te;switch(function zr(L,M){Sr(Object.values(tn).includes(M),L,"invalid-persistence-type"),(0,ae.b$)()?Sr(M!==tn.SESSION,L,"unsupported-persistence-type"):(0,ae.UG)()?Sr(M===tn.NONE,L,"unsupported-persistence-type"):ci()?Sr(M===tn.NONE||M===tn.LOCAL&&(0,ae.hl)(),L,"unsupported-persistence-type"):Sr(M===tn.NONE||li(),L,"unsupported-persistence-type")}(re._delegate,O),O){case tn.SESSION:Te=k.a;break;case tn.LOCAL:Te=(yield k.ay(k.i)._isAvailable())?k.i:k.b;break;case tn.NONE:Te=k.L;break;default:return k.at("argument-error",{appName:re._delegate.name})}return re._delegate.setPersistence(Te)})()}signInAndRetrieveDataWithCredential(O){return this.signInWithCredential(O)}signInAnonymously(){return Qt(this._delegate,k.X(this._delegate))}signInWithCredential(O){return Qt(this._delegate,k.Y(this._delegate,O))}signInWithCustomToken(O){return Qt(this._delegate,k.$(this._delegate,O))}signInWithEmailAndPassword(O,re){return Qt(this._delegate,k.a6(this._delegate,O,re))}signInWithEmailLink(O,re){return Qt(this._delegate,k.a9(this._delegate,O,re))}signInWithPhoneNumber(O,re){return rt(this._delegate,k.s(this._delegate,O,re))}signInWithPopup(O){var re=this;return(0,g.Z)(function*(){return He(gr(),re._delegate,"operation-not-supported-in-this-environment"),Qt(re._delegate,k.c(re._delegate,O,Ke))})()}signInWithRedirect(O){var re=this;return(0,g.Z)(function*(){return He(gr(),re._delegate,"operation-not-supported-in-this-environment"),yield pn(re._delegate),k.f(re._delegate,O,Ke)})()}updateCurrentUser(O){return this._delegate.updateCurrentUser(O)}verifyPasswordResetCode(O){return k.a4(this._delegate,O)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return L.Persistence=tn,L})();function Ue(L,M,O){let re=L;"function"!=typeof L&&({next:re,error:M,complete:O}=L);const Te=re;return{next:Je=>Te(Je&&Yn.getOrCreate(Je)),error:M,complete:O}}function ot(L,M){const O=function ns(L,M){const O=Ft();if(!O)return[];const re=k.az(Ei,L,M);switch(O.getItem(re)){case tn.NONE:return[k.L];case tn.LOCAL:return[k.i,k.a];case tn.SESSION:return[k.a];default:return[]}}(L,M);if("undefined"!=typeof self&&!O.includes(k.i)&&O.push(k.i),"undefined"!=typeof window)for(const re of[k.b,k.a])O.includes(re)||O.push(re);return O.includes(k.L)||O.push(k.L),O}class lt{constructor(){this.providerId="phone",this._delegate=new k.P(wi(U.Z.auth()))}static credential(M,O){return k.P.credential(M,O)}verifyPhoneNumber(M,O){return this._delegate.verifyPhoneNumber(M,O)}unwrap(){return this._delegate}}lt.PHONE_SIGN_IN_METHOD=k.P.PHONE_SIGN_IN_METHOD,lt.PROVIDER_ID=k.P.PROVIDER_ID;const qt=k.ax;class B{constructor(M,O,re=U.Z.app()){var Te;qt(null===(Te=re.options)||void 0===Te?void 0:Te.apiKey,"invalid-api-key",{appName:re.name}),this._delegate=new k.R(M,O,re.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function q(L){L.INTERNAL.registerComponent(new De.wA("auth-compat",M=>{const O=M.getProvider("app-compat").getImmediate(),re=M.getProvider("auth");return new pe(O,re)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:k.A.EMAIL_SIGNIN,PASSWORD_RESET:k.A.PASSWORD_RESET,RECOVER_EMAIL:k.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:k.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:k.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:k.A.VERIFY_EMAIL}},EmailAuthProvider:k.M,FacebookAuthProvider:k.N,GithubAuthProvider:k.T,GoogleAuthProvider:k.Q,OAuthProvider:k.U,SAMLAuthProvider:k.V,PhoneAuthProvider:lt,PhoneMultiFactorGenerator:k.m,RecaptchaVerifier:B,TwitterAuthProvider:k.W,Auth:pe,AuthCredential:k.H,Error:ae.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),L.registerVersion("@firebase/auth-compat","0.2.23")}(U.Z)},8306:(Qe,ve,F)=>{F.d(ve,{y:()=>H});var g=F(2961),U=F(727),k=F(8822),ae=F(4671);var De=F(2416),de=F(576),Re=F(2806);let H=(()=>{class Ae{constructor(ke){ke&&(this._subscribe=ke)}lift(ke){const ne=new Ae;return ne.source=this,ne.operator=ke,ne}subscribe(ke,ne,ye){const We=function Oe(Ae){return Ae&&Ae instanceof g.Lv||function te(Ae){return Ae&&(0,de.m)(Ae.next)&&(0,de.m)(Ae.error)&&(0,de.m)(Ae.complete)}(Ae)&&(0,U.Nn)(Ae)}(ke)?ke:new g.Hp(ke,ne,ye);return(0,Re.x)(()=>{const{operator:$e,source:Se}=this;We.add($e?$e.call(We,Se):Se?this._subscribe(We):this._trySubscribe(We))}),We}_trySubscribe(ke){try{return this._subscribe(ke)}catch(ne){ke.error(ne)}}forEach(ke,ne){return new(ne=$(ne))((ye,We)=>{const $e=new g.Hp({next:Se=>{try{ke(Se)}catch(ge){We(ge),$e.unsubscribe()}},error:We,complete:ye});this.subscribe($e)})}_subscribe(ke){var ne;return null===(ne=this.source)||void 0===ne?void 0:ne.subscribe(ke)}[k.L](){return this}pipe(...ke){return function we(Ae){return 0===Ae.length?ae.y:1===Ae.length?Ae[0]:function(ke){return Ae.reduce((ne,ye)=>ye(ne),ke)}}(ke)(this)}toPromise(ke){return new(ke=$(ke))((ne,ye)=>{let We;this.subscribe($e=>We=$e,$e=>ye($e),()=>ne(We))})}}return Ae.create=Le=>new Ae(Le),Ae})();function $(Ae){var Le;return null!==(Le=null!=Ae?Ae:De.v.Promise)&&void 0!==Le?Le:Promise}},7579:(Qe,ve,F)=>{F.d(ve,{x:()=>De});var g=F(8306),U=F(727);const ae=(0,F(3888).d)(Re=>function(){Re(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ce=F(8737),we=F(2806);let De=(()=>{class Re extends g.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift($){const te=new de(this,this);return te.operator=$,te}_throwIfClosed(){if(this.closed)throw new ae}next($){(0,we.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const te of this.currentObservers)te.next($)}})}error($){(0,we.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=$;const{observers:te}=this;for(;te.length;)te.shift().error($)}})}complete(){(0,we.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:$}=this;for(;$.length;)$.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var $;return(null===($=this.observers)||void 0===$?void 0:$.length)>0}_trySubscribe($){return this._throwIfClosed(),super._trySubscribe($)}_subscribe($){return this._throwIfClosed(),this._checkFinalizedStatuses($),this._innerSubscribe($)}_innerSubscribe($){const{hasError:te,isStopped:Oe,observers:Ae}=this;return te||Oe?U.Lc:(this.currentObservers=null,Ae.push($),new U.w0(()=>{this.currentObservers=null,(0,Ce.P)(Ae,$)}))}_checkFinalizedStatuses($){const{hasError:te,thrownError:Oe,isStopped:Ae}=this;te?$.error(Oe):Ae&&$.complete()}asObservable(){const $=new g.y;return $.source=this,$}}return Re.create=(H,$)=>new de(H,$),Re})();class de extends De{constructor(H,$){super(),this.destination=H,this.source=$}next(H){var $,te;null===(te=null===($=this.destination)||void 0===$?void 0:$.next)||void 0===te||te.call($,H)}error(H){var $,te;null===(te=null===($=this.destination)||void 0===$?void 0:$.error)||void 0===te||te.call($,H)}complete(){var H,$;null===($=null===(H=this.destination)||void 0===H?void 0:H.complete)||void 0===$||$.call(H)}_subscribe(H){var $,te;return null!==(te=null===($=this.source)||void 0===$?void 0:$.subscribe(H))&&void 0!==te?te:U.Lc}}},2961:(Qe,ve,F)=>{F.d(ve,{Hp:()=>ke,Lv:()=>te});var g=F(576),U=F(727),k=F(2416),ae=F(7849);function Ce(){}const we=Re("C",void 0,void 0);function Re(Se,ge,he){return{kind:Se,value:ge,error:he}}var H=F(3410),$=F(2806);class te extends U.w0{constructor(ge){super(),this.isStopped=!1,ge?(this.destination=ge,(0,U.Nn)(ge)&&ge.add(this)):this.destination=$e}static create(ge,he,Fe){return new ke(ge,he,Fe)}next(ge){this.isStopped?We(function de(Se){return Re("N",Se,void 0)}(ge),this):this._next(ge)}error(ge){this.isStopped?We(function De(Se){return Re("E",void 0,Se)}(ge),this):(this.isStopped=!0,this._error(ge))}complete(){this.isStopped?We(we,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ge){this.destination.next(ge)}_error(ge){try{this.destination.error(ge)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Oe=Function.prototype.bind;function Ae(Se,ge){return Oe.call(Se,ge)}class Le{constructor(ge){this.partialObserver=ge}next(ge){const{partialObserver:he}=this;if(he.next)try{he.next(ge)}catch(Fe){ne(Fe)}}error(ge){const{partialObserver:he}=this;if(he.error)try{he.error(ge)}catch(Fe){ne(Fe)}else ne(ge)}complete(){const{partialObserver:ge}=this;if(ge.complete)try{ge.complete()}catch(he){ne(he)}}}class ke extends te{constructor(ge,he,Fe){let X;if(super(),(0,g.m)(ge)||!ge)X={next:null!=ge?ge:void 0,error:null!=he?he:void 0,complete:null!=Fe?Fe:void 0};else{let oe;this&&k.v.useDeprecatedNextContext?(oe=Object.create(ge),oe.unsubscribe=()=>this.unsubscribe(),X={next:ge.next&&Ae(ge.next,oe),error:ge.error&&Ae(ge.error,oe),complete:ge.complete&&Ae(ge.complete,oe)}):X=ge}this.destination=new Le(X)}}function ne(Se){k.v.useDeprecatedSynchronousErrorHandling?(0,$.O)(Se):(0,ae.h)(Se)}function We(Se,ge){const{onStoppedNotification:he}=k.v;he&&H.z.setTimeout(()=>he(Se,ge))}const $e={closed:!0,next:Ce,error:function ye(Se){throw Se},complete:Ce}},727:(Qe,ve,F)=>{F.d(ve,{Lc:()=>we,w0:()=>Ce,Nn:()=>De});var g=F(576);const k=(0,F(3888).d)(Re=>function($){Re(this),this.message=$?`${$.length} errors occurred during unsubscription:\n${$.map((te,Oe)=>`${Oe+1}) ${te.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=$});var ae=F(8737);class Ce{constructor(H){this.initialTeardown=H,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let H;if(!this.closed){this.closed=!0;const{_parentage:$}=this;if($)if(this._parentage=null,Array.isArray($))for(const Ae of $)Ae.remove(this);else $.remove(this);const{initialTeardown:te}=this;if((0,g.m)(te))try{te()}catch(Ae){H=Ae instanceof k?Ae.errors:[Ae]}const{_finalizers:Oe}=this;if(Oe){this._finalizers=null;for(const Ae of Oe)try{de(Ae)}catch(Le){H=null!=H?H:[],Le instanceof k?H=[...H,...Le.errors]:H.push(Le)}}if(H)throw new k(H)}}add(H){var $;if(H&&H!==this)if(this.closed)de(H);else{if(H instanceof Ce){if(H.closed||H._hasParent(this))return;H._addParent(this)}(this._finalizers=null!==($=this._finalizers)&&void 0!==$?$:[]).push(H)}}_hasParent(H){const{_parentage:$}=this;return $===H||Array.isArray($)&&$.includes(H)}_addParent(H){const{_parentage:$}=this;this._parentage=Array.isArray($)?($.push(H),$):$?[$,H]:H}_removeParent(H){const{_parentage:$}=this;$===H?this._parentage=null:Array.isArray($)&&(0,ae.P)($,H)}remove(H){const{_finalizers:$}=this;$&&(0,ae.P)($,H),H instanceof Ce&&H._removeParent(this)}}Ce.EMPTY=(()=>{const Re=new Ce;return Re.closed=!0,Re})();const we=Ce.EMPTY;function De(Re){return Re instanceof Ce||Re&&"closed"in Re&&(0,g.m)(Re.remove)&&(0,g.m)(Re.add)&&(0,g.m)(Re.unsubscribe)}function de(Re){(0,g.m)(Re)?Re():Re.unsubscribe()}},2416:(Qe,ve,F)=>{F.d(ve,{v:()=>g});const g={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Qe,ve,F)=>{F.d(ve,{E:()=>U});const U=new(F(8306).y)(Ce=>Ce.complete())},8996:(Qe,ve,F)=>{F.d(ve,{D:()=>ge});var g=F(8421),U=F(5363),k=F(9468),we=F(8306),de=F(2202),Re=F(576),H=F(9672);function te(he,Fe){if(!he)throw new Error("Iterable cannot be null");return new we.y(X=>{(0,H.f)(X,Fe,()=>{const oe=he[Symbol.asyncIterator]();(0,H.f)(X,Fe,()=>{oe.next().then(fe=>{fe.done?X.complete():X.next(fe.value)})},0,!0)})})}var Oe=F(3670),Ae=F(8239),Le=F(1144),ke=F(6495),ne=F(2206),ye=F(4532),We=F(3260);function ge(he,Fe){return Fe?function Se(he,Fe){if(null!=he){if((0,Oe.c)(he))return function ae(he,Fe){return(0,g.Xf)(he).pipe((0,k.R)(Fe),(0,U.Q)(Fe))}(he,Fe);if((0,Le.z)(he))return function De(he,Fe){return new we.y(X=>{let oe=0;return Fe.schedule(function(){oe===he.length?X.complete():(X.next(he[oe++]),X.closed||this.schedule())})})}(he,Fe);if((0,Ae.t)(he))return function Ce(he,Fe){return(0,g.Xf)(he).pipe((0,k.R)(Fe),(0,U.Q)(Fe))}(he,Fe);if((0,ne.D)(he))return te(he,Fe);if((0,ke.T)(he))return function $(he,Fe){return new we.y(X=>{let oe;return(0,H.f)(X,Fe,()=>{oe=he[de.h](),(0,H.f)(X,Fe,()=>{let fe,Y;try{({value:fe,done:Y}=oe.next())}catch(J){return void X.error(J)}Y?X.complete():X.next(fe)},0,!0)}),()=>(0,Re.m)(null==oe?void 0:oe.return)&&oe.return()})}(he,Fe);if((0,We.L)(he))return function $e(he,Fe){return te((0,We.Q)(he),Fe)}(he,Fe)}throw(0,ye.z)(he)}(he,Fe):(0,g.Xf)(he)}},8421:(Qe,ve,F)=>{F.d(ve,{Xf:()=>Oe});var g=F(655),U=F(1144),k=F(8239),ae=F(8306),Ce=F(3670),we=F(2206),De=F(4532),de=F(6495),Re=F(3260),H=F(576),$=F(7849),te=F(8822);function Oe(Se){if(Se instanceof ae.y)return Se;if(null!=Se){if((0,Ce.c)(Se))return function Ae(Se){return new ae.y(ge=>{const he=Se[te.L]();if((0,H.m)(he.subscribe))return he.subscribe(ge);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Se);if((0,U.z)(Se))return function Le(Se){return new ae.y(ge=>{for(let he=0;he<Se.length&&!ge.closed;he++)ge.next(Se[he]);ge.complete()})}(Se);if((0,k.t)(Se))return function ke(Se){return new ae.y(ge=>{Se.then(he=>{ge.closed||(ge.next(he),ge.complete())},he=>ge.error(he)).then(null,$.h)})}(Se);if((0,we.D)(Se))return ye(Se);if((0,de.T)(Se))return function ne(Se){return new ae.y(ge=>{for(const he of Se)if(ge.next(he),ge.closed)return;ge.complete()})}(Se);if((0,Re.L)(Se))return function We(Se){return ye((0,Re.Q)(Se))}(Se)}throw(0,De.z)(Se)}function ye(Se){return new ae.y(ge=>{(function $e(Se,ge){var he,Fe,X,oe;return(0,g.mG)(this,void 0,void 0,function*(){try{for(he=(0,g.KL)(Se);!(Fe=yield he.next()).done;)if(ge.next(Fe.value),ge.closed)return}catch(fe){X={error:fe}}finally{try{Fe&&!Fe.done&&(oe=he.return)&&(yield oe.call(he))}finally{if(X)throw X.error}}ge.complete()})})(Se,ge).catch(he=>ge.error(he))})}},6451:(Qe,ve,F)=>{F.d(ve,{T:()=>we});var g=F(8189),U=F(8421),k=F(515),ae=F(7669),Ce=F(8996);function we(...De){const de=(0,ae.yG)(De),Re=(0,ae._6)(De,1/0),H=De;return H.length?1===H.length?(0,U.Xf)(H[0]):(0,g.J)(Re)((0,Ce.D)(H,de)):k.E}},5403:(Qe,ve,F)=>{F.d(ve,{x:()=>U});var g=F(2961);function U(ae,Ce,we,De,de){return new k(ae,Ce,we,De,de)}class k extends g.Lv{constructor(Ce,we,De,de,Re,H){super(Ce),this.onFinalize=Re,this.shouldUnsubscribe=H,this._next=we?function($){try{we($)}catch(te){Ce.error(te)}}:super._next,this._error=de?function($){try{de($)}catch(te){Ce.error(te)}finally{this.unsubscribe()}}:super._error,this._complete=De?function(){try{De()}catch($){Ce.error($)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ce;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:we}=this;super.unsubscribe(),!we&&(null===(Ce=this.onFinalize)||void 0===Ce||Ce.call(this))}}}},4004:(Qe,ve,F)=>{F.d(ve,{U:()=>k});var g=F(4482),U=F(5403);function k(ae,Ce){return(0,g.e)((we,De)=>{let de=0;we.subscribe((0,U.x)(De,Re=>{De.next(ae.call(Ce,Re,de++))}))})}},8189:(Qe,ve,F)=>{F.d(ve,{J:()=>k});var g=F(5577),U=F(4671);function k(ae=1/0){return(0,g.z)(U.y,ae)}},5577:(Qe,ve,F)=>{F.d(ve,{z:()=>de});var g=F(4004),U=F(8421),k=F(4482),ae=F(9672),Ce=F(5403),De=F(576);function de(Re,H,$=1/0){return(0,De.m)(H)?de((te,Oe)=>(0,g.U)((Ae,Le)=>H(te,Ae,Oe,Le))((0,U.Xf)(Re(te,Oe))),$):("number"==typeof H&&($=H),(0,k.e)((te,Oe)=>function we(Re,H,$,te,Oe,Ae,Le,ke){const ne=[];let ye=0,We=0,$e=!1;const Se=()=>{$e&&!ne.length&&!ye&&H.complete()},ge=Fe=>ye<te?he(Fe):ne.push(Fe),he=Fe=>{Ae&&H.next(Fe),ye++;let X=!1;(0,U.Xf)($(Fe,We++)).subscribe((0,Ce.x)(H,oe=>{null==Oe||Oe(oe),Ae?ge(oe):H.next(oe)},()=>{X=!0},void 0,()=>{if(X)try{for(ye--;ne.length&&ye<te;){const oe=ne.shift();Le?(0,ae.f)(H,Le,()=>he(oe)):he(oe)}Se()}catch(oe){H.error(oe)}}))};return Re.subscribe((0,Ce.x)(H,ge,()=>{$e=!0,Se()})),()=>{null==ke||ke()}}(te,Oe,Re,$)))}},5363:(Qe,ve,F)=>{F.d(ve,{Q:()=>ae});var g=F(9672),U=F(4482),k=F(5403);function ae(Ce,we=0){return(0,U.e)((De,de)=>{De.subscribe((0,k.x)(de,Re=>(0,g.f)(de,Ce,()=>de.next(Re),we),()=>(0,g.f)(de,Ce,()=>de.complete(),we),Re=>(0,g.f)(de,Ce,()=>de.error(Re),we)))})}},3099:(Qe,ve,F)=>{F.d(ve,{B:()=>Ce});var g=F(8421),U=F(7579),k=F(2961),ae=F(4482);function Ce(De={}){const{connector:de=(()=>new U.x),resetOnError:Re=!0,resetOnComplete:H=!0,resetOnRefCountZero:$=!0}=De;return te=>{let Oe,Ae,Le,ke=0,ne=!1,ye=!1;const We=()=>{null==Ae||Ae.unsubscribe(),Ae=void 0},$e=()=>{We(),Oe=Le=void 0,ne=ye=!1},Se=()=>{const ge=Oe;$e(),null==ge||ge.unsubscribe()};return(0,ae.e)((ge,he)=>{ke++,!ye&&!ne&&We();const Fe=Le=null!=Le?Le:de();he.add(()=>{ke--,0===ke&&!ye&&!ne&&(Ae=we(Se,$))}),Fe.subscribe(he),!Oe&&ke>0&&(Oe=new k.Hp({next:X=>Fe.next(X),error:X=>{ye=!0,We(),Ae=we($e,Re,X),Fe.error(X)},complete:()=>{ne=!0,We(),Ae=we($e,H),Fe.complete()}}),(0,g.Xf)(ge).subscribe(Oe))})(te)}}function we(De,de,...Re){if(!0===de)return void De();if(!1===de)return;const H=new k.Hp({next:()=>{H.unsubscribe(),De()}});return de(...Re).subscribe(H)}},9468:(Qe,ve,F)=>{F.d(ve,{R:()=>U});var g=F(4482);function U(k,ae=0){return(0,g.e)((Ce,we)=>{we.add(k.schedule(()=>Ce.subscribe(we),ae))})}},3410:(Qe,ve,F)=>{F.d(ve,{z:()=>g});const g={setTimeout(U,k,...ae){const{delegate:Ce}=g;return(null==Ce?void 0:Ce.setTimeout)?Ce.setTimeout(U,k,...ae):setTimeout(U,k,...ae)},clearTimeout(U){const{delegate:k}=g;return((null==k?void 0:k.clearTimeout)||clearTimeout)(U)},delegate:void 0}},2202:(Qe,ve,F)=>{F.d(ve,{h:()=>U});const U=function g(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Qe,ve,F)=>{F.d(ve,{L:()=>g});const g="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(Qe,ve,F)=>{F.d(ve,{_6:()=>we,jO:()=>ae,yG:()=>Ce});var g=F(576);function k(De){return De[De.length-1]}function ae(De){return(0,g.m)(k(De))?De.pop():void 0}function Ce(De){return function U(De){return De&&(0,g.m)(De.schedule)}(k(De))?De.pop():void 0}function we(De,de){return"number"==typeof k(De)?De.pop():de}},8737:(Qe,ve,F)=>{function g(U,k){if(U){const ae=U.indexOf(k);0<=ae&&U.splice(ae,1)}}F.d(ve,{P:()=>g})},3888:(Qe,ve,F)=>{function g(U){const ae=U(Ce=>{Error.call(Ce),Ce.stack=(new Error).stack});return ae.prototype=Object.create(Error.prototype),ae.prototype.constructor=ae,ae}F.d(ve,{d:()=>g})},2806:(Qe,ve,F)=>{F.d(ve,{O:()=>ae,x:()=>k});var g=F(2416);let U=null;function k(Ce){if(g.v.useDeprecatedSynchronousErrorHandling){const we=!U;if(we&&(U={errorThrown:!1,error:null}),Ce(),we){const{errorThrown:De,error:de}=U;if(U=null,De)throw de}}else Ce()}function ae(Ce){g.v.useDeprecatedSynchronousErrorHandling&&U&&(U.errorThrown=!0,U.error=Ce)}},9672:(Qe,ve,F)=>{function g(U,k,ae,Ce=0,we=!1){const De=k.schedule(function(){ae(),we?U.add(this.schedule(null,Ce)):this.unsubscribe()},Ce);if(U.add(De),!we)return De}F.d(ve,{f:()=>g})},4671:(Qe,ve,F)=>{function g(U){return U}F.d(ve,{y:()=>g})},1144:(Qe,ve,F)=>{F.d(ve,{z:()=>g});const g=U=>U&&"number"==typeof U.length&&"function"!=typeof U},2206:(Qe,ve,F)=>{F.d(ve,{D:()=>U});var g=F(576);function U(k){return Symbol.asyncIterator&&(0,g.m)(null==k?void 0:k[Symbol.asyncIterator])}},576:(Qe,ve,F)=>{function g(U){return"function"==typeof U}F.d(ve,{m:()=>g})},3670:(Qe,ve,F)=>{F.d(ve,{c:()=>k});var g=F(8822),U=F(576);function k(ae){return(0,U.m)(ae[g.L])}},6495:(Qe,ve,F)=>{F.d(ve,{T:()=>k});var g=F(2202),U=F(576);function k(ae){return(0,U.m)(null==ae?void 0:ae[g.h])}},8239:(Qe,ve,F)=>{F.d(ve,{t:()=>U});var g=F(576);function U(k){return(0,g.m)(null==k?void 0:k.then)}},3260:(Qe,ve,F)=>{F.d(ve,{L:()=>ae,Q:()=>k});var g=F(655),U=F(576);function k(Ce){return(0,g.FC)(this,arguments,function*(){const De=Ce.getReader();try{for(;;){const{value:de,done:Re}=yield(0,g.qq)(De.read());if(Re)return yield(0,g.qq)(void 0);yield yield(0,g.qq)(de)}}finally{De.releaseLock()}})}function ae(Ce){return(0,U.m)(null==Ce?void 0:Ce.getReader)}},4482:(Qe,ve,F)=>{F.d(ve,{A:()=>U,e:()=>k});var g=F(576);function U(ae){return(0,g.m)(null==ae?void 0:ae.lift)}function k(ae){return Ce=>{if(U(Ce))return Ce.lift(function(we){try{return ae(we,this)}catch(De){this.error(De)}});throw new TypeError("Unable to lift unknown Observable type")}}},7849:(Qe,ve,F)=>{F.d(ve,{h:()=>k});var g=F(2416),U=F(3410);function k(ae){U.z.setTimeout(()=>{const{onUnhandledError:Ce}=g.v;if(!Ce)throw ae;Ce(ae)})}},4532:(Qe,ve,F)=>{function g(U){return new TypeError(`You provided ${null!==U&&"object"==typeof U?"an invalid object":`'${U}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}F.d(ve,{z:()=>g})},655:(Qe,ve,F)=>{function ae(Y,J){var ee={};for(var ce in Y)Object.prototype.hasOwnProperty.call(Y,ce)&&J.indexOf(ce)<0&&(ee[ce]=Y[ce]);if(null!=Y&&"function"==typeof Object.getOwnPropertySymbols){var ie=0;for(ce=Object.getOwnPropertySymbols(Y);ie<ce.length;ie++)J.indexOf(ce[ie])<0&&Object.prototype.propertyIsEnumerable.call(Y,ce[ie])&&(ee[ce[ie]]=Y[ce[ie]])}return ee}function de(Y,J,ee,ce){return new(ee||(ee=Promise))(function(Me,nt){function Wt(Yt){try{je(ce.next(Yt))}catch(Nn){nt(Nn)}}function St(Yt){try{je(ce.throw(Yt))}catch(Nn){nt(Nn)}}function je(Yt){Yt.done?Me(Yt.value):function ie(Me){return Me instanceof ee?Me:new ee(function(nt){nt(Me)})}(Yt.value).then(Wt,St)}je((ce=ce.apply(Y,J||[])).next())})}function ne(Y){return this instanceof ne?(this.v=Y,this):new ne(Y)}function ye(Y,J,ee){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ie,ce=ee.apply(Y,J||[]),Me=[];return ie={},nt("next"),nt("throw"),nt("return"),ie[Symbol.asyncIterator]=function(){return this},ie;function nt(un){ce[un]&&(ie[un]=function(zt){return new Promise(function(xt,Lt){Me.push([un,zt,xt,Lt])>1||Wt(un,zt)})})}function Wt(un,zt){try{!function St(un){un.value instanceof ne?Promise.resolve(un.value.v).then(je,Yt):Nn(Me[0][2],un)}(ce[un](zt))}catch(xt){Nn(Me[0][3],xt)}}function je(un){Wt("next",un)}function Yt(un){Wt("throw",un)}function Nn(un,zt){un(zt),Me.shift(),Me.length&&Wt(Me[0][0],Me[0][1])}}function $e(Y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ee,J=Y[Symbol.asyncIterator];return J?J.call(Y):(Y=function te(Y){var J="function"==typeof Symbol&&Symbol.iterator,ee=J&&Y[J],ce=0;if(ee)return ee.call(Y);if(Y&&"number"==typeof Y.length)return{next:function(){return Y&&ce>=Y.length&&(Y=void 0),{value:Y&&Y[ce++],done:!Y}}};throw new TypeError(J?"Object is not iterable.":"Symbol.iterator is not defined.")}(Y),ee={},ce("next"),ce("throw"),ce("return"),ee[Symbol.asyncIterator]=function(){return this},ee);function ce(Me){ee[Me]=Y[Me]&&function(nt){return new Promise(function(Wt,St){!function ie(Me,nt,Wt,St){Promise.resolve(St).then(function(je){Me({value:je,done:Wt})},nt)}(Wt,St,(nt=Y[Me](nt)).done,nt.value)})}}}F.d(ve,{FC:()=>ye,KL:()=>$e,_T:()=>ae,mG:()=>de,qq:()=>ne})},5e3:(Qe,ve,F)=>{F.d(ve,{$8M:()=>mo,$Z:()=>TI,AFp:()=>hc,ALo:()=>LC,AaK:()=>de,BQk:()=>Gl,CHM:()=>Xu,CRH:()=>$g,CZH:()=>dc,CqO:()=>DA,DdM:()=>lh,EJc:()=>ab,EpF:()=>xI,F4k:()=>bA,FYo:()=>xC,FiY:()=>Hi,G48:()=>vb,GfV:()=>Xs,Gpc:()=>$,JOm:()=>Ws,LFG:()=>Bn,LSH:()=>la,Lbi:()=>WS,NdJ:()=>MI,OlP:()=>vn,PXZ:()=>pb,Q6J:()=>kr,QGY:()=>Qd,Qsj:()=>Cs,R0b:()=>Qi,RDi:()=>qc,Rgc:()=>nc,SBq:()=>Au,Sil:()=>ub,Suo:()=>zC,TTD:()=>qa,TgZ:()=>eg,VKq:()=>bs,VLi:()=>xh,WLB:()=>kg,X6Q:()=>yb,XFs:()=>it,Xpm:()=>lt,Y36:()=>Wl,YKP:()=>RC,YNc:()=>pI,Yjl:()=>Te,Yz7:()=>zt,ZZ4:()=>se,_Bn:()=>SC,_UZ:()=>Wy,_Vd:()=>Fr,_c5:()=>cx,_uU:()=>ug,aQg:()=>cm,c2e:()=>Ch,cJS:()=>Lt,cg1:()=>lv,dDg:()=>tm,deG:()=>Bf,dqk:()=>Vt,eFA:()=>Mh,ekj:()=>Ky,g9A:()=>sb,h0i:()=>Ri,hGG:()=>Ab,hij:()=>Zl,iGM:()=>Bv,ifc:()=>Ft,ip1:()=>mn,kL8:()=>aC,lG2:()=>re,lcZ:()=>kv,n5z:()=>er,oAB:()=>L,oxw:()=>NI,q4F:()=>Xe,qLn:()=>cp,qOj:()=>Lp,qZA:()=>Yd,qbA:()=>Su,sBO:()=>om,sIi:()=>zd,s_b:()=>ic,soG:()=>Xg,tBr:()=>na,tb:()=>ob,tp0:()=>js,uIk:()=>Bp,vHH:()=>Le,vpe:()=>Yi,wAp:()=>st,xp6:()=>W_,ynx:()=>tg,z2F:()=>gc,zSh:()=>by,zs3:()=>ws});var g=F(7579),U=F(727),k=F(8306),ae=F(6451),Ce=F(3099);function we(s){for(let o in s)if(s[o]===we)return o;throw Error("Could not find renamed property on target object.")}function De(s,o){for(const u in o)o.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&(s[u]=o[u])}function de(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(de).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function Re(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const H=we({__forward_ref__:we});function $(s){return s.__forward_ref__=$,s.toString=function(){return de(this())},s}function te(s){return Oe(s)?s():s}function Oe(s){return"function"==typeof s&&s.hasOwnProperty(H)&&s.__forward_ref__===$}class Le extends Error{constructor(o,u){super(function ke(s,o){return`NG0${Math.abs(s)}${o?": "+o:""}`}(o,u)),this.code=o}}function ne(s){return"string"==typeof s?s:null==s?"":String(s)}function ye(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():ne(s)}function ge(s,o){const u=o?` in ${o}`:"";throw new Le(-201,`No provider for ${ye(s)} found${u}`)}function St(s,o){null==s&&function je(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function zt(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Lt(s){return{providers:s.providers||[],imports:s.imports||[]}}function fn(s){return Ar(s,li)||Ar(s,gr)}function Ar(s,o){return s.hasOwnProperty(o)?s[o]:null}function ts(s){return s&&(s.hasOwnProperty(ci)||s.hasOwnProperty(xs))?s[ci]:null}const li=we({\u0275prov:we}),ci=we({\u0275inj:we}),gr=we({ngInjectableDef:we}),xs=we({ngInjectorDef:we});var it=(()=>((it=it||{})[it.Default=0]="Default",it[it.Host=1]="Host",it[it.Self=2]="Self",it[it.SkipSelf=4]="SkipSelf",it[it.Optional=8]="Optional",it))();let Gr;function tn(s){const o=Gr;return Gr=s,o}function Sr(s,o,u){const c=fn(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&it.Optional?null:void 0!==o?o:void ge(de(s),"Injector")}function zr(s){return{toString:s}.toString()}var pn=(()=>((pn=pn||{})[pn.OnPush=0]="OnPush",pn[pn.Default=1]="Default",pn))(),Ft=(()=>{return(s=Ft||(Ft={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",Ft;var s})();const tt="undefined"!=typeof globalThis&&globalThis,Ke="undefined"!=typeof window&&window,wi="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Vt=tt||"undefined"!=typeof global&&global||Ke||wi,Qt={},rt=[],Kr=we({\u0275cmp:we}),Ut=we({\u0275dir:we}),Yn=we({\u0275pipe:we}),He=we({\u0275mod:we}),pe=we({\u0275fac:we}),Ue=we({__NG_ELEMENT_ID__:we});let ot=0;function lt(s){return zr(()=>{const u={},c={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:u,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===pn.OnPush,directiveDefs:null,pipeDefs:null,selectors:s.selectors||rt,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||Ft.Emulated,id:"c",styles:s.styles||rt,_:null,setInput:null,schemas:s.schemas||null,tView:null},d=s.directives,f=s.features,y=s.pipes;return c.id+=ot++,c.inputs=O(s.inputs,u),c.outputs=O(s.outputs),f&&f.forEach(w=>w(c)),c.directiveDefs=d?()=>("function"==typeof d?d():d).map(B):null,c.pipeDefs=y?()=>("function"==typeof y?y():y).map(V):null,c})}function B(s){return ze(s)||function Je(s){return s[Ut]||null}(s)}function V(s){return function yt(s){return s[Yn]||null}(s)}const q={};function L(s){return zr(()=>{const o={type:s.type,bootstrap:s.bootstrap||rt,declarations:s.declarations||rt,imports:s.imports||rt,exports:s.exports||rt,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null};return null!=s.id&&(q[s.id]=s.type),o})}function O(s,o){if(null==s)return Qt;const u={};for(const c in s)if(s.hasOwnProperty(c)){let d=s[c],f=d;Array.isArray(d)&&(f=d[1],d=d[0]),u[d]=c,o&&(o[d]=f)}return u}const re=lt;function Te(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,onDestroy:s.type.prototype.ngOnDestroy||null}}function ze(s){return s[Kr]||null}function Ze(s,o){const u=s[He]||null;if(!u&&!0===o)throw new Error(`Type ${de(s)} does not have '\u0275mod' property.`);return u}function hi(s){return Array.isArray(s)&&"object"==typeof s[1]}function Zr(s){return Array.isArray(s)&&!0===s[1]}function Hc(s){return 0!=(8&s.flags)}function Wa(s){return 2==(2&s.flags)}function Ga(s){return 1==(1&s.flags)}function Yr(s){return null!==s.template}function e_(s){return 0!=(512&s[2])}function fi(s,o){return s.hasOwnProperty(pe)?s[pe]:null}class za{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function qa(){return Gu}function Gu(s){return s.type.prototype.ngOnChanges&&(s.setInput=P0),t_}function t_(){const s=Gc(this),o=null==s?void 0:s.current;if(o){const u=s.previous;if(u===Qt)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function P0(s,o,u,c){const d=Gc(s)||function zu(s,o){return s[ho]=o}(s,{previous:Qt,current:null}),f=d.current||(d.current={}),y=d.previous,w=this.declaredInputs[u],C=y[w];f[w]=new za(C&&C.currentValue,o,y===Qt),s[c]=o}qa.ngInherit=!0;const ho="__ngSimpleChanges__";function Gc(s){return s[ho]||null}let Ku;function qc(s){Ku=s}function cn(s){return!!s.listen}const Zu={createRenderer:(s,o)=>function Kc(){return void 0!==Ku?Ku:"undefined"!=typeof document?document:void 0}()};function sn(s){for(;Array.isArray(s);)s=s[0];return s}function Za(s,o){return sn(o[s])}function _r(s,o){return sn(o[s.index])}function Ya(s,o){return s.data[o]}function yr(s,o){const u=o[s];return hi(u)?u:u[0]}function Lo(s){return 4==(4&s[2])}function Ns(s){return 128==(128&s[2])}function Ci(s,o){return null==o?null:s[o]}function Vo(s){s[18]=0}function Uo(s,o){s[5]+=o;let u=s,c=s[3];for(;null!==c&&(1===o&&1===u[5]||-1===o&&0===u[5]);)c[5]+=o,u=c,c=c[3]}const ct={lFrame:Nf(null),bindingsEnabled:!0};function Ju(){return ct.bindingsEnabled}function Ie(){return ct.lFrame.lView}function Bt(){return ct.lFrame.tView}function Xu(s){return ct.lFrame.contextLView=s,s[8]}function gn(){let s=Sf();for(;null!==s&&64===s.type;)s=s.parent;return s}function Sf(){return ct.lFrame.currentTNode}function Ui(s,o){const u=ct.lFrame;u.currentTNode=s,u.isParent=o}function Yc(){return ct.lFrame.isParent}function Qa(){ct.lFrame.isParent=!1}function Jn(){const s=ct.lFrame;let o=s.bindingRootIndex;return-1===o&&(o=s.bindingRootIndex=s.tView.bindingStartIndex),o}function $o(){return ct.lFrame.bindingIndex++}function l_(s,o){const u=ct.lFrame;u.bindingIndex=u.bindingRootIndex=s,Jc(o)}function Jc(s){ct.lFrame.currentDirectiveIndex=s}function Mf(){return ct.lFrame.currentQueryIndex}function Rf(s){ct.lFrame.currentQueryIndex=s}function c_(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function rl(s,o,u){if(u&it.SkipSelf){let d=o,f=s;for(;!(d=d.parent,null!==d||u&it.Host||(d=c_(f),null===d||(f=f[15],10&d.type))););if(null===d)return!1;o=d,s=f}const c=ct.lFrame=fo();return c.currentTNode=o,c.lView=s,!0}function il(s){const o=fo(),u=s[1];ct.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function fo(){const s=ct.lFrame,o=null===s?null:s.child;return null===o?Nf(s):o}function Nf(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function d_(){const s=ct.lFrame;return ct.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const Xc=d_;function Di(){const s=d_();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function lr(){return ct.lFrame.selectedIndex}function cs(s){ct.lFrame.selectedIndex=s}function Tn(){const s=ct.lFrame;return Ya(s.tView,s.selectedIndex)}function ds(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const f=s.data[u].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:w,ngAfterViewInit:C,ngAfterViewChecked:T,ngOnDestroy:S}=f;y&&(s.contentHooks||(s.contentHooks=[])).push(-u,y),w&&((s.contentHooks||(s.contentHooks=[])).push(u,w),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,w)),C&&(s.viewHooks||(s.viewHooks=[])).push(-u,C),T&&((s.viewHooks||(s.viewHooks=[])).push(u,T),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,T)),null!=S&&(s.destroyHooks||(s.destroyHooks=[])).push(u,S)}}function Xa(s,o,u){p_(s,o,3,u)}function sl(s,o,u,c){(3&s[2])===u&&p_(s,o,u,c)}function kf(s,o){let u=s[2];(3&u)===o&&(u&=2047,u+=1,s[2]=u)}function p_(s,o,u,c){const f=null!=c?c:-1,y=o.length-1;let w=0;for(let C=void 0!==c?65535&s[18]:0;C<y;C++)if("number"==typeof o[C+1]){if(w=o[C],null!=c&&w>=c)break}else o[C]<0&&(s[18]+=65536),(w<f||-1==f)&&(F0(s,u,o,C),s[18]=(4294901760&s[18])+C+2),C++}function F0(s,o,u,c){const d=u[c]<0,f=u[c+1],w=s[d?-u[c]:u[c]];if(d){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{f.call(w)}finally{}}}else try{f.call(w)}finally{}}class Ho{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function Bi(s,o,u){const c=cn(s);let d=0;for(;d<u.length;){const f=u[d];if("number"==typeof f){if(0!==f)break;d++;const y=u[d++],w=u[d++],C=u[d++];c?s.setAttribute(o,w,C,y):o.setAttributeNS(y,w,C)}else{const y=f,w=u[++d];Jr(y)?c&&s.setProperty(o,y,w):c?s.setAttribute(o,y,w):o.setAttribute(y,w),d++}}return d}function Xn(s){return 3===s||4===s||6===s}function Jr(s){return 64===s.charCodeAt(0)}function al(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const d=o[c];"number"==typeof d?u=d:0===u||Wo(s,u,d,null,-1===u||2===u?o[++c]:null)}}return s}function Wo(s,o,u,c,d){let f=0,y=s.length;if(-1===o)y=-1;else for(;f<s.length;){const w=s[f++];if("number"==typeof w){if(w===o){y=-1;break}if(w>o){y=f-1;break}}}for(;f<s.length;){const w=s[f];if("number"==typeof w)break;if(w===u){if(null===c)return void(null!==d&&(s[f+1]=d));if(c===s[f+1])return void(s[f+2]=d)}f++,null!==c&&f++,null!==d&&f++}-1!==y&&(s.splice(y,0,o),f=y+1),s.splice(f++,0,u),null!==c&&s.splice(f++,0,c),null!==d&&s.splice(f++,0,d)}function Of(s){return-1!==s}function dn(s){return 32767&s}function ks(s,o){let u=function Ff(s){return s>>16}(s),c=o;for(;u>0;)c=c[15],u--;return c}let Os=!0;function Et(s){const o=Os;return Os=s,o}let Vf=0;function Go(s,o){const u=zo(s,o);if(-1!==u)return u;const c=o[1];c.firstCreatePass&&(s.injectorIndex=o.length,po(c.data,s),po(o,null),po(c.blueprint,null));const d=tu(s,o),f=s.injectorIndex;if(Of(d)){const y=dn(d),w=ks(d,o),C=w[1].data;for(let T=0;T<8;T++)o[f+T]=w[y+T]|C[y+T]}return o[f+8]=d,f}function po(s,o){s.push(0,0,0,0,0,0,0,0,o)}function zo(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function tu(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,d=o;for(;null!==d;){const f=d[1],y=f.type;if(c=2===y?f.declTNode:1===y?d[6]:null,null===c)return-1;if(u++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return-1}function fs(s,o,u){!function Un(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty(Ue)&&(c=u[Ue]),null==c&&(c=u[Ue]=Vf++);const d=255&c;o.data[s+(d>>5)]|=1<<d}(s,o,u)}function ll(s,o,u){if(u&it.Optional)return s;ge(o,"NodeInjector")}function ru(s,o,u,c){if(u&it.Optional&&void 0===c&&(c=null),0==(u&(it.Self|it.Host))){const d=s[9],f=tn(void 0);try{return d?d.get(o,c,u&it.Optional):Sr(o,c,u&it.Optional)}finally{tn(f)}}return ll(c,o,u)}function go(s,o,u,c=it.Default,d){if(null!==s){const f=function id(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(Ue)?s[Ue]:void 0;return"number"==typeof o?o>=0?255&o:rd:o}(u);if("function"==typeof f){if(!rl(o,s,c))return c&it.Host?ll(d,u,c):ru(o,u,c,d);try{const y=f(c);if(null!=y||c&it.Optional)return y;ge(u)}finally{Xc()}}else if("number"==typeof f){let y=null,w=zo(s,o),C=-1,T=c&it.Host?o[16][6]:null;for((-1===w||c&it.SkipSelf)&&(C=-1===w?tu(s,o):o[w+8],-1!==C&&sd(c,!1)?(y=o[1],w=dn(C),o=ks(C,o)):w=-1);-1!==w;){const S=o[1];if(cr(f,w,S.data)){const N=cl(w,o,u,y,c,T);if(N!==nd)return N}C=o[w+8],-1!==C&&sd(c,o[1].data[w+8]===T)&&cr(f,w,o)?(y=S,w=dn(C),o=ks(C,o)):w=-1}}}return ru(o,u,c,d)}const nd={};function rd(){return new Fs(gn(),Ie())}function cl(s,o,u,c,d,f){const y=o[1],w=y.data[s+8],S=dl(w,y,u,null==c?Wa(w)&&Os:c!=y&&0!=(3&w.type),d&it.Host&&f===w);return null!==S?pi(o,y,S,w):nd}function dl(s,o,u,c,d){const f=s.providerIndexes,y=o.data,w=1048575&f,C=s.directiveStart,S=f>>20,j=d?w+S:s.directiveEnd;for(let Z=c?w:w+S;Z<j;Z++){const le=y[Z];if(Z<C&&u===le||Z>=C&&le.type===u)return Z}if(d){const Z=y[C];if(Z&&Yr(Z)&&Z.type===u)return C}return null}function pi(s,o,u,c){let d=s[u];const f=o.data;if(function L0(s){return s instanceof Ho}(d)){const y=d;y.resolving&&function We(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new Le(-200,`Circular dependency in DI detected for ${s}${u}`)}(ye(f[u]));const w=Et(y.canSeeViewProviders);y.resolving=!0;const C=y.injectImpl?tn(y.injectImpl):null;rl(s,c,it.Default);try{d=s[u]=y.factory(void 0,f,s,c),o.firstCreatePass&&u>=c.directiveStart&&function Pf(s,o,u){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:f}=o.type.prototype;if(c){const y=Gu(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,y),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,y)}d&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,d),f&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,f),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,f))}(u,f[u],o)}finally{null!==C&&tn(C),Et(w),y.resolving=!1,Xc()}}return d}function cr(s,o,u){return!!(u[o+(s>>5)]&1<<s)}function sd(s,o){return!(s&it.Self||s&it.Host&&o)}class Fs{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return go(this._tNode,this._lView,o,c,u)}}function er(s){return zr(()=>{const o=s.prototype.constructor,u=o[pe]||qo(o),c=Object.prototype;let d=Object.getPrototypeOf(s.prototype).constructor;for(;d&&d!==c;){const f=d[pe]||qo(d);if(f&&f!==u)return f;d=Object.getPrototypeOf(d)}return f=>new f})}function qo(s){return Oe(s)?()=>{const o=qo(te(s));return o&&o()}:fi(s)}function mo(s){return function nu(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let d=0;for(;d<c;){const f=u[d];if(Xn(f))break;if(0===f)d+=2;else if("number"==typeof f)for(d++;d<c&&"string"==typeof u[d];)d++;else{if(f===o)return u[d+1];d+=2}}}return null}(gn(),s)}const ji="__parameters__";function $i(s,o,u){return zr(()=>{const c=function zn(s){return function(...u){if(s){const c=s(...u);for(const d in c)this[d]=c[d]}}}(o);function d(...f){if(this instanceof d)return c.apply(this,f),this;const y=new d(...f);return w.annotation=y,w;function w(C,T,S){const N=C.hasOwnProperty(ji)?C[ji]:Object.defineProperty(C,ji,{value:[]})[ji];for(;N.length<=S;)N.push(null);return(N[S]=N[S]||[]).push(y),C}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class vn{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=zt({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Bf=new vn("AnalyzeForEntryComponents");function vr(s,o){void 0===o&&(o=s);for(let u=0;u<s.length;u++){let c=s[u];Array.isArray(c)?(o===s&&(o=s.slice(0,u)),vr(c,o)):o!==s&&o.push(c)}return o}function Xr(s,o){s.forEach(u=>Array.isArray(u)?Xr(u,o):o(u))}function ud(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function Yo(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}function Er(s,o,u){let c=Qo(s,o);return c>=0?s[1|c]=u:(c=~c,function $f(s,o,u,c){let d=s.length;if(d==o)s.push(u,c);else if(1===d)s.push(c,s[0]),s[0]=u;else{for(d--,s.push(s[d-1],s[d]);d>o;)s[d]=s[d-2],d--;s[o]=u,s[o+1]=c}}(s,c,o,u)),c}function su(s,o){const u=Qo(s,o);if(u>=0)return s[1|u]}function Qo(s,o){return function Wf(s,o,u){let c=0,d=s.length>>u;for(;d!==c;){const f=c+(d-c>>1),y=s[f<<u];if(o===y)return f<<u;y>o?d=f:c=f+1}return~(d<<u)}(s,o,1)}const Us={},Jo="__NG_DI_FLAG__",ml="ngTempTokenPath",qf=/\n/gm,hd="__source",_l=we({provide:String,useValue:we});let ei;function Ot(s){const o=ei;return ei=s,o}function ou(s,o=it.Default){if(void 0===ei)throw new Le(203,"");return null===ei?Sr(s,void 0,o):ei.get(s,o&it.Optional?null:void 0,o)}function Bn(s,o=it.Default){return(function ln(){return Gr}()||ou)(te(s),o)}const m_=Bn;function Xo(s){const o=[];for(let u=0;u<s.length;u++){const c=te(s[u]);if(Array.isArray(c)){if(0===c.length)throw new Le(900,"");let d,f=it.Default;for(let y=0;y<c.length;y++){const w=c[y],C=fd(w);"number"==typeof C?-1===C?d=w.token:f|=C:d=w}o.push(Bn(d,f))}else o.push(Bn(c))}return o}function ea(s,o){return s[Jo]=o,s.prototype[Jo]=o,s}function fd(s){return s[Jo]}const na=ea($i("Inject",s=>({token:s})),-1),Hi=ea($i("Optional"),8),js=ea($i("SkipSelf"),4);class du{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Ai(s){return s instanceof du?s.changingThisBreaksApplicationSecurity:s}const D_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,rp=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var wn=(()=>((wn=wn||{})[wn.NONE=0]="NONE",wn[wn.HTML=1]="HTML",wn[wn.STYLE=2]="STYLE",wn[wn.SCRIPT=3]="SCRIPT",wn[wn.URL=4]="URL",wn[wn.RESOURCE_URL=5]="RESOURCE_URL",wn))();function la(s){const o=function xl(){const s=Ie();return s&&s[12]}();return o?o.sanitize(wn.URL,s)||"":function Si(s,o){const u=function yd(s){return s instanceof du&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===o}(s,"URL")?Ai(s):function fu(s){return(s=String(s)).match(D_)||s.match(rp)?s:"unsafe:"+s}(ne(s))}const Z0="__ngContext__";function Rr(s,o){s[Z0]=o}function A_(s){const o=function Id(s){return s[Z0]||null}(s);return o?Array.isArray(o)?o:o.lView:null}function R_(s){return s.ngOriginalError}function gT(s,...o){s.error(...o)}class cp{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o),c=function pT(s){return s&&s.ngErrorLogger||gT}(o);c(this._console,"ERROR",o),u&&c(this._console,"ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&R_(o);for(;u&&R_(u);)u=R_(u);return u||null}}const DT=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Vt))();function ys(s){return s instanceof Function?s():s}var Ws=(()=>((Ws=Ws||{})[Ws.Important=1]="Important",Ws[Ws.DashCase=2]="DashCase",Ws))();function P_(s,o){return undefined(s,o)}function Td(s){const o=s[3];return Zr(o)?o[3]:o}function fp(s){return nw(s[13])}function O_(s){return nw(s[4])}function nw(s){for(;null!==s&&!Zr(s);)s=s[4];return s}function Ml(s,o,u,c,d){if(null!=c){let f,y=!1;Zr(c)?f=c:hi(c)&&(y=!0,c=c[0]);const w=sn(c);0===s&&null!==u?null==d?uw(o,u,w):da(o,u,w,d||null,!0):1===s&&null!==u?da(o,u,w,d||null,!0):2===s?function gw(s,o,u){const c=_p(s,o);c&&function cw(s,o,u,c){cn(s)?s.removeChild(o,u,c):o.removeChild(u)}(s,c,o,u)}(o,w,y):3===s&&o.destroyNode(w),null!=f&&function gu(s,o,u,c,d){const f=u[7];f!==sn(u)&&Ml(o,s,c,f,d);for(let w=10;w<u.length;w++){const C=u[w];K(C[1],C,s,o,c,f)}}(o,s,f,u,d)}}function Nr(s,o,u){if(cn(s))return s.createElement(o,u);{const c=null!==u?function qu(s){const o=s.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(u):null;return null===c?s.createElement(o):s.createElementNS(c,o)}}function sw(s,o){const u=s[9],c=u.indexOf(o),d=o[3];1024&o[2]&&(o[2]&=-1025,Uo(d,-1)),u.splice(c,1)}function gp(s,o){if(s.length<=10)return;const u=10+o,c=s[u];if(c){const d=c[17];null!==d&&d!==s&&sw(d,c),o>0&&(s[u-1][4]=c[4]);const f=Yo(s,10+o);!function ST(s,o){K(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(c[1],c);const y=f[19];null!==y&&y.detachView(f[1]),c[3]=null,c[4]=null,c[2]&=-129}return c}function ow(s,o){if(!(256&o[2])){const u=o[11];cn(u)&&u.destroyNode&&K(s,o,u,3,null,null),function L_(s){let o=s[13];if(!o)return mp(s[1],s);for(;o;){let u=null;if(hi(o))u=o[13];else{const c=o[10];c&&(u=c)}if(!u){for(;o&&!o[4]&&o!==s;)hi(o)&&mp(o[1],o),o=o[3];null===o&&(o=s),hi(o)&&mp(o[1],o),u=o&&o[4]}o=u}}(o)}}function mp(s,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function V_(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const d=o[u[c]];if(!(d instanceof Ho)){const f=u[c+1];if(Array.isArray(f))for(let y=0;y<f.length;y+=2){const w=d[f[y]],C=f[y+1];try{C.call(w)}finally{}}else try{f.call(d)}finally{}}}}(s,o),function aw(s,o){const u=s.cleanup,c=o[7];let d=-1;if(null!==u)for(let f=0;f<u.length-1;f+=2)if("string"==typeof u[f]){const y=u[f+1],w="function"==typeof y?y(o):sn(o[y]),C=c[d=u[f+2]],T=u[f+3];"boolean"==typeof T?w.removeEventListener(u[f],C,T):T>=0?c[d=T]():c[d=-T].unsubscribe(),f+=2}else{const y=c[d=u[f+1]];u[f].call(y)}if(null!==c){for(let f=d+1;f<c.length;f++)c[f]();o[7]=null}}(s,o),1===o[1].type&&cn(o[11])&&o[11].destroy();const u=o[17];if(null!==u&&Zr(o[3])){u!==o[3]&&sw(u,o);const c=o[19];null!==c&&c.detachView(s)}}}function MT(s,o,u){return function ca(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[0];if(2&c.flags){const d=s.data[c.directiveStart].encapsulation;if(d===Ft.None||d===Ft.Emulated)return null}return _r(c,u)}(s,o.parent,u)}function da(s,o,u,c,d){cn(s)?s.insertBefore(o,u,c,d):o.insertBefore(u,c,d)}function uw(s,o,u){cn(s)?s.appendChild(o,u):o.appendChild(u)}function lw(s,o,u,c,d){null!==c?da(s,o,u,c,d):uw(s,o,u)}function _p(s,o){return cn(s)?s.parentNode(o):o.parentNode}let hw=function U_(s,o,u){return 40&s.type?_r(s,u):null};function Nl(s,o,u,c){const d=MT(s,c,o),f=o[11],w=function dw(s,o,u){return hw(s,o,u)}(c.parent||o[6],c,o);if(null!=d)if(Array.isArray(u))for(let C=0;C<u.length;C++)lw(f,d,u[C],w,!1);else lw(f,d,u,w,!1)}function yp(s,o){if(null!==o){const u=o.type;if(3&u)return _r(o,s);if(4&u)return vp(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return yp(s,c);{const d=s[o.index];return Zr(d)?vp(-1,d):sn(d)}}if(32&u)return P_(o,s)()||sn(s[o.index]);{const c=pw(s,o);return null!==c?Array.isArray(c)?c[0]:yp(Td(s[16]),c):yp(s,o.next)}}return null}function pw(s,o){return null!==o?s[16][6].projection[o.projection]:null}function vp(s,o){const u=10+s+1;if(u<o.length){const c=o[u],d=c[1].firstChild;if(null!==d)return yp(c,d)}return o[7]}function mw(s,o,u,c,d,f,y){for(;null!=u;){const w=c[u.index],C=u.type;if(y&&0===o&&(w&&Rr(sn(w),c),u.flags|=4),64!=(64&u.flags))if(8&C)mw(s,o,u.child,c,d,f,!1),Ml(o,s,d,w,f);else if(32&C){const T=P_(u,c);let S;for(;S=T();)Ml(o,s,d,S,f);Ml(o,s,d,w,f)}else 16&C?j_(s,o,c,u,d,f):Ml(o,s,d,w,f);u=y?u.projectionNext:u.next}}function K(s,o,u,c,d,f){mw(u,c,s.firstChild,o,d,f,!1)}function j_(s,o,u,c,d,f){const y=u[16],C=y[6].projection[c.projection];if(Array.isArray(C))for(let T=0;T<C.length;T++)Ml(o,s,d,C[T],f);else mw(s,o,C,y[3],d,f,!0)}function _w(s,o,u){cn(s)?s.setAttribute(o,"style",u):o.style.cssText=u}function Ep(s,o,u){cn(s)?""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u):o.className=u}function yw(s,o,u){let c=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const f=o.length;if(d+f===c||s.charCodeAt(d+f)<=32)return d}u=d+1}}const vw="ng-template";function Ad(s,o,u){let c=0;for(;c<s.length;){let d=s[c++];if(u&&"class"===d){if(d=s[c],-1!==yw(d.toLowerCase(),o,0))return!0}else if(1===d){for(;c<s.length&&"string"==typeof(d=s[c++]);)if(d.toLowerCase()===o)return!0;return!1}}return!1}function wo(s){return 4===s.type&&s.value!==vw}function Ew(s,o,u){return o===(4!==s.type||u?s.value:vw)}function Pr(s,o,u){let c=4;const d=s.attrs||[],f=function Iw(s){for(let o=0;o<s.length;o++)if(Xn(s[o]))return o;return s.length}(d);let y=!1;for(let w=0;w<o.length;w++){const C=o[w];if("number"!=typeof C){if(!y)if(4&c){if(c=2|1&c,""!==C&&!Ew(s,C,u)||""===C&&1===o.length){if(hr(c))return!1;y=!0}}else{const T=8&c?C:o[++w];if(8&c&&null!==s.attrs){if(!Ad(s.attrs,T,u)){if(hr(c))return!1;y=!0}continue}const N=PT(8&c?"class":C,d,wo(s),u);if(-1===N){if(hr(c))return!1;y=!0;continue}if(""!==T){let j;j=N>f?"":d[N+1].toLowerCase();const Z=8&c?j:null;if(Z&&-1!==yw(Z,T,0)||2&c&&T!==j){if(hr(c))return!1;y=!0}}}}else{if(!y&&!hr(c)&&!hr(C))return!1;if(y&&hr(C))continue;y=!1,c=C|1&c}}return hr(c)||y}function hr(s){return 0==(1&s)}function PT(s,o,u,c){if(null===o)return-1;let d=0;if(c||!u){let f=!1;for(;d<o.length;){const y=o[d];if(y===s)return d;if(3===y||6===y)f=!0;else{if(1===y||2===y){let w=o[++d];for(;"string"==typeof w;)w=o[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=f?1:2}return-1}return function Cw(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function $_(s,o,u=!1){for(let c=0;c<o.length;c++)if(Pr(s,o[c],u))return!0;return!1}function H_(s,o){return s?":not("+o.trim()+")":o}function Dw(s){let o=s[0],u=1,c=2,d="",f=!1;for(;u<s.length;){let y=s[u];if("string"==typeof y)if(2&c){const w=s[++u];d+="["+y+(w.length>0?'="'+w+'"':"")+"]"}else 8&c?d+="."+y:4&c&&(d+=" "+y);else""!==d&&!hr(y)&&(o+=H_(f,d),d=""),c=y,f=f||!hr(c);u++}return""!==d&&(o+=H_(f,d)),o}const vt={};function W_(s){G_(Bt(),Ie(),lr()+s,!1)}function G_(s,o,u,c){if(!c)if(3==(3&o[2])){const f=s.preOrderCheckHooks;null!==f&&Xa(o,f,u)}else{const f=s.preOrderHooks;null!==f&&sl(o,f,0,u)}cs(u)}function Sd(s,o){return s<<17|o<<2}function vs(s){return s>>17&32767}function xd(s){return 2|s}function zs(s){return(131068&s)>>2}function Md(s,o){return-131069&s|o<<2}function wp(s){return 1|s}function ny(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const d=u[c],f=u[c+1];if(-1!==f){const y=s.data[f];Rf(d),y.contentQueries(2,o[f],f)}}}function Pd(s,o,u,c,d,f,y,w,C,T){const S=o.blueprint.slice();return S[0]=d,S[2]=140|c,Vo(S),S[3]=S[15]=s,S[8]=u,S[10]=y||s&&s[10],S[11]=w||s&&s[11],S[12]=C||s&&s[12]||null,S[9]=T||s&&s[9]||null,S[6]=f,S[16]=2==o.type?s[16]:S,S}function mu(s,o,u,c,d){let f=s.data[o];if(null===f)f=function kd(s,o,u,c,d){const f=Sf(),y=Yc(),C=s.data[o]=function Ow(s,o,u,c,d,f){return{type:u,index:c,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:f,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?f:f&&f.parent,u,o,c,d);return null===s.firstChild&&(s.firstChild=C),null!==f&&(y?null==f.child&&null!==C.parent&&(f.child=C):null===f.next&&(f.next=C)),C}(s,o,u,c,d),function u_(){return ct.lFrame.inI18n}()&&(f.flags|=64);else if(64&f.type){f.type=u,f.value=c,f.attrs=d;const y=function Ps(){const s=ct.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();f.injectorIndex=null===y?-1:y.injectorIndex}return Ui(f,!0),f}function fa(s,o,u,c){if(0===u)return-1;const d=o.length;for(let f=0;f<u;f++)o.push(c),s.blueprint.push(c),s.data.push(null);return d}function Ap(s,o,u){il(o);try{const c=s.viewQuery;null!==c&&Ey(1,c,u);const d=s.template;null!==d&&Fd(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&ny(s,o),s.staticViewQueries&&Ey(2,s.viewQuery,u);const f=s.components;null!==f&&function ry(s,o){for(let u=0;u<o.length;u++)Ud(s,o[u])}(o,f)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[2]&=-5,Di()}}function pa(s,o,u,c){const d=o[2];if(256!=(256&d)){il(o);try{Vo(o),function el(s){return ct.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&Fd(s,o,u,2,c);const y=3==(3&d);if(y){const T=s.preOrderCheckHooks;null!==T&&Xa(o,T,null)}else{const T=s.preOrderHooks;null!==T&&sl(o,T,0,null),kf(o,0)}if(function KT(s){for(let o=fp(s);null!==o;o=O_(o)){if(!o[2])continue;const u=o[9];for(let c=0;c<u.length;c++){const d=u[c],f=d[3];0==(1024&d[2])&&Uo(f,1),d[2]|=1024}}}(o),function gy(s){for(let o=fp(s);null!==o;o=O_(o))for(let u=10;u<o.length;u++){const c=o[u],d=c[1];Ns(c)&&pa(d,c,d.template,c[8])}}(o),null!==s.contentQueries&&ny(s,o),y){const T=s.contentCheckHooks;null!==T&&Xa(o,T)}else{const T=s.contentHooks;null!==T&&sl(o,T,1),kf(o,1)}!function jT(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let c=0;c<u.length;c++){const d=u[c];if(d<0)cs(~d);else{const f=d,y=u[++c],w=u[++c];l_(y,f),w(2,o[f])}}}finally{cs(-1)}}(s,o);const w=s.components;null!==w&&function lP(s,o){for(let u=0;u<o.length;u++)Ww(s,o[u])}(o,w);const C=s.viewQuery;if(null!==C&&Ey(2,C,c),y){const T=s.viewCheckHooks;null!==T&&Xa(o,T)}else{const T=s.viewHooks;null!==T&&sl(o,T,2),kf(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[2]&=-73,1024&o[2]&&(o[2]&=-1025,Uo(o[3],-1))}finally{Di()}}}function Od(s,o,u,c){const d=o[10],y=Lo(o);try{!y&&d.begin&&d.begin(),y&&Ap(s,o,c),pa(s,o,u,c)}finally{!y&&d.end&&d.end()}}function Fd(s,o,u,c,d){const f=lr(),y=2&c;try{cs(-1),y&&o.length>20&&G_(s,o,20,!1),u(c,d)}finally{cs(f)}}function _u(s,o,u){if(Hc(o)){const d=o.directiveEnd;for(let f=o.directiveStart;f<d;f++){const y=s.data[f];y.contentQueries&&y.contentQueries(1,u[f],f)}}}function yu(s,o,u){!Ju()||(function hP(s,o,u,c){const d=u.directiveStart,f=u.directiveEnd;s.firstCreatePass||Go(u,o),Rr(c,o);const y=u.initialInputs;for(let w=d;w<f;w++){const C=s.data[w],T=Yr(C);T&&zT(o,u,C);const S=pi(o,s,w,u);Rr(S,o),null!==y&&qT(0,w-d,S,C,0,y),T&&(yr(u.index,o)[8]=S)}}(s,o,u,_r(u,o)),128==(128&u.flags)&&function WT(s,o,u){const c=u.directiveStart,d=u.directiveEnd,y=u.index,w=function Qc(){return ct.lFrame.currentDirectiveIndex}();try{cs(y);for(let C=c;C<d;C++){const T=s.data[C],S=o[C];Jc(C),(null!==T.hostBindings||0!==T.hostVars||null!==T.hostAttrs)&&cy(T,S)}}finally{cs(-1),Jc(w)}}(s,o,u))}function iy(s,o,u=_r){const c=o.localNames;if(null!==c){let d=o.index+1;for(let f=0;f<c.length;f+=2){const y=c[f+1],w=-1===y?u(o,s):s[y];s[d++]=w}}}function Sp(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=Ld(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function Ld(s,o,u,c,d,f,y,w,C,T){const S=20+c,N=S+d,j=function sy(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:vt);return u}(S,N),Z="function"==typeof T?T():T;return j[1]={type:s,blueprint:j,template:u,queries:null,viewQuery:w,declTNode:o,data:j.slice().fill(null,S),bindingStartIndex:S,expandoStartIndex:N,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof f?f():f,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:C,consts:Z,incompleteFirstPass:!1}}function Vd(s,o,u,c){const d=zw(o);null===u?d.push(c):(d.push(u),s.firstCreatePass&&wy(s).push(c,d.length-1))}function uy(s,o,u){for(let c in s)if(s.hasOwnProperty(c)){const d=s[c];(u=null===u?{}:u).hasOwnProperty(c)?u[c].push(o,d):u[c]=[o,d]}return u}function Bw(s,o,u,c){let d=!1;if(Ju()){const f=function GT(s,o,u){const c=s.directiveRegistry;let d=null;if(c)for(let f=0;f<c.length;f++){const y=c[f];$_(u,y.selectors,!1)&&(d||(d=[]),fs(Go(u,o),s,y.type),Yr(y)?(dy(s,u),d.unshift(y)):d.push(y))}return d}(s,o,u),y=null===c?null:{"":-1};if(null!==f){d=!0,$w(u,s.data.length,f.length);for(let S=0;S<f.length;S++){const N=f[S];N.providersResolver&&N.providersResolver(N)}let w=!1,C=!1,T=fa(s,o,f.length,null);for(let S=0;S<f.length;S++){const N=f[S];u.mergedAttrs=al(u.mergedAttrs,N.hostAttrs),fy(s,u,o,T,N),hy(T,N,y),null!==N.contentQueries&&(u.flags|=8),(null!==N.hostBindings||null!==N.hostAttrs||0!==N.hostVars)&&(u.flags|=128);const j=N.type.prototype;!w&&(j.ngOnChanges||j.ngOnInit||j.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),w=!0),!C&&(j.ngOnChanges||j.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),C=!0),T++}!function Fw(s,o){const c=o.directiveEnd,d=s.data,f=o.attrs,y=[];let w=null,C=null;for(let T=o.directiveStart;T<c;T++){const S=d[T],N=S.inputs,j=null===f||wo(o)?null:Hw(N,f);y.push(j),w=uy(N,T,w),C=uy(S.outputs,T,C)}null!==w&&(w.hasOwnProperty("class")&&(o.flags|=16),w.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=y,o.inputs=w,o.outputs=C}(s,u)}y&&function jw(s,o,u){if(o){const c=s.localNames=[];for(let d=0;d<o.length;d+=2){const f=u[o[d+1]];if(null==f)throw new Le(-301,!1);c.push(o[d],f)}}}(u,c,y)}return u.mergedAttrs=al(u.mergedAttrs,u.attrs),d}function HT(s,o,u,c,d,f){const y=f.hostBindings;if(y){let w=s.hostBindingOpCodes;null===w&&(w=s.hostBindingOpCodes=[]);const C=~o.index;(function dP(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(w)!=C&&w.push(C),w.push(c,d,y)}}function cy(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function dy(s,o){o.flags|=2,(s.components||(s.components=[])).push(o.index)}function hy(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Yr(o)&&(u[""]=s)}}function $w(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}function fy(s,o,u,c,d){s.data[c]=d;const f=d.factory||(d.factory=fi(d.type)),y=new Ho(f,Yr(d),null);s.blueprint[c]=y,u[c]=y,HT(s,o,0,c,fa(s,u,d.hostVars,vt),d)}function zT(s,o,u){const c=_r(o,s),d=Sp(u),f=s[10],y=Fl(s,Pd(s,d,null,u.onPush?64:16,c,o,f,f.createRenderer(c,u),null,null));s[o.index]=y}function Io(s,o,u,c,d,f){const y=_r(s,o);!function Rp(s,o,u,c,d,f,y){if(null==f)cn(s)?s.removeAttribute(o,d,u):o.removeAttribute(d);else{const w=null==y?ne(f):y(f,c||"",d);cn(s)?s.setAttribute(o,d,w,u):u?o.setAttributeNS(u,d,w):o.setAttribute(d,w)}}(o[11],y,f,s.value,u,c,d)}function qT(s,o,u,c,d,f){const y=f[o];if(null!==y){const w=c.setInput;for(let C=0;C<y.length;){const T=y[C++],S=y[C++],N=y[C++];null!==w?c.setInput(u,N,T,S):u[S]=N}}}function Hw(s,o){let u=null,c=0;for(;c<o.length;){const d=o[c];if(0!==d)if(5!==d){if("number"==typeof d)break;s.hasOwnProperty(d)&&(null===u&&(u=[]),u.push(d,s[d],o[c+1])),c+=2}else c+=2;else c+=4}return u}function py(s,o,u,c){return new Array(s,!0,!1,o,null,0,c,u,null,null)}function Ww(s,o){const u=yr(o,s);if(Ns(u)){const c=u[1];80&u[2]?pa(c,u,c.template,u[8]):u[5]>0&&my(u)}}function my(s){for(let c=fp(s);null!==c;c=O_(c))for(let d=10;d<c.length;d++){const f=c[d];if(1024&f[2]){const y=f[1];pa(y,f,y.template,f[8])}else f[5]>0&&my(f)}const u=s[1].components;if(null!==u)for(let c=0;c<u.length;c++){const d=yr(u[c],s);Ns(d)&&d[5]>0&&my(d)}}function Ud(s,o){const u=yr(o,s),c=u[1];(function ZT(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(c,u),Ap(c,u,u[8])}function Fl(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function _y(s){for(;s;){s[2]|=64;const o=Td(s);if(e_(s)&&!o)return s;s=o}return null}function Bd(s){!function Np(s){for(let o=0;o<s.components.length;o++){const u=s.components[o],c=A_(u),d=c[1];Od(d,c,d.template,u)}}(s[8])}function Ey(s,o,u){Rf(0),o(s,u)}const QT=(()=>Promise.resolve(null))();function zw(s){return s[7]||(s[7]=[])}function wy(s){return s.cleanup||(s.cleanup=[])}function JT(s,o){const u=s[9],c=u?u.get(cp,null):null;c&&c.handleError(o)}function Pp(s,o,u,c,d){for(let f=0;f<u.length;){const y=u[f++],w=u[f++],C=o[y],T=s.data[y];null!==T.setInput?T.setInput(C,d,c,w):C[w]=d}}function Co(s,o,u){const c=Za(o,s);!function rw(s,o,u){cn(s)?s.setValue(o,u):o.textContent=u}(s[11],c,u)}function jd(s,o,u){let c=u?s.styles:null,d=u?s.classes:null,f=0;if(null!==o)for(let y=0;y<o.length;y++){const w=o[y];"number"==typeof w?f=w:1==f?d=Re(d,w):2==f&&(c=Re(c,w+": "+o[++y]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=d:s.classesWithoutHost=d}const Iy=new vn("INJECTOR",-1);class Cy{get(o,u=Us){if(u===Us){const c=new Error(`NullInjectorError: No provider for ${de(o)}!`);throw c.name="NullInjectorError",c}return u}}const by=new vn("Set Injector scope."),Vl={},eA={};let Dy;function kp(){return void 0===Dy&&(Dy=new Cy),Dy}function Ty(s,o=null,u=null,c){const d=Zw(s,o,u,c);return d._resolveInjectorDefTypes(),d}function Zw(s,o=null,u=null,c){return new Yw(s,u,o||kp(),c)}class Yw{constructor(o,u,c,d=null){this.parent=c,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const f=[];u&&Xr(u,w=>this.processProvider(w,o,u)),Xr([o],w=>this.processInjectorType(w,[],f)),this.records.set(Iy,Ul(void 0,this));const y=this.records.get(by);this.scope=null!=y?y.value:null,this.source=d||("object"==typeof o?null:de(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,u=Us,c=it.Default){this.assertNotDestroyed();const d=Ot(this),f=tn(void 0);try{if(!(c&it.SkipSelf)){let w=this.records.get(o);if(void 0===w){const C=function rA(s){return"function"==typeof s||"object"==typeof s&&s instanceof vn}(o)&&fn(o);w=C&&this.injectableDefInScope(C)?Ul(Ay(o),Vl):null,this.records.set(o,w)}if(null!=w)return this.hydrate(o,w)}return(c&it.Self?kp():this.parent).get(o,u=c&it.Optional&&u===Us?null:u)}catch(y){if("NullInjectorError"===y.name){if((y[ml]=y[ml]||[]).unshift(de(o)),d)throw y;return function ta(s,o,u,c){const d=s[ml];throw o[hd]&&d.unshift(o[hd]),s.message=function yo(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.substr(2):s;let d=de(o);if(Array.isArray(o))d=o.map(de).join(" -> ");else if("object"==typeof o){let f=[];for(let y in o)if(o.hasOwnProperty(y)){let w=o[y];f.push(y+":"+("string"==typeof w?JSON.stringify(w):de(w)))}d=`{${f.join(", ")}}`}return`${u}${c?"("+c+")":""}[${d}]: ${s.replace(qf,"\n  ")}`}("\n"+s.message,d,u,c),s.ngTokenPath=d,s[ml]=null,s}(y,o,"R3InjectorError",this.source)}throw y}finally{tn(f),Ot(d)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((c,d)=>o.push(de(d))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Le(205,!1)}processInjectorType(o,u,c){if(!(o=te(o)))return!1;let d=ts(o);const f=null==d&&o.ngModule||void 0,y=void 0===f?o:f,w=-1!==c.indexOf(y);if(void 0!==f&&(d=ts(f)),null==d)return!1;if(null!=d.imports&&!w){let S;c.push(y);try{Xr(d.imports,N=>{this.processInjectorType(N,u,c)&&(void 0===S&&(S=[]),S.push(N))})}finally{}if(void 0!==S)for(let N=0;N<S.length;N++){const{ngModule:j,providers:Z}=S[N];Xr(Z,le=>this.processProvider(le,j,Z||rt))}}this.injectorDefTypes.add(y);const C=fi(y)||(()=>new y);this.records.set(y,Ul(C,Vl));const T=d.providers;if(null!=T&&!w){const S=o;Xr(T,N=>this.processProvider(N,S,T))}return void 0!==f&&void 0!==o.providers}processProvider(o,u,c){let d=$d(o=te(o))?o:te(o&&o.provide);const f=function tA(s,o,u){return xy(s)?Ul(void 0,s.useValue):Ul(Sy(s),Vl)}(o);if($d(o)||!0!==o.multi)this.records.get(d);else{let y=this.records.get(d);y||(y=Ul(void 0,Vl,!0),y.factory=()=>Xo(y.multi),this.records.set(d,y)),d=o,y.multi.push(o)}this.records.set(d,f)}hydrate(o,u){return u.value===Vl&&(u.value=eA,u.value=u.factory()),"object"==typeof u.value&&u.value&&function Xw(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this.onDestroy.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=te(o.providedIn);return"string"==typeof u?"any"===u||u===this.scope:this.injectorDefTypes.has(u)}}function Ay(s){const o=fn(s),u=null!==o?o.factory:fi(s);if(null!==u)return u;if(s instanceof vn)throw new Le(204,!1);if(s instanceof Function)return function Qw(s){const o=s.length;if(o>0)throw function iu(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}(o,"?"),new Le(204,!1);const u=function oo(s){const o=s&&(s[li]||s[gr]);if(o){const u=function Dn(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new Le(204,!1)}function Sy(s,o,u){let c;if($d(s)){const d=te(s);return fi(d)||Ay(d)}if(xy(s))c=()=>te(s.useValue);else if(function mP(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...Xo(s.deps||[]));else if(function gP(s){return!(!s||!s.useExisting)}(s))c=()=>Bn(te(s.useExisting));else{const d=te(s&&(s.useClass||s.provide));if(!function nA(s){return!!s.deps}(s))return fi(d)||Ay(d);c=()=>new d(...Xo(s.deps))}return c}function Ul(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function xy(s){return null!==s&&"object"==typeof s&&_l in s}function $d(s){return"function"==typeof s}let ws=(()=>{class s{static create(u,c){var d;if(Array.isArray(u))return Ty({name:""},c,u,"");{const f=null!==(d=u.name)&&void 0!==d?d:"";return Ty({name:f},u.parent,u.providers,f)}}}return s.THROW_IF_NOT_FOUND=Us,s.NULL=new Cy,s.\u0275prov=zt({token:s,providedIn:"any",factory:()=>Bn(Iy)}),s.__NG_ELEMENT_ID__=-1,s})();function bo(s,o){ds(A_(s)[1],gn())}function Lp(s){let o=function Fp(s){return Object.getPrototypeOf(s.prototype).constructor}(s.type),u=!0;const c=[s];for(;o;){let d;if(Yr(s))d=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Le(903,"");d=o.\u0275dir}if(d){if(u){c.push(d);const y=s;y.inputs=Gd(s.inputs),y.declaredInputs=Gd(s.declaredInputs),y.outputs=Gd(s.outputs);const w=d.hostBindings;w&&ky(s,w);const C=d.viewQuery,T=d.contentQueries;if(C&&cI(s,C),T&&dI(s,T),De(s.inputs,d.inputs),De(s.declaredInputs,d.declaredInputs),De(s.outputs,d.outputs),Yr(d)&&d.data.animation){const S=s.data;S.animation=(S.animation||[]).concat(d.data.animation)}}const f=d.features;if(f)for(let y=0;y<f.length;y++){const w=f[y];w&&w.ngInherit&&w(s),w===Lp&&(u=!1)}}o=Object.getPrototypeOf(o)}!function Py(s){let o=0,u=null;for(let c=s.length-1;c>=0;c--){const d=s[c];d.hostVars=o+=d.hostVars,d.hostAttrs=al(d.hostAttrs,u=al(u,d.hostAttrs))}}(c)}function Gd(s){return s===Qt?{}:s===rt?[]:s}function cI(s,o){const u=s.viewQuery;s.viewQuery=u?(c,d)=>{o(c,d),u(c,d)}:o}function dI(s,o){const u=s.contentQueries;s.contentQueries=u?(c,d,f)=>{o(c,d,f),u(c,d,f)}:o}function ky(s,o){const u=s.hostBindings;s.hostBindings=u?(c,d)=>{o(c,d),u(c,d)}:o}let Vp=null;function ma(){if(!Vp){const s=Vt.Symbol;if(s&&s.iterator)Vp=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const c=o[u];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Vp=c)}}}return Vp}function zd(s){return!!Ly(s)&&(Array.isArray(s)||!(s instanceof Map)&&ma()in s)}function Ly(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function Ks(s,o,u){return s[o]=u}function Zs(s,o){return s[o]}function jn(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function _a(s,o,u,c){const d=jn(s,o,u);return jn(s,o+1,c)||d}function Bp(s,o,u,c){const d=Ie();return jn(d,$o(),o)&&(Bt(),Io(Tn(),d,s,o,u,c)),Bp}function pI(s,o,u,c,d,f,y,w){const C=Ie(),T=Bt(),S=s+20,N=T.firstCreatePass?function dA(s,o,u,c,d,f,y,w,C){const T=o.consts,S=mu(o,s,4,y||null,Ci(T,w));Bw(o,u,S,Ci(T,C)),ds(o,S);const N=S.tViews=Ld(2,S,c,d,f,o.directiveRegistry,o.pipeRegistry,null,o.schemas,T);return null!==o.queries&&(o.queries.template(o,S),N.queries=o.queries.embeddedTView(S)),S}(S,T,C,o,u,c,d,f,y):T.data[S];Ui(N,!1);const j=C[11].createComment("");Nl(T,C,j,N),Rr(j,C),Fl(C,C[S]=py(j,C,j,N)),Ga(N)&&yu(T,C,N),null!=y&&iy(C,N,w)}function Wl(s,o=it.Default){const u=Ie();return null===u?Bn(s,o):go(gn(),u,te(s),o)}function TI(){throw new Error("invalid")}function kr(s,o,u){const c=Ie();return jn(c,$o(),o)&&function ni(s,o,u,c,d,f,y,w){const C=_r(o,u);let S,T=o.inputs;!w&&null!=T&&(S=T[c])?(Pp(s,u,S,c,d),Wa(o)&&function ly(s,o){const u=yr(o,s);16&u[2]||(u[2]|=64)}(u,o.index)):3&o.type&&(c=function Lw(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),d=null!=y?y(d,o.value||"",c):d,cn(f)?f.setProperty(C,c,d):Jr(c)||(C.setProperty?C.setProperty(c,d):C[c]=d))}(Bt(),Tn(),c,s,o,c[11],u,!1),kr}function Hy(s,o,u,c,d){const y=d?"class":"style";Pp(s,u,o.inputs[y],y,c)}function eg(s,o,u,c){const d=Ie(),f=Bt(),y=20+s,w=d[11],C=d[y]=Nr(w,o,function O0(){return ct.lFrame.currentNamespace}()),T=f.firstCreatePass?function CA(s,o,u,c,d,f,y){const w=o.consts,T=mu(o,s,2,d,Ci(w,f));return Bw(o,u,T,Ci(w,y)),null!==T.attrs&&jd(T,T.attrs,!1),null!==T.mergedAttrs&&jd(T,T.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,T),T}(y,f,d,0,o,u,c):f.data[y];Ui(T,!0);const S=T.mergedAttrs;null!==S&&Bi(w,C,S);const N=T.classes;null!==N&&Ep(w,C,N);const j=T.styles;return null!==j&&_w(w,C,j),64!=(64&T.flags)&&Nl(f,d,C,T),0===function Af(){return ct.lFrame.elementDepthCount}()&&Rr(C,d),function Zc(){ct.lFrame.elementDepthCount++}(),Ga(T)&&(yu(f,d,T),_u(f,T,d)),null!==c&&iy(d,T),eg}function Yd(){let s=gn();Yc()?Qa():(s=s.parent,Ui(s,!1));const o=s;!function i_(){ct.lFrame.elementDepthCount--}();const u=Bt();return u.firstCreatePass&&(ds(u,s),Hc(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function V0(s){return 0!=(16&s.flags)}(o)&&Hy(u,o,Ie(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function yn(s){return 0!=(32&s.flags)}(o)&&Hy(u,o,Ie(),o.stylesWithoutHost,!1),Yd}function Wy(s,o,u,c){return eg(s,o,u,c),Yd(),Wy}function tg(s,o,u){const c=Ie(),d=Bt(),f=s+20,y=d.firstCreatePass?function TP(s,o,u,c,d){const f=o.consts,y=Ci(f,c),w=mu(o,s,8,"ng-container",y);return null!==y&&jd(w,y,!0),Bw(o,u,w,Ci(f,d)),null!==o.queries&&o.queries.elementStart(o,w),w}(f,d,c,o,u):d.data[f];Ui(y,!0);const w=c[f]=c[11].createComment("");return Nl(d,c,w,y),Rr(w,c),Ga(y)&&(yu(d,c,y),_u(d,y,c)),null!=u&&iy(c,y),tg}function Gl(){let s=gn();const o=Bt();return Yc()?Qa():(s=s.parent,Ui(s,!1)),o.firstCreatePass&&(ds(o,s),Hc(s)&&o.queries.elementEnd(s)),Gl}function xI(){return Ie()}function Qd(s){return!!s&&"function"==typeof s.then}function bA(s){return!!s&&"function"==typeof s.subscribe}const DA=bA;function MI(s,o,u,c){const d=Ie(),f=Bt(),y=gn();return function AA(s,o,u,c,d,f,y,w){const C=Ga(c),S=s.firstCreatePass&&wy(s),N=o[8],j=zw(o);let Z=!0;if(3&c.type||w){const Ve=_r(c,o),qe=w?w(Ve):Ve,_e=j.length,z=w?Rt=>w(sn(Rt[c.index])):c.index;if(cn(u)){let Rt=null;if(!w&&C&&(Rt=function ng(s,o,u,c){const d=s.cleanup;if(null!=d)for(let f=0;f<d.length-1;f+=2){const y=d[f];if(y===u&&d[f+1]===c){const w=o[7],C=d[f+2];return w.length>C?w[C]:null}"string"==typeof y&&(f+=2)}return null}(s,o,d,c.index)),null!==Rt)(Rt.__ngLastListenerFn__||Rt).__ngNextListenerFn__=f,Rt.__ngLastListenerFn__=f,Z=!1;else{f=Gy(c,o,N,f,!1);const Nt=u.listen(qe,d,f);j.push(f,Nt),S&&S.push(d,z,_e,_e+1)}}else f=Gy(c,o,N,f,!0),qe.addEventListener(d,f,y),j.push(f),S&&S.push(d,z,_e,y)}else f=Gy(c,o,N,f,!1);const le=c.outputs;let Ne;if(Z&&null!==le&&(Ne=le[d])){const Ve=Ne.length;if(Ve)for(let qe=0;qe<Ve;qe+=2){const Ni=o[Ne[qe]][Ne[qe+1]].subscribe(f),Ds=j.length;j.push(f,Ni),S&&S.push(d,c.index,Ds,-(Ds+1))}}}(f,d,d[11],y,s,o,!!u,c),MI}function RI(s,o,u,c){try{return!1!==u(c)}catch(d){return JT(s,d),!1}}function Gy(s,o,u,c,d){return function f(y){if(y===Function)return c;const w=2&s.flags?yr(s.index,o):o;0==(32&o[2])&&_y(w);let C=RI(o,0,c,y),T=f.__ngNextListenerFn__;for(;T;)C=RI(o,0,T,y)&&C,T=T.__ngNextListenerFn__;return d&&!1===C&&(y.preventDefault(),y.returnValue=!1),C}}function NI(s=1){return function h_(s){return(ct.lFrame.contextLView=function f_(s,o){for(;s>0;)o=o[15],s--;return o}(s,ct.lFrame.contextLView))[8]}(s)}function rg(s,o,u,c,d){const f=s[u+1],y=null===o;let w=c?vs(f):zs(f),C=!1;for(;0!==w&&(!1===C||y);){const S=s[w+1];NA(s[w],o)&&(C=!0,s[w+1]=c?wp(S):xd(S)),w=c?vs(S):zs(S)}C&&(s[u+1]=c?xd(f):wp(f))}function NA(s,o){return null===s||null==o||(Array.isArray(s)?s[1]:s)===o||!(!Array.isArray(s)||"string"!=typeof o)&&Qo(s,o)>=0}function Ky(s,o){return function Ir(s,o,u,c){const d=Ie(),f=Bt(),y=function bi(s){const o=ct.lFrame,u=o.bindingIndex;return o.bindingIndex=o.bindingIndex+s,u}(2);f.firstUpdatePass&&function Zy(s,o,u,c){const d=s.data;if(null===d[u+1]){const f=d[lr()],y=function sg(s,o){return o>=s.expandoStartIndex}(s,u);(function ag(s,o){return 0!=(s.flags&(o?16:32))})(f,c)&&null===o&&!y&&(o=!1),o=function Yy(s,o,u,c){const d=function nl(s){const o=ct.lFrame.currentDirectiveIndex;return-1===o?null:s[o]}(s);let f=c?o.residualClasses:o.residualStyles;if(null===d)0===(c?o.classBindings:o.styleBindings)&&(u=wu(u=Xd(null,s,o,u,c),o.attrs,c),f=null);else{const y=o.directiveStylingLast;if(-1===y||s[y]!==d)if(u=Xd(d,s,o,u,c),null===f){let C=function Qy(s,o,u){const c=u?o.classBindings:o.styleBindings;if(0!==zs(c))return s[vs(c)]}(s,o,c);void 0!==C&&Array.isArray(C)&&(C=Xd(null,s,o,C[1],c),C=wu(C,o.attrs,c),function Jy(s,o,u,c){s[vs(u?o.classBindings:o.styleBindings)]=c}(s,o,c,C))}else f=function LA(s,o,u){let c;const d=o.directiveEnd;for(let f=1+o.directiveStylingLast;f<d;f++)c=wu(c,s[f].hostAttrs,u);return wu(c,o.attrs,u)}(s,o,c)}return void 0!==f&&(c?o.residualClasses=f:o.residualStyles=f),u}(d,f,o,c),function RA(s,o,u,c,d,f){let y=f?o.classBindings:o.styleBindings,w=vs(y),C=zs(y);s[c]=u;let S,T=!1;if(Array.isArray(u)){const N=u;S=N[1],(null===S||Qo(N,S)>0)&&(T=!0)}else S=u;if(d)if(0!==C){const j=vs(s[w+1]);s[c+1]=Sd(j,w),0!==j&&(s[j+1]=Md(s[j+1],c)),s[w+1]=function Sw(s,o){return 131071&s|o<<17}(s[w+1],c)}else s[c+1]=Sd(w,0),0!==w&&(s[w+1]=Md(s[w+1],c)),w=c;else s[c+1]=Sd(C,0),0===w?w=c:s[C+1]=Md(s[C+1],c),C=c;T&&(s[c+1]=xd(s[c+1])),rg(s,S,c,!0),rg(s,S,c,!1),function SP(s,o,u,c,d){const f=d?s.residualClasses:s.residualStyles;null!=f&&"string"==typeof o&&Qo(f,o)>=0&&(u[c+1]=wp(u[c+1]))}(o,S,s,c,f),y=Sd(w,C),f?o.classBindings=y:o.styleBindings=y}(d,f,o,u,y,c)}}(f,s,y,c),o!==vt&&jn(d,y,o)&&function og(s,o,u,c,d,f,y,w){if(!(3&o.type))return;const C=s.data,T=C[w+1];Kl(function K_(s){return 1==(1&s)}(T)?zI(C,o,u,d,zs(T),y):void 0)||(Kl(f)||function q_(s){return 2==(2&s)}(T)&&(f=zI(C,null,u,d,w,y)),function Gs(s,o,u,c,d){const f=cn(s);if(o)d?f?s.addClass(u,c):u.classList.add(c):f?s.removeClass(u,c):u.classList.remove(c);else{let y=-1===c.indexOf("-")?void 0:Ws.DashCase;if(null==d)f?s.removeStyle(u,c,y):u.style.removeProperty(c);else{const w="string"==typeof d&&d.endsWith("!important");w&&(d=d.slice(0,-10),y|=Ws.Important),f?s.setStyle(u,c,d,y):u.style.setProperty(c,d,w?"important":"")}}}(c,y,Za(lr(),u),d,f))}(f,f.data[lr()],d,d[11],s,d[y+1]=function qI(s,o){return null==s||("string"==typeof o?s+=o:"object"==typeof s&&(s=de(Ai(s)))),s}(o,u),c,y)}(s,o,null,!0),Ky}function Xd(s,o,u,c,d){let f=null;const y=u.directiveEnd;let w=u.directiveStylingLast;for(-1===w?w=u.directiveStart:w++;w<y&&(f=o[w],c=wu(c,f.hostAttrs,d),f!==s);)w++;return null!==s&&(u.directiveStylingLast=w),c}function wu(s,o,u){const c=u?1:2;let d=-1;if(null!==o)for(let f=0;f<o.length;f++){const y=o[f];"number"==typeof y?d=y:d===c&&(Array.isArray(s)||(s=void 0===s?[]:["",s]),Er(s,y,!!u||o[++f]))}return void 0===s?null:s}function zI(s,o,u,c,d,f){const y=null===o;let w;for(;d>0;){const C=s[d],T=Array.isArray(C),S=T?C[1]:C,N=null===S;let j=u[d+1];j===vt&&(j=N?rt:void 0);let Z=N?su(j,c):S===c?j:void 0;if(T&&!Kl(Z)&&(Z=su(C,c)),Kl(Z)&&(w=Z,y))return w;const le=s[d+1];d=y?vs(le):zs(le)}if(null!==o){let C=f?o.residualClasses:o.residualStyles;null!=C&&(w=su(C,c))}return w}function Kl(s){return void 0!==s}function ug(s,o=""){const u=Ie(),c=Bt(),d=s+20,f=c.firstCreatePass?mu(c,d,1,o,null):c.data[d],y=u[d]=function pp(s,o){return cn(s)?s.createText(o):s.createTextNode(o)}(u[11],o);Nl(c,u,y,f),Ui(f,!1)}function Zl(s,o,u){const c=Ie(),d=function qi(s,o,u,c){return jn(s,$o(),u)?o+ne(u)+c:vt}(c,s,o,u);return d!==vt&&Co(c,lr(),d),Zl}const Iu=void 0;var YA=["en",[["a","p"],["AM","PM"],Iu],[["AM","PM"],Iu,Iu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Iu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Iu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Iu,"{1} 'at' {0}",Iu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function ZA(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let Cu={};function lv(s){const o=function RP(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=QA(o);if(u)return u;const c=o.split("-")[0];if(u=QA(c),u)return u;if("en"===c)return YA;throw new Error(`Missing locale data for the locale "${s}".`)}function aC(s){return lv(s)[st.PluralCase]}function QA(s){return s in Cu||(Cu[s]=Vt.ng&&Vt.ng.common&&Vt.ng.common.locales&&Vt.ng.common.locales[s]),Cu[s]}var st=(()=>((st=st||{})[st.LocaleId=0]="LocaleId",st[st.DayPeriodsFormat=1]="DayPeriodsFormat",st[st.DayPeriodsStandalone=2]="DayPeriodsStandalone",st[st.DaysFormat=3]="DaysFormat",st[st.DaysStandalone=4]="DaysStandalone",st[st.MonthsFormat=5]="MonthsFormat",st[st.MonthsStandalone=6]="MonthsStandalone",st[st.Eras=7]="Eras",st[st.FirstDayOfWeek=8]="FirstDayOfWeek",st[st.WeekendRange=9]="WeekendRange",st[st.DateFormat=10]="DateFormat",st[st.TimeFormat=11]="TimeFormat",st[st.DateTimeFormat=12]="DateTimeFormat",st[st.NumberSymbols=13]="NumberSymbols",st[st.NumberFormats=14]="NumberFormats",st[st.CurrencyCode=15]="CurrencyCode",st[st.CurrencySymbol=16]="CurrencySymbol",st[st.CurrencyName=17]="CurrencyName",st[st.Currencies=18]="Currencies",st[st.Directionality=19]="Directionality",st[st.PluralCase=20]="PluralCase",st[st.ExtraData=21]="ExtraData",st))();const yg="en-US";let cv=yg;function sh(s,o,u,c,d){if(s=te(s),Array.isArray(s))for(let f=0;f<s.length;f++)sh(s[f],o,u,c,d);else{const f=Bt(),y=Ie();let w=$d(s)?s:te(s.provide),C=Sy(s);const T=gn(),S=1048575&T.providerIndexes,N=T.directiveStart,j=T.providerIndexes>>20;if($d(s)||!s.multi){const Z=new Ho(C,d,Wl),le=TC(w,o,d?S:S+j,N);-1===le?(fs(Go(T,y),f,w),DC(f,s,o.length),o.push(w),T.directiveStart++,T.directiveEnd++,d&&(T.providerIndexes+=1048576),u.push(Z),y.push(Z)):(u[le]=Z,y[le]=Z)}else{const Z=TC(w,o,S+j,N),le=TC(w,o,S,S+j),Ne=Z>=0&&u[Z],Ve=le>=0&&u[le];if(d&&!Ve||!d&&!Ne){fs(Go(T,y),f,w);const qe=function AC(s,o,u,c,d){const f=new Ho(s,u,Wl);return f.multi=[],f.index=o,f.componentProviders=0,wS(f,d,c&&!u),f}(d?Mg:xg,u.length,d,c,C);!d&&Ve&&(u[le].providerFactory=qe),DC(f,s,o.length,0),o.push(w),T.directiveStart++,T.directiveEnd++,d&&(T.providerIndexes+=1048576),u.push(qe),y.push(qe)}else DC(f,s,Z>-1?Z:le,wS(u[d?le:Z],C,!d&&c));!d&&c&&Ve&&u[le].componentProviders++}}}function DC(s,o,u,c){const d=$d(o),f=function Jw(s){return!!s.useClass}(o);if(d||f){const C=(f?te(o.useClass):o).prototype.ngOnDestroy;if(C){const T=s.destroyHooks||(s.destroyHooks=[]);if(!d&&o.multi){const S=T.indexOf(u);-1===S?T.push(u,[c,C]):T[S+1].push(c,C)}else T.push(u,C)}}}function wS(s,o,u){return u&&s.componentProviders++,s.multi.push(o)-1}function TC(s,o,u,c){for(let d=u;d<c;d++)if(o[d]===s)return d;return-1}function xg(s,o,u,c){return Ia(this.multi,[])}function Mg(s,o,u,c){const d=this.multi;let f;if(this.providerFactory){const y=this.providerFactory.componentProviders,w=pi(u,u[1],this.providerFactory.index,c);f=w.slice(0,y),Ia(d,f);for(let C=y;C<w.length;C++)f.push(w[C])}else f=[],Ia(d,f);return f}function Ia(s,o){for(let u=0;u<s.length;u++)o.push((0,s[u])());return o}function SC(s,o=[]){return u=>{u.providersResolver=(c,d)=>function Tv(s,o,u){const c=Bt();if(c.firstCreatePass){const d=Yr(s);sh(u,c.data,c.blueprint,d,!0),sh(o,c.data,c.blueprint,d,!1)}}(c,d?d(s):s,o)}}class Ca{}class BP{resolveComponentFactory(o){throw function IS(s){const o=Error(`No component factory found for ${de(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let Fr=(()=>{class s{}return s.NULL=new BP,s})();function CS(){return Ql(gn(),Ie())}function Ql(s,o){return new Au(_r(s,o))}let Au=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=CS,s})();function Av(s){return s instanceof Au?s.nativeElement:s}class xC{}let Cs=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function bS(){const s=Ie(),u=yr(gn().index,s);return function $P(s){return s[11]}(hi(u)?u:s)}(),s})(),DS=(()=>{class s{}return s.\u0275prov=zt({token:s,providedIn:"root",factory:()=>null}),s})();class Xs{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Xe=new Xs("13.3.11"),ah={};function _t(s,o,u,c,d=!1){for(;null!==u;){const f=o[u.index];if(null!==f&&c.push(sn(f)),Zr(f))for(let w=10;w<f.length;w++){const C=f[w],T=C[1].firstChild;null!==T&&_t(C[1],C,T,c)}const y=u.type;if(8&y)_t(s,o,u.child,c);else if(32&y){const w=P_(u,o);let C;for(;C=w();)c.push(C)}else if(16&y){const w=pw(o,u);if(Array.isArray(w))c.push(...w);else{const C=Td(o[16]);_t(C[1],C,w,c,!0)}}u=d?u.projectionNext:u.next}return c}class Da{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return _t(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Zr(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(gp(o,c),Yo(u,c))}this._attachedToViewContainer=!1}ow(this._lView[1],this._lView)}onDestroy(o){Vd(this._lView[1],this._lView,null,o)}markForCheck(){_y(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function vy(s,o,u){const c=o[10];c.begin&&c.begin();try{pa(s,o,s.template,u)}catch(d){throw JT(o,d),d}finally{c.end&&c.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Le(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function F_(s,o){K(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Le(902,"");this._appRef=o}}class Rg extends Da{constructor(o){super(o),this._view=o}detectChanges(){Bd(this._view)}checkNoChanges(){}get context(){return null}}class Jl extends Fr{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=ze(o);return new xv(u,this.ngModule)}}function MC(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class xv extends Ca{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function Tw(s){return s.map(Dw).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return MC(this.componentDef.inputs)}get outputs(){return MC(this.componentDef.outputs)}create(o,u,c,d){const f=(d=d||this.ngModule)?function TS(s,o){return{get:(u,c,d)=>{const f=s.get(u,ah,d);return f!==ah||c===ah?f:o.get(u,c,d)}}}(o,d.injector):o,y=f.get(xC,Zu),w=f.get(DS,null),C=y.createRenderer(null,this.componentDef),T=this.componentDef.selectors[0][0]||"div",S=c?function xp(s,o,u){if(cn(s))return s.selectRootElement(o,u===Ft.ShadowDom);let c="string"==typeof o?s.querySelector(o):o;return c.textContent="",c}(C,c,this.componentDef.encapsulation):Nr(y.createRenderer(null,this.componentDef),T,function Sv(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(T)),N=this.componentDef.onPush?576:528,j=function lI(s,o){return{components:[],scheduler:s||DT,clean:QT,playerHandler:o||null,flags:0}}(),Z=Ld(0,null,null,1,0,null,null,null,null,null),le=Pd(null,Z,j,N,null,null,y,C,w,f);let Ne,Ve;il(le);try{const qe=function aI(s,o,u,c,d,f){const y=u[1];u[20]=s;const C=mu(y,20,2,"#host",null),T=C.mergedAttrs=o.hostAttrs;null!==T&&(jd(C,T,!0),null!==s&&(Bi(d,s,T),null!==C.classes&&Ep(d,s,C.classes),null!==C.styles&&_w(d,s,C.styles)));const S=c.createRenderer(s,o),N=Pd(u,Sp(o),null,o.onPush?64:16,u[20],C,c,S,f||null,null);return y.firstCreatePass&&(fs(Go(C,u),y,o.type),dy(y,C),$w(C,u.length,1)),Fl(u,N),u[20]=N}(S,this.componentDef,le,y,C);if(S)if(c)Bi(C,S,["ng-version",Xe.full]);else{const{attrs:_e,classes:z}=function Aw(s){const o=[],u=[];let c=1,d=2;for(;c<s.length;){let f=s[c];if("string"==typeof f)2===d?""!==f&&o.push(f,s[++c]):8===d&&u.push(f);else{if(!hr(d))break;d=f}c++}return{attrs:o,classes:u}}(this.componentDef.selectors[0]);_e&&Bi(C,S,_e),z&&z.length>0&&Ep(C,S,z.join(" "))}if(Ve=Ya(Z,20),void 0!==u){const _e=Ve.projection=[];for(let z=0;z<this.ngContentSelectors.length;z++){const Rt=u[z];_e.push(null!=Rt?Array.from(Rt):null)}}Ne=function uI(s,o,u,c,d){const f=u[1],y=function Uw(s,o,u){const c=gn();s.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),fy(s,c,o,fa(s,o,1,null),u));const d=pi(o,s,c.directiveStart,c);Rr(d,o);const f=_r(c,o);return f&&Rr(f,o),d}(f,u,o);if(c.components.push(y),s[8]=y,d&&d.forEach(C=>C(y,o)),o.contentQueries){const C=gn();o.contentQueries(1,y,C.directiveStart)}const w=gn();return!f.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(cs(w.index),HT(u[1],w,0,w.directiveStart,w.directiveEnd,o),cy(o,y)),y}(qe,this.componentDef,le,j,[bo]),Ap(Z,le,null)}finally{Di()}return new Ng(this.componentType,Ne,Ql(Ve,le),le,Ve)}}class Ng extends class oh{}{constructor(o,u,c,d,f){super(),this.location=c,this._rootLView=d,this._tNode=f,this.instance=u,this.hostView=this.changeDetectorRef=new Rg(d),this.componentType=o}get injector(){return new Fs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class Ri{}class RC{}const Xl=new Map;class Rv extends Ri{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Jl(this);const c=Ze(o);this._bootstrapComponents=ys(c.bootstrap),this._r3Injector=Zw(o,u,[{provide:Ri,useValue:this},{provide:Fr,useValue:this.componentFactoryResolver}],de(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,u=ws.THROW_IF_NOT_FOUND,c=it.Default){return o===ws||o===Ri||o===Iy?this:this._r3Injector.get(o,u,c)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class uh extends RC{constructor(o){super(),this.moduleType=o,null!==Ze(o)&&function NC(s){const o=new Set;!function u(c){const d=Ze(c,!0),f=d.id;null!==f&&(function Pg(s,o,u){if(o&&o!==u)throw new Error(`Duplicate module registered for ${s} - ${de(o)} vs ${de(o.name)}`)}(f,Xl.get(f),c),Xl.set(f,c));const y=ys(d.imports);for(const w of y)o.has(w)||(o.add(w),u(w))}(s)}(o)}create(o){return new Rv(this.moduleType,o)}}function lh(s,o,u){const c=Jn()+s,d=Ie();return d[c]===vt?Ks(d,c,u?o.call(u):o()):Zs(d,c)}function bs(s,o,u,c){return ch(Ie(),Jn(),s,o,u,c)}function kg(s,o,u,c,d){return function Og(s,o,u,c,d,f,y){const w=o+u;return _a(s,w,d,f)?Ks(s,w+2,y?c.call(y,d,f):c(d,f)):ec(s,w+2)}(Ie(),Jn(),s,o,u,c,d)}function Su(s,o,u,c,d,f,y,w){const C=Jn()+s,T=Ie(),S=function zi(s,o,u,c,d,f){const y=_a(s,o,u,c);return _a(s,o+2,d,f)||y}(T,C,u,c,d,f);return jn(T,C+4,y)||S?Ks(T,C+5,w?o.call(w,u,c,d,f,y):o(u,c,d,f,y)):Zs(T,C+5)}function ec(s,o){const u=s[o];return u===vt?void 0:u}function ch(s,o,u,c,d,f){const y=o+u;return jn(s,y,d)?Ks(s,y+1,f?c.call(f,d):c(d)):ec(s,y+1)}function LC(s,o){const u=Bt();let c;const d=s+20;u.firstCreatePass?(c=function Pv(s,o){if(o)for(let u=o.length-1;u>=0;u--){const c=o[u];if(s===c.name)return c}}(o,u.pipeRegistry),u.data[d]=c,c.onDestroy&&(u.destroyHooks||(u.destroyHooks=[])).push(d,c.onDestroy)):c=u.data[d];const f=c.factory||(c.factory=fi(c.type)),y=tn(Wl);try{const w=Et(!1),C=f();return Et(w),function Vy(s,o,u,c){u>=s.data.length&&(s.data[u]=null,s.blueprint[u]=null),o[u]=c}(u,Ie(),d,C),C}finally{tn(y)}}function kv(s,o,u){const c=s+20,d=Ie(),f=function us(s,o){return s[o]}(d,c);return function fh(s,o){return s[1].data[o].pure}(d,c)?ch(d,Jn(),o,f.transform,u,f):f.transform(u)}function tc(s){return o=>{setTimeout(s,void 0,o)}}const Yi=class kS extends g.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){var d,f,y;let w=o,C=u||(()=>null),T=c;if(o&&"object"==typeof o){const N=o;w=null===(d=N.next)||void 0===d?void 0:d.bind(N),C=null===(f=N.error)||void 0===f?void 0:f.bind(N),T=null===(y=N.complete)||void 0===y?void 0:y.bind(N)}this.__isAsync&&(C=tc(C),w&&(w=tc(w)),T&&(T=tc(T)));const S=super.subscribe({next:w,error:C,complete:T});return o instanceof U.w0&&o.add(S),S}};function VC(){return this._results[ma()]()}class Vg{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=ma(),c=Vg.prototype;c[u]||(c[u]=VC)}get changes(){return this._changes||(this._changes=new Yi)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const d=vr(o);(this._changesDetected=!function ad(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let d=s[c],f=o[c];if(u&&(d=u(d),f=u(f)),f!==d)return!1}return!0}(c._results,d,u))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let nc=(()=>{class s{}return s.__NG_ELEMENT_ID__=Fv,s})();const Ug=nc,Ov=class extends Ug{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}createEmbeddedView(o){const u=this._declarationTContainer.tViews,c=Pd(this._declarationLView,u,o,16,null,u.declTNode,null,null,null,null);c[17]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[19];return null!==f&&(c[19]=f.createEmbeddedView(u)),Ap(u,c,o),new Da(c)}};function Fv(){return rc(gn(),Ie())}function rc(s,o){return 4&s.type?new Ov(o,s,Ql(s,o)):null}let ic=(()=>{class s{}return s.__NG_ELEMENT_ID__=UC,s})();function UC(){return jg(gn(),Ie())}const BC=ic,jC=class extends BC{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return Ql(this._hostTNode,this._hostLView)}get injector(){return new Fs(this._hostTNode,this._hostLView)}get parentInjector(){const o=tu(this._hostTNode,this._hostLView);if(Of(o)){const u=ks(o,this._hostLView),c=dn(o);return new Fs(u[1].data[c+8],u)}return new Fs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=Lv(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,c){const d=o.createEmbeddedView(u||{});return this.insert(d,c),d}createComponent(o,u,c,d,f){const y=o&&!function _o(s){return"function"==typeof s}(o);let w;if(y)w=u;else{const N=u||{};w=N.index,c=N.injector,d=N.projectableNodes,f=N.ngModuleRef}const C=y?o:new xv(ze(o)),T=c||this.parentInjector;if(!f&&null==C.ngModule){const j=(y?T:this.parentInjector).get(Ri,null);j&&(f=j)}const S=C.create(T,d,void 0,f);return this.insert(S.hostView,w),S}insert(o,u){const c=o._lView,d=c[1];if(function Tf(s){return Zr(s[3])}(c)){const S=this.indexOf(o);if(-1!==S)this.detach(S);else{const N=c[3],j=new jC(N,N[6],N[3]);j.detach(j.indexOf(o))}}const f=this._adjustIndex(u),y=this._lContainer;!function Rl(s,o,u,c){const d=10+c,f=u.length;c>0&&(u[d-1][4]=o),c<f-10?(o[4]=u[d],ud(u,10+c,o)):(u.push(o),o[4]=null),o[3]=u;const y=o[17];null!==y&&u!==y&&function xT(s,o){const u=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===u?s[9]=[o]:u.push(o)}(y,o);const w=o[19];null!==w&&w.insertView(s),o[2]|=128}(d,c,y,f);const w=vp(f,y),C=c[11],T=_p(C,y[7]);return null!==T&&function iw(s,o,u,c,d,f){c[0]=d,c[6]=o,K(s,c,u,1,d,f)}(d,y[6],C,c,T,w),o.attachToViewContainerRef(),ud(Bg(y),f,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=Lv(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=gp(this._lContainer,u);c&&(Yo(Bg(this._lContainer),u),ow(c[1],c))}detach(o){const u=this._adjustIndex(o,-1),c=gp(this._lContainer,u);return c&&null!=Yo(Bg(this._lContainer),u)?new Da(c):null}_adjustIndex(o,u=0){return null==o?this.length+u:o}};function Lv(s){return s[8]}function Bg(s){return s[8]||(s[8]=[])}function jg(s,o){let u;const c=o[s.index];if(Zr(c))u=c;else{let d;if(8&s.type)d=sn(c);else{const f=o[11];d=f.createComment("");const y=_r(s,o);da(f,_p(f,y),d,function RT(s,o){return cn(s)?s.nextSibling(o):o.nextSibling}(f,y),!1)}o[s.index]=u=py(c,o,d,s),Fl(o,u)}return new jC(u,s,o)}class ph{constructor(o){this.queryList=o,this.matches=null}clone(){return new ph(this.queryList)}setDirty(){this.queryList.setDirty()}}class gh{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let f=0;f<c;f++){const y=u.getByIndex(f);d.push(this.queries[y.indexInDeclarationView].clone())}return new gh(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==Hg(o,u).matches&&this.queries[u].setDirty()}}class rr{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class ir{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const d=null!==u?u.length:0,f=this.getByIndex(c).embeddedTView(o,d);f&&(f.indexInDeclarationView=c,null!==u?u.push(f):u=[f])}return null!==u?new ir(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class sc{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new sc(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const f=c[d];this.matchTNodeWithReadOption(o,u,Vv(u,f)),this.matchTNodeWithReadOption(o,u,dl(u,o,f,!1,!1))}else c===nc?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,dl(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===Au||d===ic||d===nc&&4&u.type)this.addMatch(u.index,-2);else{const f=dl(u,o,d,!1,!1);null!==f&&this.addMatch(u.index,f)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function Vv(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function LS(s,o,u,c){return-1===u?function FS(s,o){return 11&s.type?Ql(s,o):4&s.type?rc(s,o):null}(o,s):-2===u?function WC(s,o,u){return u===Au?Ql(o,s):u===nc?rc(o,s):u===ic?jg(o,s):void 0}(s,o,c):pi(s,s[1],u,o)}function GC(s,o,u,c){const d=o[19].queries[c];if(null===d.matches){const f=s.data,y=u.matches,w=[];for(let C=0;C<y.length;C+=2){const T=y[C];w.push(T<0?null:LS(o,f[T],y[C+1],u.metadata.read))}d.matches=w}return d.matches}function Uv(s,o,u,c){const d=s.queries.getByIndex(u),f=d.matches;if(null!==f){const y=GC(s,o,d,u);for(let w=0;w<f.length;w+=2){const C=f[w];if(C>0)c.push(y[w/2]);else{const T=f[w+1],S=o[-C];for(let N=10;N<S.length;N++){const j=S[N];j[17]===j[3]&&Uv(j[1],j,T,c)}if(null!==S[9]){const N=S[9];for(let j=0;j<N.length;j++){const Z=N[j];Uv(Z[1],Z,T,c)}}}}}return c}function Bv(s){const o=Ie(),u=Bt(),c=Mf();Rf(c+1);const d=Hg(u,c);if(s.dirty&&Lo(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const f=d.crossesNgTemplate?Uv(u,o,c,[]):GC(u,o,d,c);s.reset(f,Av),s.notifyOnChanges()}return!0}return!1}function zC(s,o,u,c){const d=Bt();if(d.firstCreatePass){const f=gn();(function mh(s,o,u){null===s.queries&&(s.queries=new ir),s.queries.track(new sc(o,u))})(d,new rr(o,u,c),f.index),function $v(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}!function KC(s,o,u){const c=new Vg(4==(4&u));Vd(s,o,c,c.destroy),null===o[19]&&(o[19]=new gh),o[19].queries.push(new ph(c))}(d,Ie(),u)}function $g(){return function qC(s,o){return s[19].queries[o].queryList}(Ie(),Mf())}function Hg(s,o){return s.queries.getByIndex(o)}function Ru(...s){}const mn=new vn("Application Initializer");let dc=(()=>{class s{constructor(u){this.appInits=u,this.resolve=Ru,this.reject=Ru,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const u=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const f=this.appInits[d]();if(Qd(f))u.push(f);else if(DA(f)){const y=new Promise((w,C)=>{f.subscribe({complete:w,error:C})});u.push(y)}}Promise.all(u).then(()=>{c()}).catch(d=>{this.reject(d)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(Bn(mn,8))},s.\u0275prov=zt({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const hc=new vn("AppId",{providedIn:"root",factory:function fc(){return`${Jg()}${Jg()}${Jg()}`}});function Jg(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const sb=new vn("Platform Initializer"),WS=new vn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),ob=new vn("appBootstrapListener");let Ch=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=zt({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Xg=new vn("LocaleId",{providedIn:"root",factory:()=>m_(Xg,it.Optional|it.SkipSelf)||function xa(){return"undefined"!=typeof $localize&&$localize.locale||yg}()}),ab=new vn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class zS{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let ub=(()=>{class s{compileModuleSync(u){return new uh(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),f=ys(Ze(u).declarations).reduce((y,w)=>{const C=ze(w);return C&&y.push(new xv(C)),y},[]);return new zS(c,f)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=zt({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const lb=(()=>Promise.resolve(0))();function Dh(s){"undefined"==typeof Zone?lb.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class Qi{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yi(!1),this.onMicrotaskEmpty=new Yi(!1),this.onStable=new Yi(!1),this.onError=new Yi(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&u,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function Xv(){let s=Vt.requestAnimationFrame,o=Vt.cancelAnimationFrame;if("undefined"!=typeof Zone&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function YS(s){const o=()=>{!function ZS(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(Vt,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,eE(s),s.isCheckStableRunning=!0,Th(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),eE(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,d,f,y,w)=>{try{return Ah(s),u.invokeTask(d,f,y,w)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===f.type||s.shouldCoalesceRunChangeDetection)&&o(),pc(s)}},onInvoke:(u,c,d,f,y,w,C)=>{try{return Ah(s),u.invoke(d,f,y,w,C)}finally{s.shouldCoalesceRunChangeDetection&&o(),pc(s)}},onHasTask:(u,c,d,f)=>{u.hasTask(d,f),c===d&&("microTask"==f.change?(s._hasPendingMicrotasks=f.microTask,eE(s),Th(s)):"macroTask"==f.change&&(s.hasPendingMacrotasks=f.macroTask))},onHandleError:(u,c,d,f)=>(u.handleError(d,f),s.runOutsideAngular(()=>s.onError.emit(f)),!1)})}(d)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Qi.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Qi.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,d){const f=this._inner,y=f.scheduleEventTask("NgZoneEvent: "+d,o,cb,Ru,Ru);try{return f.runTask(y,u,c)}finally{f.cancelTask(y)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const cb={};function Th(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function eE(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function Ah(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function pc(s){s._nesting--,Th(s)}class em{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Yi,this.onMicrotaskEmpty=new Yi,this.onStable=new Yi,this.onError=new Yi}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,d){return o.apply(u,c)}}let tm=(()=>{class s{constructor(u){this._ngZone=u,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Qi.assertNotInAngularZone(),Dh(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Dh(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,d){let f=-1;c&&c>0&&(f=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==f),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:f,updateCb:d})}whenStable(u,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(u,c,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(Bn(Qi))},s.\u0275prov=zt({token:s,factory:s.\u0275fac}),s})(),db=(()=>{class s{constructor(){this._applications=new Map,tE.addToWindow(this)}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return tE.findTestabilityInTree(this,u,c)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=zt({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();class Sh{addToWindow(o){}findTestabilityInTree(o,u,c){return null}}function xh(s){tE=s}let tE=new Sh,on=null;const nE=new vn("AllowMultipleToken"),hb=new vn("PlatformOnDestroy");class pb{constructor(o,u){this.name=o,this.token=u}}function Mh(s,o,u=[]){const c=`Platform: ${o}`,d=new vn(c);return(f=[])=>{let y=nm();if(!y||y.injector.get(nE,!1)){const w=[...u,...f,{provide:d,useValue:!0}];s?s(w):function gb(s){if(on&&!on.get(nE,!1))throw new Le(400,"");on=s;const o=s.get(rm),u=s.get(sb,null);u&&u.forEach(c=>c())}(function To(s=[],o){return ws.create({name:o,providers:[{provide:by,useValue:"platform"},{provide:hb,useValue:()=>on=null},...s]})}(w,c))}return function mb(s){const o=nm();if(!o)throw new Le(401,"");return o}()}}function nm(){var s;return null!==(s=null==on?void 0:on.get(rm))&&void 0!==s?s:null}let rm=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const w=function Rh(s,o){let u;return u="noop"===s?new em:("zone.js"===s?void 0:s)||new Qi({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),u}(c?c.ngZone:void 0,{ngZoneEventCoalescing:c&&c.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:c&&c.ngZoneRunCoalescing||!1}),C=[{provide:Qi,useValue:w}];return w.run(()=>{const T=ws.create({providers:C,parent:this.injector,name:u.moduleType.name}),S=u.create(T),N=S.injector.get(cp,null);if(!N)throw new Le(402,"");return w.runOutsideAngular(()=>{const j=w.onError.subscribe({next:Z=>{N.handleError(Z)}});S.onDestroy(()=>{sm(this._modules,S),j.unsubscribe()})}),function _b(s,o,u){try{const c=u();return Qd(c)?c.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(N,w,()=>{const j=S.injector.get(dc);return j.runInitializers(),j.donePromise.then(()=>(function XA(s){St(s,"Expected localeId to be defined"),"string"==typeof s&&(cv=s.toLowerCase().replace(/_/g,"-"))}(S.injector.get(Xg,yg)||yg),this._moduleDoBootstrap(S),S))})})}bootstrapModule(u,c=[]){const d=im({},c);return function QS(s,o,u){const c=new uh(u);return Promise.resolve(c)}(0,0,u).then(f=>this.bootstrapModuleFactory(f,d))}_moduleDoBootstrap(u){const c=u.injector.get(gc);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new Le(403,"");u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Le(404,"");this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(hb,null);null==u||u(),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(Bn(ws))},s.\u0275prov=zt({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function im(s,o){return Array.isArray(o)?o.reduce(im,s):Object.assign(Object.assign({},s),o)}let gc=(()=>{class s{constructor(u,c,d,f){this._zone=u,this._injector=c,this._exceptionHandler=d,this._initStatus=f,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const y=new k.y(C=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{C.next(this._stable),C.complete()})}),w=new k.y(C=>{let T;this._zone.runOutsideAngular(()=>{T=this._zone.onStable.subscribe(()=>{Qi.assertNotInAngularZone(),Dh(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,C.next(!0))})})});const S=this._zone.onUnstable.subscribe(()=>{Qi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{C.next(!1)}))});return()=>{T.unsubscribe(),S.unsubscribe()}});this.isStable=(0,ae.T)(y,w.pipe((0,Ce.B)()))}bootstrap(u,c){if(!this._initStatus.done)throw new Le(405,"");let d;d=u instanceof Ca?u:this._injector.get(Fr).resolveComponentFactory(u),this.componentTypes.push(d.componentType);const f=function fb(s){return s.isBoundToModule}(d)?void 0:this._injector.get(Ri),w=d.create(ws.NULL,[],c||d.selector,f),C=w.location.nativeElement,T=w.injector.get(tm,null),S=T&&w.injector.get(db);return T&&S&&S.registerApplication(C,T),w.onDestroy(()=>{this.detachView(w.hostView),sm(this.components,w),S&&S.unregisterApplication(C)}),this._loadComponent(w),w}tick(){if(this._runningTick)throw new Le(101,"");try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;sm(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(ob,[]).concat(this._bootstrapListeners).forEach(d=>d(u))}ngOnDestroy(){this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return s.\u0275fac=function(u){return new(u||s)(Bn(Qi),Bn(ws),Bn(cp),Bn(dc))},s.\u0275prov=zt({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function sm(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}let rE=!0,mc=!1;function yb(){return mc=!0,rE}function vb(){if(mc)throw new Error("Cannot enable prod mode after platform setup.");rE=!1}let om=(()=>{class s{}return s.__NG_ELEMENT_ID__=Ib,s})();function Ib(s){return function Cb(s,o,u){if(Wa(s)&&!u){const c=yr(s.index,o);return new Da(c,c)}return 47&s.type?new Da(o[16],o):null}(gn(),Ie(),16==(16&s))}class Ao{constructor(){}supports(o){return zd(o)}create(o){return new ox(o)}}const aE=(s,o)=>o;class ox{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||aE}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,d=0,f=null;for(;u||c;){const y=!c||u&&u.currentIndex<lm(c,d,f)?u:c,w=lm(y,d,f),C=y.currentIndex;if(y===c)d--,c=c._nextRemoved;else if(u=u._next,null==y.previousIndex)d++;else{f||(f=[]);const T=w-d,S=C-d;if(T!=S){for(let j=0;j<T;j++){const Z=j<f.length?f[j]:f[j]=0,le=Z+j;S<=le&&le<T&&(f[j]=Z+1)}f[y.previousIndex]=S-T}}w!==C&&o(y,w,C)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!zd(o))throw new Le(900,"");return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,f,y,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let w=0;w<this.length;w++)f=o[w],y=this._trackByFn(w,f),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,f,y,w)),Object.is(u.item,f)||this._addIdentityChange(u,f)):(u=this._mismatch(u,f,y,w),c=!0),u=u._next}else d=0,function Fy(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[ma()]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,w=>{y=this._trackByFn(d,w),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,w,y,d)),Object.is(u.item,w)||this._addIdentityChange(u,w)):(u=this._mismatch(u,w,y,d),c=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,d){let f;return null===o?f=this._itTail:(f=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,f,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,f,d)):o=this._addAfter(new xe(u,c),f,d),o}_verifyReinsertion(o,u,c,d){let f=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==f?o=this._reinsertAfter(f,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,f=o._nextRemoved;return null===d?this._removalsHead=f:d._nextRemoved=f,null===f?this._removalsTail=d:f._prevRemoved=d,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new Ma),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Ma),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class xe{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Hn{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class Ma{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new Hn,this.map.set(u,c)),c.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function lm(s,o,u){const c=s.previousIndex;if(null===c)return c;let d=0;return u&&c<u.length&&(d=u[c]),c+o+d}class Ye{constructor(){}supports(o){return o instanceof Map||Ly(o)}create(){return new pt}}class pt{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||Ly(o)))throw new Le(900,"")}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const f=this._getOrCreateRecordForKey(d,c);u=this._insertBeforeOrAppend(u,f)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const f=d._prev,y=d._next;return f&&(f._next=y),y&&(y._prev=f),d._next=null,d._prev=null,d}const c=new ax(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class ax{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Be(){return new se([new Ao])}let se=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||Be()),deps:[[s,new js,new Hi]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(null!=c)return c;throw new Le(901,"")}}return s.\u0275prov=zt({token:s,providedIn:"root",factory:Be}),s})();function qn(){return new cm([new Ye])}let cm=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||qn()),deps:[[s,new js,new Hi]]}}find(u){const c=this.factories.find(f=>f.supports(u));if(c)return c;throw new Le(901,"")}}return s.\u0275prov=zt({token:s,providedIn:"root",factory:qn}),s})();const cx=Mh(null,"core",[]);let Ab=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(Bn(gc))},s.\u0275mod=L({type:s}),s.\u0275inj=Lt({}),s})()},3942:(Qe,ve,F)=>{F.d(ve,{Z:()=>Le});var g=F(2090),U=F(4859),k=F(9681),ae=F(1877);class Ce{constructor(ne,ye){this._delegate=ne,this.firebase=ye,(0,k._addComponent)(ne,new U.wA("app-compat",()=>this,"PUBLIC")),this.container=ne.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ne){this._delegate.automaticDataCollectionEnabled=ne}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ne=>{this._delegate.checkDestroyed(),ne()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,k.deleteApp)(this._delegate)))}_getService(ne,ye=k._DEFAULT_ENTRY_NAME){var We;this._delegate.checkDestroyed();const $e=this._delegate.container.getProvider(ne);return!$e.isInitialized()&&"EXPLICIT"===(null===(We=$e.getComponent())||void 0===We?void 0:We.instantiationMode)&&$e.initialize(),$e.getImmediate({identifier:ye})}_removeServiceInstance(ne,ye=k._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ne).clearInstance(ye)}_addComponent(ne){(0,k._addComponent)(this._delegate,ne)}_addOrOverwriteComponent(ne){(0,k._addOrOverwriteComponent)(this._delegate,ne)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const De=new g.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),H=function Re(){const ke=function de(ke){const ne={},ye={__esModule:!0,initializeApp:function Se(X,oe={}){const fe=k.initializeApp(X,oe);if((0,g.r3)(ne,fe.name))return ne[fe.name];const Y=new ke(fe,ye);return ne[fe.name]=Y,Y},app:$e,registerVersion:k.registerVersion,setLogLevel:k.setLogLevel,onLog:k.onLog,apps:null,SDK_VERSION:k.SDK_VERSION,INTERNAL:{registerComponent:function he(X){const oe=X.name,fe=oe.replace("-compat","");if(k._registerComponent(X)&&"PUBLIC"===X.type){const Y=(J=$e())=>{if("function"!=typeof J[fe])throw De.create("invalid-app-argument",{appName:oe});return J[fe]()};void 0!==X.serviceProps&&(0,g.ZB)(Y,X.serviceProps),ye[fe]=Y,ke.prototype[fe]=function(...J){return this._getService.bind(this,oe).apply(this,X.multipleInstances?J:[])}}return"PUBLIC"===X.type?ye[fe]:null},removeApp:function We(X){delete ne[X]},useAsService:function Fe(X,oe){return"serverAuth"===oe?null:oe},modularAPIs:k}};function $e(X){if(!(0,g.r3)(ne,X=X||k._DEFAULT_ENTRY_NAME))throw De.create("no-app",{appName:X});return ne[X]}return ye.default=ye,Object.defineProperty(ye,"apps",{get:function ge(){return Object.keys(ne).map(X=>ne[X])}}),$e.App=ke,ye}(Ce);return ke.INTERNAL=Object.assign(Object.assign({},ke.INTERNAL),{createFirebaseNamespace:Re,extendNamespace:function ne(ye){(0,g.ZB)(ke,ye)},createSubscribe:g.ne,ErrorFactory:g.LL,deepExtend:g.ZB}),ke}(),$=new ae.Yd("@firebase/app-compat");if((0,g.jU)()&&void 0!==self.firebase){$.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const ke=self.firebase.SDK_VERSION;ke&&ke.indexOf("LITE")>=0&&$.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Le=H;!function Ae(ke){(0,k.registerVersion)("@firebase/app-compat","0.1.37",ke)}()},9681:(Qe,ve,F)=>{F.r(ve),F.d(ve,{FirebaseError:()=>ae.ZR,SDK_VERSION:()=>li,_DEFAULT_ENTRY_NAME:()=>St,_addComponent:()=>un,_addOrOverwriteComponent:()=>zt,_apps:()=>Yt,_clearComponents:()=>Ar,_components:()=>Nn,_getProvider:()=>Lt,_registerComponent:()=>xt,_removeServiceInstance:()=>fn,deleteApp:()=>it,getApp:()=>gr,getApps:()=>xs,initializeApp:()=>ci,onLog:()=>tn,registerVersion:()=>ln,setLogLevel:()=>Sr});var g=F(5861),U=F(4859),k=F(1877),ae=F(2090),Ce=F(8766);class we{constructor(pe){this.container=pe}getPlatformInfoString(){return this.container.getProviders().map(Ue=>{if(function De(He){const pe=He.getComponent();return"VERSION"===(null==pe?void 0:pe.type)}(Ue)){const ot=Ue.getImmediate();return`${ot.library}/${ot.version}`}return null}).filter(Ue=>Ue).join(" ")}}const de="@firebase/app",H=new k.Yd("@firebase/app"),St="[DEFAULT]",je={[de]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Yt=new Map,Nn=new Map;function un(He,pe){try{He.container.addComponent(pe)}catch(Ue){H.debug(`Component ${pe.name} failed to register with FirebaseApp ${He.name}`,Ue)}}function zt(He,pe){He.container.addOrOverwriteComponent(pe)}function xt(He){const pe=He.name;if(Nn.has(pe))return H.debug(`There were multiple attempts to register component ${pe}.`),!1;Nn.set(pe,He);for(const Ue of Yt.values())un(Ue,He);return!0}function Lt(He,pe){const Ue=He.container.getProvider("heartbeat").getImmediate({optional:!0});return Ue&&Ue.triggerHeartbeat(),He.container.getProvider(pe)}function fn(He,pe,Ue=St){Lt(He,pe).clearInstance(Ue)}function Ar(){Nn.clear()}const Dn=new ae.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ts{constructor(pe,Ue,ot){this._isDeleted=!1,this._options=Object.assign({},pe),this._config=Object.assign({},Ue),this._name=Ue.name,this._automaticDataCollectionEnabled=Ue.automaticDataCollectionEnabled,this._container=ot,this.container.addComponent(new U.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(pe){this.checkDestroyed(),this._automaticDataCollectionEnabled=pe}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(pe){this._isDeleted=pe}checkDestroyed(){if(this.isDeleted)throw Dn.create("app-deleted",{appName:this._name})}}const li="9.12.1";function ci(He,pe={}){let Ue=He;"object"!=typeof pe&&(pe={name:pe});const ot=Object.assign({name:St,automaticDataCollectionEnabled:!1},pe),lt=ot.name;if("string"!=typeof lt||!lt)throw Dn.create("bad-app-name",{appName:String(lt)});if(Ue||(Ue=(0,ae.aH)()),!Ue)throw Dn.create("no-options");const qt=Yt.get(lt);if(qt){if((0,ae.vZ)(Ue,qt.options)&&(0,ae.vZ)(ot,qt.config))return qt;throw Dn.create("duplicate-app",{appName:lt})}const B=new U.H0(lt);for(const q of Nn.values())B.addComponent(q);const V=new ts(Ue,ot,B);return Yt.set(lt,V),V}function gr(He=St){const pe=Yt.get(He);if(!pe&&He===St)return ci();if(!pe)throw Dn.create("no-app",{appName:He});return pe}function xs(){return Array.from(Yt.values())}function it(He){return Gr.apply(this,arguments)}function Gr(){return(Gr=(0,g.Z)(function*(He){const pe=He.name;Yt.has(pe)&&(Yt.delete(pe),yield Promise.all(He.container.getProviders().map(Ue=>Ue.delete())),He.isDeleted=!0)})).apply(this,arguments)}function ln(He,pe,Ue){var ot;let lt=null!==(ot=je[He])&&void 0!==ot?ot:He;Ue&&(lt+=`-${Ue}`);const qt=lt.match(/\s|\//),B=pe.match(/\s|\//);if(qt||B){const V=[`Unable to register library "${lt}" with version "${pe}":`];return qt&&V.push(`library name "${lt}" contains illegal characters (whitespace or "/")`),qt&&B&&V.push("and"),B&&V.push(`version name "${pe}" contains illegal characters (whitespace or "/")`),void H.warn(V.join(" "))}xt(new U.wA(`${lt}-version`,()=>({library:lt,version:pe}),"VERSION"))}function tn(He,pe){if(null!==He&&"function"!=typeof He)throw Dn.create("invalid-log-argument");(0,k.Am)(He,pe)}function Sr(He){(0,k.Ub)(He)}const pn="firebase-heartbeat-store";let or=null;function ns(){return or||(or=(0,Ce.X3)("firebase-heartbeat-database",1,{upgrade:(He,pe)=>{0===pe&&He.createObjectStore(pn)}}).catch(He=>{throw Dn.create("idb-open",{originalErrorMessage:He.message})})),or}function tt(){return(tt=(0,g.Z)(function*(He){var pe;try{return(yield ns()).transaction(pn).objectStore(pn).get(qr(He))}catch(Ue){if(Ue instanceof ae.ZR)H.warn(Ue.message);else{const ot=Dn.create("idb-get",{originalErrorMessage:null===(pe=Ue)||void 0===pe?void 0:pe.message});H.warn(ot.message)}}})).apply(this,arguments)}function Ke(He,pe){return wi.apply(this,arguments)}function wi(){return(wi=(0,g.Z)(function*(He,pe){var Ue;try{const lt=(yield ns()).transaction(pn,"readwrite");return yield lt.objectStore(pn).put(pe,qr(He)),lt.done}catch(ot){if(ot instanceof ae.ZR)H.warn(ot.message);else{const lt=Dn.create("idb-set",{originalErrorMessage:null===(Ue=ot)||void 0===Ue?void 0:Ue.message});H.warn(lt.message)}}})).apply(this,arguments)}function qr(He){return`${He.name}!${He.options.appId}`}class Pn{constructor(pe){this.container=pe,this._heartbeatsCache=null;const Ue=this.container.getProvider("app").getImmediate();this._storage=new Kr(Ue),this._heartbeatsCachePromise=this._storage.read().then(ot=>(this._heartbeatsCache=ot,ot))}triggerHeartbeat(){var pe=this;return(0,g.Z)(function*(){const ot=pe.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),lt=Qt();if(null===pe._heartbeatsCache&&(pe._heartbeatsCache=yield pe._heartbeatsCachePromise),pe._heartbeatsCache.lastSentHeartbeatDate!==lt&&!pe._heartbeatsCache.heartbeats.some(qt=>qt.date===lt))return pe._heartbeatsCache.heartbeats.push({date:lt,agent:ot}),pe._heartbeatsCache.heartbeats=pe._heartbeatsCache.heartbeats.filter(qt=>{const B=new Date(qt.date).valueOf();return Date.now()-B<=2592e6}),pe._storage.overwrite(pe._heartbeatsCache)})()}getHeartbeatsHeader(){var pe=this;return(0,g.Z)(function*(){if(null===pe._heartbeatsCache&&(yield pe._heartbeatsCachePromise),null===pe._heartbeatsCache||0===pe._heartbeatsCache.heartbeats.length)return"";const Ue=Qt(),{heartbeatsToSend:ot,unsentEntries:lt}=function rt(He,pe=1024){const Ue=[];let ot=He.slice();for(const lt of He){const qt=Ue.find(B=>B.agent===lt.agent);if(qt){if(qt.dates.push(lt.date),Ut(Ue)>pe){qt.dates.pop();break}}else if(Ue.push({agent:lt.agent,dates:[lt.date]}),Ut(Ue)>pe){Ue.pop();break}ot=ot.slice(1)}return{heartbeatsToSend:Ue,unsentEntries:ot}}(pe._heartbeatsCache.heartbeats),qt=(0,ae.L)(JSON.stringify({version:2,heartbeats:ot}));return pe._heartbeatsCache.lastSentHeartbeatDate=Ue,lt.length>0?(pe._heartbeatsCache.heartbeats=lt,yield pe._storage.overwrite(pe._heartbeatsCache)):(pe._heartbeatsCache.heartbeats=[],pe._storage.overwrite(pe._heartbeatsCache)),qt})()}}function Qt(){return(new Date).toISOString().substring(0,10)}class Kr{constructor(pe){this.app=pe,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,g.Z)(function*(){return!!(0,ae.hl)()&&(0,ae.eu)().then(()=>!0).catch(()=>!1)})()}read(){var pe=this;return(0,g.Z)(function*(){return(yield pe._canUseIndexedDBPromise)&&(yield function Ft(He){return tt.apply(this,arguments)}(pe.app))||{heartbeats:[]}})()}overwrite(pe){var Ue=this;return(0,g.Z)(function*(){var ot;if(yield Ue._canUseIndexedDBPromise){const qt=yield Ue.read();return Ke(Ue.app,{lastSentHeartbeatDate:null!==(ot=pe.lastSentHeartbeatDate)&&void 0!==ot?ot:qt.lastSentHeartbeatDate,heartbeats:pe.heartbeats})}})()}add(pe){var Ue=this;return(0,g.Z)(function*(){var ot;if(yield Ue._canUseIndexedDBPromise){const qt=yield Ue.read();return Ke(Ue.app,{lastSentHeartbeatDate:null!==(ot=pe.lastSentHeartbeatDate)&&void 0!==ot?ot:qt.lastSentHeartbeatDate,heartbeats:[...qt.heartbeats,...pe.heartbeats]})}})()}}function Ut(He){return(0,ae.L)(JSON.stringify({version:2,heartbeats:He})).length}!function Yn(He){xt(new U.wA("platform-logger",pe=>new we(pe),"PRIVATE")),xt(new U.wA("heartbeat",pe=>new Pn(pe),"PRIVATE")),ln(de,"0.8.2",He),ln(de,"0.8.2","esm2017"),ln("fire-js","")}("")},4859:(Qe,ve,F)=>{F.d(ve,{H0:()=>de,wA:()=>k});var g=F(5861),U=F(2090);class k{constructor(H,$,te){this.name=H,this.instanceFactory=$,this.type=te,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(H){return this.instantiationMode=H,this}setMultipleInstances(H){return this.multipleInstances=H,this}setServiceProps(H){return this.serviceProps=H,this}setInstanceCreatedCallback(H){return this.onInstanceCreated=H,this}}const ae="[DEFAULT]";class Ce{constructor(H,$){this.name=H,this.container=$,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(H){const $=this.normalizeInstanceIdentifier(H);if(!this.instancesDeferred.has($)){const te=new U.BH;if(this.instancesDeferred.set($,te),this.isInitialized($)||this.shouldAutoInitialize())try{const Oe=this.getOrInitializeService({instanceIdentifier:$});Oe&&te.resolve(Oe)}catch(Oe){}}return this.instancesDeferred.get($).promise}getImmediate(H){var $;const te=this.normalizeInstanceIdentifier(null==H?void 0:H.identifier),Oe=null!==($=null==H?void 0:H.optional)&&void 0!==$&&$;if(!this.isInitialized(te)&&!this.shouldAutoInitialize()){if(Oe)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:te})}catch(Ae){if(Oe)return null;throw Ae}}getComponent(){return this.component}setComponent(H){if(H.name!==this.name)throw Error(`Mismatching Component ${H.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=H,this.shouldAutoInitialize()){if(function De(Re){return"EAGER"===Re.instantiationMode}(H))try{this.getOrInitializeService({instanceIdentifier:ae})}catch($){}for(const[$,te]of this.instancesDeferred.entries()){const Oe=this.normalizeInstanceIdentifier($);try{const Ae=this.getOrInitializeService({instanceIdentifier:Oe});te.resolve(Ae)}catch(Ae){}}}}clearInstance(H=ae){this.instancesDeferred.delete(H),this.instancesOptions.delete(H),this.instances.delete(H)}delete(){var H=this;return(0,g.Z)(function*(){const $=Array.from(H.instances.values());yield Promise.all([...$.filter(te=>"INTERNAL"in te).map(te=>te.INTERNAL.delete()),...$.filter(te=>"_delete"in te).map(te=>te._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(H=ae){return this.instances.has(H)}getOptions(H=ae){return this.instancesOptions.get(H)||{}}initialize(H={}){const{options:$={}}=H,te=this.normalizeInstanceIdentifier(H.instanceIdentifier);if(this.isInitialized(te))throw Error(`${this.name}(${te}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Oe=this.getOrInitializeService({instanceIdentifier:te,options:$});for(const[Ae,Le]of this.instancesDeferred.entries())te===this.normalizeInstanceIdentifier(Ae)&&Le.resolve(Oe);return Oe}onInit(H,$){var te;const Oe=this.normalizeInstanceIdentifier($),Ae=null!==(te=this.onInitCallbacks.get(Oe))&&void 0!==te?te:new Set;Ae.add(H),this.onInitCallbacks.set(Oe,Ae);const Le=this.instances.get(Oe);return Le&&H(Le,Oe),()=>{Ae.delete(H)}}invokeOnInitCallbacks(H,$){const te=this.onInitCallbacks.get($);if(te)for(const Oe of te)try{Oe(H,$)}catch(Ae){}}getOrInitializeService({instanceIdentifier:H,options:$={}}){let te=this.instances.get(H);if(!te&&this.component&&(te=this.component.instanceFactory(this.container,{instanceIdentifier:(Re=H,Re===ae?void 0:Re),options:$}),this.instances.set(H,te),this.instancesOptions.set(H,$),this.invokeOnInitCallbacks(te,H),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,H,te)}catch(Oe){}var Re;return te||null}normalizeInstanceIdentifier(H=ae){return this.component?this.component.multipleInstances?H:ae:H}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class de{constructor(H){this.name=H,this.providers=new Map}addComponent(H){const $=this.getProvider(H.name);if($.isComponentSet())throw new Error(`Component ${H.name} has already been registered with ${this.name}`);$.setComponent(H)}addOrOverwriteComponent(H){this.getProvider(H.name).isComponentSet()&&this.providers.delete(H.name),this.addComponent(H)}getProvider(H){if(this.providers.has(H))return this.providers.get(H);const $=new Ce(H,this);return this.providers.set(H,$),$}getProviders(){return Array.from(this.providers.values())}}},1877:(Qe,ve,F)=>{F.d(ve,{Am:()=>Re,Ub:()=>de,Yd:()=>De,in:()=>U});const g=[];var U=(()=>{return(H=U||(U={}))[H.DEBUG=0]="DEBUG",H[H.VERBOSE=1]="VERBOSE",H[H.INFO=2]="INFO",H[H.WARN=3]="WARN",H[H.ERROR=4]="ERROR",H[H.SILENT=5]="SILENT",U;var H})();const k={debug:U.DEBUG,verbose:U.VERBOSE,info:U.INFO,warn:U.WARN,error:U.ERROR,silent:U.SILENT},ae=U.INFO,Ce={[U.DEBUG]:"log",[U.VERBOSE]:"log",[U.INFO]:"info",[U.WARN]:"warn",[U.ERROR]:"error"},we=(H,$,...te)=>{if($<H.logLevel)return;const Oe=(new Date).toISOString(),Ae=Ce[$];if(!Ae)throw new Error(`Attempted to log a message with an invalid logType (value: ${$})`);console[Ae](`[${Oe}]  ${H.name}:`,...te)};class De{constructor($){this.name=$,this._logLevel=ae,this._logHandler=we,this._userLogHandler=null,g.push(this)}get logLevel(){return this._logLevel}set logLevel($){if(!($ in U))throw new TypeError(`Invalid value "${$}" assigned to \`logLevel\``);this._logLevel=$}setLogLevel($){this._logLevel="string"==typeof $?k[$]:$}get logHandler(){return this._logHandler}set logHandler($){if("function"!=typeof $)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=$}get userLogHandler(){return this._userLogHandler}set userLogHandler($){this._userLogHandler=$}debug(...$){this._userLogHandler&&this._userLogHandler(this,U.DEBUG,...$),this._logHandler(this,U.DEBUG,...$)}log(...$){this._userLogHandler&&this._userLogHandler(this,U.VERBOSE,...$),this._logHandler(this,U.VERBOSE,...$)}info(...$){this._userLogHandler&&this._userLogHandler(this,U.INFO,...$),this._logHandler(this,U.INFO,...$)}warn(...$){this._userLogHandler&&this._userLogHandler(this,U.WARN,...$),this._logHandler(this,U.WARN,...$)}error(...$){this._userLogHandler&&this._userLogHandler(this,U.ERROR,...$),this._logHandler(this,U.ERROR,...$)}}function de(H){g.forEach($=>{$.setLogLevel(H)})}function Re(H,$){for(const te of g){let Oe=null;$&&$.level&&(Oe=k[$.level]),te.userLogHandler=null===H?null:(Ae,Le,...ke)=>{const ne=ke.map(ye=>{if(null==ye)return null;if("string"==typeof ye)return ye;if("number"==typeof ye||"boolean"==typeof ye)return ye.toString();if(ye instanceof Error)return ye.message;try{return JSON.stringify(ye)}catch(We){return null}}).filter(ye=>ye).join(" ");Le>=(null!=Oe?Oe:Ae.logLevel)&&H({level:U[Le].toLowerCase(),message:ne,args:ke,type:Ae.name})}}}},8766:(Qe,ve,F)=>{F.d(ve,{Lj:()=>Se,X3:()=>$e});var g=F(5861);let k,ae;const De=new WeakMap,de=new WeakMap,Re=new WeakMap,H=new WeakMap,$=new WeakMap;let Ae={get(oe,fe,Y){if(oe instanceof IDBTransaction){if("done"===fe)return de.get(oe);if("objectStoreNames"===fe)return oe.objectStoreNames||Re.get(oe);if("store"===fe)return Y.objectStoreNames[1]?void 0:Y.objectStore(Y.objectStoreNames[0])}return ye(oe[fe])},set:(oe,fe,Y)=>(oe[fe]=Y,!0),has:(oe,fe)=>oe instanceof IDBTransaction&&("done"===fe||"store"===fe)||fe in oe};function ne(oe){return"function"==typeof oe?function ke(oe){return oe!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function we(){return ae||(ae=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(oe)?function(...fe){return oe.apply(We(this),fe),ye(De.get(this))}:function(...fe){return ye(oe.apply(We(this),fe))}:function(fe,...Y){const J=oe.call(We(this),fe,...Y);return Re.set(J,fe.sort?fe.sort():[fe]),ye(J)}}(oe):(oe instanceof IDBTransaction&&function Oe(oe){if(de.has(oe))return;const fe=new Promise((Y,J)=>{const ee=()=>{oe.removeEventListener("complete",ce),oe.removeEventListener("error",ie),oe.removeEventListener("abort",ie)},ce=()=>{Y(),ee()},ie=()=>{J(oe.error||new DOMException("AbortError","AbortError")),ee()};oe.addEventListener("complete",ce),oe.addEventListener("error",ie),oe.addEventListener("abort",ie)});de.set(oe,fe)}(oe),((oe,fe)=>fe.some(Y=>oe instanceof Y))(oe,function Ce(){return k||(k=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(oe,Ae):oe)}function ye(oe){if(oe instanceof IDBRequest)return function te(oe){const fe=new Promise((Y,J)=>{const ee=()=>{oe.removeEventListener("success",ce),oe.removeEventListener("error",ie)},ce=()=>{Y(ye(oe.result)),ee()},ie=()=>{J(oe.error),ee()};oe.addEventListener("success",ce),oe.addEventListener("error",ie)});return fe.then(Y=>{Y instanceof IDBCursor&&De.set(Y,oe)}).catch(()=>{}),$.set(fe,oe),fe}(oe);if(H.has(oe))return H.get(oe);const fe=ne(oe);return fe!==oe&&(H.set(oe,fe),$.set(fe,oe)),fe}const We=oe=>$.get(oe);function $e(oe,fe,{blocked:Y,upgrade:J,blocking:ee,terminated:ce}={}){const ie=indexedDB.open(oe,fe),Me=ye(ie);return J&&ie.addEventListener("upgradeneeded",nt=>{J(ye(ie.result),nt.oldVersion,nt.newVersion,ye(ie.transaction))}),Y&&ie.addEventListener("blocked",()=>Y()),Me.then(nt=>{ce&&nt.addEventListener("close",()=>ce()),ee&&nt.addEventListener("versionchange",()=>ee())}).catch(()=>{}),Me}function Se(oe,{blocked:fe}={}){const Y=indexedDB.deleteDatabase(oe);return fe&&Y.addEventListener("blocked",()=>fe()),ye(Y).then(()=>{})}const ge=["get","getKey","getAll","getAllKeys","count"],he=["put","add","delete","clear"],Fe=new Map;function X(oe,fe){if(!(oe instanceof IDBDatabase)||fe in oe||"string"!=typeof fe)return;if(Fe.get(fe))return Fe.get(fe);const Y=fe.replace(/FromIndex$/,""),J=fe!==Y,ee=he.includes(Y);if(!(Y in(J?IDBIndex:IDBObjectStore).prototype)||!ee&&!ge.includes(Y))return;const ce=function(){var ie=(0,g.Z)(function*(Me,...nt){const Wt=this.transaction(Me,ee?"readwrite":"readonly");let St=Wt.store;return J&&(St=St.index(nt.shift())),(yield Promise.all([St[Y](...nt),ee&&Wt.done]))[0]});return function(nt){return ie.apply(this,arguments)}}();return Fe.set(fe,ce),ce}!function Le(oe){Ae=oe(Ae)}(oe=>QV(YV({},oe),{get:(fe,Y,J)=>X(fe,Y)||oe.get(fe,Y,J),has:(fe,Y)=>!!X(fe,Y)||oe.has(fe,Y)}))},5861:(Qe,ve,F)=>{function g(k,ae,Ce,we,De,de,Re){try{var H=k[de](Re),$=H.value}catch(te){return void Ce(te)}H.done?ae($):Promise.resolve($).then(we,De)}function U(k){return function(){var ae=this,Ce=arguments;return new Promise(function(we,De){var de=k.apply(ae,Ce);function Re($){g(de,we,De,Re,H,"next",$)}function H($){g(de,we,De,Re,H,"throw",$)}Re(void 0)})}}F.d(ve,{Z:()=>U})}},Qe=>{Qe(Qe.s=3747)}]);